var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(n){var q=0;return function(){return q<n.length?{done:!1,value:n[q++]}:{done:!0}}};$jscomp.arrayIterator=function(n){return{next:$jscomp.arrayIteratorImpl(n)}};$jscomp.makeIterator=function(n){var q="undefined"!=typeof Symbol&&Symbol.iterator&&n[Symbol.iterator];return q?q.call(n):$jscomp.arrayIterator(n)};
$jscomp.getGlobal=function(n){return"undefined"!=typeof window&&window===n?n:"undefined"!=typeof global&&null!=global?global:n};$jscomp.global=$jscomp.getGlobal(this);$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(n,q,a){n!=Array.prototype&&n!=Object.prototype&&(n[q]=a.value)};
$jscomp.polyfill=function(n,q,a,h){if(q){a=$jscomp.global;n=n.split(".");for(h=0;h<n.length-1;h++){var g=n[h];g in a||(a[g]={});a=a[g]}n=n[n.length-1];h=a[n];q=q(h);q!=h&&null!=q&&$jscomp.defineProperty(a,n,{configurable:!0,writable:!0,value:q})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(n){function q(){this.batch_=null}function a(a){return a instanceof g?a:new g(function(d,m){d(a)})}if(n&&!$jscomp.FORCE_POLYFILL_PROMISE)return n;q.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var d=this;this.asyncExecuteFunction(function(){d.executeBatch_()})}this.batch_.push(a)};var h=$jscomp.global.setTimeout;q.prototype.asyncExecuteFunction=function(a){h(a,0)};q.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var g=0;g<a.length;++g){var m=a[g];a[g]=null;try{m()}catch(c){this.asyncThrow_(c)}}}this.batch_=null};q.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var g=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var d=this.createResolveAndReject_();try{a(d.resolve,d.reject)}catch(m){d.reject(m)}};g.prototype.createResolveAndReject_=function(){function a(c){return function(b){m||(m=!0,c.call(g,b))}}var g=this,m=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};g.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof g)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var d=null!=a;break a;case "function":d=!0;break a;default:d=!1}d?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};g.prototype.resolveToNonPromiseObj_=function(a){var d=void 0;try{d=a.then}catch(m){this.reject_(m);return}"function"==typeof d?
this.settleSameAsThenable_(d,a):this.fulfill_(a)};g.prototype.reject_=function(a){this.settle_(2,a)};g.prototype.fulfill_=function(a){this.settle_(1,a)};g.prototype.settle_=function(a,g){if(0!=this.state_)throw Error("Cannot settle("+a+", "+g+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=g;this.executeOnSettledCallbacks_()};g.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)p.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var p=new q;g.prototype.settleSameAsPromise_=function(a){var d=this.createResolveAndReject_();a.callWhenSettled_(d.resolve,d.reject)};g.prototype.settleSameAsThenable_=function(a,g){var m=this.createResolveAndReject_();try{a.call(g,m.resolve,m.reject)}catch(c){m.reject(c)}};g.prototype.then=function(a,h){function m(l,a){return"function"==typeof l?function(k){try{c(l(k))}catch(t){b(t)}}:a}var c,b,l=new g(function(l,a){c=l;b=a});this.callWhenSettled_(m(a,c),m(h,b));return l};
g.prototype.catch=function(a){return this.then(void 0,a)};g.prototype.callWhenSettled_=function(a,g){function m(){switch(c.state_){case 1:a(c.result_);break;case 2:g(c.result_);break;default:throw Error("Unexpected state: "+c.state_);}}var c=this;null==this.onSettledCallbacks_?p.asyncExecute(m):this.onSettledCallbacks_.push(m)};g.resolve=a;g.reject=function(a){return new g(function(g,m){m(a)})};g.race=function(d){return new g(function(g,m){for(var c=$jscomp.makeIterator(d),b=c.next();!b.done;b=c.next())a(b.value).callWhenSettled_(g,
m)})};g.all=function(d){var h=$jscomp.makeIterator(d),m=h.next();return m.done?a([]):new g(function(c,b){function l(b){return function(l){f[b]=l;r--;0==r&&c(f)}}var f=[],r=0;do f.push(void 0),r++,a(m.value).callWhenSettled_(l(f.length-1),b),m=h.next();while(!m.done)})};return g},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(n){return n?n:function(n,a,h){var g=this.length||0;0>a&&(a=Math.max(0,g+a));if(null==h||h>g)h=g;h=Number(h);0>h&&(h=Math.max(0,g+h));for(a=Number(a||0);a<h;a++)this[a]=n;return this}},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(n,q){this.$jscomp$symbol$id_=n;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:q})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function n(a){if(this instanceof n)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(a||"")+"_"+q++,a)}var q=0;return n}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var n=$jscomp.global.Symbol.iterator;n||(n=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[n]&&$jscomp.defineProperty(Array.prototype,n,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var n=$jscomp.global.Symbol.asyncIterator;n||(n=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(n){$jscomp.initSymbolIterator();n={next:n};n[$jscomp.global.Symbol.iterator]=function(){return this};return n};
$jscomp.iteratorFromArray=function(n,q){$jscomp.initSymbolIterator();n instanceof String&&(n+="");var a=0,h={next:function(){if(a<n.length){var g=a++;return{value:q(g,n[g]),done:!1}}h.next=function(){return{done:!0,value:void 0}};return h.next()}};h[Symbol.iterator]=function(){return h};return h};$jscomp.polyfill("Array.prototype.keys",function(n){return n?n:function(){return $jscomp.iteratorFromArray(this,function(n){return n})}},"es6","es3");
(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"17qc":function(n,q,a){a.d(q,"a",function(){return p});var h=a("oYeq"),g=a("ADVu");n=a("xCqU");var p=function(a){function d(){var m=null!==a&&a.apply(this,arguments)||this;m.buttons=[0,1,2];m.angularSensibilityX=1E3;m.angularSensibilityY=1E3;m.pinchPrecision=12;m.pinchDeltaPercentage=0;m.useNaturalPinchZoom=!1;m.panningSensibility=1E3;m.multiTouchPanning=!0;m.multiTouchPanAndZoom=!0;m.pinchInwards=!0;m._isPanClick=!1;m._twoFingerActivityCount=
0;m._isPinching=!1;return m}Object(h.d)(d,a);d.prototype.getClassName=function(){return"ArcRotateCameraPointersInput"};d.prototype.onTouch=function(a,c,b){0!==this.panningSensibility&&(this._ctrlKey&&this.camera._useCtrlForPanning||this._isPanClick)?(this.camera.inertialPanningX+=-c/this.panningSensibility,this.camera.inertialPanningY+=b/this.panningSensibility):(this.camera.inertialAlphaOffset-=c/this.angularSensibilityX,this.camera.inertialBetaOffset-=b/this.angularSensibilityY)};d.prototype.onDoubleTap=
function(a){this.camera.useInputToRestoreState&&this.camera.restoreState()};d.prototype.onMultiTouch=function(a,c,b,l,f,r){if(0!==b||null!==f)if(0!==l||null!==r)if(a=this.pinchInwards?1:-1,this.multiTouchPanAndZoom)this.useNaturalPinchZoom?this.camera.radius=this.camera.radius*Math.sqrt(b)/Math.sqrt(l):this.camera.inertialRadiusOffset=this.pinchDeltaPercentage?this.camera.inertialRadiusOffset+.001*(l-b)*this.camera.radius*this.pinchDeltaPercentage:this.camera.inertialRadiusOffset+(l-b)/(this.pinchPrecision*
a*(this.angularSensibilityX+this.angularSensibilityY)/2),0!==this.panningSensibility&&f&&r&&(b=r.x-f.x,f=r.y-f.y,this.camera.inertialPanningX+=-b/this.panningSensibility,this.camera.inertialPanningY+=f/this.panningSensibility);else{this._twoFingerActivityCount++;c=Math.sqrt(b);var k=Math.sqrt(l);this._isPinching||20>this._twoFingerActivityCount&&Math.abs(k-c)>this.camera.pinchToPanMaxDistance?(this.camera.inertialRadiusOffset=this.pinchDeltaPercentage?this.camera.inertialRadiusOffset+.001*(l-b)*this.camera.radius*
this.pinchDeltaPercentage:this.camera.inertialRadiusOffset+(l-b)/(this.pinchPrecision*a*(this.angularSensibilityX+this.angularSensibilityY)/2),this._isPinching=!0):0!==this.panningSensibility&&this.multiTouchPanning&&r&&f&&(b=r.x-f.x,f=r.y-f.y,this.camera.inertialPanningX+=-b/this.panningSensibility,this.camera.inertialPanningY+=f/this.panningSensibility)}};d.prototype.onButtonDown=function(a){this._isPanClick=a.button===this.camera._panningMouseButton};d.prototype.onButtonUp=function(a){this._twoFingerActivityCount=
0;this._isPinching=!1};d.prototype.onLostFocus=function(){this._isPanClick=!1;this._twoFingerActivityCount=0;this._isPinching=!1};Object(h.c)([Object(g.c)()],d.prototype,"buttons",void 0);Object(h.c)([Object(g.c)()],d.prototype,"angularSensibilityX",void 0);Object(h.c)([Object(g.c)()],d.prototype,"angularSensibilityY",void 0);Object(h.c)([Object(g.c)()],d.prototype,"pinchPrecision",void 0);Object(h.c)([Object(g.c)()],d.prototype,"pinchDeltaPercentage",void 0);Object(h.c)([Object(g.c)()],d.prototype,
"useNaturalPinchZoom",void 0);Object(h.c)([Object(g.c)()],d.prototype,"panningSensibility",void 0);Object(h.c)([Object(g.c)()],d.prototype,"multiTouchPanning",void 0);Object(h.c)([Object(g.c)()],d.prototype,"multiTouchPanAndZoom",void 0);return d}(a("cCS0").a);n.a.ArcRotateCameraPointersInput=p},"46vk":function(n,q,a){a.d(q,"a",function(){return r});var h=a("oYeq"),g=a("ps+7");n=a("sdjL");var p=a("CAkI"),d=a("/SR9"),u=a("M9Dn"),m=a("dprs");q=a("Ufda");var c=a("SqLj"),b=a("uyO6"),l=a("0FRC");a("JwOz");
a("fBKG");var f=a("YKqZ");q.a.AddNodeConstructor("WebVRFreeCamera",function(b,c){return function(){return new r(b,d.e.Zero(),c)}});q.a.AddNodeConstructor("WebVRGamepadCamera",function(b,c){return function(){return new r(b,d.e.Zero(),c)}});var r=function(k){function a(c,a,f,r){void 0===r&&(r={});var e=k.call(this,c,a,f)||this;e.webVROptions=r;e._vrDevice=null;e.rawPose=null;e._specsVersion="1.1";e._attached=!1;e._descendants=[];e._deviceRoomPosition=d.e.Zero();e._deviceRoomRotationQuaternion=d.b.Identity();
e._standingMatrix=null;e.devicePosition=d.e.Zero();e.deviceRotationQuaternion=d.b.Identity();e.deviceScaleFactor=1;e._deviceToWorld=d.a.Identity();e._worldToDevice=d.a.Identity();e.controllers=[];e.onControllersAttachedObservable=new g.a;e.onControllerMeshLoadedObservable=new g.a;e.onPoseUpdatedFromDeviceObservable=new g.a;e._poseSet=!1;e.rigParenting=!0;e._defaultHeight=void 0;e._detachIfAttached=function(){var b=e.getEngine().getVRDevice();b&&!b.isPresenting&&e.detachControl()};e._workingVector=
d.e.Zero();e._oneVector=d.e.One();e._workingMatrix=d.a.Identity();e._tmpMatrix=new d.a;e._cache.position=d.e.Zero();r.defaultHeight&&(e._defaultHeight=r.defaultHeight,e.position.y=e._defaultHeight);e.minZ=.1;5===arguments.length&&(e.webVROptions=arguments[4]);void 0==e.webVROptions.trackPosition&&(e.webVROptions.trackPosition=!0);void 0==e.webVROptions.controllerMeshes&&(e.webVROptions.controllerMeshes=!0);void 0==e.webVROptions.defaultLightingOnControllers&&(e.webVROptions.defaultLightingOnControllers=
!0);e.rotationQuaternion=new d.b;e.webVROptions&&e.webVROptions.positionScale&&(e.deviceScaleFactor=e.webVROptions.positionScale);var v=e.getEngine();e._onVREnabled=function(b){b&&e.initControllers()};v.onVRRequestPresentComplete.add(e._onVREnabled);v.initWebVR().add(function(b){b.vrDisplay&&e._vrDevice!==b.vrDisplay&&(e._vrDevice=b.vrDisplay,e.setCameraRigMode(p.a.RIG_MODE_WEBVR,{parentCamera:e,vrDisplay:e._vrDevice,frameData:e._frameData,specs:e._specsVersion}),e._attached&&e.getEngine().enableVR(e.webVROptions))});
"undefined"!==typeof VRFrameData&&(e._frameData=new VRFrameData);r.useMultiview&&(e.getScene().getEngine().getCaps().multiview?(e._useMultiviewToSingleView=!0,e._rigPostProcess=new l.a("VRMultiviewToSingleview",e,1)):(b.a.Warn("Multiview is not supported, falling back to standard rendering"),e._useMultiviewToSingleView=!1));f.onBeforeCameraRenderObservable.add(function(b){b.parent===e&&e.rigParenting&&(e._descendants=e.getDescendants(!0,function(b){var c=e.controllers.some(function(c){return c._mesh===
b}),a=-1!==e._rigCameras.indexOf(b);return!c&&!a}),e._descendants.forEach(function(c){c.parent=b}))});f.onAfterCameraRenderObservable.add(function(b){b.parent===e&&e.rigParenting&&e._descendants.forEach(function(b){b.parent=e})});return e}Object(h.d)(a,k);a.prototype.deviceDistanceToRoomGround=function(){return this._standingMatrix?(this._standingMatrix.getTranslationToRef(this._workingVector),this._deviceRoomPosition.y+this._workingVector.y):this._defaultHeight||0};a.prototype.useStandingMatrix=
function(b){var c=this;void 0===b&&(b=function(b){});this.getEngine().initWebVRAsync().then(function(e){e.vrDisplay&&e.vrDisplay.stageParameters&&e.vrDisplay.stageParameters.sittingToStandingTransform&&c.webVROptions.trackPosition?(c._standingMatrix=new d.a,d.a.FromFloat32ArrayToRefScaled(e.vrDisplay.stageParameters.sittingToStandingTransform,0,1,c._standingMatrix),c.getScene().useRightHandedSystem||c._standingMatrix&&c._standingMatrix.toggleModelMatrixHandInPlace(),b(!0)):b(!1)})};a.prototype.useStandingMatrixAsync=
function(){var b=this;return new Promise(function(c){b.useStandingMatrix(function(b){c(b)})})};a.prototype.dispose=function(){this._detachIfAttached();this.getEngine().onVRRequestPresentComplete.removeCallback(this._onVREnabled);this._updateCacheWhenTrackingDisabledObserver&&this._scene.onBeforeRenderObservable.remove(this._updateCacheWhenTrackingDisabledObserver);k.prototype.dispose.call(this)};a.prototype.getControllerByName=function(b){for(var c=0,a=this.controllers;c<a.length;c++){var l=a[c];
if(l.hand===b)return l}return null};Object.defineProperty(a.prototype,"leftController",{get:function(){this._leftController||(this._leftController=this.getControllerByName("left"));return this._leftController},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"rightController",{get:function(){this._rightController||(this._rightController=this.getControllerByName("right"));return this._rightController},enumerable:!1,configurable:!0});a.prototype.getForwardRay=function(b){void 0===b&&
(b=100);return this.leftCamera?k.prototype.getForwardRay.call(this,b,this.leftCamera.getWorldMatrix(),this.leftCamera.globalPosition):k.prototype.getForwardRay.call(this,b)};a.prototype._checkInputs=function(){this._vrDevice&&this._vrDevice.isPresenting&&(this._vrDevice.getFrameData(this._frameData),this.updateFromDevice(this._frameData.pose));k.prototype._checkInputs.call(this)};a.prototype.updateFromDevice=function(b){b&&b.orientation&&4===b.orientation.length&&(this.rawPose=b,this._deviceRoomRotationQuaternion.copyFromFloats(b.orientation[0],
b.orientation[1],-b.orientation[2],-b.orientation[3]),this.getScene().useRightHandedSystem&&(this._deviceRoomRotationQuaternion.z*=-1,this._deviceRoomRotationQuaternion.w*=-1),this.webVROptions.trackPosition&&this.rawPose.position&&(this._deviceRoomPosition.copyFromFloats(this.rawPose.position[0],this.rawPose.position[1],-this.rawPose.position[2]),this.getScene().useRightHandedSystem&&(this._deviceRoomPosition.z*=-1)),this._poseSet=!0)};a.prototype.attachControl=function(b){b=f.b.BackCompatCameraNoPreventDefault(arguments);
k.prototype.attachControl.call(this,b);this._attached=!0;b=p.a.ForceAttachControlToAlwaysPreventDefault?!1:b;this._vrDevice&&this.getEngine().enableVR(this.webVROptions);var c=this._scene.getEngine().getHostWindow();c&&c.addEventListener("vrdisplaypresentchange",this._detachIfAttached)};a.prototype.detachControl=function(b){this.getScene().gamepadManager.onGamepadConnectedObservable.remove(this._onGamepadConnectedObserver);this.getScene().gamepadManager.onGamepadDisconnectedObservable.remove(this._onGamepadDisconnectedObserver);
k.prototype.detachControl.call(this);this._attached=!1;this.getEngine().disableVR();window.removeEventListener("vrdisplaypresentchange",this._detachIfAttached)};a.prototype.getClassName=function(){return"WebVRFreeCamera"};a.prototype.resetToCurrentRotation=function(){this._vrDevice.resetPose()};a.prototype._updateRigCameras=function(){var b=this._rigCameras[0],c=this._rigCameras[1];b.rotationQuaternion.copyFrom(this._deviceRoomRotationQuaternion);c.rotationQuaternion.copyFrom(this._deviceRoomRotationQuaternion);
b.position.copyFrom(this._deviceRoomPosition);c.position.copyFrom(this._deviceRoomPosition)};a.prototype._correctPositionIfNotTrackPosition=function(b,c){void 0===c&&(c=!1);this.rawPose&&this.rawPose.position&&!this.webVROptions.trackPosition&&(d.a.TranslationToRef(this.rawPose.position[0],this.rawPose.position[1],-this.rawPose.position[2],this._tmpMatrix),c||this._tmpMatrix.invert(),this._tmpMatrix.multiplyToRef(b,b))};a.prototype._updateCache=function(b){var c=this;this.rotationQuaternion.equals(this._cache.rotationQuaternion)&&
this.position.equals(this._cache.position)||(this.updateCacheCalled||(this.updateCacheCalled=!0,this.update()),this.rotationQuaternion.toRotationMatrix(this._workingMatrix),d.e.TransformCoordinatesToRef(this._deviceRoomPosition,this._workingMatrix,this._workingVector),this.devicePosition.subtractToRef(this._workingVector,this._workingVector),d.a.ComposeToRef(this._oneVector,this.rotationQuaternion,this._workingVector,this._deviceToWorld),this._deviceToWorld.getTranslationToRef(this._workingVector),
this._workingVector.addInPlace(this.position),this._workingVector.subtractInPlace(this._cache.position),this._deviceToWorld.setTranslation(this._workingVector),this._deviceToWorld.invertToRef(this._worldToDevice),this.controllers.forEach(function(b){b._deviceToWorld.copyFrom(c._deviceToWorld);c._correctPositionIfNotTrackPosition(b._deviceToWorld);b.update()}));b||k.prototype._updateCache.call(this);this.updateCacheCalled=!1};a.prototype._computeDevicePosition=function(){d.e.TransformCoordinatesToRef(this._deviceRoomPosition,
this._deviceToWorld,this.devicePosition)};a.prototype.update=function(){this._computeDevicePosition();d.a.FromQuaternionToRef(this._deviceRoomRotationQuaternion,this._workingMatrix);this._workingMatrix.multiplyToRef(this._deviceToWorld,this._workingMatrix);d.b.FromRotationMatrixToRef(this._workingMatrix,this.deviceRotationQuaternion);this._poseSet&&this.onPoseUpdatedFromDeviceObservable.notifyObservers(null);k.prototype.update.call(this)};a.prototype._getViewMatrix=function(){return d.a.Identity()};
a.prototype._getWebVRViewMatrix=function(){var b=this._cameraRigParams.parentCamera;b._updateCache();d.a.FromArrayToRef(this._cameraRigParams.left?this._cameraRigParams.frameData.leftViewMatrix:this._cameraRigParams.frameData.rightViewMatrix,0,this._webvrViewMatrix);this.getScene().useRightHandedSystem||this._webvrViewMatrix.toggleModelMatrixHandInPlace();this._webvrViewMatrix.getRotationMatrixToRef(this._cameraRotationMatrix);d.e.TransformCoordinatesToRef(this._referencePoint,this._cameraRotationMatrix,
this._transformedReferencePoint);this.position.addToRef(this._transformedReferencePoint,this._currentTarget);1!==b.deviceScaleFactor&&(this._webvrViewMatrix.invert(),b.deviceScaleFactor&&(this._webvrViewMatrix.multiplyAtIndex(12,b.deviceScaleFactor),this._webvrViewMatrix.multiplyAtIndex(13,b.deviceScaleFactor),this._webvrViewMatrix.multiplyAtIndex(14,b.deviceScaleFactor)),this._webvrViewMatrix.invert());b._correctPositionIfNotTrackPosition(this._webvrViewMatrix,!0);b._worldToDevice.multiplyToRef(this._webvrViewMatrix,
this._webvrViewMatrix);this._workingMatrix=this._workingMatrix||d.a.Identity();this._webvrViewMatrix.invertToRef(this._workingMatrix);this._workingMatrix.multiplyToRef(b.getWorldMatrix(),this._workingMatrix);this._workingMatrix.getTranslationToRef(this._globalPosition);this._markSyncedWithParent();return this._webvrViewMatrix};a.prototype._getWebVRProjectionMatrix=function(){var b=this.parent;b._vrDevice.depthNear=b.minZ;b._vrDevice.depthFar=b.maxZ;d.a.FromArrayToRef(this._cameraRigParams.left?this._cameraRigParams.frameData.leftProjectionMatrix:
this._cameraRigParams.frameData.rightProjectionMatrix,0,this._projectionMatrix);this.getScene().useRightHandedSystem||this._projectionMatrix.toggleProjectionMatrixHandInPlace();return this._projectionMatrix};a.prototype.initControllers=function(){var b=this;this.controllers=[];var a=this.getScene().gamepadManager;this._onGamepadDisconnectedObserver=a.onGamepadDisconnectedObservable.add(function(c){c.type===u.a.POSE_ENABLED&&(c.defaultModel&&c.defaultModel.setEnabled(!1),"right"===c.hand&&(b._rightController=
null),"left"===c.hand&&(b._leftController=null),c=b.controllers.indexOf(c),-1!==c&&b.controllers.splice(c,1))});this._onGamepadConnectedObserver=a.onGamepadConnectedObservable.add(function(a){if(a.type===u.a.POSE_ENABLED&&(b.webVROptions.trackPosition||(a._disableTrackPosition(new d.e("left"==a.hand?-.15:.15,-.5,.25)),b._updateCacheWhenTrackingDisabledObserver||(b._updateCacheWhenTrackingDisabledObserver=b._scene.onBeforeRenderObservable.add(function(){b._updateCache()}))),a.deviceScaleFactor=b.deviceScaleFactor,
a._deviceToWorld.copyFrom(b._deviceToWorld),b._correctPositionIfNotTrackPosition(a._deviceToWorld),b.webVROptions.controllerMeshes&&(a.defaultModel?a.defaultModel.setEnabled(!0):a.initControllerMesh(b.getScene(),function(l){l.scaling.scaleInPlace(b.deviceScaleFactor);b.onControllerMeshLoadedObservable.notifyObservers(a);if(b.webVROptions.defaultLightingOnControllers){b._lightOnControllers||(b._lightOnControllers=new c.a("vrControllersLight",new d.e(0,1,0),b.getScene()));var e=function(b,c){(b=b.getChildren())&&
0!==b.length&&b.forEach(function(b){c.includedOnlyMeshes.push(b);e(b,c)})};b._lightOnControllers.includedOnlyMeshes.push(l);e(l,b._lightOnControllers)}})),a.attachToPoseControlledCamera(b),-1===b.controllers.indexOf(a))){b.controllers.push(a);for(var l=!1,e=0;e<b.controllers.length;e++)b.controllers[e].controllerType===m.c.VIVE&&(l?b.controllers[e].hand="right":(l=!0,b.controllers[e].hand="left"));2<=b.controllers.length&&b.onControllersAttachedObservable.notifyObservers(b.controllers)}})};return a}(n.a)},
"5Jap":function(n,q,a){a.d(q,"a",function(){return u});var h=a("oYeq"),g=a("ADVu");n=a("xCqU");var p=a("/SR9"),d=a("M9Dn"),u=function(){function a(){this.gamepadAngularSensibility=200;this.gamepadMoveSensibility=40;this._yAxisScale=1;this._cameraTransform=p.a.Identity();this._deltaTransform=p.e.Zero();this._vector3=p.e.Zero();this._vector2=p.d.Zero()}Object.defineProperty(a.prototype,"invertYAxis",{get:function(){return 1!==this._yAxisScale},set:function(c){this._yAxisScale=c?-1:1},enumerable:!1,
configurable:!0});a.prototype.attachControl=function(){var c=this,b=this.camera.getScene().gamepadManager;this._onGamepadConnectedObserver=b.onGamepadConnectedObservable.add(function(b){b.type===d.a.POSE_ENABLED||c.gamepad&&b.type!==d.a.XBOX||(c.gamepad=b)});this._onGamepadDisconnectedObserver=b.onGamepadDisconnectedObservable.add(function(b){c.gamepad===b&&(c.gamepad=null)});this.gamepad=b.getGamepadByType(d.a.XBOX);!this.gamepad&&b.gamepads.length&&(this.gamepad=b.gamepads[0])};a.prototype.detachControl=
function(c){this.camera.getScene().gamepadManager.onGamepadConnectedObservable.remove(this._onGamepadConnectedObserver);this.camera.getScene().gamepadManager.onGamepadDisconnectedObservable.remove(this._onGamepadDisconnectedObserver);this.gamepad=null};a.prototype.checkInputs=function(){if(this.gamepad&&this.gamepad.leftStick){var c=this.camera,b=this.gamepad.leftStick,a=b.x/this.gamepadMoveSensibility,f=b.y/this.gamepadMoveSensibility;b.x=.005<Math.abs(a)?0+a:0;b.y=.005<Math.abs(f)?0+f:0;if(a=this.gamepad.rightStick){f=
a.x/this.gamepadAngularSensibility;var r=a.y/this.gamepadAngularSensibility*this._yAxisScale;a.x=.001<Math.abs(f)?0+f:0;a.y=.001<Math.abs(r)?0+r:0}else a={x:0,y:0};c.rotationQuaternion?c.rotationQuaternion.toRotationMatrix(this._cameraTransform):p.a.RotationYawPitchRollToRef(c.rotation.y,c.rotation.x,0,this._cameraTransform);f=50*c._computeLocalCameraSpeed();this._vector3.copyFromFloats(b.x*f,0,-b.y*f);p.e.TransformCoordinatesToRef(this._vector3,this._cameraTransform,this._deltaTransform);c.cameraDirection.addInPlace(this._deltaTransform);
this._vector2.copyFromFloats(a.y,a.x);c.cameraRotation.addInPlace(this._vector2)}};a.prototype.getClassName=function(){return"FreeCameraGamepadInput"};a.prototype.getSimpleName=function(){return"gamepad"};Object(h.c)([Object(g.c)()],a.prototype,"gamepadAngularSensibility",void 0);Object(h.c)([Object(g.c)()],a.prototype,"gamepadMoveSensibility",void 0);return a}();n.a.FreeCameraGamepadInput=u},"5WzX":function(n,q,a){a.d(q,"a",function(){return u});var h=a("oYeq"),g=a("/SR9"),p=a("mHtN");n=a("Ufda");
var d=a("SYzJ"),u=function(a){function c(b,c,f,r,k,d,m){void 0===f&&(f=null);void 0===r&&(r=null);void 0===k&&(k=null);void 0===d&&(d=null);void 0===m&&(m=null);var e=a.call(this,b,c.getScene())||this;e.name=b;e.children=[];e.animations=[];e._index=null;e._absoluteTransform=new g.a;e._invertedAbsoluteTransform=new g.a;e._scalingDeterminant=1;e._worldTransform=new g.a;e._needToDecompose=!0;e._needToCompose=!1;e._linkedTransformNode=null;e._waitingTransformNodeId=null;e._skeleton=c;e._localMatrix=r?
r.clone():g.a.Identity();e._restPose=k?k:e._localMatrix.clone();e._bindPose=e._localMatrix.clone();e._baseMatrix=d?d:e._localMatrix.clone();e._index=m;c.bones.push(e);e.setParent(f,!1);(d||r)&&e._updateDifferenceMatrix();return e}Object(h.d)(c,a);Object.defineProperty(c.prototype,"_matrix",{get:function(){this._compose();return this._localMatrix},set:function(b){this._localMatrix.copyFrom(b);this._needToDecompose=!0},enumerable:!1,configurable:!0});c.prototype.getClassName=function(){return"Bone"};
c.prototype.getSkeleton=function(){return this._skeleton};c.prototype.getParent=function(){return this._parent};c.prototype.getChildren=function(){return this.children};c.prototype.getIndex=function(){return null===this._index?this.getSkeleton().bones.indexOf(this):this._index};c.prototype.setParent=function(b,c){void 0===c&&(c=!0);if(this._parent!==b){if(this._parent){var a=this._parent.children.indexOf(this);-1!==a&&this._parent.children.splice(a,1)}(this._parent=b)&&this._parent.children.push(this);
c&&this._updateDifferenceMatrix();this.markAsDirty()}};c.prototype.getLocalMatrix=function(){this._compose();return this._localMatrix};c.prototype.getBaseMatrix=function(){return this._baseMatrix};c.prototype.getRestPose=function(){return this._restPose};c.prototype.setRestPose=function(b){this._restPose.copyFrom(b)};c.prototype.getBindPose=function(){return this._bindPose};c.prototype.setBindPose=function(b){this._bindPose.copyFrom(b)};c.prototype.getWorldMatrix=function(){return this._worldTransform};
c.prototype.returnToRest=function(){0<this._skeleton._numBonesWithLinkedTransformNode?this.updateMatrix(this._restPose,!1,!1):this.updateMatrix(this._restPose,!1,!0)};c.prototype.getInvertedAbsoluteTransform=function(){return this._invertedAbsoluteTransform};c.prototype.getAbsoluteTransform=function(){return this._absoluteTransform};c.prototype.linkTransformNode=function(b){this._linkedTransformNode&&this._skeleton._numBonesWithLinkedTransformNode--;(this._linkedTransformNode=b)&&this._skeleton._numBonesWithLinkedTransformNode++};
c.prototype.getTransformNode=function(){return this._linkedTransformNode};Object.defineProperty(c.prototype,"position",{get:function(){this._decompose();return this._localPosition},set:function(b){this._decompose();this._localPosition.copyFrom(b);this._markAsDirtyAndCompose()},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"rotation",{get:function(){return this.getRotation()},set:function(b){this.setRotation(b)},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,
"rotationQuaternion",{get:function(){this._decompose();return this._localRotation},set:function(b){this.setRotationQuaternion(b)},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"scaling",{get:function(){return this.getScale()},set:function(b){this.setScale(b)},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"animationPropertiesOverride",{get:function(){return this._skeleton.animationPropertiesOverride},enumerable:!1,configurable:!0});c.prototype._decompose=function(){this._needToDecompose&&
(this._needToDecompose=!1,this._localScaling||(this._localScaling=g.e.Zero(),this._localRotation=g.b.Zero(),this._localPosition=g.e.Zero()),this._localMatrix.decompose(this._localScaling,this._localRotation,this._localPosition))};c.prototype._compose=function(){this._needToCompose&&(this._localScaling?(this._needToCompose=!1,g.a.ComposeToRef(this._localScaling,this._localRotation,this._localPosition,this._localMatrix)):this._needToCompose=!1)};c.prototype.updateMatrix=function(b,c,a){void 0===c&&
(c=!0);void 0===a&&(a=!0);this._baseMatrix.copyFrom(b);c&&this._updateDifferenceMatrix();a?(this._needToCompose=!1,this._localMatrix.copyFrom(b),this._markAsDirtyAndDecompose()):this.markAsDirty()};c.prototype._updateDifferenceMatrix=function(b,c){void 0===c&&(c=!0);b||(b=this._baseMatrix);this._parent?b.multiplyToRef(this._parent._absoluteTransform,this._absoluteTransform):this._absoluteTransform.copyFrom(b);this._absoluteTransform.invertToRef(this._invertedAbsoluteTransform);if(c)for(b=0;b<this.children.length;b++)this.children[b]._updateDifferenceMatrix();
this._scalingDeterminant=0>this._absoluteTransform.determinant()?-1:1};c.prototype.markAsDirty=function(){this._currentRenderId++;this._childUpdateId++;this._skeleton._markAsDirty()};c.prototype._markAsDirtyAndCompose=function(){this.markAsDirty();this._needToCompose=!0};c.prototype._markAsDirtyAndDecompose=function(){this.markAsDirty();this._needToDecompose=!0};c.prototype.translate=function(b,a,f){void 0===a&&(a=d.c.LOCAL);var l=this.getLocalMatrix();if(a==d.c.LOCAL)l.addAtIndex(12,b.x),l.addAtIndex(13,
b.y),l.addAtIndex(14,b.z);else{a=null;f&&(a=f.getWorldMatrix());this._skeleton.computeAbsoluteTransforms();var k=c._tmpMats[0],m=c._tmpVecs[0];this._parent?f&&a?(k.copyFrom(this._parent.getAbsoluteTransform()),k.multiplyToRef(a,k)):k.copyFrom(this._parent.getAbsoluteTransform()):g.a.IdentityToRef(k);k.setTranslationFromFloats(0,0,0);k.invert();g.e.TransformCoordinatesToRef(b,k,m);l.addAtIndex(12,m.x);l.addAtIndex(13,m.y);l.addAtIndex(14,m.z)}this._markAsDirtyAndDecompose()};c.prototype.setPosition=
function(b,a,f){void 0===a&&(a=d.c.LOCAL);var l=this.getLocalMatrix();if(a==d.c.LOCAL)l.setTranslationFromFloats(b.x,b.y,b.z);else{a=null;f&&(a=f.getWorldMatrix());this._skeleton.computeAbsoluteTransforms();var k=c._tmpMats[0],m=c._tmpVecs[0];this._parent?(f&&a?(k.copyFrom(this._parent.getAbsoluteTransform()),k.multiplyToRef(a,k)):k.copyFrom(this._parent.getAbsoluteTransform()),k.invert()):g.a.IdentityToRef(k);g.e.TransformCoordinatesToRef(b,k,m);l.setTranslationFromFloats(m.x,m.y,m.z)}this._markAsDirtyAndDecompose()};
c.prototype.setAbsolutePosition=function(b,c){this.setPosition(b,d.c.WORLD,c)};c.prototype.scale=function(b,a,f,r){void 0===r&&(r=!1);var k=this.getLocalMatrix(),l=c._tmpMats[0];g.a.ScalingToRef(b,a,f,l);l.multiplyToRef(k,k);l.invert();for(var m=0,e=this.children;m<e.length;m++){k=e[m];var v=k.getLocalMatrix();v.multiplyToRef(l,v);v.multiplyAtIndex(12,b);v.multiplyAtIndex(13,a);v.multiplyAtIndex(14,f);k._markAsDirtyAndDecompose()}this._markAsDirtyAndDecompose();if(r)for(l=0,m=this.children;l<m.length;l++)k=
m[l],k.scale(b,a,f,r)};c.prototype.setScale=function(b){this._decompose();this._localScaling.copyFrom(b);this._markAsDirtyAndCompose()};c.prototype.getScale=function(){this._decompose();return this._localScaling};c.prototype.getScaleToRef=function(b){this._decompose();b.copyFrom(this._localScaling)};c.prototype.setYawPitchRoll=function(b,a,f,r,k){void 0===r&&(r=d.c.LOCAL);if(r===d.c.LOCAL){var l=c._tmpQuat;g.b.RotationYawPitchRollToRef(b,a,f,l);this.setRotationQuaternion(l,r,k)}else if(l=c._tmpMats[0],
this._getNegativeRotationToRef(l,k)){var m=c._tmpMats[1];g.a.RotationYawPitchRollToRef(b,a,f,m);l.multiplyToRef(m,m);this._rotateWithMatrix(m,r,k)}};c.prototype.rotate=function(b,a,f,m){void 0===f&&(f=d.c.LOCAL);var k=c._tmpMats[0];k.setTranslationFromFloats(0,0,0);g.a.RotationAxisToRef(b,a,k);this._rotateWithMatrix(k,f,m)};c.prototype.setAxisAngle=function(b,a,f,m){void 0===f&&(f=d.c.LOCAL);if(f===d.c.LOCAL){var k=c._tmpQuat;g.b.RotationAxisToRef(b,a,k);this.setRotationQuaternion(k,f,m)}else if(k=
c._tmpMats[0],this._getNegativeRotationToRef(k,m)){var l=c._tmpMats[1];g.a.RotationAxisToRef(b,a,l);k.multiplyToRef(l,l);this._rotateWithMatrix(l,f,m)}};c.prototype.setRotation=function(b,c,a){void 0===c&&(c=d.c.LOCAL);this.setYawPitchRoll(b.y,b.x,b.z,c,a)};c.prototype.setRotationQuaternion=function(b,a,f){void 0===a&&(a=d.c.LOCAL);if(a===d.c.LOCAL)this._decompose(),this._localRotation.copyFrom(b),this._markAsDirtyAndCompose();else{var l=c._tmpMats[0];if(this._getNegativeRotationToRef(l,f)){var k=
c._tmpMats[1];g.a.FromQuaternionToRef(b,k);l.multiplyToRef(k,k);this._rotateWithMatrix(k,a,f)}}};c.prototype.setRotationMatrix=function(b,a,f){void 0===a&&(a=d.c.LOCAL);if(a===d.c.LOCAL){var l=c._tmpQuat;g.b.FromRotationMatrixToRef(b,l);this.setRotationQuaternion(l,a,f)}else if(l=c._tmpMats[0],this._getNegativeRotationToRef(l,f)){var k=c._tmpMats[1];k.copyFrom(b);l.multiplyToRef(b,k);this._rotateWithMatrix(k,a,f)}};c.prototype._rotateWithMatrix=function(b,a,f){void 0===a&&(a=d.c.LOCAL);var l=this.getLocalMatrix(),
k=l.m[12],m=l.m[13],g=l.m[14],e=this.getParent(),v=c._tmpMats[3],h=c._tmpMats[4];e&&a==d.c.WORLD?(f?(v.copyFrom(f.getWorldMatrix()),e.getAbsoluteTransform().multiplyToRef(v,v)):v.copyFrom(e.getAbsoluteTransform()),h.copyFrom(v),h.invert(),l.multiplyToRef(v,l),l.multiplyToRef(b,l),l.multiplyToRef(h,l)):a==d.c.WORLD&&f?(v.copyFrom(f.getWorldMatrix()),h.copyFrom(v),h.invert(),l.multiplyToRef(v,l),l.multiplyToRef(b,l),l.multiplyToRef(h,l)):l.multiplyToRef(b,l);l.setTranslationFromFloats(k,m,g);this.computeAbsoluteTransforms();
this._markAsDirtyAndDecompose()};c.prototype._getNegativeRotationToRef=function(b,a){var f=c._tmpMats[2];b.copyFrom(this.getAbsoluteTransform());a&&(b.multiplyToRef(a.getWorldMatrix(),b),g.a.ScalingToRef(a.scaling.x,a.scaling.y,a.scaling.z,f));b.invert();if(isNaN(b.m[0]))return!1;f.multiplyAtIndex(0,this._scalingDeterminant);b.multiplyToRef(f,b);return!0};c.prototype.getPosition=function(b,a){void 0===b&&(b=d.c.LOCAL);void 0===a&&(a=null);var c=g.e.Zero();this.getPositionToRef(b,a,c);return c};c.prototype.getPositionToRef=
function(b,a,f){void 0===b&&(b=d.c.LOCAL);if(b==d.c.LOCAL)a=this.getLocalMatrix(),f.x=a.m[12],f.y=a.m[13],f.z=a.m[14];else{b=null;a&&(b=a.getWorldMatrix());this._skeleton.computeAbsoluteTransforms();var l=c._tmpMats[0];a&&b?(l.copyFrom(this.getAbsoluteTransform()),l.multiplyToRef(b,l)):l=this.getAbsoluteTransform();f.x=l.m[12];f.y=l.m[13];f.z=l.m[14]}};c.prototype.getAbsolutePosition=function(b){void 0===b&&(b=null);var a=g.e.Zero();this.getPositionToRef(d.c.WORLD,b,a);return a};c.prototype.getAbsolutePositionToRef=
function(b,a){this.getPositionToRef(d.c.WORLD,b,a)};c.prototype.computeAbsoluteTransforms=function(){this._compose();if(this._parent)this._localMatrix.multiplyToRef(this._parent._absoluteTransform,this._absoluteTransform);else{this._absoluteTransform.copyFrom(this._localMatrix);var b=this._skeleton.getPoseMatrix();b&&this._absoluteTransform.multiplyToRef(b,this._absoluteTransform)}b=this.children;for(var a=b.length,c=0;c<a;c++)b[c].computeAbsoluteTransforms()};c.prototype.getDirection=function(b,
a){void 0===a&&(a=null);var c=g.e.Zero();this.getDirectionToRef(b,a,c);return c};c.prototype.getDirectionToRef=function(b,a,f){void 0===a&&(a=null);var l=null;a&&(l=a.getWorldMatrix());this._skeleton.computeAbsoluteTransforms();var k=c._tmpMats[0];k.copyFrom(this.getAbsoluteTransform());a&&l&&k.multiplyToRef(l,k);g.e.TransformNormalToRef(b,k,f);f.normalize()};c.prototype.getRotation=function(b,a){void 0===b&&(b=d.c.LOCAL);void 0===a&&(a=null);var c=g.e.Zero();this.getRotationToRef(b,a,c);return c};
c.prototype.getRotationToRef=function(b,a,f){void 0===b&&(b=d.c.LOCAL);void 0===a&&(a=null);var l=c._tmpQuat;this.getRotationQuaternionToRef(b,a,l);l.toEulerAnglesToRef(f)};c.prototype.getRotationQuaternion=function(b,a){void 0===b&&(b=d.c.LOCAL);void 0===a&&(a=null);var c=g.b.Identity();this.getRotationQuaternionToRef(b,a,c);return c};c.prototype.getRotationQuaternionToRef=function(b,a,f){void 0===b&&(b=d.c.LOCAL);void 0===a&&(a=null);if(b==d.c.LOCAL)this._decompose(),f.copyFrom(this._localRotation);
else{b=c._tmpMats[0];var l=this.getAbsoluteTransform();a?l.multiplyToRef(a.getWorldMatrix(),b):b.copyFrom(l);b.multiplyAtIndex(0,this._scalingDeterminant);b.multiplyAtIndex(1,this._scalingDeterminant);b.multiplyAtIndex(2,this._scalingDeterminant);b.decompose(void 0,f,void 0)}};c.prototype.getRotationMatrix=function(b,a){void 0===b&&(b=d.c.LOCAL);var c=g.a.Identity();this.getRotationMatrixToRef(b,a,c);return c};c.prototype.getRotationMatrixToRef=function(b,a,f){void 0===b&&(b=d.c.LOCAL);if(b==d.c.LOCAL)this.getLocalMatrix().getRotationMatrixToRef(f);
else{b=c._tmpMats[0];var l=this.getAbsoluteTransform();a?l.multiplyToRef(a.getWorldMatrix(),b):b.copyFrom(l);b.multiplyAtIndex(0,this._scalingDeterminant);b.multiplyAtIndex(1,this._scalingDeterminant);b.multiplyAtIndex(2,this._scalingDeterminant);b.getRotationMatrixToRef(f)}};c.prototype.getAbsolutePositionFromLocal=function(b,a){void 0===a&&(a=null);var c=g.e.Zero();this.getAbsolutePositionFromLocalToRef(b,a,c);return c};c.prototype.getAbsolutePositionFromLocalToRef=function(b,a,f){void 0===a&&(a=
null);var l=null;a&&(l=a.getWorldMatrix());this._skeleton.computeAbsoluteTransforms();var k=c._tmpMats[0];a&&l?(k.copyFrom(this.getAbsoluteTransform()),k.multiplyToRef(l,k)):k=this.getAbsoluteTransform();g.e.TransformCoordinatesToRef(b,k,f)};c.prototype.getLocalPositionFromAbsolute=function(b,a){void 0===a&&(a=null);var c=g.e.Zero();this.getLocalPositionFromAbsoluteToRef(b,a,c);return c};c.prototype.getLocalPositionFromAbsoluteToRef=function(b,a,f){void 0===a&&(a=null);var l=null;a&&(l=a.getWorldMatrix());
this._skeleton.computeAbsoluteTransforms();var k=c._tmpMats[0];k.copyFrom(this.getAbsoluteTransform());a&&l&&k.multiplyToRef(l,k);k.invert();g.e.TransformCoordinatesToRef(b,k,f)};c.prototype.setCurrentPoseAsRest=function(){this.setRestPose(this.getLocalMatrix())};c._tmpVecs=p.a.BuildArray(2,g.e.Zero);c._tmpQuat=g.b.Identity();c._tmpMats=p.a.BuildArray(5,g.a.Identity);return c}(n.a)},"8MBl":function(n,q,a){a.d(q,"a",function(){return g});var h=a("/SR9"),g=function(){function a(){this.compensateDistortion=
!0;this.multiviewEnabled=!1}Object.defineProperty(a.prototype,"aspectRatio",{get:function(){return this.hResolution/(2*this.vResolution)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"aspectRatioFov",{get:function(){return 2*Math.atan(this.postProcessScaleFactor*this.vScreenSize/(2*this.eyeToScreenDistance))},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"leftHMatrix",{get:function(){return h.a.Translation(4*(this.hScreenSize/4-this.lensSeparationDistance/
2)/this.hScreenSize,0,0)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"rightHMatrix",{get:function(){return h.a.Translation(-(4*(this.hScreenSize/4-this.lensSeparationDistance/2)/this.hScreenSize),0,0)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"leftPreViewMatrix",{get:function(){return h.a.Translation(.5*this.interpupillaryDistance,0,0)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"rightPreViewMatrix",{get:function(){return h.a.Translation(-.5*
this.interpupillaryDistance,0,0)},enumerable:!1,configurable:!0});a.GetDefault=function(){var d=new a;d.hResolution=1280;d.vResolution=800;d.hScreenSize=.149759993;d.vScreenSize=.0935999975;d.vScreenCenter=.0467999987;d.eyeToScreenDistance=.0410000011;d.lensSeparationDistance=.063500002;d.interpupillaryDistance=.064000003;d.distortionK=[1,.219999999,.239999995,0];d.chromaAbCorrection=[.995999992,-.00400000019,1.01400006,0];d.postProcessScaleFactor=1.714605507808412;d.lensCenterOffset=.151976421;return d};
return a}()},"93XQ":function(n,q,a){a.d(q,"a",function(){return m});var h=a("oYeq"),g=a("ADVu");n=a("xCqU");var p=a("jSHE"),d=a("/SR9"),u=a("YKqZ"),m=function(){function a(){this.keysForward=[87];this.keysBackward=[83];this.keysUp=[69];this.keysDown=[81];this.keysRight=[68];this.keysLeft=[65];this._keys=[]}a.prototype.attachControl=function(b){var a=this;b=u.b.BackCompatCameraNoPreventDefault(arguments);this._onCanvasBlurObserver||(this._scene=this.camera.getScene(),this._engine=this._scene.getEngine(),
this._onCanvasBlurObserver=this._engine.onCanvasBlurObservable.add(function(){a._keys=[]}),this._onKeyboardObserver=this._scene.onKeyboardObservable.add(function(c){var f=c.event;if(c.type===p.a.KEYDOWN){if(-1!==a.keysForward.indexOf(f.keyCode)||-1!==a.keysBackward.indexOf(f.keyCode)||-1!==a.keysUp.indexOf(f.keyCode)||-1!==a.keysDown.indexOf(f.keyCode)||-1!==a.keysLeft.indexOf(f.keyCode)||-1!==a.keysRight.indexOf(f.keyCode))c=a._keys.indexOf(f.keyCode),-1===c&&a._keys.push(f.keyCode),b||f.preventDefault()}else if(-1!==
a.keysForward.indexOf(f.keyCode)||-1!==a.keysBackward.indexOf(f.keyCode)||-1!==a.keysUp.indexOf(f.keyCode)||-1!==a.keysDown.indexOf(f.keyCode)||-1!==a.keysLeft.indexOf(f.keyCode)||-1!==a.keysRight.indexOf(f.keyCode))c=a._keys.indexOf(f.keyCode),0<=c&&a._keys.splice(c,1),b||f.preventDefault()}))};a.prototype.detachControl=function(b){this._scene&&(this._onKeyboardObserver&&this._scene.onKeyboardObservable.remove(this._onKeyboardObserver),this._onCanvasBlurObserver&&this._engine.onCanvasBlurObservable.remove(this._onCanvasBlurObserver),
this._onCanvasBlurObserver=this._onKeyboardObserver=null);this._keys=[]};a.prototype.getClassName=function(){return"FlyCameraKeyboardInput"};a.prototype._onLostFocus=function(b){this._keys=[]};a.prototype.getSimpleName=function(){return"keyboard"};a.prototype.checkInputs=function(){if(this._onKeyboardObserver)for(var b=this.camera,a=0;a<this._keys.length;a++){var c=this._keys[a],m=b._computeLocalCameraSpeed();-1!==this.keysForward.indexOf(c)?b._localDirection.copyFromFloats(0,0,m):-1!==this.keysBackward.indexOf(c)?
b._localDirection.copyFromFloats(0,0,-m):-1!==this.keysUp.indexOf(c)?b._localDirection.copyFromFloats(0,m,0):-1!==this.keysDown.indexOf(c)?b._localDirection.copyFromFloats(0,-m,0):-1!==this.keysRight.indexOf(c)?b._localDirection.copyFromFloats(m,0,0):-1!==this.keysLeft.indexOf(c)&&b._localDirection.copyFromFloats(-m,0,0);b.getScene().useRightHandedSystem&&(b._localDirection.z*=-1);b.getViewMatrix().invertToRef(b._cameraTransformMatrix);d.e.TransformNormalToRef(b._localDirection,b._cameraTransformMatrix,
b._transformedDirection);b.cameraDirection.addInPlace(b._transformedDirection)}};Object(h.c)([Object(g.c)()],a.prototype,"keysForward",void 0);Object(h.c)([Object(g.c)()],a.prototype,"keysBackward",void 0);Object(h.c)([Object(g.c)()],a.prototype,"keysUp",void 0);Object(h.c)([Object(g.c)()],a.prototype,"keysDown",void 0);Object(h.c)([Object(g.c)()],a.prototype,"keysRight",void 0);Object(h.c)([Object(g.c)()],a.prototype,"keysLeft",void 0);return a}();n.a.FlyCameraKeyboardInput=m},"9AUY":function(n,
q,a){n=a("CAkI");var h=a("qjwu"),g=a("H9Lp");n.a._setStereoscopicAnaglyphRigMode=function(a){a._rigCameras[0]._rigPostProcess=new h.a(a.name+"_passthru",1,a._rigCameras[0]);a._rigCameras[1]._rigPostProcess=new g.a(a.name+"_anaglyph",1,a._rigCameras)}},"FjK/":function(n,q,a){var h=a("/AUW");n=a("xCqU");var g=a("/SR9");a("g739").a.prototype.addVirtualJoystick=function(){this.add(new p);return this};var p=function(){function a(){}a.prototype.getLeftJoystick=function(){return this._leftjoystick};a.prototype.getRightJoystick=
function(){return this._rightjoystick};a.prototype.checkInputs=function(){if(this._leftjoystick){var a=this.camera,m=50*a._computeLocalCameraSpeed(),c=g.a.RotationYawPitchRoll(a.rotation.y,a.rotation.x,0);m=g.e.TransformCoordinates(new g.e(this._leftjoystick.deltaPosition.x*m,this._leftjoystick.deltaPosition.y*m,this._leftjoystick.deltaPosition.z*m),c);a.cameraDirection=a.cameraDirection.add(m);a.cameraRotation=a.cameraRotation.addVector3(this._rightjoystick.deltaPosition);this._leftjoystick.pressed||
(this._leftjoystick.deltaPosition=this._leftjoystick.deltaPosition.scale(.9));this._rightjoystick.pressed||(this._rightjoystick.deltaPosition=this._rightjoystick.deltaPosition.scale(.9))}};a.prototype.attachControl=function(){this._leftjoystick=new h.b(!0);this._leftjoystick.setAxisForUpDown(h.a.Z);this._leftjoystick.setAxisForLeftRight(h.a.X);this._leftjoystick.setJoystickSensibility(.15);this._rightjoystick=new h.b(!1);this._rightjoystick.setAxisForUpDown(h.a.X);this._rightjoystick.setAxisForLeftRight(h.a.Y);
this._rightjoystick.reverseUpDown=!0;this._rightjoystick.setJoystickSensibility(.05);this._rightjoystick.setJoystickColor("yellow")};a.prototype.detachControl=function(a){this._leftjoystick.releaseCanvas();this._rightjoystick.releaseCanvas()};a.prototype.getClassName=function(){return"FreeCameraVirtualJoystickInput"};a.prototype.getSimpleName=function(){return"virtualJoystick"};return a}();n.a.FreeCameraVirtualJoystickInput=p},HcSi:function(n,q,a){a.d(q,"a",function(){return u});var h=a("oYeq"),g=
a("17qc"),p=a("kv5N"),d=a("XRWu"),u=function(a){function c(b){return a.call(this,b)||this}Object(h.d)(c,a);c.prototype.addMouseWheel=function(){this.add(new d.a);return this};c.prototype.addPointers=function(){this.add(new g.a);return this};c.prototype.addKeyboard=function(){this.add(new p.a);return this};return c}(a("xCqU").b)},Hl4A:function(n,q,a){a.d(q,"a",function(){return m});var h=a("oYeq"),g=a("ps+7"),p=a("ADVu");n=a("xCqU");var d=a("98Qd"),u=a("YKqZ"),m=function(){function a(b){void 0===b&&
(b=!0);this.touchEnabled=b;this.buttons=[0,1,2];this.angularSensibility=2E3;this.previousPosition=null;this.onPointerMovedObservable=new g.a;this._allowCameraRotation=!0}a.prototype.attachControl=function(b){var a=this;b=u.b.BackCompatCameraNoPreventDefault(arguments);var c=this.camera.getEngine(),m=c.getInputElement();this._pointerInput||(this._pointerInput=function(k){var f=k.event;if(!(c.isInVRExclusivePointerMode||!a.touchEnabled&&"touch"===f.pointerType||k.type!==d.a.POINTERMOVE&&-1===a.buttons.indexOf(f.button))){var l=
f.srcElement||f.target;if(k.type===d.a.POINTERDOWN&&l){try{l.setPointerCapture(f.pointerId)}catch(e){}a.previousPosition={x:f.clientX,y:f.clientY};b||(f.preventDefault(),m&&m.focus());c.isPointerLock&&a._onMouseMove&&a._onMouseMove(k.event)}else if(k.type===d.a.POINTERUP&&l){try{l.releasePointerCapture(f.pointerId)}catch(e){}a.previousPosition=null;b||f.preventDefault()}else k.type===d.a.POINTERMOVE&&(a.previousPosition?(k=f.clientX-a.previousPosition.x,l=f.clientY-a.previousPosition.y,a.camera.getScene().useRightHandedSystem&&
(k*=-1),a.camera.parent&&0>a.camera.parent._getWorldMatrixDeterminant()&&(k*=-1),a._allowCameraRotation&&(a.camera.cameraRotation.y+=k/a.angularSensibility,a.camera.cameraRotation.x+=l/a.angularSensibility),a.onPointerMovedObservable.notifyObservers({offsetX:k,offsetY:l}),a.previousPosition={x:f.clientX,y:f.clientY},b||f.preventDefault()):c.isPointerLock&&a._onMouseMove&&a._onMouseMove(k.event))}});this._onMouseMove=function(k){if(c.isPointerLock&&!c.isInVRExclusivePointerMode){var f=k.movementX||
k.mozMovementX||k.webkitMovementX||k.msMovementX||0;a.camera.getScene().useRightHandedSystem&&(f*=-1);a.camera.parent&&0>a.camera.parent._getWorldMatrixDeterminant()&&(f*=-1);a.camera.cameraRotation.y+=f/a.angularSensibility;a.camera.cameraRotation.x+=(k.movementY||k.mozMovementY||k.webkitMovementY||k.msMovementY||0)/a.angularSensibility;a.previousPosition=null;b||k.preventDefault()}};this._observer=this.camera.getScene().onPointerObservable.add(this._pointerInput,d.a.POINTERDOWN|d.a.POINTERUP|d.a.POINTERMOVE);
m&&m.addEventListener("contextmenu",this.onContextMenu.bind(this),!1)};a.prototype.onContextMenu=function(b){b.preventDefault()};a.prototype.detachControl=function(b){this._observer&&(this.camera.getScene().onPointerObservable.remove(this._observer),this.onContextMenu&&(b=this.camera.getEngine().getInputElement())&&b.removeEventListener("contextmenu",this.onContextMenu),this.onPointerMovedObservable&&this.onPointerMovedObservable.clear(),this.previousPosition=this._onMouseMove=this._observer=null)};
a.prototype.getClassName=function(){return"FreeCameraMouseInput"};a.prototype.getSimpleName=function(){return"mouse"};Object(h.c)([Object(p.c)()],a.prototype,"buttons",void 0);Object(h.c)([Object(p.c)()],a.prototype,"angularSensibility",void 0);return a}();n.a.FreeCameraMouseInput=m},IIar:function(n,q,a){var h=a("8MBl"),g=a("oYeq"),p=a("CAkI");q=a("VfJ7");var d=a("/SR9");n=a("Ufda");a("PbDj");a("mDQ4");n.a.AddNodeConstructor("VRDeviceOrientationFreeCamera",function(a,b){return function(){return new u(a,
0,0,1,d.e.Zero(),b)}});var u=function(a){function b(b,c,m,k,g,d,e,v){void 0===e&&(e=!0);void 0===v&&(v=h.a.GetDefault());b=a.call(this,b,c,m,k,g,d)||this;v.compensateDistortion=e;b.setCameraRigMode(p.a.RIG_MODE_VR,{vrCameraMetrics:v});b.inputs.addVRDeviceOrientation();return b}Object(g.d)(b,a);b.prototype.getClassName=function(){return"VRDeviceOrientationArcRotateCamera"};return b}(q.a);q=a("L3Hx");a("K1vB");n.a.AddNodeConstructor("VRDeviceOrientationGamepadCamera",function(a,b){return function(){return new m(a,
d.e.Zero(),b)}});var m=function(a){function b(b,c,m,k,g){void 0===k&&(k=!0);void 0===g&&(g=h.a.GetDefault());b=a.call(this,b,c,m,k,g)||this;b.inputs.addGamepad();return b}Object(g.d)(b,a);b.prototype.getClassName=function(){return"VRDeviceOrientationGamepadCamera"};return b}(q.a);a("Su4L");a("46vk")},JwOz:function(n,q,a){n=a("CAkI");var h=a("/SR9"),g=a("JIAX");n.a._setWebVRRigMode=function(a,d){if(d.vrDisplay){var u=d.vrDisplay.getEyeParameters("left"),m=d.vrDisplay.getEyeParameters("right");a._rigCameras[0].viewport=
new g.a(0,0,.5,1);a._rigCameras[0].setCameraRigParameter("left",!0);a._rigCameras[0].setCameraRigParameter("specs",d.specs);a._rigCameras[0].setCameraRigParameter("eyeParameters",u);a._rigCameras[0].setCameraRigParameter("frameData",d.frameData);a._rigCameras[0].setCameraRigParameter("parentCamera",d.parentCamera);a._rigCameras[0]._cameraRigParams.vrWorkMatrix=new h.a;a._rigCameras[0].getProjectionMatrix=a._getWebVRProjectionMatrix;a._rigCameras[0].parent=a;a._rigCameras[0]._getViewMatrix=a._getWebVRViewMatrix;
a._rigCameras[1].viewport=new g.a(.5,0,.5,1);a._rigCameras[1].setCameraRigParameter("eyeParameters",m);a._rigCameras[1].setCameraRigParameter("specs",d.specs);a._rigCameras[1].setCameraRigParameter("frameData",d.frameData);a._rigCameras[1].setCameraRigParameter("parentCamera",d.parentCamera);a._rigCameras[1]._cameraRigParams.vrWorkMatrix=new h.a;a._rigCameras[1].getProjectionMatrix=a._getWebVRProjectionMatrix;a._rigCameras[1].parent=a;a._rigCameras[1]._getViewMatrix=a._getWebVRViewMatrix}}},L3Hx:function(n,
q,a){a.d(q,"a",function(){return u});var h=a("oYeq"),g=a("CAkI");n=a("KjVj");var p=a("8MBl"),d=a("/SR9");q=a("Ufda");a("mDQ4");q.a.AddNodeConstructor("VRDeviceOrientationFreeCamera",function(a,c){return function(){return new u(a,d.e.Zero(),c)}});var u=function(a){function c(b,c,f,m,k){void 0===m&&(m=!0);void 0===k&&(k=p.a.GetDefault());b=a.call(this,b,c,f)||this;k.compensateDistortion=m;b.setCameraRigMode(g.a.RIG_MODE_VR,{vrCameraMetrics:k});return b}Object(h.d)(c,a);c.prototype.getClassName=function(){return"VRDeviceOrientationFreeCamera"};
return c}(n.a)},PbDj:function(n,q,a){n=a("xCqU");q=a("HcSi");var h=a("YKqZ");q.a.prototype.addVRDeviceOrientation=function(){this.add(new g);return this};var g=function(){function a(){this.gammaCorrection=this.alphaCorrection=1;this._gamma=this._alpha=0;this._dirty=!1;this._deviceOrientationHandler=this._onOrientationEvent.bind(this)}a.prototype.attachControl=function(a){var g=this;a=h.b.BackCompatCameraNoPreventDefault(arguments);this.camera.attachControl(a);var m=this.camera.getScene().getEngine().getHostWindow();
m&&("undefined"!==typeof DeviceOrientationEvent&&"function"===typeof DeviceOrientationEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(function(a){"granted"===a?m.addEventListener("deviceorientation",g._deviceOrientationHandler):h.b.Warn("Permission not granted.")}).catch(function(a){h.b.Error(a)}):m.addEventListener("deviceorientation",this._deviceOrientationHandler))};a.prototype._onOrientationEvent=function(a){null!==a.alpha&&(this._alpha=(+a.alpha|0)*this.alphaCorrection);
null!==a.gamma&&(this._gamma=(+a.gamma|0)*this.gammaCorrection);this._dirty=!0};a.prototype.checkInputs=function(){this._dirty&&(this._dirty=!1,0>this._gamma&&(this._gamma=180+this._gamma),this.camera.alpha=-this._alpha/180*Math.PI%Math.PI*2,this.camera.beta=this._gamma/180*Math.PI)};a.prototype.detachControl=function(a){window.removeEventListener("deviceorientation",this._deviceOrientationHandler)};a.prototype.getClassName=function(){return"ArcRotateCameraVRDeviceOrientationInput"};a.prototype.getSimpleName=
function(){return"VRDeviceOrientation"};return a}();n.a.ArcRotateCameraVRDeviceOrientationInput=g},PjAf:function(n,q,a){var h=a("oYeq"),g=a("CAkI");n=a("VfJ7");var p=a("/SR9");q=a("Ufda");a("9AUY");q.a.AddNodeConstructor("AnaglyphArcRotateCamera",function(a,b,c){return function(){return new d(a,0,0,1,p.e.Zero(),c.interaxial_distance,b)}});var d=function(a){function b(b,c,e,k,f,m,v){b=a.call(this,b,c,e,k,f,v)||this;b.interaxialDistance=m;b.setCameraRigMode(g.a.RIG_MODE_STEREOSCOPIC_ANAGLYPH,{interaxialDistance:m});
return b}Object(h.d)(b,a);b.prototype.getClassName=function(){return"AnaglyphArcRotateCamera"};return b}(n.a),u=a("sdjL");q.a.AddNodeConstructor("AnaglyphFreeCamera",function(a,b,c){return function(){return new m(a,p.e.Zero(),c.interaxial_distance,b)}});var m=function(a){function b(b,c,e,k){b=a.call(this,b,c,k)||this;b.interaxialDistance=e;b.setCameraRigMode(g.a.RIG_MODE_STEREOSCOPIC_ANAGLYPH,{interaxialDistance:e});return b}Object(h.d)(b,a);b.prototype.getClassName=function(){return"AnaglyphFreeCamera"};
return b}(u.a),c=a("xLOD");q.a.AddNodeConstructor("AnaglyphGamepadCamera",function(a,c,k){return function(){return new b(a,p.e.Zero(),k.interaxial_distance,c)}});var b=function(a){function b(b,c,k,e){b=a.call(this,b,c,e)||this;b.interaxialDistance=k;b.setCameraRigMode(g.a.RIG_MODE_STEREOSCOPIC_ANAGLYPH,{interaxialDistance:k});return b}Object(h.d)(b,a);b.prototype.getClassName=function(){return"AnaglyphGamepadCamera"};return b}(c.a),l=a("wN8c");q.a.AddNodeConstructor("AnaglyphUniversalCamera",function(a,
b,c){return function(){return new f(a,p.e.Zero(),c.interaxial_distance,b)}});var f=function(a){function b(b,c,k,e){b=a.call(this,b,c,e)||this;b.interaxialDistance=k;b.setCameraRigMode(g.a.RIG_MODE_STEREOSCOPIC_ANAGLYPH,{interaxialDistance:k});return b}Object(h.d)(b,a);b.prototype.getClassName=function(){return"AnaglyphUniversalCamera"};return b}(l.a);a("qz3X");q.a.AddNodeConstructor("StereoscopicArcRotateCamera",function(a,b,c){return function(){return new r(a,0,0,1,p.e.Zero(),c.interaxial_distance,
c.isStereoscopicSideBySide,b)}});var r=function(a){function b(b,c,k,e,f,m,l,d){b=a.call(this,b,c,k,e,f,d)||this;b.interaxialDistance=m;b.isStereoscopicSideBySide=l;b.setCameraRigMode(l?g.a.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:g.a.RIG_MODE_STEREOSCOPIC_OVERUNDER,{interaxialDistance:m});return b}Object(h.d)(b,a);b.prototype.getClassName=function(){return"StereoscopicArcRotateCamera"};return b}(n.a);q.a.AddNodeConstructor("StereoscopicFreeCamera",function(a,b,c){return function(){return new k(a,
p.e.Zero(),c.interaxial_distance,c.isStereoscopicSideBySide,b)}});var k=function(a){function b(b,c,k,e,f){b=a.call(this,b,c,f)||this;b.interaxialDistance=k;b.isStereoscopicSideBySide=e;b.setCameraRigMode(e?g.a.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:g.a.RIG_MODE_STEREOSCOPIC_OVERUNDER,{interaxialDistance:k});return b}Object(h.d)(b,a);b.prototype.getClassName=function(){return"StereoscopicFreeCamera"};return b}(u.a);q.a.AddNodeConstructor("StereoscopicGamepadCamera",function(b,a,c){return function(){return new t(b,
p.e.Zero(),c.interaxial_distance,c.isStereoscopicSideBySide,a)}});var t=function(b){function a(a,c,k,e,f){a=b.call(this,a,c,f)||this;a.interaxialDistance=k;a.isStereoscopicSideBySide=e;a.setCameraRigMode(e?g.a.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:g.a.RIG_MODE_STEREOSCOPIC_OVERUNDER,{interaxialDistance:k});return a}Object(h.d)(a,b);a.prototype.getClassName=function(){return"StereoscopicGamepadCamera"};return a}(c.a);q.a.AddNodeConstructor("StereoscopicFreeCamera",function(a,b,c){return function(){return new z(a,
p.e.Zero(),c.interaxial_distance,c.isStereoscopicSideBySide,b)}});var z=function(a){function b(b,c,k,e,f){b=a.call(this,b,c,f)||this;b.interaxialDistance=k;b.isStereoscopicSideBySide=e;b.setCameraRigMode(e?g.a.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:g.a.RIG_MODE_STEREOSCOPIC_OVERUNDER,{interaxialDistance:k});return b}Object(h.d)(b,a);b.prototype.getClassName=function(){return"StereoscopicUniversalCamera"};return b}(l.a)},"Qu+o":function(n,q,a){n=a("xCqU");var h=a("/SR9"),g=a("YKqZ");q=a("g739");
var p=a("ps+7");q.a.prototype.addDeviceOrientation=function(){this._deviceOrientationInput||(this._deviceOrientationInput=new d,this.add(this._deviceOrientationInput));return this};var d=function(){function a(){var a=this;this._screenOrientationAngle=0;this._screenQuaternion=new h.b;this._gamma=this._beta=this._alpha=0;this._onDeviceOrientationChangedObservable=new p.a;this._orientationChanged=function(){a._screenOrientationAngle=void 0!==window.orientation?+window.orientation:window.screen.orientation&&
window.screen.orientation.angle?window.screen.orientation.angle:0;a._screenOrientationAngle=-g.b.ToRadians(a._screenOrientationAngle/2);a._screenQuaternion.copyFromFloats(0,Math.sin(a._screenOrientationAngle),0,Math.cos(a._screenOrientationAngle))};this._deviceOrientation=function(c){a._alpha=null!==c.alpha?c.alpha:0;a._beta=null!==c.beta?c.beta:0;a._gamma=null!==c.gamma?c.gamma:0;null!==c.alpha&&a._onDeviceOrientationChangedObservable.notifyObservers()};this._constantTranform=new h.b(-Math.sqrt(.5),
0,0,Math.sqrt(.5));this._orientationChanged()}a.WaitForOrientationChangeAsync=function(a){return new Promise(function(c,b){var m=!1,f=function(){window.removeEventListener("deviceorientation",f);m=!0;c()};a&&setTimeout(function(){m||(window.removeEventListener("deviceorientation",f),b("WaitForOrientationChangeAsync timed out"))},a);"undefined"!==typeof DeviceOrientationEvent&&"function"===typeof DeviceOrientationEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(function(a){"granted"==
a?window.addEventListener("deviceorientation",f):g.b.Warn("Permission not granted.")}).catch(function(a){g.b.Error(a)}):window.addEventListener("deviceorientation",f)})};Object.defineProperty(a.prototype,"camera",{get:function(){return this._camera},set:function(a){var c=this;this._camera=a;null==this._camera||this._camera.rotationQuaternion||(this._camera.rotationQuaternion=new h.b);this._camera&&this._camera.onDisposeObservable.add(function(){c._onDeviceOrientationChangedObservable.clear()})},enumerable:!1,
configurable:!0});a.prototype.attachControl=function(){var a=this,c=this.camera.getScene().getEngine().getHostWindow();if(c){var b=function(){c.addEventListener("orientationchange",a._orientationChanged);c.addEventListener("deviceorientation",a._deviceOrientation);a._orientationChanged()};"undefined"!==typeof DeviceOrientationEvent&&"function"===typeof DeviceOrientationEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(function(a){"granted"===a?b():g.b.Warn("Permission not granted.")}).catch(function(a){g.b.Error(a)}):
b()}};a.prototype.detachControl=function(a){window.removeEventListener("orientationchange",this._orientationChanged);window.removeEventListener("deviceorientation",this._deviceOrientation);this._alpha=0};a.prototype.checkInputs=function(){this._alpha&&(h.b.RotationYawPitchRollToRef(g.b.ToRadians(this._alpha),g.b.ToRadians(this._beta),-g.b.ToRadians(this._gamma),this.camera.rotationQuaternion),this._camera.rotationQuaternion.multiplyInPlace(this._screenQuaternion),this._camera.rotationQuaternion.multiplyInPlace(this._constantTranform),
this._camera.rotationQuaternion.z*=-1,this._camera.rotationQuaternion.w*=-1)};a.prototype.getClassName=function(){return"FreeCameraDeviceOrientationInput"};a.prototype.getSimpleName=function(){return"deviceOrientation"};return a}();n.a.FreeCameraDeviceOrientationInput=d},"SQ0+":function(n,q,a){a.d(q,"a",function(){return m});var h=a("oYeq"),g=a("ADVu");n=a("xCqU");var p=a("98Qd"),d=a("/SR9"),u=a("YKqZ"),m=function(){function a(a){void 0===a&&(a=!1);this.allowMouse=a;this.touchAngularSensibility=2E5;
this.touchMoveSensibility=250;this._offsetY=this._offsetX=null;this._pointerPressed=[]}a.prototype.attachControl=function(a){var b=this;a=u.b.BackCompatCameraNoPreventDefault(arguments);var c=null;void 0===this._pointerInput&&(this._onLostFocus=function(){b._offsetX=null;b._offsetY=null},this._pointerInput=function(k){var f=k.event,m=!b.camera.getEngine().hostInformation.isMobile&&f instanceof MouseEvent;if(b.allowMouse||"mouse"!==f.pointerType&&!m)k.type===p.a.POINTERDOWN?(a||f.preventDefault(),
b._pointerPressed.push(f.pointerId),1===b._pointerPressed.length&&(c={x:f.clientX,y:f.clientY})):k.type===p.a.POINTERUP?(a||f.preventDefault(),k=b._pointerPressed.indexOf(f.pointerId),-1!==k&&(b._pointerPressed.splice(k,1),0==k&&(c=null,b._offsetX=null,b._offsetY=null))):k.type===p.a.POINTERMOVE&&(a||f.preventDefault(),c&&(k=b._pointerPressed.indexOf(f.pointerId),0==k&&(b._offsetX=f.clientX-c.x,b._offsetY=-(f.clientY-c.y))))});this._observer=this.camera.getScene().onPointerObservable.add(this._pointerInput,
p.a.POINTERDOWN|p.a.POINTERUP|p.a.POINTERMOVE);if(this._onLostFocus){var m=this.camera.getEngine().getInputElement();m&&m.addEventListener("blur",this._onLostFocus)}};a.prototype.detachControl=function(a){this._pointerInput&&(this._observer&&(this.camera.getScene().onPointerObservable.remove(this._observer),this._observer=null),this._onLostFocus&&((a=this.camera.getEngine().getInputElement())&&a.removeEventListener("blur",this._onLostFocus),this._onLostFocus=null),this._pointerPressed=[],this._offsetY=
this._offsetX=null)};a.prototype.checkInputs=function(){if(null!==this._offsetX&&null!==this._offsetY&&(0!==this._offsetX||0!==this._offsetY)){var a=this.camera;a.cameraRotation.y=this._offsetX/this.touchAngularSensibility;if(1<this._pointerPressed.length)a.cameraRotation.x=-this._offsetY/this.touchAngularSensibility;else{var c=a._computeLocalCameraSpeed();c=new d.e(0,0,c*this._offsetY/this.touchMoveSensibility);d.a.RotationYawPitchRollToRef(a.rotation.y,a.rotation.x,0,a._cameraRotationMatrix);a.cameraDirection.addInPlace(d.e.TransformCoordinates(c,
a._cameraRotationMatrix))}}};a.prototype.getClassName=function(){return"FreeCameraTouchInput"};a.prototype.getSimpleName=function(){return"touch"};Object(h.c)([Object(g.c)()],a.prototype,"touchAngularSensibility",void 0);Object(h.c)([Object(g.c)()],a.prototype,"touchMoveSensibility",void 0);return a}();n.a.FreeCameraTouchInput=m},Su4L:function(n,q,a){a.d(q,"a",function(){return J});var h=a("oYeq"),g=a("uyO6"),p=a("ps+7"),d=a("sdjL"),u=a("fX5v"),m=a("KjVj"),c=a("L3Hx"),b=a("46vk"),l=a("98Qd"),f=a("/SR9"),
r=a("Xeau"),k=a("M9Dn"),t=a("dprs"),z=a("vpVX"),e=a("ddrY"),v=a("wAMR"),A=a("2/Cc"),B=a("stmW"),C=a("kdvT"),G=a("WrCc"),H=a("c7Ru"),y=a("4SJX"),w=a("mBE3"),I=a("8MBl");a("bnDv");a("s3JK");a("5xLc");a("K1vB");a("8dKw");var E=a("SYzJ"),K=a("HD13"),x=a("Ul6c");n=function(){function a(b,c){void 0===c&&(c=null);this.scene=b;this._rotationLeftAsked=this._rotationRightAsked=this._teleportationBackRequestInitiated=this._teleportationRequestInitiated=this._isActionableMesh=this._pointerDownOnMeshAsked=!1;
this._dpadPressed=!0;this._activePointer=!1;this._id=a._idCounter++;c?this._gazeTracker=c.clone("gazeTracker"):(this._gazeTracker=v.a.CreateTorus("gazeTracker",.0035,.0025,20,b,!1),this._gazeTracker.bakeCurrentTransformIntoVertices(),this._gazeTracker.isPickable=!1,this._gazeTracker.isVisible=!1,b=new C.a("targetMat",b),b.specularColor=r.a.Black(),b.emissiveColor=new r.a(.7,.7,.7),b.backFaceCulling=!1,this._gazeTracker.material=b)}a.prototype._getForwardRay=function(a){return new A.a(f.e.Zero(),new f.e(0,
0,a))};a.prototype._selectionPointerDown=function(){this._pointerDownOnMeshAsked=!0;this._currentHit&&this.scene.simulatePointerDown(this._currentHit,{pointerId:this._id})};a.prototype._selectionPointerUp=function(){this._currentHit&&this.scene.simulatePointerUp(this._currentHit,{pointerId:this._id});this._pointerDownOnMeshAsked=!1};a.prototype._activatePointer=function(){this._activePointer=!0};a.prototype._deactivatePointer=function(){this._activePointer=!1};a.prototype._updatePointerDistance=function(a){};
a.prototype.dispose=function(){this._teleportationEnabled=this._interactionsEnabled=!1;this._gazeTracker&&this._gazeTracker.dispose()};a._idCounter=0;return a}();var N=function(a){function b(b,c,k){var e=a.call(this,c,k)||this;e.webVRController=b;e._laserPointer=v.a.CreateCylinder("laserPointer",1,.004,2E-4,20,1,c,!1);k=new C.a("laserPointerMat",c);k.emissiveColor=new r.a(.7,.7,.7);k.alpha=.6;e._laserPointer.material=k;e._laserPointer.rotation.x=Math.PI/2;e._laserPointer.position.z=-.5;e._laserPointer.isVisible=
!1;e._laserPointer.isPickable=!1;b.mesh||(k=new v.a("preloadControllerMesh",c),c=new v.a(t.a.POINTING_POSE,c),c.rotation.x=-.7,k.addChild(c),b.attachToMesh(k));e._setLaserPointerParent(b.mesh);e._meshAttachedObserver=b._meshAttachedObservable.add(function(a){e._setLaserPointerParent(a)});return e}Object(h.d)(b,a);b.prototype._getForwardRay=function(a){return this.webVRController.getForwardRay(a)};b.prototype._activatePointer=function(){a.prototype._activatePointer.call(this);this._laserPointer.isVisible=
!0};b.prototype._deactivatePointer=function(){a.prototype._deactivatePointer.call(this);this._laserPointer.isVisible=!1};b.prototype._setLaserPointerColor=function(a){this._laserPointer.material.emissiveColor=a};b.prototype._setLaserPointerLightingDisabled=function(a){this._laserPointer.material.disableLighting=a};b.prototype._setLaserPointerParent=function(a){var b=function(a){a.isPickable=!1;a.getChildMeshes().forEach(function(a){b(a)})};b(a);var c=a.getChildren(void 0,!1);this.webVRController._pointingPoseNode=
null;for(var k=0;k<c.length;k++)if(c[k].name&&0<=c[k].name.indexOf(t.a.POINTING_POSE)){a=c[k];this.webVRController._pointingPoseNode=a;break}this._laserPointer.parent=a};b.prototype._updatePointerDistance=function(a){void 0===a&&(a=100);this._laserPointer.scaling.y=a;this._laserPointer.position.z=-a/2};b.prototype.dispose=function(){a.prototype.dispose.call(this);this._laserPointer.dispose();this._meshAttachedObserver&&this.webVRController._meshAttachedObservable.remove(this._meshAttachedObserver)};
return b}(n),F=function(a){function b(b,c){c=a.call(this,c)||this;c.getCamera=b;return c}Object(h.d)(b,a);b.prototype._getForwardRay=function(a){var b=this.getCamera();return b?b.getForwardRay(a):new A.a(f.e.Zero(),f.e.Forward())};return b}(n);(function(){return function(){}})();var J=function(){function a(b,c){var d=this;void 0===c&&(c={});this.webVROptions=c;this.enableGazeEvenWhenNoPointerLock=this._fullscreenVRpresenting=this._webVRpresenting=this._webVRrequesting=this._webVRready=this._webVRsupported=
!1;this.exitVROnDoubleTap=!0;this.onEnteringVRObservable=new p.a;this.onAfterEnteringVRObservable=new p.a;this.onExitingVRObservable=new p.a;this.onControllerMeshLoadedObservable=new p.a;this._teleportActive=this._teleportationRequested=this._useCustomVRButton=!1;this._floorMeshesCollection=[];this._teleportationMode=a.TELEPORTATIONMODE_CONSTANTTIME;this._teleportationTime=122;this._teleportationSpeed=20;this._rotationAllowed=!0;this._teleportBackwardsVector=new f.e(0,-1,-1);this._isDefaultTeleportationTarget=
!0;this._teleportationFillColor="#444444";this._teleportationBorderColor="#FFFFFF";this._rotationAngle=0;this._haloCenter=new f.e(0,0,0);this._padSensibilityUp=.65;this._padSensibilityDown=.35;this._rightController=this._leftController=null;this._gazeColor=new r.a(.7,.7,.7);this._laserColor=new r.a(.7,.7,.7);this._pickedLaserColor=new r.a(.2,.2,1);this._pickedGazeColor=new r.a(0,0,1);this.onNewMeshSelected=new p.a;this.onMeshSelectedWithController=new p.a;this.onNewMeshPicked=new p.a;this.onBeforeCameraTeleport=
new p.a;this.onAfterCameraTeleport=new p.a;this.onSelectedMeshUnselected=new p.a;this.teleportationEnabled=!0;this._interactionsRequested=this._interactionsEnabled=this._teleportationInitialized=!1;this.requestPointerLockOnFullScreen=this.updateControllerLaserColor=this.updateGazeTrackerColor=this.updateGazeTrackerScale=this._displayLaserPointer=this._displayGaze=!0;this.xrTestDone=!1;this._onResize=function(){d.moveButtonToBottomRight();d._fullscreenVRpresenting&&d._webVRready&&d.exitVR()};this._onFullscreenChange=
function(){var a=document;void 0!==a.fullscreen?d._fullscreenVRpresenting=document.fullscreen:void 0!==a.mozFullScreen?d._fullscreenVRpresenting=a.mozFullScreen:void 0!==a.webkitIsFullScreen?d._fullscreenVRpresenting=a.webkitIsFullScreen:void 0!==a.msIsFullScreen?d._fullscreenVRpresenting=a.msIsFullScreen:void 0!==document.msFullscreenElement&&(d._fullscreenVRpresenting=document.msFullscreenElement);!d._fullscreenVRpresenting&&d._inputElement&&(d.exitVR(),!d._useCustomVRButton&&d._btnVR&&(d._btnVR.style.top=
d._inputElement.offsetTop+d._inputElement.offsetHeight-70+"px",d._btnVR.style.left=d._inputElement.offsetLeft+d._inputElement.offsetWidth-100+"px",d.updateButtonVisibility()))};this._cachedAngularSensibility={angularSensibilityX:null,angularSensibilityY:null,angularSensibility:null};this.beforeRender=function(){d._leftController&&d._leftController._activePointer&&d._castRayAndSelectObject(d._leftController);d._rightController&&d._rightController._activePointer&&d._castRayAndSelectObject(d._rightController);
d._noControllerIsActive&&(d._scene.getEngine().isPointerLock||d.enableGazeEvenWhenNoPointerLock)?d._castRayAndSelectObject(d._cameraGazer):d._cameraGazer._gazeTracker.isVisible=!1};this._onNewGamepadConnected=function(a){if(a.type!==k.a.POSE_ENABLED){if(a.leftStick)a.onleftstickchanged(function(a){d._teleportationInitialized&&d.teleportationEnabled&&(!d._leftController&&!d._rightController||d._leftController&&!d._leftController._activePointer&&d._rightController&&!d._rightController._activePointer)&&
(d._checkTeleportWithRay(a,d._cameraGazer),d._checkTeleportBackwards(a,d._cameraGazer))});if(a.rightStick)a.onrightstickchanged(function(a){d._teleportationInitialized&&d._checkRotate(a,d._cameraGazer)});a.type===k.a.XBOX&&(a.onbuttondown(function(a){d._interactionsEnabled&&a===e.a.A&&d._cameraGazer._selectionPointerDown()}),a.onbuttonup(function(a){d._interactionsEnabled&&a===e.a.A&&d._cameraGazer._selectionPointerUp()}))}else{var b=new N(a,d._scene,d._cameraGazer._gazeTracker);"right"===a.hand||
d._leftController&&d._leftController.webVRController!=a?d._rightController=b:d._leftController=b;d._tryEnableInteractionOnController(b)}};this._tryEnableInteractionOnController=function(a){d._interactionsRequested&&!a._interactionsEnabled&&d._enableInteractionOnController(a);d._teleportationRequested&&!a._teleportationEnabled&&d._enableTeleportationOnController(a)};this._onNewGamepadDisconnected=function(a){a instanceof z.a&&("left"===a.hand&&null!=d._leftController&&(d._leftController.dispose(),
d._leftController=null),"right"===a.hand&&null!=d._rightController&&(d._rightController.dispose(),d._rightController=null))};this._workingVector=f.e.Zero();this._workingQuaternion=f.b.Identity();this._workingMatrix=f.a.Identity();this._scene=b;this._inputElement=b.getEngine().getInputElement();"getVRDisplays"in navigator||(c.useXR=!0);void 0===c.createFallbackVRDeviceOrientationFreeCamera&&(c.createFallbackVRDeviceOrientationFreeCamera=!0);void 0===c.createDeviceOrientationCamera&&(c.createDeviceOrientationCamera=
!0);void 0===c.laserToggle&&(c.laserToggle=!0);void 0===c.defaultHeight&&(c.defaultHeight=1.7);c.useCustomVRButton&&(this._useCustomVRButton=!0,c.customVRButton&&(this._btnVR=c.customVRButton));c.rayLength&&(this._rayLength=c.rayLength);this._defaultHeight=c.defaultHeight;c.positionScale&&(this._rayLength*=c.positionScale,this._defaultHeight*=c.positionScale);this._hasEnteredVR=!1;this._position=this._scene.activeCamera?this._scene.activeCamera.position.clone():new f.e(0,this._defaultHeight,0);if(c.createDeviceOrientationCamera||
!this._scene.activeCamera){this._deviceOrientationCamera=new m.a("deviceOrientationVRHelper",this._position.clone(),b);if(this._scene.activeCamera&&(this._deviceOrientationCamera.minZ=this._scene.activeCamera.minZ,this._deviceOrientationCamera.maxZ=this._scene.activeCamera.maxZ,this._scene.activeCamera instanceof u.a&&this._scene.activeCamera.rotation)){var h=this._scene.activeCamera;h.rotationQuaternion?this._deviceOrientationCamera.rotationQuaternion.copyFrom(h.rotationQuaternion):this._deviceOrientationCamera.rotationQuaternion.copyFrom(f.b.RotationYawPitchRoll(h.rotation.y,
h.rotation.x,h.rotation.z));this._deviceOrientationCamera.rotation=h.rotation.clone()}this._scene.activeCamera=this._deviceOrientationCamera;this._inputElement&&this._scene.activeCamera.attachControl()}else this._existingCamera=this._scene.activeCamera;this.webVROptions.useXR&&navigator.xr?K.a.IsSessionSupportedAsync("immersive-vr").then(function(a){a?(g.a.Log("Using WebXR. It is recommended to use the WebXRDefaultExperience directly"),b.createDefaultXRExperienceAsync({floorMeshes:c.floorMeshes||
[]}).then(function(a){d.xr=a;d.xrTestDone=!0;d._cameraGazer=new F(function(){return d.xr.baseExperience.camera},b);d.xr.baseExperience.onStateChangedObservable.add(function(a){switch(a){case x.a.ENTERING_XR:d.onEnteringVRObservable.notifyObservers(d);d._interactionsEnabled||d.xr.pointerSelection.detach();d.xr.pointerSelection.displayLaserPointer=d._displayLaserPointer;break;case x.a.EXITING_XR:d.onExitingVRObservable.notifyObservers(d);d._scene.getEngine().resize();break;case x.a.IN_XR:d._hasEnteredVR=
!0;break;case x.a.NOT_IN_XR:d._hasEnteredVR=!1}})})):d.completeVRInit(b,c)}):this.completeVRInit(b,c)}Object.defineProperty(a.prototype,"onEnteringVR",{get:function(){return this.onEnteringVRObservable},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"onExitingVR",{get:function(){return this.onExitingVRObservable},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"onControllerMeshLoaded",{get:function(){return this.onControllerMeshLoadedObservable},enumerable:!1,
configurable:!0});Object.defineProperty(a.prototype,"teleportationTarget",{get:function(){return this._teleportationTarget},set:function(a){a&&(a.name="teleportationTarget",this._isDefaultTeleportationTarget=!1,this._teleportationTarget=a)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"gazeTrackerMesh",{get:function(){return this._cameraGazer._gazeTracker},set:function(a){a&&(this._cameraGazer._gazeTracker&&this._cameraGazer._gazeTracker.dispose(),this._leftController&&this._leftController._gazeTracker&&
this._leftController._gazeTracker.dispose(),this._rightController&&this._rightController._gazeTracker&&this._rightController._gazeTracker.dispose(),this._cameraGazer._gazeTracker=a,this._cameraGazer._gazeTracker.bakeCurrentTransformIntoVertices(),this._cameraGazer._gazeTracker.isPickable=!1,this._cameraGazer._gazeTracker.isVisible=!1,this._cameraGazer._gazeTracker.name="gazeTracker",this._leftController&&(this._leftController._gazeTracker=this._cameraGazer._gazeTracker.clone("gazeTracker")),this._rightController&&
(this._rightController._gazeTracker=this._cameraGazer._gazeTracker.clone("gazeTracker")))},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"leftControllerGazeTrackerMesh",{get:function(){return this._leftController?this._leftController._gazeTracker:null},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"rightControllerGazeTrackerMesh",{get:function(){return this._rightController?this._rightController._gazeTracker:null},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,
"displayGaze",{get:function(){return this._displayGaze},set:function(a){this._displayGaze=a;a||(this._cameraGazer._gazeTracker.isVisible=!1,this._leftController&&(this._leftController._gazeTracker.isVisible=!1),this._rightController&&(this._rightController._gazeTracker.isVisible=!1))},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"displayLaserPointer",{get:function(){return this._displayLaserPointer},set:function(a){(this._displayLaserPointer=a)?(this._rightController&&this._rightController._activatePointer(),
this._leftController&&this._leftController._activatePointer()):(this._rightController&&(this._rightController._deactivatePointer(),this._rightController._gazeTracker.isVisible=!1),this._leftController&&(this._leftController._deactivatePointer(),this._leftController._gazeTracker.isVisible=!1))},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"deviceOrientationCamera",{get:function(){return this._deviceOrientationCamera},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,
"currentVRCamera",{get:function(){return this._webVRready?this._webVRCamera:this._scene.activeCamera},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"webVRCamera",{get:function(){return this._webVRCamera},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"vrDeviceOrientationCamera",{get:function(){return this._vrDeviceOrientationCamera},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"vrButton",{get:function(){return this._btnVR},enumerable:!1,
configurable:!0});Object.defineProperty(a.prototype,"_teleportationRequestInitiated",{get:function(){return this._cameraGazer._teleportationRequestInitiated||null!==this._leftController&&this._leftController._teleportationRequestInitiated||null!==this._rightController&&this._rightController._teleportationRequestInitiated},enumerable:!1,configurable:!0});a.prototype.completeVRInit=function(a,k){var e=this;this.xrTestDone=!0;k.createFallbackVRDeviceOrientationFreeCamera&&(k.useMultiview&&(k.vrDeviceOrientationCameraMetrics||
(k.vrDeviceOrientationCameraMetrics=I.a.GetDefault()),k.vrDeviceOrientationCameraMetrics.multiviewEnabled=!0),this._vrDeviceOrientationCamera=new c.a("VRDeviceOrientationVRHelper",this._position,this._scene,!0,k.vrDeviceOrientationCameraMetrics),this._vrDeviceOrientationCamera.angularSensibility=Number.MAX_VALUE);this._webVRCamera=new b.a("WebVRHelper",this._position,this._scene,k);this._webVRCamera.useStandingMatrix();this._cameraGazer=new F(function(){return e.currentVRCamera},a);if(!this._useCustomVRButton){this._btnVR=
document.createElement("BUTTON");this._btnVR.className="babylonVRicon";this._btnVR.id="babylonVRiconbtn";this._btnVR.title="Click to switch to VR";var f=".babylonVRicon { position: absolute; right: 20px; height: 50px; width: 80px; background-color: rgba(51,51,51,0.7); background-image: url("+(window.SVGSVGElement?"data:image/svg+xml;charset=UTF-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%222048%22%20height%3D%221152%22%20viewBox%3D%220%200%202048%201152%22%20version%3D%221.1%22%3E%3Cpath%20transform%3D%22rotate%28180%201024%2C576.0000000000001%29%22%20d%3D%22m1109%2C896q17%2C0%2030%2C-12t13%2C-30t-12.5%2C-30.5t-30.5%2C-12.5l-170%2C0q-18%2C0%20-30.5%2C12.5t-12.5%2C30.5t13%2C30t30%2C12l170%2C0zm-85%2C256q59%2C0%20132.5%2C-1.5t154.5%2C-5.5t164.5%2C-11.5t163%2C-20t150%2C-30t124.5%2C-41.5q23%2C-11%2042%2C-24t38%2C-30q27%2C-25%2041%2C-61.5t14%2C-72.5l0%2C-257q0%2C-123%20-47%2C-232t-128%2C-190t-190%2C-128t-232%2C-47l-81%2C0q-37%2C0%20-68.5%2C14t-60.5%2C34.5t-55.5%2C45t-53%2C45t-53%2C34.5t-55.5%2C14t-55.5%2C-14t-53%2C-34.5t-53%2C-45t-55.5%2C-45t-60.5%2C-34.5t-68.5%2C-14l-81%2C0q-123%2C0%20-232%2C47t-190%2C128t-128%2C190t-47%2C232l0%2C257q0%2C68%2038%2C115t97%2C73q54%2C24%20124.5%2C41.5t150%2C30t163%2C20t164.5%2C11.5t154.5%2C5.5t132.5%2C1.5zm939%2C-298q0%2C39%20-24.5%2C67t-58.5%2C42q-54%2C23%20-122%2C39.5t-143.5%2C28t-155.5%2C19t-157%2C11t-148.5%2C5t-129.5%2C1.5q-59%2C0%20-130%2C-1.5t-148%2C-5t-157%2C-11t-155.5%2C-19t-143.5%2C-28t-122%2C-39.5q-34%2C-14%20-58.5%2C-42t-24.5%2C-67l0%2C-257q0%2C-106%2040.5%2C-199t110%2C-162.5t162.5%2C-109.5t199%2C-40l81%2C0q27%2C0%2052%2C14t50%2C34.5t51%2C44.5t55.5%2C44.5t63.5%2C34.5t74%2C14t74%2C-14t63.5%2C-34.5t55.5%2C-44.5t51%2C-44.5t50%2C-34.5t52%2C-14l14%2C0q37%2C0%2070%2C0.5t64.5%2C4.5t63.5%2C12t68%2C23q71%2C30%20128.5%2C78.5t98.5%2C110t63.5%2C133.5t22.5%2C149l0%2C257z%22%20fill%3D%22white%22%20/%3E%3C/svg%3E%0A":
"https://cdn.babylonjs.com/Assets/vrButton.png")+"); background-size: 80%; background-repeat:no-repeat; background-position: center; border: none; outline: none; transition: transform 0.125s ease-out } .babylonVRicon:hover { transform: scale(1.05) } .babylonVRicon:active {background-color: rgba(51,51,51,1) } .babylonVRicon:focus {background-color: rgba(51,51,51,1) }.babylonVRicon.vrdisplaypresenting { display: none; }";var d=document.createElement("style");d.appendChild(document.createTextNode(f));
document.getElementsByTagName("head")[0].appendChild(d);this.moveButtonToBottomRight()}this._btnVR&&this._btnVR.addEventListener("click",function(){e.isInVRMode?e._scene.getEngine().disableVR():e.enterVR()});if(f=this._scene.getEngine().getHostWindow())f.addEventListener("resize",this._onResize),document.addEventListener("fullscreenchange",this._onFullscreenChange,!1),document.addEventListener("mozfullscreenchange",this._onFullscreenChange,!1),document.addEventListener("webkitfullscreenchange",this._onFullscreenChange,
!1),document.addEventListener("msfullscreenchange",this._onFullscreenChange,!1),document.onmsfullscreenchange=this._onFullscreenChange,k.createFallbackVRDeviceOrientationFreeCamera?this.displayVRButton():this._scene.getEngine().onVRDisplayChangedObservable.add(function(a){a.vrDisplay&&e.displayVRButton()}),this._onKeyDown=function(a){27===a.keyCode&&e.isInVRMode&&e.exitVR()},document.addEventListener("keydown",this._onKeyDown),this._scene.onPrePointerObservable.add(function(){e._hasEnteredVR&&e.exitVROnDoubleTap&&
(e.exitVR(),e._fullscreenVRpresenting&&e._scene.getEngine().exitFullscreen())},l.a.POINTERDOUBLETAP,!1),this._onVRDisplayChanged=function(a){return e.onVRDisplayChanged(a)},this._onVrDisplayPresentChange=function(){return e.onVrDisplayPresentChange()},this._onVRRequestPresentStart=function(){e._webVRrequesting=!0;e.updateButtonVisibility()},this._onVRRequestPresentComplete=function(){e._webVRrequesting=!1;e.updateButtonVisibility()},a.getEngine().onVRDisplayChangedObservable.add(this._onVRDisplayChanged),
a.getEngine().onVRRequestPresentStart.add(this._onVRRequestPresentStart),a.getEngine().onVRRequestPresentComplete.add(this._onVRRequestPresentComplete),f.addEventListener("vrdisplaypresentchange",this._onVrDisplayPresentChange),a.onDisposeObservable.add(function(){e.dispose()}),this._webVRCamera.onControllerMeshLoadedObservable.add(function(a){return e._onDefaultMeshLoaded(a)}),this._scene.gamepadManager.onGamepadConnectedObservable.add(this._onNewGamepadConnected),this._scene.gamepadManager.onGamepadDisconnectedObservable.add(this._onNewGamepadDisconnected),
this.updateButtonVisibility(),this._circleEase=new y.b,this._circleEase.setEasingMode(y.c.EASINGMODE_EASEINOUT),this._teleportationEasing=this._circleEase,a.onPointerObservable.add(function(b){e._interactionsEnabled&&a.activeCamera===e.vrDeviceOrientationCamera&&"mouse"===b.event.pointerType&&(b.type===l.a.POINTERDOWN?e._cameraGazer._selectionPointerDown():b.type===l.a.POINTERUP&&e._cameraGazer._selectionPointerUp())}),this.webVROptions.floorMeshes&&this.enableTeleportation({floorMeshes:this.webVROptions.floorMeshes})};
a.prototype._onDefaultMeshLoaded=function(a){this._leftController&&this._leftController.webVRController==a&&a.mesh&&this._leftController._setLaserPointerParent(a.mesh);this._rightController&&this._rightController.webVRController==a&&a.mesh&&this._rightController._setLaserPointerParent(a.mesh);try{this.onControllerMeshLoadedObservable.notifyObservers(a)}catch(D){g.a.Warn("Error in your custom logic onControllerMeshLoaded: "+D)}};Object.defineProperty(a.prototype,"isInVRMode",{get:function(){return this.xr&&
this.webVROptions.useXR&&this.xr.baseExperience.state===x.a.IN_XR||this._webVRpresenting||this._fullscreenVRpresenting},enumerable:!1,configurable:!0});a.prototype.onVrDisplayPresentChange=function(){var a=this._scene.getEngine().getVRDevice();if(a){var b=this._webVRpresenting;this._webVRpresenting=a.isPresenting;b&&!this._webVRpresenting&&this.exitVR()}else g.a.Warn("Detected VRDisplayPresentChange on an unknown VRDisplay. Did you can enterVR on the vrExperienceHelper?");this.updateButtonVisibility()};
a.prototype.onVRDisplayChanged=function(a){this._webVRsupported=a.vrSupported;this._webVRready=!!a.vrDisplay;this._webVRpresenting=a.vrDisplay&&a.vrDisplay.isPresenting;this.updateButtonVisibility()};a.prototype.moveButtonToBottomRight=function(){if(this._inputElement&&!this._useCustomVRButton&&this._btnVR){var a=this._inputElement.getBoundingClientRect();this._btnVR.style.top=a.top+a.height-70+"px";this._btnVR.style.left=a.left+a.width-100+"px"}};a.prototype.displayVRButton=function(){this._useCustomVRButton||
this._btnVRDisplayed||!this._btnVR||(document.body.appendChild(this._btnVR),this._btnVRDisplayed=!0)};a.prototype.updateButtonVisibility=function(){this._btnVR&&!this._useCustomVRButton&&(this._btnVR.className="babylonVRicon",this.isInVRMode?this._btnVR.className+=" vrdisplaypresenting":(this._webVRready&&(this._btnVR.className+=" vrdisplayready"),this._webVRsupported&&(this._btnVR.className+=" vrdisplaysupported"),this._webVRrequesting&&(this._btnVR.className+=" vrdisplayrequesting")))};a.prototype.enterVR=
function(){var a=this;if(this.xr)this.xr.baseExperience.enterXRAsync("immersive-vr","local-floor",this.xr.renderTarget);else{if(this.onEnteringVRObservable)try{this.onEnteringVRObservable.notifyObservers(this)}catch(L){g.a.Warn("Error in your custom logic onEnteringVR: "+L)}if(this._scene.activeCamera){this._position=this._scene.activeCamera.position.clone();this.vrDeviceOrientationCamera&&(this.vrDeviceOrientationCamera.rotation=f.b.FromRotationMatrix(this._scene.activeCamera.getWorldMatrix().getRotationMatrix()).toEulerAngles(),
this.vrDeviceOrientationCamera.angularSensibility=2E3);if(this.webVRCamera){var b=this.webVRCamera.deviceRotationQuaternion.toEulerAngles().y;b=f.b.FromRotationMatrix(this._scene.activeCamera.getWorldMatrix().getRotationMatrix()).toEulerAngles().y-b;var c=this.webVRCamera.rotationQuaternion.toEulerAngles().y;this.webVRCamera.rotationQuaternion=f.b.FromEulerAngles(0,c+b,0)}this._existingCamera=this._scene.activeCamera;this._existingCamera.angularSensibilityX&&(this._cachedAngularSensibility.angularSensibilityX=
this._existingCamera.angularSensibilityX,this._existingCamera.angularSensibilityX=Number.MAX_VALUE);this._existingCamera.angularSensibilityY&&(this._cachedAngularSensibility.angularSensibilityY=this._existingCamera.angularSensibilityY,this._existingCamera.angularSensibilityY=Number.MAX_VALUE);this._existingCamera.angularSensibility&&(this._cachedAngularSensibility.angularSensibility=this._existingCamera.angularSensibility,this._existingCamera.angularSensibility=Number.MAX_VALUE)}this._webVRrequesting||
(this._webVRready?this._webVRpresenting||(this._scene.getEngine().onVRRequestPresentComplete.addOnce(function(b){a.onAfterEnteringVRObservable.notifyObservers({success:b})}),this._webVRCamera.position=this._position,this._scene.activeCamera=this._webVRCamera):this._vrDeviceOrientationCamera&&(this._vrDeviceOrientationCamera.position=this._position,this._scene.activeCamera&&(this._vrDeviceOrientationCamera.minZ=this._scene.activeCamera.minZ),this._scene.activeCamera=this._vrDeviceOrientationCamera,
this._scene.getEngine().enterFullscreen(this.requestPointerLockOnFullScreen),this.updateButtonVisibility(),this._vrDeviceOrientationCamera.onViewMatrixChangedObservable.addOnce(function(){a.onAfterEnteringVRObservable.notifyObservers({success:!0})})),this._scene.activeCamera&&this._inputElement&&this._scene.activeCamera.attachControl(),this._interactionsEnabled&&this._scene.registerBeforeRender(this.beforeRender),this._displayLaserPointer&&[this._leftController,this._rightController].forEach(function(a){a&&
a._activatePointer()}),this._hasEnteredVR=!0)}};a.prototype.exitVR=function(){if(this.xr)this.xr.baseExperience.exitXRAsync();else if(this._hasEnteredVR){if(this.onExitingVRObservable)try{this.onExitingVRObservable.notifyObservers(this)}catch(D){g.a.Warn("Error in your custom logic onExitingVR: "+D)}this._webVRpresenting&&this._scene.getEngine().disableVR();this._scene.activeCamera&&(this._position=this._scene.activeCamera.position.clone());this.vrDeviceOrientationCamera&&(this.vrDeviceOrientationCamera.angularSensibility=
Number.MAX_VALUE);this._deviceOrientationCamera?(this._deviceOrientationCamera.position=this._position,this._scene.activeCamera=this._deviceOrientationCamera,this._cachedAngularSensibility.angularSensibilityX&&(this._deviceOrientationCamera.angularSensibilityX=this._cachedAngularSensibility.angularSensibilityX,this._cachedAngularSensibility.angularSensibilityX=null),this._cachedAngularSensibility.angularSensibilityY&&(this._deviceOrientationCamera.angularSensibilityY=this._cachedAngularSensibility.angularSensibilityY,
this._cachedAngularSensibility.angularSensibilityY=null),this._cachedAngularSensibility.angularSensibility&&(this._deviceOrientationCamera.angularSensibility=this._cachedAngularSensibility.angularSensibility,this._cachedAngularSensibility.angularSensibility=null)):this._existingCamera&&(this._existingCamera.position=this._position,this._scene.activeCamera=this._existingCamera,this._inputElement&&this._scene.activeCamera.attachControl(),this._cachedAngularSensibility.angularSensibilityX&&(this._existingCamera.angularSensibilityX=
this._cachedAngularSensibility.angularSensibilityX,this._cachedAngularSensibility.angularSensibilityX=null),this._cachedAngularSensibility.angularSensibilityY&&(this._existingCamera.angularSensibilityY=this._cachedAngularSensibility.angularSensibilityY,this._cachedAngularSensibility.angularSensibilityY=null),this._cachedAngularSensibility.angularSensibility&&(this._existingCamera.angularSensibility=this._cachedAngularSensibility.angularSensibility,this._cachedAngularSensibility.angularSensibility=
null));this.updateButtonVisibility();this._interactionsEnabled&&(this._scene.unregisterBeforeRender(this.beforeRender),this._cameraGazer._gazeTracker.isVisible=!1,this._leftController&&(this._leftController._gazeTracker.isVisible=!1),this._rightController&&(this._rightController._gazeTracker.isVisible=!1));this._scene.getEngine().resize();[this._leftController,this._rightController].forEach(function(a){a&&a._deactivatePointer()});this._hasEnteredVR=!1;var a=this._scene.getEngine();a._onVrDisplayPresentChange&&
a._onVrDisplayPresentChange()}};Object.defineProperty(a.prototype,"position",{get:function(){return this._position},set:function(a){this._position=a;this._scene.activeCamera&&(this._scene.activeCamera.position=a)},enumerable:!1,configurable:!0});a.prototype.enableInteractions=function(){var a=this;this._interactionsEnabled||(this._interactionsRequested=!0,this.xr?this.xr.baseExperience.state===x.a.IN_XR&&this.xr.pointerSelection.attach():(this._leftController&&this._enableInteractionOnController(this._leftController),
this._rightController&&this._enableInteractionOnController(this._rightController),this.raySelectionPredicate=function(b){return b.isVisible&&(b.isPickable||b.name===a._floorMeshName)},this.meshSelectionPredicate=function(){return!0},this._raySelectionPredicate=function(b){return a._isTeleportationFloor(b)||-1===b.name.indexOf("gazeTracker")&&-1===b.name.indexOf("teleportationTarget")&&-1===b.name.indexOf("torusTeleportation")?a.raySelectionPredicate(b):!1},this._interactionsEnabled=!0))};Object.defineProperty(a.prototype,
"_noControllerIsActive",{get:function(){return!(this._leftController&&this._leftController._activePointer)&&!(this._rightController&&this._rightController._activePointer)},enumerable:!1,configurable:!0});a.prototype._isTeleportationFloor=function(a){for(var b=0;b<this._floorMeshesCollection.length;b++)if(this._floorMeshesCollection[b].id===a.id)return!0;return this._floorMeshName&&a.name===this._floorMeshName?!0:!1};a.prototype.addFloorMesh=function(a){this._floorMeshesCollection&&(-1<this._floorMeshesCollection.indexOf(a)||
this._floorMeshesCollection.push(a))};a.prototype.removeFloorMesh=function(a){this._floorMeshesCollection&&(a=this._floorMeshesCollection.indexOf(a),-1!==a&&this._floorMeshesCollection.splice(a,1))};a.prototype.enableTeleportation=function(a){var b=this;void 0===a&&(a={});if(!this._teleportationInitialized){this._teleportationRequested=!0;this.enableInteractions();if(this.webVROptions.useXR&&(a.floorMeshes||a.floorMeshName)){var c=a.floorMeshes||[];if(!c.length){var k=this._scene.getMeshByName(a.floorMeshName);
k&&c.push(k)}if(this.xr){c.forEach(function(a){b.xr.teleportation.addFloorMesh(a)});this.xr.teleportation.attached||this.xr.teleportation.attach();return}if(!this.xrTestDone){var e=function(){b.xrTestDone&&(b._scene.unregisterBeforeRender(e),b.xr?b.xr.teleportation.attached||b.xr.teleportation.attach():b.enableTeleportation(a))};this._scene.registerBeforeRender(e);return}}a.floorMeshName&&(this._floorMeshName=a.floorMeshName);a.floorMeshes&&(this._floorMeshesCollection=a.floorMeshes);a.teleportationMode&&
(this._teleportationMode=a.teleportationMode);a.teleportationTime&&0<a.teleportationTime&&(this._teleportationTime=a.teleportationTime);a.teleportationSpeed&&0<a.teleportationSpeed&&(this._teleportationSpeed=a.teleportationSpeed);void 0!==a.easingFunction&&(this._teleportationEasing=a.easingFunction);null!=this._leftController&&this._enableTeleportationOnController(this._leftController);null!=this._rightController&&this._enableTeleportationOnController(this._rightController);c=new B.a;c.vignetteColor=
new r.b(0,0,0,0);c.vignetteEnabled=!0;this._postProcessMove=new H.a("postProcessMove",1,this._webVRCamera,void 0,void 0,void 0,void 0,c);this._webVRCamera.detachPostProcess(this._postProcessMove);this._teleportationInitialized=!0;this._isDefaultTeleportationTarget&&(this._createTeleportationCircles(),this._teleportationTarget.scaling.scaleInPlace(this._webVRCamera.deviceScaleFactor))}};a.prototype._enableInteractionOnController=function(a){var b=this;a.webVRController.mesh&&(a._interactionsEnabled=
!0,this.isInVRMode&&this._displayLaserPointer&&a._activatePointer(),this.webVROptions.laserToggle&&a.webVRController.onMainButtonStateChangedObservable.add(function(c){b._displayLaserPointer&&1===c.value&&(a._activePointer?a._deactivatePointer():a._activatePointer(),b.displayGaze&&(a._gazeTracker.isVisible=a._activePointer))}),a.webVRController.onTriggerStateChangedObservable.add(function(c){var k=a;b._noControllerIsActive&&(k=b._cameraGazer);k._pointerDownOnMeshAsked?c.value<b._padSensibilityDown&&
k._selectionPointerUp():c.value>b._padSensibilityUp&&k._selectionPointerDown()}))};a.prototype._checkTeleportWithRay=function(a,b){if(!this._teleportationRequestInitiated||b._teleportationRequestInitiated)b._teleportationRequestInitiated?Math.sqrt(a.y*a.y+a.x*a.x)<this._padSensibilityDown&&(this._teleportActive&&this.teleportCamera(this._haloCenter),b._teleportationRequestInitiated=!1):a.y<-this._padSensibilityUp&&b._dpadPressed&&(b._activatePointer(),b._teleportationRequestInitiated=!0)};a.prototype._checkRotate=
function(a,b){b._teleportationRequestInitiated||(b._rotationLeftAsked?a.x>-this._padSensibilityDown&&(b._rotationLeftAsked=!1):a.x<-this._padSensibilityUp&&b._dpadPressed&&(b._rotationLeftAsked=!0,this._rotationAllowed&&this._rotateCamera(!1)),b._rotationRightAsked?a.x<this._padSensibilityDown&&(b._rotationRightAsked=!1):a.x>this._padSensibilityUp&&b._dpadPressed&&(b._rotationRightAsked=!0,this._rotationAllowed&&this._rotateCamera(!0)))};a.prototype._checkTeleportBackwards=function(a,b){if(!b._teleportationRequestInitiated)if(a.y>
this._padSensibilityUp&&b._dpadPressed){if(!b._teleportationBackRequestInitiated&&this.currentVRCamera){a=f.b.FromRotationMatrix(this.currentVRCamera.getWorldMatrix().getRotationMatrix());var c=this.currentVRCamera.position;this.currentVRCamera.devicePosition&&this.currentVRCamera.deviceRotationQuaternion&&(a=this.currentVRCamera.deviceRotationQuaternion,c=this.currentVRCamera.devicePosition);a.toEulerAnglesToRef(this._workingVector);this._workingVector.z=0;this._workingVector.x=0;f.b.RotationYawPitchRollToRef(this._workingVector.y,
this._workingVector.x,this._workingVector.z,this._workingQuaternion);this._workingQuaternion.toRotationMatrix(this._workingMatrix);f.e.TransformCoordinatesToRef(this._teleportBackwardsVector,this._workingMatrix,this._workingVector);a=new A.a(c,this._workingVector);(a=this._scene.pickWithRay(a,this._raySelectionPredicate))&&a.pickedPoint&&a.pickedMesh&&this._isTeleportationFloor(a.pickedMesh)&&5>a.distance&&this.teleportCamera(a.pickedPoint);b._teleportationBackRequestInitiated=!0}}else b._teleportationBackRequestInitiated=
!1};a.prototype._enableTeleportationOnController=function(a){var b=this;a.webVRController.mesh&&(a._interactionsEnabled||this._enableInteractionOnController(a),a._interactionsEnabled=!0,a._teleportationEnabled=!0,a.webVRController.controllerType===t.c.VIVE&&(a._dpadPressed=!1,a.webVRController.onPadStateChangedObservable.add(function(b){a._dpadPressed=b.pressed;a._dpadPressed||(a._rotationLeftAsked=!1,a._rotationRightAsked=!1,a._teleportationBackRequestInitiated=!1)})),a.webVRController.onPadValuesChangedObservable.add(function(c){b.teleportationEnabled&&
(b._checkTeleportBackwards(c,a),b._checkTeleportWithRay(c,a));b._checkRotate(c,a)}))};a.prototype._createTeleportationCircles=function(){this._teleportationTarget=v.a.CreateGround("teleportationTarget",2,2,2,this._scene);this._teleportationTarget.isPickable=!1;var a=new G.a("DynamicTexture",512,this._scene,!0);a.hasAlpha=!0;var b=a.getContext();b.beginPath();b.arc(256,256,200,0,2*Math.PI,!1);b.fillStyle=this._teleportationFillColor;b.fill();b.lineWidth=10;b.strokeStyle=this._teleportationBorderColor;
b.stroke();b.closePath();a.update();b=new C.a("TextPlaneMaterial",this._scene);b.diffuseTexture=a;this._teleportationTarget.material=b;a=v.a.CreateTorus("torusTeleportation",.75,.1,25,this._scene,!1);a.isPickable=!1;a.parent=this._teleportationTarget;b=new w.a("animationInnerCircle","position.y",30,w.a.ANIMATIONTYPE_FLOAT,w.a.ANIMATIONLOOPMODE_CYCLE);var c=[];c.push({frame:0,value:0});c.push({frame:30,value:.4});c.push({frame:60,value:0});b.setKeys(c);c=new y.e;c.setEasingMode(y.c.EASINGMODE_EASEINOUT);
b.setEasingFunction(c);a.animations=[];a.animations.push(b);this._scene.beginAnimation(a,0,60,!0);this._hideTeleportationTarget()};a.prototype._displayTeleportationTarget=function(){this._teleportActive=!0;this._teleportationInitialized&&(this._teleportationTarget.isVisible=!0,this._isDefaultTeleportationTarget&&(this._teleportationTarget.getChildren()[0].isVisible=!0))};a.prototype._hideTeleportationTarget=function(){this._teleportActive=!1;this._teleportationInitialized&&(this._teleportationTarget.isVisible=
!1,this._isDefaultTeleportationTarget&&(this._teleportationTarget.getChildren()[0].isVisible=!1))};a.prototype._rotateCamera=function(a){var b=this;if(this.currentVRCamera instanceof d.a){a?this._rotationAngle++:this._rotationAngle--;this.currentVRCamera.animations=[];a=f.b.FromRotationMatrix(f.a.RotationY(Math.PI/4*this._rotationAngle));var c=new w.a("animationRotation","rotationQuaternion",90,w.a.ANIMATIONTYPE_QUATERNION,w.a.ANIMATIONLOOPMODE_CONSTANT),k=[];k.push({frame:0,value:this.currentVRCamera.rotationQuaternion});
k.push({frame:6,value:a});c.setKeys(k);c.setEasingFunction(this._circleEase);this.currentVRCamera.animations.push(c);this._postProcessMove.animations=[];a=new w.a("animationPP","vignetteWeight",90,w.a.ANIMATIONTYPE_FLOAT,w.a.ANIMATIONLOOPMODE_CONSTANT);c=[];c.push({frame:0,value:0});c.push({frame:3,value:4});c.push({frame:6,value:0});a.setKeys(c);a.setEasingFunction(this._circleEase);this._postProcessMove.animations.push(a);a=new w.a("animationPP2","vignetteStretch",90,w.a.ANIMATIONTYPE_FLOAT,w.a.ANIMATIONLOOPMODE_CONSTANT);
c=[];c.push({frame:0,value:0});c.push({frame:3,value:10});c.push({frame:6,value:0});a.setKeys(c);a.setEasingFunction(this._circleEase);this._postProcessMove.animations.push(a);this._postProcessMove.imageProcessingConfiguration.vignetteWeight=0;this._postProcessMove.imageProcessingConfiguration.vignetteStretch=0;this._postProcessMove.samples=4;this._webVRCamera.attachPostProcess(this._postProcessMove);this._scene.beginAnimation(this._postProcessMove,0,6,!1,1,function(){b._webVRCamera.detachPostProcess(b._postProcessMove)});
this._scene.beginAnimation(this.currentVRCamera,0,6,!1,1)}};a.prototype._moveTeleportationSelectorTo=function(a,b,c){if(a.pickedPoint){b._teleportationRequestInitiated&&(this._displayTeleportationTarget(),this._haloCenter.copyFrom(a.pickedPoint),this._teleportationTarget.position.copyFrom(a.pickedPoint));if(a=this._convertNormalToDirectionOfRay(a.getNormal(!0,!1),c))b=f.e.Cross(E.a.Y,a),c=f.e.Cross(a,b),f.e.RotationFromAxisToRef(c,a,b,this._teleportationTarget.rotation);this._teleportationTarget.position.y+=
.1}};a.prototype.teleportCamera=function(b){var c=this;if(this.currentVRCamera instanceof d.a){this.webVRCamera.leftCamera?(this._workingVector.copyFrom(this.webVRCamera.leftCamera.globalPosition),this._workingVector.subtractInPlace(this.webVRCamera.position),b.subtractToRef(this._workingVector,this._workingVector)):this._workingVector.copyFrom(b);this._workingVector.y=this.isInVRMode?this._workingVector.y+this.webVRCamera.deviceDistanceToRoomGround()*this._webVRCamera.deviceScaleFactor:this._workingVector.y+
this._defaultHeight;this.onBeforeCameraTeleport.notifyObservers(this._workingVector);if(this._teleportationMode==a.TELEPORTATIONMODE_CONSTANTSPEED){b=90;var k=f.e.Distance(this.currentVRCamera.position,this._workingVector);k=this._teleportationSpeed/k}else b=Math.round(90*this._teleportationTime/1E3),k=1;this.currentVRCamera.animations=[];var e=new w.a("animationCameraTeleportation","position",90,w.a.ANIMATIONTYPE_VECTOR3,w.a.ANIMATIONLOOPMODE_CONSTANT);e.setKeys([{frame:0,value:this.currentVRCamera.position},
{frame:b,value:this._workingVector}]);e.setEasingFunction(this._teleportationEasing);this.currentVRCamera.animations.push(e);this._postProcessMove.animations=[];e=Math.round(b/2);var m=new w.a("animationPP","vignetteWeight",90,w.a.ANIMATIONTYPE_FLOAT,w.a.ANIMATIONLOOPMODE_CONSTANT),g=[];g.push({frame:0,value:0});g.push({frame:e,value:8});g.push({frame:b,value:0});m.setKeys(g);this._postProcessMove.animations.push(m);m=new w.a("animationPP2","vignetteStretch",90,w.a.ANIMATIONTYPE_FLOAT,w.a.ANIMATIONLOOPMODE_CONSTANT);
g=[];g.push({frame:0,value:0});g.push({frame:e,value:10});g.push({frame:b,value:0});m.setKeys(g);this._postProcessMove.animations.push(m);this._postProcessMove.imageProcessingConfiguration.vignetteWeight=0;this._postProcessMove.imageProcessingConfiguration.vignetteStretch=0;this._webVRCamera.attachPostProcess(this._postProcessMove);this._scene.beginAnimation(this._postProcessMove,0,b,!1,k,function(){c._webVRCamera.detachPostProcess(c._postProcessMove)});this._scene.beginAnimation(this.currentVRCamera,
0,b,!1,k,function(){c.onAfterCameraTeleport.notifyObservers(c._workingVector)});this._hideTeleportationTarget()}};a.prototype._convertNormalToDirectionOfRay=function(a,b){a&&Math.acos(f.e.Dot(a,b.direction))<Math.PI/2&&a.scaleInPlace(-1);return a};a.prototype._castRayAndSelectObject=function(a){if(this.currentVRCamera instanceof d.a){var b=a._getForwardRay(this._rayLength),c=this._scene.pickWithRay(b,this._raySelectionPredicate);c&&(a._laserPointer&&(c.originMesh=a._laserPointer.parent),this._scene.simulatePointerMove(c,
{pointerId:a._id}));if((a._currentHit=c)&&c.pickedPoint){if(this._displayGaze){var k=1;a._gazeTracker.isVisible=!0;a._isActionableMesh&&(k=3);this.updateGazeTrackerScale&&(a._gazeTracker.scaling.x=c.distance*k,a._gazeTracker.scaling.y=c.distance*k,a._gazeTracker.scaling.z=c.distance*k);if(k=this._convertNormalToDirectionOfRay(c.getNormal(),b)){var e=f.e.Cross(E.a.Y,k),m=f.e.Cross(k,e);f.e.RotationFromAxisToRef(m,k,e,a._gazeTracker.rotation)}a._gazeTracker.position.copyFrom(c.pickedPoint);a._gazeTracker.position.x=
0>a._gazeTracker.position.x?a._gazeTracker.position.x+.002:a._gazeTracker.position.x-.002;a._gazeTracker.position.y=0>a._gazeTracker.position.y?a._gazeTracker.position.y+.002:a._gazeTracker.position.y-.002;a._gazeTracker.position.z=0>a._gazeTracker.position.z?a._gazeTracker.position.z+.002:a._gazeTracker.position.z-.002}a._updatePointerDistance(c.distance)}else a._updatePointerDistance(),a._gazeTracker.isVisible=!1;if(c&&c.pickedMesh)if(this._teleportationInitialized&&this._isTeleportationFloor(c.pickedMesh)&&
c.pickedPoint)a._currentMeshSelected&&!this._isTeleportationFloor(a._currentMeshSelected)&&this._notifySelectedMeshUnselected(a._currentMeshSelected),a._currentMeshSelected=null,a._teleportationRequestInitiated&&this._moveTeleportationSelectorTo(c,a,b);else{if(c.pickedMesh!==a._currentMeshSelected)if(this.meshSelectionPredicate(c.pickedMesh)){this.onNewMeshPicked.notifyObservers(c);a._currentMeshSelected=c.pickedMesh;c.pickedMesh.isPickable&&c.pickedMesh.actionManager?(this.changeGazeColor(this._pickedGazeColor),
this.changeLaserColor(this._pickedLaserColor),a._isActionableMesh=!0):(this.changeGazeColor(this._gazeColor),this.changeLaserColor(this._laserColor),a._isActionableMesh=!1);try{this.onNewMeshSelected.notifyObservers(c.pickedMesh),a.webVRController&&this.onMeshSelectedWithController.notifyObservers({mesh:c.pickedMesh,controller:a.webVRController})}catch(M){g.a.Warn("Error while raising onNewMeshSelected or onMeshSelectedWithController: "+M)}}else this._notifySelectedMeshUnselected(a._currentMeshSelected),
a._currentMeshSelected=null,this.changeGazeColor(this._gazeColor),this.changeLaserColor(this._laserColor)}else this._notifySelectedMeshUnselected(a._currentMeshSelected),a._currentMeshSelected=null,this.changeGazeColor(this._gazeColor),this.changeLaserColor(this._laserColor)}};a.prototype._notifySelectedMeshUnselected=function(a){a&&this.onSelectedMeshUnselected.notifyObservers(a)};a.prototype.setLaserColor=function(a,b){void 0===b&&(b=this._pickedLaserColor);this._laserColor=a;this._pickedLaserColor=
b};a.prototype.setLaserLightingState=function(a){void 0===a&&(a=!0);this._leftController&&this._leftController._setLaserPointerLightingDisabled(!a);this._rightController&&this._rightController._setLaserPointerLightingDisabled(!a)};a.prototype.setGazeColor=function(a,b){void 0===b&&(b=this._pickedGazeColor);this._gazeColor=a;this._pickedGazeColor=b};a.prototype.changeLaserColor=function(a){this.updateControllerLaserColor&&(this._leftController&&this._leftController._setLaserPointerColor(a),this._rightController&&
this._rightController._setLaserPointerColor(a))};a.prototype.changeGazeColor=function(a){this.updateGazeTrackerColor&&this._cameraGazer._gazeTracker.material&&(this._cameraGazer._gazeTracker.material.emissiveColor=a,this._leftController&&(this._leftController._gazeTracker.material.emissiveColor=a),this._rightController&&(this._rightController._gazeTracker.material.emissiveColor=a))};a.prototype.dispose=function(){this.isInVRMode&&this.exitVR();this._postProcessMove&&this._postProcessMove.dispose();
this._webVRCamera&&this._webVRCamera.dispose();this._vrDeviceOrientationCamera&&this._vrDeviceOrientationCamera.dispose();!this._useCustomVRButton&&this._btnVR&&this._btnVR.parentNode&&document.body.removeChild(this._btnVR);this._deviceOrientationCamera&&this._scene.activeCamera!=this._deviceOrientationCamera&&this._deviceOrientationCamera.dispose();this._cameraGazer&&this._cameraGazer.dispose();this._leftController&&this._leftController.dispose();this._rightController&&this._rightController.dispose();
this._teleportationTarget&&this._teleportationTarget.dispose();this.xr&&this.xr.dispose();this._floorMeshesCollection=[];document.removeEventListener("keydown",this._onKeyDown);window.removeEventListener("vrdisplaypresentchange",this._onVrDisplayPresentChange);window.removeEventListener("resize",this._onResize);document.removeEventListener("fullscreenchange",this._onFullscreenChange);document.removeEventListener("mozfullscreenchange",this._onFullscreenChange);document.removeEventListener("webkitfullscreenchange",
this._onFullscreenChange);document.removeEventListener("msfullscreenchange",this._onFullscreenChange);document.onmsfullscreenchange=null;this._scene.getEngine().onVRDisplayChangedObservable.removeCallback(this._onVRDisplayChanged);this._scene.getEngine().onVRRequestPresentStart.removeCallback(this._onVRRequestPresentStart);this._scene.getEngine().onVRRequestPresentComplete.removeCallback(this._onVRRequestPresentComplete);window.removeEventListener("vrdisplaypresentchange",this._onVrDisplayPresentChange);
this._scene.gamepadManager.onGamepadConnectedObservable.removeCallback(this._onNewGamepadConnected);this._scene.gamepadManager.onGamepadDisconnectedObservable.removeCallback(this._onNewGamepadDisconnected);this._scene.unregisterBeforeRender(this.beforeRender)};a.prototype.getClassName=function(){return"VRExperienceHelper"};a.TELEPORTATIONMODE_CONSTANTTIME=0;a.TELEPORTATIONMODE_CONSTANTSPEED=1;return a}()},VfJ7:function(n,q,a){a.d(q,"a",function(){return t});var h=a("oYeq"),g=a("ADVu"),p=a("ps+7"),
d=a("/SR9");n=a("Ufda");var u=a("wAMR"),m=a("3adM"),c=a("r2Xo"),b=a("GhKI"),l=a("CAkI");q=a("fX5v");var f=a("HcSi"),r=a("MhaC"),k=a("YKqZ");n.a.AddNodeConstructor("ArcRotateCamera",function(a,b){return function(){return new t(a,0,0,1,d.e.Zero(),b)}});var t=function(a){function e(b,c,k,e,m,g,h){void 0===h&&(h=!0);var l=a.call(this,b,d.e.Zero(),g,h)||this;l.inertialAlphaOffset=0;l.inertialBetaOffset=0;l.inertialRadiusOffset=0;l.lowerAlphaLimit=null;l.upperAlphaLimit=null;l.lowerBetaLimit=.01;l.upperBetaLimit=
Math.PI-.01;l.lowerRadiusLimit=null;l.upperRadiusLimit=null;l.inertialPanningX=0;l.inertialPanningY=0;l.pinchToPanMaxDistance=20;l.panningDistanceLimit=null;l.panningOriginTarget=d.e.Zero();l.panningInertia=.9;l.zoomOnFactor=1;l.targetScreenOffset=d.d.Zero();l.allowUpsideDown=!0;l.useInputToRestoreState=!0;l._viewMatrix=new d.a;l.panningAxis=new d.e(1,1,0);l.onMeshTargetChangedObservable=new p.a;l.checkCollisions=!1;l.collisionRadius=new d.e(.5,.5,.5);l._previousPosition=d.e.Zero();l._collisionVelocity=
d.e.Zero();l._newPosition=d.e.Zero();l._computationVector=d.e.Zero();l._onCollisionPositionChange=function(a,b,c){void 0===c&&(c=null);if(c){if(l.setPosition(b),l.onCollide)l.onCollide(c)}else l._previousPosition.copyFrom(l._position);b=Math.cos(l.alpha);c=Math.sin(l.alpha);var k=Math.cos(l.beta),e=Math.sin(l.beta);0===e&&(e=1E-4);a=l._getTargetPosition();l._computationVector.copyFromFloats(l.radius*b*e,l.radius*k,l.radius*c*e);a.addToRef(l._computationVector,l._newPosition);l._position.copyFrom(l._newPosition);
b=l.upVector;l.allowUpsideDown&&0>l.beta&&(b=b.clone(),b=b.negate());l._computeViewMatrix(l._position,a,b);l._viewMatrix.addAtIndex(12,l.targetScreenOffset.x);l._viewMatrix.addAtIndex(13,l.targetScreenOffset.y);l._collisionTriggered=!1};l._target=d.e.Zero();m&&l.setTarget(m);l.alpha=c;l.beta=k;l.radius=e;l.getViewMatrix();l.inputs=new f.a(l);l.inputs.addKeyboard().addMouseWheel().addPointers();return l}Object(h.d)(e,a);Object.defineProperty(e.prototype,"target",{get:function(){return this._target},
set:function(a){this.setTarget(a)},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"position",{get:function(){return this._position},set:function(a){this.setPosition(a)},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"upVector",{get:function(){return this._upVector},set:function(a){this._upToYMatrix||(this._YToUpMatrix=new d.a,this._upToYMatrix=new d.a,this._upVector=d.e.Zero());a.normalize();this._upVector.copyFrom(a);this.setMatUp()},enumerable:!1,configurable:!0});
e.prototype.setMatUp=function(){d.a.RotationAlignToRef(d.e.UpReadOnly,this._upVector,this._YToUpMatrix);d.a.RotationAlignToRef(this._upVector,d.e.UpReadOnly,this._upToYMatrix)};Object.defineProperty(e.prototype,"angularSensibilityX",{get:function(){var a=this.inputs.attached.pointers;return a?a.angularSensibilityX:0},set:function(a){var b=this.inputs.attached.pointers;b&&(b.angularSensibilityX=a)},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"angularSensibilityY",{get:function(){var a=
this.inputs.attached.pointers;return a?a.angularSensibilityY:0},set:function(a){var b=this.inputs.attached.pointers;b&&(b.angularSensibilityY=a)},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"pinchPrecision",{get:function(){var a=this.inputs.attached.pointers;return a?a.pinchPrecision:0},set:function(a){var b=this.inputs.attached.pointers;b&&(b.pinchPrecision=a)},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"pinchDeltaPercentage",{get:function(){var a=this.inputs.attached.pointers;
return a?a.pinchDeltaPercentage:0},set:function(a){var b=this.inputs.attached.pointers;b&&(b.pinchDeltaPercentage=a)},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"useNaturalPinchZoom",{get:function(){var a=this.inputs.attached.pointers;return a?a.useNaturalPinchZoom:!1},set:function(a){var b=this.inputs.attached.pointers;b&&(b.useNaturalPinchZoom=a)},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"panningSensibility",{get:function(){var a=this.inputs.attached.pointers;
return a?a.panningSensibility:0},set:function(a){var b=this.inputs.attached.pointers;b&&(b.panningSensibility=a)},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"keysUp",{get:function(){var a=this.inputs.attached.keyboard;return a?a.keysUp:[]},set:function(a){var b=this.inputs.attached.keyboard;b&&(b.keysUp=a)},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"keysDown",{get:function(){var a=this.inputs.attached.keyboard;return a?a.keysDown:[]},set:function(a){var b=
this.inputs.attached.keyboard;b&&(b.keysDown=a)},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"keysLeft",{get:function(){var a=this.inputs.attached.keyboard;return a?a.keysLeft:[]},set:function(a){var b=this.inputs.attached.keyboard;b&&(b.keysLeft=a)},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"keysRight",{get:function(){var a=this.inputs.attached.keyboard;return a?a.keysRight:[]},set:function(a){var b=this.inputs.attached.keyboard;b&&(b.keysRight=a)},enumerable:!1,
configurable:!0});Object.defineProperty(e.prototype,"wheelPrecision",{get:function(){var a=this.inputs.attached.mousewheel;return a?a.wheelPrecision:0},set:function(a){var b=this.inputs.attached.mousewheel;b&&(b.wheelPrecision=a)},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"wheelDeltaPercentage",{get:function(){var a=this.inputs.attached.mousewheel;return a?a.wheelDeltaPercentage:0},set:function(a){var b=this.inputs.attached.mousewheel;b&&(b.wheelDeltaPercentage=a)},enumerable:!1,
configurable:!0});Object.defineProperty(e.prototype,"bouncingBehavior",{get:function(){return this._bouncingBehavior},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"useBouncingBehavior",{get:function(){return null!=this._bouncingBehavior},set:function(a){a!==this.useBouncingBehavior&&(a?(this._bouncingBehavior=new c.a,this.addBehavior(this._bouncingBehavior)):this._bouncingBehavior&&(this.removeBehavior(this._bouncingBehavior),this._bouncingBehavior=null))},enumerable:!1,configurable:!0});
Object.defineProperty(e.prototype,"framingBehavior",{get:function(){return this._framingBehavior},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"useFramingBehavior",{get:function(){return null!=this._framingBehavior},set:function(a){a!==this.useFramingBehavior&&(a?(this._framingBehavior=new b.a,this.addBehavior(this._framingBehavior)):this._framingBehavior&&(this.removeBehavior(this._framingBehavior),this._framingBehavior=null))},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,
"autoRotationBehavior",{get:function(){return this._autoRotationBehavior},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"useAutoRotationBehavior",{get:function(){return null!=this._autoRotationBehavior},set:function(a){a!==this.useAutoRotationBehavior&&(a?(this._autoRotationBehavior=new m.a,this.addBehavior(this._autoRotationBehavior)):this._autoRotationBehavior&&(this.removeBehavior(this._autoRotationBehavior),this._autoRotationBehavior=null))},enumerable:!1,configurable:!0});
e.prototype._initCache=function(){a.prototype._initCache.call(this);this._cache._target=new d.e(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);this._cache.alpha=void 0;this._cache.beta=void 0;this._cache.radius=void 0;this._cache.targetScreenOffset=d.d.Zero()};e.prototype._updateCache=function(b){b||a.prototype._updateCache.call(this);this._cache._target.copyFrom(this._getTargetPosition());this._cache.alpha=this.alpha;this._cache.beta=this.beta;this._cache.radius=this.radius;this._cache.targetScreenOffset.copyFrom(this.targetScreenOffset)};
e.prototype._getTargetPosition=function(){if(this._targetHost&&this._targetHost.getAbsolutePosition){var a=this._targetHost.absolutePosition;this._targetBoundingCenter?a.addToRef(this._targetBoundingCenter,this._target):this._target.copyFrom(a)}return(a=this._getLockedTargetPosition())?a:this._target};e.prototype.storeState=function(){this._storedAlpha=this.alpha;this._storedBeta=this.beta;this._storedRadius=this.radius;this._storedTarget=this._getTargetPosition().clone();this._storedTargetScreenOffset=
this.targetScreenOffset.clone();return a.prototype.storeState.call(this)};e.prototype._restoreStateValues=function(){if(!a.prototype._restoreStateValues.call(this))return!1;this.setTarget(this._storedTarget.clone());this.alpha=this._storedAlpha;this.beta=this._storedBeta;this.radius=this._storedRadius;this.targetScreenOffset=this._storedTargetScreenOffset.clone();this.inertialPanningY=this.inertialPanningX=this.inertialRadiusOffset=this.inertialBetaOffset=this.inertialAlphaOffset=0;return!0};e.prototype._isSynchronizedViewMatrix=
function(){return a.prototype._isSynchronizedViewMatrix.call(this)?this._cache._target.equals(this._getTargetPosition())&&this._cache.alpha===this.alpha&&this._cache.beta===this.beta&&this._cache.radius===this.radius&&this._cache.targetScreenOffset.equals(this.targetScreenOffset):!1};e.prototype.attachControl=function(a,b,c,e){var f=this;void 0===c&&(c=!0);void 0===e&&(e=2);b=k.b.BackCompatCameraNoPreventDefault(arguments);this._useCtrlForPanning=c;this._panningMouseButton=e;"boolean"===typeof arguments[0]&&
(1<arguments.length&&(this._useCtrlForPanning=arguments[1]),2<arguments.length&&(this._panningMouseButton=arguments[2]));this.inputs.attachElement(b);this._reset=function(){f.inertialAlphaOffset=0;f.inertialBetaOffset=0;f.inertialRadiusOffset=0;f.inertialPanningX=0;f.inertialPanningY=0}};e.prototype.detachControl=function(a){this.inputs.detachElement();this._reset&&this._reset()};e.prototype._checkInputs=function(){if(!this._collisionTriggered){this.inputs.checkInputs();if(0!==this.inertialAlphaOffset||
0!==this.inertialBetaOffset||0!==this.inertialRadiusOffset){var b=this.inertialAlphaOffset;0>=this.beta&&(b*=-1);this.getScene().useRightHandedSystem&&(b*=-1);this.parent&&0>this.parent._getWorldMatrixDeterminant()&&(b*=-1);this.alpha+=b;this.beta+=this.inertialBetaOffset;this.radius-=this.inertialRadiusOffset;this.inertialAlphaOffset*=this.inertia;this.inertialBetaOffset*=this.inertia;this.inertialRadiusOffset*=this.inertia;Math.abs(this.inertialAlphaOffset)<r.a&&(this.inertialAlphaOffset=0);Math.abs(this.inertialBetaOffset)<
r.a&&(this.inertialBetaOffset=0);Math.abs(this.inertialRadiusOffset)<this.speed*r.a&&(this.inertialRadiusOffset=0)}if(0!==this.inertialPanningX||0!==this.inertialPanningY)this._localDirection||(this._localDirection=d.e.Zero(),this._transformedDirection=d.e.Zero()),this._localDirection.copyFromFloats(this.inertialPanningX,this.inertialPanningY,this.inertialPanningY),this._localDirection.multiplyInPlace(this.panningAxis),this._viewMatrix.invertToRef(this._cameraTransformMatrix),d.e.TransformNormalToRef(this._localDirection,
this._cameraTransformMatrix,this._transformedDirection),this.panningAxis.y||(this._transformedDirection.y=0),this._targetHost||(this.panningDistanceLimit?(this._transformedDirection.addInPlace(this._target),d.e.DistanceSquared(this._transformedDirection,this.panningOriginTarget)<=this.panningDistanceLimit*this.panningDistanceLimit&&this._target.copyFrom(this._transformedDirection)):this._target.addInPlace(this._transformedDirection)),this.inertialPanningX*=this.panningInertia,this.inertialPanningY*=
this.panningInertia,Math.abs(this.inertialPanningX)<this.speed*r.a&&(this.inertialPanningX=0),Math.abs(this.inertialPanningY)<this.speed*r.a&&(this.inertialPanningY=0);this._checkLimits();a.prototype._checkInputs.call(this)}};e.prototype._checkLimits=function(){null===this.lowerBetaLimit||void 0===this.lowerBetaLimit?this.allowUpsideDown&&this.beta>Math.PI&&(this.beta-=2*Math.PI):this.beta<this.lowerBetaLimit&&(this.beta=this.lowerBetaLimit);null===this.upperBetaLimit||void 0===this.upperBetaLimit?
this.allowUpsideDown&&this.beta<-Math.PI&&(this.beta+=2*Math.PI):this.beta>this.upperBetaLimit&&(this.beta=this.upperBetaLimit);null!==this.lowerAlphaLimit&&this.alpha<this.lowerAlphaLimit&&(this.alpha=this.lowerAlphaLimit);null!==this.upperAlphaLimit&&this.alpha>this.upperAlphaLimit&&(this.alpha=this.upperAlphaLimit);null!==this.lowerRadiusLimit&&this.radius<this.lowerRadiusLimit&&(this.radius=this.lowerRadiusLimit,this.inertialRadiusOffset=0);null!==this.upperRadiusLimit&&this.radius>this.upperRadiusLimit&&
(this.radius=this.upperRadiusLimit,this.inertialRadiusOffset=0)};e.prototype.rebuildAnglesAndRadius=function(){this._position.subtractToRef(this._getTargetPosition(),this._computationVector);0===this._upVector.x&&1===this._upVector.y&&0===this._upVector.z||d.e.TransformCoordinatesToRef(this._computationVector,this._upToYMatrix,this._computationVector);this.radius=this._computationVector.length();0===this.radius&&(this.radius=1E-4);var a=this.alpha;this.alpha=0===this._computationVector.x&&0===this._computationVector.z?
Math.PI/2:Math.acos(this._computationVector.x/Math.sqrt(Math.pow(this._computationVector.x,2)+Math.pow(this._computationVector.z,2)));0>this._computationVector.z&&(this.alpha=2*Math.PI-this.alpha);this.alpha+=2*Math.round((a-this.alpha)/(2*Math.PI))*Math.PI;this.beta=Math.acos(this._computationVector.y/this.radius);this._checkLimits()};e.prototype.setPosition=function(a){this._position.equals(a)||(this._position.copyFrom(a),this.rebuildAnglesAndRadius())};e.prototype.setTarget=function(a,b,c){void 0===
b&&(b=!1);void 0===c&&(c=!1);if(a.getBoundingInfo)this._targetBoundingCenter=b?a.getBoundingInfo().boundingBox.centerWorld.clone():null,a.computeWorldMatrix(),this._targetHost=a,this._target=this._getTargetPosition(),this.onMeshTargetChangedObservable.notifyObservers(this._targetHost);else{if((b=this._getTargetPosition())&&!c&&b.equals(a))return;this._targetHost=null;this._target=a;this._targetBoundingCenter=null;this.onMeshTargetChangedObservable.notifyObservers(null)}this.rebuildAnglesAndRadius()};
e.prototype._getViewMatrix=function(){var a=Math.cos(this.alpha),b=Math.sin(this.alpha),c=Math.cos(this.beta),k=Math.sin(this.beta);0===k&&(k=1E-4);0===this.radius&&(this.radius=1E-4);var e=this._getTargetPosition();this._computationVector.copyFromFloats(this.radius*a*k,this.radius*c,this.radius*b*k);0===this._upVector.x&&1===this._upVector.y&&0===this._upVector.z||d.e.TransformCoordinatesToRef(this._computationVector,this._YToUpMatrix,this._computationVector);e.addToRef(this._computationVector,this._newPosition);
this.getScene().collisionsEnabled&&this.checkCollisions?(k=this.getScene().collisionCoordinator,this._collider||(this._collider=k.createCollider()),this._collider._radius=this.collisionRadius,this._newPosition.subtractToRef(this._position,this._collisionVelocity),this._collisionTriggered=!0,k.getNewPosition(this._position,this._collisionVelocity,this._collider,3,null,this._onCollisionPositionChange,this.uniqueId)):(this._position.copyFrom(this._newPosition),a=this.upVector,this.allowUpsideDown&&0>
k&&(a=a.negate()),this._computeViewMatrix(this._position,e,a),this._viewMatrix.addAtIndex(12,this.targetScreenOffset.x),this._viewMatrix.addAtIndex(13,this.targetScreenOffset.y));this._currentTarget=e;return this._viewMatrix};e.prototype.zoomOn=function(a,b){void 0===b&&(b=!1);a=a||this.getScene().meshes;a=u.a.MinMax(a);var c=d.e.Distance(a.min,a.max);this.radius=c*this.zoomOnFactor;this.focusOn({min:a.min,max:a.max,distance:c},b)};e.prototype.focusOn=function(a,b){void 0===b&&(b=!1);if(void 0===
a.min){var c=a||this.getScene().meshes;c=u.a.MinMax(c);a=d.e.Distance(c.min,c.max)}else c=a,a=a.distance;this._target=u.a.Center(c);b||(this.maxZ=2*a)};e.prototype.createRigCamera=function(a,b){var c=0;switch(this.cameraRigMode){case l.a.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case l.a.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case l.a.RIG_MODE_STEREOSCOPIC_OVERUNDER:case l.a.RIG_MODE_STEREOSCOPIC_INTERLACED:case l.a.RIG_MODE_VR:c=this._cameraRigParams.stereoHalfAngle*(0===b?1:-1);break;case l.a.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:c=
this._cameraRigParams.stereoHalfAngle*(0===b?-1:1)}a=new e(a,this.alpha+c,this.beta,this.radius,this._target,this.getScene());a._cameraRigParams={};a.isRigCamera=!0;a.rigParent=this;a.upVector=this.upVector;return a};e.prototype._updateRigCameras=function(){var b=this._rigCameras[0],c=this._rigCameras[1];b.beta=c.beta=this.beta;switch(this.cameraRigMode){case l.a.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case l.a.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case l.a.RIG_MODE_STEREOSCOPIC_OVERUNDER:case l.a.RIG_MODE_STEREOSCOPIC_INTERLACED:case l.a.RIG_MODE_VR:b.alpha=
this.alpha-this._cameraRigParams.stereoHalfAngle;c.alpha=this.alpha+this._cameraRigParams.stereoHalfAngle;break;case l.a.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:b.alpha=this.alpha+this._cameraRigParams.stereoHalfAngle,c.alpha=this.alpha-this._cameraRigParams.stereoHalfAngle}a.prototype._updateRigCameras.call(this)};e.prototype.dispose=function(){this.inputs.clear();a.prototype.dispose.call(this)};e.prototype.getClassName=function(){return"ArcRotateCamera"};Object(h.c)([Object(g.c)()],e.prototype,
"alpha",void 0);Object(h.c)([Object(g.c)()],e.prototype,"beta",void 0);Object(h.c)([Object(g.c)()],e.prototype,"radius",void 0);Object(h.c)([Object(g.o)("target")],e.prototype,"_target",void 0);Object(h.c)([Object(g.c)()],e.prototype,"inertialAlphaOffset",void 0);Object(h.c)([Object(g.c)()],e.prototype,"inertialBetaOffset",void 0);Object(h.c)([Object(g.c)()],e.prototype,"inertialRadiusOffset",void 0);Object(h.c)([Object(g.c)()],e.prototype,"lowerAlphaLimit",void 0);Object(h.c)([Object(g.c)()],e.prototype,
"upperAlphaLimit",void 0);Object(h.c)([Object(g.c)()],e.prototype,"lowerBetaLimit",void 0);Object(h.c)([Object(g.c)()],e.prototype,"upperBetaLimit",void 0);Object(h.c)([Object(g.c)()],e.prototype,"lowerRadiusLimit",void 0);Object(h.c)([Object(g.c)()],e.prototype,"upperRadiusLimit",void 0);Object(h.c)([Object(g.c)()],e.prototype,"inertialPanningX",void 0);Object(h.c)([Object(g.c)()],e.prototype,"inertialPanningY",void 0);Object(h.c)([Object(g.c)()],e.prototype,"pinchToPanMaxDistance",void 0);Object(h.c)([Object(g.c)()],
e.prototype,"panningDistanceLimit",void 0);Object(h.c)([Object(g.o)()],e.prototype,"panningOriginTarget",void 0);Object(h.c)([Object(g.c)()],e.prototype,"panningInertia",void 0);Object(h.c)([Object(g.c)()],e.prototype,"zoomOnFactor",void 0);Object(h.c)([Object(g.c)()],e.prototype,"targetScreenOffset",void 0);Object(h.c)([Object(g.c)()],e.prototype,"allowUpsideDown",void 0);Object(h.c)([Object(g.c)()],e.prototype,"useInputToRestoreState",void 0);return e}(q.a)},XRWu:function(n,q,a){a.d(q,"a",function(){return m});
var h=a("oYeq"),g=a("ADVu");n=a("xCqU");var p=a("98Qd"),d=a("sH6m"),u=a("YKqZ"),m=function(){function a(){this.wheelPrecision=3;this.wheelDeltaPercentage=0}a.prototype.computeDeltaFromMouseWheelLegacyEvent=function(a,c){c*=.01*a*this.wheelDeltaPercentage;return 0<a?c/(1+this.wheelDeltaPercentage):c*(1+this.wheelDeltaPercentage)};a.prototype.attachControl=function(a){var b=this;a=u.b.BackCompatCameraNoPreventDefault(arguments);this._wheel=function(c,m){if(c.type===p.a.POINTERWHEEL){c=c.event;m=c.wheelDelta?
c.wheelDelta:60*-(c.deltaY||c.detail);if(b.wheelDeltaPercentage){var k=b.computeDeltaFromMouseWheelLegacyEvent(m,b.camera.radius);if(0<k){var f=b.camera.radius;k=b.camera.inertialRadiusOffset+k;for(var l=0;20>l&&.001<Math.abs(k);l++)f-=k,k*=b.camera.inertia;f=d.a.Clamp(f,0,Number.MAX_VALUE);k=b.computeDeltaFromMouseWheelLegacyEvent(m,f)}}else k=m/(40*b.wheelPrecision);k&&(b.camera.inertialRadiusOffset+=k);c.preventDefault&&(a||c.preventDefault())}};this._observer=this.camera.getScene().onPointerObservable.add(this._wheel,
p.a.POINTERWHEEL)};a.prototype.detachControl=function(a){this._observer&&(this.camera.getScene().onPointerObservable.remove(this._observer),this._wheel=this._observer=null)};a.prototype.getClassName=function(){return"ArcRotateCameraMouseWheelInput"};a.prototype.getSimpleName=function(){return"mousewheel"};Object(h.c)([Object(g.c)()],a.prototype,"wheelPrecision",void 0);Object(h.c)([Object(g.c)()],a.prototype,"wheelDeltaPercentage",void 0);return a}();n.a.ArcRotateCameraMouseWheelInput=m},Y7hS:function(n,
q,a){a("5WzX");var h=a("/SR9"),g=a("SYzJ");(function(){function a(a,d,c){this.targetPosition=h.e.Zero();this.poleTargetPosition=h.e.Zero();this.poleTargetLocalOffset=h.e.Zero();this.poleAngle=0;this.slerpAmount=1;this._bone1Quat=h.b.Identity();this._bone1Mat=h.a.Identity();this._maxAngle=this._bone2Ang=Math.PI;this._rightHandedSystem=!1;this._bendAxis=h.e.Right();this._slerping=!1;this._adjustRoll=0;this._bone2=d;if(this._bone1=d.getParent()){this.mesh=a;var b=d.getPosition();0<d.getAbsoluteTransform().determinant()&&
(this._rightHandedSystem=!0,this._bendAxis.x=0,this._bendAxis.y=0,this._bendAxis.z=-1,b.x>b.y&&b.x>b.z&&(this._adjustRoll=.5*Math.PI,this._bendAxis.z=1));if(this._bone1.length)d=this._bone1.getScale(),b=this._bone2.getScale(),this._bone1Length=this._bone1.length*d.y*this.mesh.scaling.y,this._bone2Length=this._bone2.length*b.y*this.mesh.scaling.y;else if(this._bone1.children[0]){a.computeWorldMatrix(!0);d=this._bone2.children[0].getAbsolutePosition(a);b=this._bone2.getAbsolutePosition(a);var m=this._bone1.getAbsolutePosition(a);
this._bone1Length=h.e.Distance(d,b);this._bone2Length=h.e.Distance(b,m)}this._bone1.getRotationMatrixToRef(g.c.WORLD,a,this._bone1Mat);this.maxAngle=Math.PI;c&&(c.targetMesh&&(this.targetMesh=c.targetMesh,this.targetMesh.computeWorldMatrix(!0)),c.poleTargetMesh?(this.poleTargetMesh=c.poleTargetMesh,this.poleTargetMesh.computeWorldMatrix(!0)):c.poleTargetBone?this.poleTargetBone=c.poleTargetBone:this._bone1.getParent()&&(this.poleTargetBone=this._bone1.getParent()),c.poleTargetLocalOffset&&this.poleTargetLocalOffset.copyFrom(c.poleTargetLocalOffset),
c.poleAngle&&(this.poleAngle=c.poleAngle),c.bendAxis&&this._bendAxis.copyFrom(c.bendAxis),c.maxAngle&&(this.maxAngle=c.maxAngle),c.slerpAmount&&(this.slerpAmount=c.slerpAmount))}}Object.defineProperty(a.prototype,"maxAngle",{get:function(){return this._maxAngle},set:function(a){this._setMaxAngle(a)},enumerable:!1,configurable:!0});a.prototype._setMaxAngle=function(a){0>a&&(a=0);if(a>Math.PI||void 0==a)a=Math.PI;this._maxAngle=a;var d=this._bone1Length,c=this._bone2Length;this._maxReach=Math.sqrt(d*
d+c*c-2*d*c*Math.cos(a))};a.prototype.update=function(){var d=this._bone1;if(d){var m=this.targetPosition,c=this.poleTargetPosition,b=a._tmpMats[0],l=a._tmpMats[1];this.targetMesh&&m.copyFrom(this.targetMesh.getAbsolutePosition());this.poleTargetBone?this.poleTargetBone.getAbsolutePositionFromLocalToRef(this.poleTargetLocalOffset,this.mesh,c):this.poleTargetMesh&&h.e.TransformCoordinatesToRef(this.poleTargetLocalOffset,this.poleTargetMesh.getWorldMatrix(),c);var f=a._tmpVecs[0],r=a._tmpVecs[1],k=
a._tmpVecs[2],t=a._tmpVecs[3],n=a._tmpVecs[4],e=a._tmpQuat;d.getAbsolutePositionToRef(this.mesh,f);c.subtractToRef(f,n);0==n.x&&0==n.y&&0==n.z?n.y=1:n.normalize();m.subtractToRef(f,t);t.normalize();h.e.CrossToRef(t,n,r);r.normalize();h.e.CrossToRef(t,r,k);k.normalize();h.a.FromXYZAxesToRef(k,t,r,b);d=this._bone1Length;c=this._bone2Length;f=h.e.Distance(f,m);0<this._maxReach&&(f=Math.min(this._maxReach,f));m=(c*c+f*f-d*d)/(2*c*f);f=(f*f+d*d-c*c)/(2*f*d);1<m&&(m=1);1<f&&(f=1);-1>m&&(m=-1);-1>f&&(f=
-1);f=Math.acos(f);m=-Math.acos(m)-f;this._rightHandedSystem?(h.a.RotationYawPitchRollToRef(0,0,this._adjustRoll,l),l.multiplyToRef(b,b),h.a.RotationAxisToRef(this._bendAxis,f,l)):(d=a._tmpVecs[5],d.copyFrom(this._bendAxis),d.x*=-1,h.a.RotationAxisToRef(d,-f,l));l.multiplyToRef(b,b);this.poleAngle&&(h.a.RotationAxisToRef(t,this.poleAngle,l),b.multiplyToRef(l,b));this._bone1&&(1>this.slerpAmount?(this._slerping||h.b.FromRotationMatrixToRef(this._bone1Mat,this._bone1Quat),h.b.FromRotationMatrixToRef(b,
e),h.b.SlerpToRef(this._bone1Quat,e,this.slerpAmount,this._bone1Quat),m=this._bone2Ang*(1-this.slerpAmount)+m*this.slerpAmount,this._bone1.setRotationQuaternion(this._bone1Quat,g.c.WORLD,this.mesh),this._slerping=!0):(this._bone1.setRotationMatrix(b,g.c.WORLD,this.mesh),this._bone1Mat.copyFrom(b),this._slerping=!1));this._bone2.setAxisAngle(this._bendAxis,m,g.c.LOCAL);this._bone2Ang=m}};a._tmpVecs=[h.e.Zero(),h.e.Zero(),h.e.Zero(),h.e.Zero(),h.e.Zero(),h.e.Zero()];a._tmpQuat=h.b.Identity();a._tmpMats=
[h.a.Identity(),h.a.Identity()];return a})();var p=a("mHtN");(function(){function a(a,d,c,b){this.upAxis=h.e.Up();this.upAxisSpace=g.c.LOCAL;this.adjustRoll=this.adjustPitch=this.adjustYaw=0;this.slerpAmount=1;this._boneQuat=h.b.Identity();this._firstFrameSkipped=this._slerping=!1;this._fowardAxis=h.e.Forward();this.mesh=a;this.bone=d;this.target=c;b&&(b.adjustYaw&&(this.adjustYaw=b.adjustYaw),b.adjustPitch&&(this.adjustPitch=b.adjustPitch),b.adjustRoll&&(this.adjustRoll=b.adjustRoll),this.maxYaw=
null!=b.maxYaw?b.maxYaw:Math.PI,this.minYaw=null!=b.minYaw?b.minYaw:-Math.PI,this.maxPitch=null!=b.maxPitch?b.maxPitch:Math.PI,this.minPitch=null!=b.minPitch?b.minPitch:-Math.PI,null!=b.slerpAmount&&(this.slerpAmount=b.slerpAmount),null!=b.upAxis&&(this.upAxis=b.upAxis),null!=b.upAxisSpace&&(this.upAxisSpace=b.upAxisSpace),null!=b.yawAxis||null!=b.pitchAxis)&&(a=g.a.Y,c=g.a.X,null!=b.yawAxis&&(a=b.yawAxis.clone(),a.normalize()),null!=b.pitchAxis&&(c=b.pitchAxis.clone(),c.normalize()),b=h.e.Cross(c,
a),this._transformYawPitch=h.a.Identity(),h.a.FromXYZAxesToRef(c,a,b,this._transformYawPitch),this._transformYawPitchInv=this._transformYawPitch.clone(),this._transformYawPitch.invert());d.getParent()||this.upAxisSpace!=g.c.BONE||(this.upAxisSpace=g.c.LOCAL)}Object.defineProperty(a.prototype,"minYaw",{get:function(){return this._minYaw},set:function(a){this._minYaw=a;this._minYawSin=Math.sin(a);this._minYawCos=Math.cos(a);null!=this._maxYaw&&(this._midYawConstraint=.5*this._getAngleDiff(this._minYaw,
this._maxYaw)+this._minYaw,this._yawRange=this._maxYaw-this._minYaw)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"maxYaw",{get:function(){return this._maxYaw},set:function(a){this._maxYaw=a;this._maxYawSin=Math.sin(a);this._maxYawCos=Math.cos(a);null!=this._minYaw&&(this._midYawConstraint=.5*this._getAngleDiff(this._minYaw,this._maxYaw)+this._minYaw,this._yawRange=this._maxYaw-this._minYaw)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"minPitch",{get:function(){return this._minPitch},
set:function(a){this._minPitch=a;this._minPitchTan=Math.tan(a)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"maxPitch",{get:function(){return this._maxPitch},set:function(a){this._maxPitch=a;this._maxPitchTan=Math.tan(a)},enumerable:!1,configurable:!0});a.prototype.update=function(){if(1>this.slerpAmount&&!this._firstFrameSkipped)this._firstFrameSkipped=!0;else{var d=this.bone,m=a._tmpVecs[0];d.getAbsolutePositionToRef(this.mesh,m);var c=this.target,b=a._tmpMats[0],l=a._tmpMats[1],
f=this.mesh,r=d.getParent();d=a._tmpVecs[1];d.copyFrom(this.upAxis);this.upAxisSpace==g.c.BONE&&r?(this._transformYawPitch&&h.e.TransformCoordinatesToRef(d,this._transformYawPitchInv,d),r.getDirectionToRef(d,this.mesh,d)):this.upAxisSpace==g.c.LOCAL&&(f.getDirectionToRef(d,d),1==f.scaling.x&&1==f.scaling.y&&1==f.scaling.z||d.normalize());var k=!1,t=!1;if(this._maxYaw!=Math.PI||this._minYaw!=-Math.PI)k=!0;if(this._maxPitch!=Math.PI||this._minPitch!=-Math.PI)t=!0;if(k||t){var n=a._tmpMats[2],e=a._tmpMats[3];
if(this.upAxisSpace==g.c.BONE&&1==d.y&&r)r.getRotationMatrixToRef(g.c.WORLD,this.mesh,n);else if(this.upAxisSpace!=g.c.LOCAL||1!=d.y||r){var v=a._tmpVecs[2];v.copyFrom(this._fowardAxis);this._transformYawPitch&&h.e.TransformCoordinatesToRef(v,this._transformYawPitchInv,v);r?r.getDirectionToRef(v,this.mesh,v):f.getDirectionToRef(v,v);f=h.e.Cross(d,v);f.normalize();v=h.e.Cross(f,d);h.a.FromXYZAxesToRef(f,d,v,n)}else n.copyFrom(f.getWorldMatrix());n.invertToRef(e);f=null;t&&(t=a._tmpVecs[3],c.subtractToRef(m,
t),h.e.TransformCoordinatesToRef(t,e,t),f=Math.sqrt(t.x*t.x+t.z*t.z),r=v=Math.atan2(t.y,f),v>this._maxPitch?(t.y=this._maxPitchTan*f,r=this._maxPitch):v<this._minPitch&&(t.y=this._minPitchTan*f,r=this._minPitch),v!=r&&(h.e.TransformCoordinatesToRef(t,n,t),t.addInPlace(m),c=t));if(k){t=a._tmpVecs[4];c.subtractToRef(m,t);h.e.TransformCoordinatesToRef(t,e,t);v=k=Math.atan2(t.x,t.z);if(k>this._maxYaw||k<this._minYaw)null==f&&(f=Math.sqrt(t.x*t.x+t.z*t.z)),this._yawRange>Math.PI?this._isAngleBetween(k,
this._maxYaw,this._midYawConstraint)?(t.z=this._maxYawCos*f,t.x=this._maxYawSin*f,v=this._maxYaw):this._isAngleBetween(k,this._midYawConstraint,this._minYaw)&&(t.z=this._minYawCos*f,t.x=this._minYawSin*f,v=this._minYaw):k>this._maxYaw?(t.z=this._maxYawCos*f,t.x=this._maxYawSin*f,v=this._maxYaw):k<this._minYaw&&(t.z=this._minYawCos*f,t.x=this._minYawSin*f,v=this._minYaw);if(this._slerping&&this._yawRange>Math.PI){r=a._tmpVecs[8];r.copyFrom(g.a.Z);this._transformYawPitch&&h.e.TransformCoordinatesToRef(r,
this._transformYawPitchInv,r);var p=a._tmpMats[4];this._boneQuat.toRotationMatrix(p);this.mesh.getWorldMatrix().multiplyToRef(p,p);h.e.TransformCoordinatesToRef(r,p,r);h.e.TransformCoordinatesToRef(r,e,r);e=Math.atan2(r.x,r.z);r=this._getAngleBetween(e,k);p=this._getAngleBetween(e,this._midYawConstraint);r>p&&(null==f&&(f=Math.sqrt(t.x*t.x+t.z*t.z)),v=this._getAngleBetween(e,this._maxYaw),v=this._getAngleBetween(e,this._minYaw)<v?e+.75*Math.PI:e-.75*Math.PI,t.z=Math.cos(v)*f,t.x=Math.sin(v)*f)}k!=
v&&(h.e.TransformCoordinatesToRef(t,n,t),t.addInPlace(m),c=t)}}n=a._tmpVecs[5];e=a._tmpVecs[6];f=a._tmpVecs[7];t=a._tmpQuat;c.subtractToRef(m,n);n.normalize();h.e.CrossToRef(d,n,e);e.normalize();h.e.CrossToRef(n,e,f);f.normalize();h.a.FromXYZAxesToRef(e,f,n,b);if(0!==e.x||0!==e.y||0!==e.z)if(0!==f.x||0!==f.y||0!==f.z)if(0!==n.x||0!==n.y||0!==n.z){if(this.adjustYaw||this.adjustPitch||this.adjustRoll)h.a.RotationYawPitchRollToRef(this.adjustYaw,this.adjustPitch,this.adjustRoll,l),l.multiplyToRef(b,
b);1>this.slerpAmount?(this._slerping||this.bone.getRotationQuaternionToRef(g.c.WORLD,this.mesh,this._boneQuat),this._transformYawPitch&&this._transformYawPitch.multiplyToRef(b,b),h.b.FromRotationMatrixToRef(b,t),h.b.SlerpToRef(this._boneQuat,t,this.slerpAmount,this._boneQuat),this.bone.setRotationQuaternion(this._boneQuat,g.c.WORLD,this.mesh),this._slerping=!0):(this._transformYawPitch&&this._transformYawPitch.multiplyToRef(b,b),this.bone.setRotationMatrix(b,g.c.WORLD,this.mesh),this._slerping=!1)}}};
a.prototype._getAngleDiff=function(a,d){a=(d-a)%(2*Math.PI);a>Math.PI?a-=2*Math.PI:a<-Math.PI&&(a+=2*Math.PI);return a};a.prototype._getAngleBetween=function(a,d){a%=2*Math.PI;a=0>a?a+2*Math.PI:a;d%=2*Math.PI;d=0>d?d+2*Math.PI:d;a=a<d?d-a:a-d;a>Math.PI&&(a=2*Math.PI-a);return a};a.prototype._isAngleBetween=function(a,d,c){a%=2*Math.PI;a=0>a?a+2*Math.PI:a;d%=2*Math.PI;d=0>d?d+2*Math.PI:d;c%=2*Math.PI;c=0>c?c+2*Math.PI:c;if(d<c){if(a>d&&a<c)return!0}else if(a>c&&a<d)return!0;return!1};a._tmpVecs=p.a.BuildArray(10,
h.e.Zero);a._tmpQuat=h.b.Identity();a._tmpMats=p.a.BuildArray(5,h.a.Identity);return a})();a("btC8")},btC8:function(n,q,a){a.d(q,"a",function(){return f});var h=a("5WzX"),g=a("ps+7"),p=a("/SR9"),d=a("T5W1"),u=a("mBE3"),m=a("E2tu"),c=a("e2Mr"),b=a("uyO6"),l=a("Dc3z"),f=function(){function a(a,b,f){this.name=a;this.id=b;this.bones=[];this.needInitialSkinMatrix=!1;this.overrideMesh=null;this._isDirty=!0;this._meshesWithPoseMatrix=[];this._identity=p.a.Identity();this._ranges={};this._lastAbsoluteTransformsUpdateId=
-1;this._canUseTextureForBones=!1;this._numBonesWithLinkedTransformNode=this._uniqueId=0;this._waitingOverrideMeshId=this._hasWaitingData=null;this.doNotSerialize=!1;this._useTextureToStoreBoneMatrices=!0;this._animationPropertiesOverride=null;this.onBeforeComputeObservable=new g.a;this.bones=[];this._scene=f||c.a.LastCreatedScene;this._uniqueId=this._scene.getUniqueId();this._scene.addSkeleton(this);this._isDirty=!0;a=this._scene.getEngine().getCaps();this._canUseTextureForBones=a.textureFloat&&
0<a.maxVertexTextureImageUnits}Object.defineProperty(a.prototype,"useTextureToStoreBoneMatrices",{get:function(){return this._useTextureToStoreBoneMatrices},set:function(a){this._useTextureToStoreBoneMatrices=a;this._markAsDirty()},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"animationPropertiesOverride",{get:function(){return this._animationPropertiesOverride?this._animationPropertiesOverride:this._scene.animationPropertiesOverride},set:function(a){this._animationPropertiesOverride=
a},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"isUsingTextureForMatrices",{get:function(){return this.useTextureToStoreBoneMatrices&&this._canUseTextureForBones},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"uniqueId",{get:function(){return this._uniqueId},enumerable:!1,configurable:!0});a.prototype.getClassName=function(){return"Skeleton"};a.prototype.getChildren=function(){return this.bones.filter(function(a){return!a.getParent()})};a.prototype.getTransformMatrices=
function(a){if(this.needInitialSkinMatrix&&a._bonesTransformMatrices)return a._bonesTransformMatrices;this._transformMatrices||this.prepare();return this._transformMatrices};a.prototype.getTransformMatrixTexture=function(a){return this.needInitialSkinMatrix&&a._transformMatrixTexture?a._transformMatrixTexture:this._transformMatrixTexture};a.prototype.getScene=function(){return this._scene};a.prototype.toString=function(a){var b="Name: "+this.name+", nBones: "+this.bones.length;b+=", nAnimationRanges: "+
(this._ranges?Object.keys(this._ranges).length:"none");if(a){b+=", Ranges: {";a=!0;for(var c in this._ranges)a&&(b+=", ",a=!1),b+=c;b+="}"}return b};a.prototype.getBoneIndexByName=function(a){for(var b=0,c=this.bones.length;b<c;b++)if(this.bones[b].name===a)return b;return-1};a.prototype.createAnimationRange=function(a,b,c){if(!this._ranges[a]){this._ranges[a]=new m.a(a,b,c);for(var k=0,f=this.bones.length;k<f;k++)this.bones[k].animations[0]&&this.bones[k].animations[0].createRange(a,b,c)}};a.prototype.deleteAnimationRange=
function(a,b){void 0===b&&(b=!0);for(var c=0,k=this.bones.length;c<k;c++)this.bones[c].animations[0]&&this.bones[c].animations[0].deleteRange(a,b);this._ranges[a]=null};a.prototype.getAnimationRange=function(a){return this._ranges[a]||null};a.prototype.getAnimationRanges=function(){var a=[],b;for(b in this._ranges)a.push(this._ranges[b]);return a};a.prototype.copyAnimationRange=function(a,c,f){void 0===f&&(f=!1);if(this._ranges[c]||!a.getAnimationRange(c))return!1;var e=!0,k=this._getHighestAnimationFrame()+
1,d={},l=a.bones,g;var h=0;for(g=l.length;h<g;h++)d[l[h].name]=l[h];this.bones.length!==l.length&&(b.a.Warn("copyAnimationRange: this rig has "+this.bones.length+" bones, while source as "+l.length),e=!1);l=f&&this.dimensionsAtRest&&a.dimensionsAtRest?this.dimensionsAtRest.divide(a.dimensionsAtRest):null;h=0;for(g=this.bones.length;h<g;h++){var n=this.bones[h].name,t=d[n];t?e=e&&this.bones[h].copyAnimationRange(t,c,k,f,l):(b.a.Warn("copyAnimationRange: not same rig, missing source bone "+n),e=!1)}(a=
a.getAnimationRange(c))&&(this._ranges[c]=new m.a(c,a.from+k,a.to+k));return e};a.prototype.returnToRest=function(){for(var a=p.c.Vector3[0],b=p.c.Quaternion[0],c=p.c.Vector3[1],e=0;e<this.bones.length;e++){var f=this.bones[e];-1!==f._index&&(f.returnToRest(),f._linkedTransformNode&&(f.getRestPose().decompose(a,b,c),f._linkedTransformNode.position=c.clone(),f._linkedTransformNode.rotationQuaternion=b.clone(),f._linkedTransformNode.scaling=a.clone()))}};a.prototype._getHighestAnimationFrame=function(){for(var a=
0,b=0,c=this.bones.length;b<c;b++)if(this.bones[b].animations[0]){var e=this.bones[b].animations[0].getHighestFrame();a<e&&(a=e)}return a};a.prototype.beginAnimation=function(a,b,c,e){return(a=this.getAnimationRange(a))?this._scene.beginAnimation(this,a.from,a.to,b,c,e):null};a.MakeAnimationAdditive=function(a,b,c){void 0===b&&(b=0);var e=a.getAnimationRange(c);if(!e)return null;for(var k=a._scene.getAllAnimatablesByTarget(a),f=null,d=0;d<k.length;d++){var l=k[d];if(l.fromFrame===(null===e||void 0===
e?void 0:e.from)&&l.toFrame===(null===e||void 0===e?void 0:e.to)){f=l;break}}e=a.getAnimatables();for(d=0;d<e.length;d++)if(k=e[d].animations)for(l=0;l<k.length;l++)u.a.MakeAnimationAdditive(k[l],b,c);f&&(f.isAdditive=!0);return a};a.prototype._markAsDirty=function(){this._isDirty=!0};a.prototype._registerMeshWithPoseMatrix=function(a){this._meshesWithPoseMatrix.push(a)};a.prototype._unregisterMeshWithPoseMatrix=function(a){a=this._meshesWithPoseMatrix.indexOf(a);-1<a&&this._meshesWithPoseMatrix.splice(a,
1)};a.prototype._computeTransformMatrices=function(a,b){this.onBeforeComputeObservable.notifyObservers(this);for(var c=0;c<this.bones.length;c++){var e=this.bones[c];e._childUpdateId++;var k=e.getParent();k?e.getLocalMatrix().multiplyToRef(k.getWorldMatrix(),e.getWorldMatrix()):b?e.getLocalMatrix().multiplyToRef(b,e.getWorldMatrix()):e.getWorldMatrix().copyFrom(e.getLocalMatrix());-1!==e._index&&(k=null===e._index?c:e._index,e.getInvertedAbsoluteTransform().multiplyToArray(e.getWorldMatrix(),a,16*
k))}this._identity.copyToArray(a,16*this.bones.length)};a.prototype.prepare=function(){if(0<this._numBonesWithLinkedTransformNode)for(var a=0,b=this.bones;a<b.length;a++){var c=b[a];c._linkedTransformNode&&(c._linkedTransformNode.computeWorldMatrix(),c._matrix=c._linkedTransformNode._localMatrix,c.markAsDirty())}if(this._isDirty){if(this.needInitialSkinMatrix)for(a=0;a<this._meshesWithPoseMatrix.length;a++){b=this._meshesWithPoseMatrix[a];c=b.getPoseMatrix();b._bonesTransformMatrices&&b._bonesTransformMatrices.length===
16*(this.bones.length+1)||(b._bonesTransformMatrices=new Float32Array(16*(this.bones.length+1)));if(this._synchronizedWithMesh!==b){this._synchronizedWithMesh=b;for(var e=0;e<this.bones.length;e++){var f=this.bones[e];f.getParent()||(f.getBaseMatrix().multiplyToRef(c,p.c.Matrix[1]),f._updateDifferenceMatrix(p.c.Matrix[1]))}this.isUsingTextureForMatrices&&(e=4*(this.bones.length+1),b._transformMatrixTexture&&b._transformMatrixTexture.getSize().width===e||(b._transformMatrixTexture&&b._transformMatrixTexture.dispose(),
b._transformMatrixTexture=d.a.CreateRGBATexture(b._bonesTransformMatrices,4*(this.bones.length+1),1,this._scene,!1,!1,1,1)))}this._computeTransformMatrices(b._bonesTransformMatrices,c);this.isUsingTextureForMatrices&&b._transformMatrixTexture&&b._transformMatrixTexture.update(b._bonesTransformMatrices)}else this._transformMatrices&&this._transformMatrices.length===16*(this.bones.length+1)||(this._transformMatrices=new Float32Array(16*(this.bones.length+1)),this.isUsingTextureForMatrices&&(this._transformMatrixTexture&&
this._transformMatrixTexture.dispose(),this._transformMatrixTexture=d.a.CreateRGBATexture(this._transformMatrices,4*(this.bones.length+1),1,this._scene,!1,!1,1,1))),this._computeTransformMatrices(this._transformMatrices,null),this.isUsingTextureForMatrices&&this._transformMatrixTexture&&this._transformMatrixTexture.update(this._transformMatrices);this._isDirty=!1;this._scene._activeBones.addCount(this.bones.length,!1)}};a.prototype.getAnimatables=function(){if(!this._animatables||this._animatables.length!==
this.bones.length){this._animatables=[];for(var a=0;a<this.bones.length;a++)this._animatables.push(this.bones[a])}return this._animatables};a.prototype.clone=function(b,c){b=new a(b,c||b,this._scene);b.needInitialSkinMatrix=this.needInitialSkinMatrix;b.overrideMesh=this.overrideMesh;for(c=0;c<this.bones.length;c++){var f=this.bones[c],e=null,k=f.getParent();k&&(e=this.bones.indexOf(k),e=b.bones[e]);e=new h.a(f.name,b,e,f.getBaseMatrix().clone(),f.getRestPose().clone());e._index=f._index;f._linkedTransformNode&&
e.linkTransformNode(f._linkedTransformNode);l.a.DeepCopy(f.animations,e.animations)}if(this._ranges){b._ranges={};for(var d in this._ranges)(c=this._ranges[d])&&(b._ranges[d]=c.clone())}this._isDirty=!0;return b};a.prototype.enableBlending=function(a){void 0===a&&(a=.01);this.bones.forEach(function(b){b.animations.forEach(function(b){b.enableBlending=!0;b.blendingSpeed=a})})};a.prototype.dispose=function(){this._meshesWithPoseMatrix=[];this.getScene().stopAnimation(this);this.getScene().removeSkeleton(this);
this._transformMatrixTexture&&(this._transformMatrixTexture.dispose(),this._transformMatrixTexture=null)};a.prototype.serialize=function(){var a,b,c={};c.name=this.name;c.id=this.id;this.dimensionsAtRest&&(c.dimensionsAtRest=this.dimensionsAtRest.asArray());c.bones=[];c.needInitialSkinMatrix=this.needInitialSkinMatrix;c.overrideMeshId=null===(a=this.overrideMesh)||void 0===a?void 0:a.id;for(a=0;a<this.bones.length;a++){var e=this.bones[a],f=e.getParent();f={parentBoneIndex:f?this.bones.indexOf(f):
-1,index:e.getIndex(),name:e.name,matrix:e.getBaseMatrix().toArray(),rest:e.getRestPose().toArray(),linkedTransformNodeId:null===(b=e.getTransformNode())||void 0===b?void 0:b.id};c.bones.push(f);e.length&&(f.length=e.length);e.metadata&&(f.metadata=e.metadata);e.animations&&0<e.animations.length&&(f.animation=e.animations[0].serialize());c.ranges=[];for(var d in this._ranges)if(e=this._ranges[d])f={},f.name=d,f.from=e.from,f.to=e.to,c.ranges.push(f)}return c};a.Parse=function(b,c){c=new a(b.name,
b.id,c);b.dimensionsAtRest&&(c.dimensionsAtRest=p.e.FromArray(b.dimensionsAtRest));c.needInitialSkinMatrix=b.needInitialSkinMatrix;b.overrideMeshId&&(c._hasWaitingData=!0,c._waitingOverrideMeshId=b.overrideMeshId);var f;for(f=0;f<b.bones.length;f++){var e=b.bones[f],d=b.bones[f].index,k=null;-1<e.parentBoneIndex&&(k=c.bones[e.parentBoneIndex]);var l=e.rest?p.a.FromArray(e.rest):null;d=new h.a(e.name,c,k,p.a.FromArray(e.matrix),l,null,d);void 0!==e.id&&null!==e.id&&(d.id=e.id);e.length&&(d.length=
e.length);e.metadata&&(d.metadata=e.metadata);e.animation&&d.animations.push(u.a.Parse(e.animation));void 0!==e.linkedTransformNodeId&&null!==e.linkedTransformNodeId&&(c._hasWaitingData=!0,d._waitingTransformNodeId=e.linkedTransformNodeId)}if(b.ranges)for(f=0;f<b.ranges.length;f++)e=b.ranges[f],c.createAnimationRange(e.name,e.from,e.to);return c};a.prototype.computeAbsoluteTransforms=function(a){void 0===a&&(a=!1);var b=this._scene.getRenderId();if(this._lastAbsoluteTransformsUpdateId!=b||a)this.bones[0].computeAbsoluteTransforms(),
this._lastAbsoluteTransformsUpdateId=b};a.prototype.getPoseMatrix=function(){var a=null;0<this._meshesWithPoseMatrix.length&&(a=this._meshesWithPoseMatrix[0].getPoseMatrix());return a};a.prototype.sortBones=function(){for(var a=[],b=Array(this.bones.length),c=0;c<this.bones.length;c++)this._sortBones(c,a,b);this.bones=a};a.prototype._sortBones=function(a,b,c){if(!c[a]){c[a]=!0;var f=this.bones[a];void 0===f._index&&(f._index=a);(a=f.getParent())&&this._sortBones(this.bones.indexOf(a),b,c);b.push(f)}};
a.prototype.setCurrentPoseAsRest=function(){this.bones.forEach(function(a){a.setCurrentPoseAsRest()})};return a}()},cCS0:function(n,q,a){a.d(q,"a",function(){return u});var h=a("oYeq"),g=a("ADVu"),p=a("YKqZ"),d=a("98Qd"),u=function(){function a(){this.buttons=[0,1,2]}a.prototype.attachControl=function(a){var b=this;a=p.b.BackCompatCameraNoPreventDefault(arguments);var c=this.camera.getEngine(),f=c.getInputElement(),g=0,k=null;this.pointB=this.pointA=null;this._shiftKey=this._metaKey=this._ctrlKey=
this._altKey=!1;this._buttonsPressed=0;this._pointerInput=function(l,e){e=l.event;var h="touch"===e.pointerType;if(!c.isInVRExclusivePointerMode&&(l.type===d.a.POINTERMOVE||-1!==b.buttons.indexOf(e.button))){var m=e.srcElement||e.target;b._altKey=e.altKey;b._ctrlKey=e.ctrlKey;b._metaKey=e.metaKey;b._shiftKey=e.shiftKey;b._buttonsPressed=e.buttons;if(c.isPointerLock)l=e.movementX||e.mozMovementX||e.webkitMovementX||e.msMovementX||0,h=e.movementY||e.mozMovementY||e.webkitMovementY||e.msMovementY||0,
b.onTouch(null,l,h),b.pointA=null,b.pointB=null;else if(l.type===d.a.POINTERDOWN&&m){try{m.setPointerCapture(e.pointerId)}catch(B){}null===b.pointA?b.pointA={x:e.clientX,y:e.clientY,pointerId:e.pointerId,type:e.pointerType}:null===b.pointB&&(b.pointB={x:e.clientX,y:e.clientY,pointerId:e.pointerId,type:e.pointerType});b.onButtonDown(e);a||(e.preventDefault(),f&&f.focus())}else if(l.type===d.a.POINTERDOUBLETAP)b.onDoubleTap(e.pointerType);else if(l.type===d.a.POINTERUP&&m){try{m.releasePointerCapture(e.pointerId)}catch(B){}h||
(b.pointB=null);c._badOS?b.pointA=b.pointB=null:b.pointB&&b.pointA&&b.pointA.pointerId==e.pointerId?(b.pointA=b.pointB,b.pointB=null):b.pointA&&b.pointB&&b.pointB.pointerId==e.pointerId?b.pointB=null:b.pointA=b.pointB=null;if(0!==g||k)b.onMultiTouch(b.pointA,b.pointB,g,0,k,null),g=0,k=null;b.onButtonUp(e);a||e.preventDefault()}else l.type===d.a.POINTERMOVE&&(a||e.preventDefault(),b.pointA&&null===b.pointB?(l=e.clientX-b.pointA.x,h=e.clientY-b.pointA.y,b.onTouch(b.pointA,l,h),b.pointA.x=e.clientX,
b.pointA.y=e.clientY):b.pointA&&b.pointB&&(h=b.pointA.pointerId===e.pointerId?b.pointA:b.pointB,h.x=e.clientX,h.y=e.clientY,h=b.pointA.x-b.pointB.x,m=b.pointA.y-b.pointB.y,h=h*h+m*m,e={x:(b.pointA.x+b.pointB.x)/2,y:(b.pointA.y+b.pointB.y)/2,pointerId:e.pointerId,type:l.type},b.onMultiTouch(b.pointA,b.pointB,g,h,k,e),k=e,g=h))}};this._observer=this.camera.getScene().onPointerObservable.add(this._pointerInput,d.a.POINTERDOWN|d.a.POINTERUP|d.a.POINTERMOVE);this._onLostFocus=function(){b.pointA=b.pointB=
null;g=0;k=null;b.onLostFocus()};f&&f.addEventListener("contextmenu",this.onContextMenu.bind(this),!1);var h=this.camera.getScene().getEngine().getHostWindow();h&&p.b.RegisterTopRootEvents(h,[{name:"blur",handler:this._onLostFocus}])};a.prototype.detachControl=function(a){this._onLostFocus&&(a=this.camera.getScene().getEngine().getHostWindow())&&p.b.UnregisterTopRootEvents(a,[{name:"blur",handler:this._onLostFocus}]);this._observer&&(this.camera.getScene().onPointerObservable.remove(this._observer),
this._observer=null,this.onContextMenu&&(a=this.camera.getScene().getEngine().getInputElement())&&a.removeEventListener("contextmenu",this.onContextMenu),this._onLostFocus=null);this._shiftKey=this._metaKey=this._ctrlKey=this._altKey=!1;this._buttonsPressed=0};a.prototype.getClassName=function(){return"BaseCameraPointersInput"};a.prototype.getSimpleName=function(){return"pointers"};a.prototype.onDoubleTap=function(a){};a.prototype.onTouch=function(a,b,d){};a.prototype.onMultiTouch=function(a,b,d,
f,g,k){};a.prototype.onContextMenu=function(a){a.preventDefault()};a.prototype.onButtonDown=function(a){};a.prototype.onButtonUp=function(a){};a.prototype.onLostFocus=function(){};Object(h.c)([Object(g.c)()],a.prototype,"buttons",void 0);return a}()},"et6+":function(n,q,a){a("9AUY");a("qz3X");a("mDQ4");a("JwOz")},gJ7H:function(n,q,a){a.d(q,"a",function(){return d});var h=a("oYeq"),g=a("ADVu");n=a("xCqU");var p=a("M9Dn"),d=function(){function a(){this.gamepadRotationSensibility=80;this.gamepadMoveSensibility=
40;this._yAxisScale=1}Object.defineProperty(a.prototype,"invertYAxis",{get:function(){return 1!==this._yAxisScale},set:function(a){this._yAxisScale=a?-1:1},enumerable:!1,configurable:!0});a.prototype.attachControl=function(){var a=this,c=this.camera.getScene().gamepadManager;this._onGamepadConnectedObserver=c.onGamepadConnectedObservable.add(function(b){b.type===p.a.POSE_ENABLED||a.gamepad&&b.type!==p.a.XBOX||(a.gamepad=b)});this._onGamepadDisconnectedObserver=c.onGamepadDisconnectedObservable.add(function(b){a.gamepad===
b&&(a.gamepad=null)});this.gamepad=c.getGamepadByType(p.a.XBOX)};a.prototype.detachControl=function(a){this.camera.getScene().gamepadManager.onGamepadConnectedObservable.remove(this._onGamepadConnectedObserver);this.camera.getScene().gamepadManager.onGamepadDisconnectedObservable.remove(this._onGamepadDisconnectedObserver);this.gamepad=null};a.prototype.checkInputs=function(){if(this.gamepad){var a=this.camera,c=this.gamepad.rightStick;if(c){if(0!=c.x){var b=c.x/this.gamepadRotationSensibility;0!=
b&&.005<Math.abs(b)&&(a.inertialAlphaOffset+=b)}0!=c.y&&(c=c.y/this.gamepadRotationSensibility*this._yAxisScale,0!=c&&.005<Math.abs(c)&&(a.inertialBetaOffset+=c))}(a=this.gamepad.leftStick)&&0!=a.y&&(a=a.y/this.gamepadMoveSensibility,0!=a&&.005<Math.abs(a)&&(this.camera.inertialRadiusOffset-=a))}};a.prototype.getClassName=function(){return"ArcRotateCameraGamepadInput"};a.prototype.getSimpleName=function(){return"gamepad"};Object(h.c)([Object(g.c)()],a.prototype,"gamepadRotationSensibility",void 0);
Object(h.c)([Object(g.c)()],a.prototype,"gamepadMoveSensibility",void 0);return a}();n.a.ArcRotateCameraGamepadInput=d},gpYA:function(n,q,a){a.d(q,"a",function(){return p});var h=a("oYeq"),g=a("ADVu");n=a("xCqU");var p=function(a){function d(){var d=null!==a&&a.apply(this,arguments)||this;d.angularSensibilityX=1;d.angularSensibilityY=1;d.pinchPrecision=1E4;d.pinchDeltaPercentage=0;d.axisXControlRadius=!1;d.axisXControlHeight=!1;d.axisXControlRotation=!0;d.axisYControlRadius=!1;d.axisYControlHeight=
!0;d.axisYControlRotation=!1;d.axisPinchControlRadius=!0;d.axisPinchControlHeight=!1;d.axisPinchControlRotation=!1;d.warningEnable=!0;d._warningCounter=0;return d}Object(h.d)(d,a);d.prototype.getClassName=function(){return"FollowCameraPointersInput"};d.prototype.onTouch=function(a,c,b){this._warning();this.axisXControlRotation?this.camera.rotationOffset+=c/this.angularSensibilityX:this.axisYControlRotation&&(this.camera.rotationOffset+=b/this.angularSensibilityX);this.axisXControlHeight?this.camera.heightOffset+=
c/this.angularSensibilityY:this.axisYControlHeight&&(this.camera.heightOffset+=b/this.angularSensibilityY);this.axisXControlRadius?this.camera.radius-=c/this.angularSensibilityY:this.axisYControlRadius&&(this.camera.radius-=b/this.angularSensibilityY)};d.prototype.onMultiTouch=function(a,c,b,d,f,g){if(0!==b||null!==f)if(0!==d||null!==g)a=(d-b)/(this.pinchPrecision*(this.angularSensibilityX+this.angularSensibilityY)/2),this.pinchDeltaPercentage?(a*=.01*this.pinchDeltaPercentage,this.axisPinchControlRotation&&
(this.camera.rotationOffset+=a*this.camera.rotationOffset),this.axisPinchControlHeight&&(this.camera.heightOffset+=a*this.camera.heightOffset),this.axisPinchControlRadius&&(this.camera.radius-=a*this.camera.radius)):(this.axisPinchControlRotation&&(this.camera.rotationOffset+=a),this.axisPinchControlHeight&&(this.camera.heightOffset+=a),this.axisPinchControlRadius&&(this.camera.radius-=a))};d.prototype._warning=function(){this.warningEnable&&0===this._warningCounter++%100&&(console.assert(1>=this.axisXControlRotation+
this.axisXControlHeight+this.axisXControlRadius,"It probably only makes sense to control ONE camera property with each pointer axis. Set 'warningEnable = false' if you are sure. Currently enabled: axisXControlRotation: "+this.axisXControlRotation+", axisXControlHeight: "+this.axisXControlHeight+", axisXControlRadius: "+this.axisXControlRadius),console.assert(1>=this.axisYControlRotation+this.axisYControlHeight+this.axisYControlRadius,"It probably only makes sense to control ONE camera property with each pointer axis. Set 'warningEnable = false' if you are sure. Currently enabled: axisYControlRotation: "+
this.axisYControlRotation+", axisYControlHeight: "+this.axisYControlHeight+", axisYControlRadius: "+this.axisYControlRadius),console.assert(1>=this.axisPinchControlRotation+this.axisPinchControlHeight+this.axisPinchControlRadius,"It probably only makes sense to control ONE camera property with each pointer axis. Set 'warningEnable = false' if you are sure. Currently enabled: axisPinchControlRotation: "+this.axisPinchControlRotation+", axisPinchControlHeight: "+this.axisPinchControlHeight+", axisPinchControlRadius: "+
this.axisPinchControlRadius))};Object(h.c)([Object(g.c)()],d.prototype,"angularSensibilityX",void 0);Object(h.c)([Object(g.c)()],d.prototype,"angularSensibilityY",void 0);Object(h.c)([Object(g.c)()],d.prototype,"pinchPrecision",void 0);Object(h.c)([Object(g.c)()],d.prototype,"pinchDeltaPercentage",void 0);Object(h.c)([Object(g.c)()],d.prototype,"axisXControlRadius",void 0);Object(h.c)([Object(g.c)()],d.prototype,"axisXControlHeight",void 0);Object(h.c)([Object(g.c)()],d.prototype,"axisXControlRotation",
void 0);Object(h.c)([Object(g.c)()],d.prototype,"axisYControlRadius",void 0);Object(h.c)([Object(g.c)()],d.prototype,"axisYControlHeight",void 0);Object(h.c)([Object(g.c)()],d.prototype,"axisYControlRotation",void 0);Object(h.c)([Object(g.c)()],d.prototype,"axisPinchControlRadius",void 0);Object(h.c)([Object(g.c)()],d.prototype,"axisPinchControlHeight",void 0);Object(h.c)([Object(g.c)()],d.prototype,"axisPinchControlRotation",void 0);return d}(a("cCS0").a);n.a.FollowCameraPointersInput=p},iUAG:function(n,
q,a){a.d(q,"a",function(){return u});var h=a("oYeq");n=a("xCqU");var g=a("ADVu"),p=a("jSHE"),d=a("YKqZ"),u=function(){function a(){this.keysHeightOffsetIncr=[38];this.keysHeightOffsetDecr=[40];this.keysHeightOffsetModifierShift=this.keysHeightOffsetModifierCtrl=this.keysHeightOffsetModifierAlt=!1;this.keysRotationOffsetIncr=[37];this.keysRotationOffsetDecr=[39];this.keysRotationOffsetModifierShift=this.keysRotationOffsetModifierCtrl=this.keysRotationOffsetModifierAlt=!1;this.keysRadiusIncr=[40];this.keysRadiusDecr=
[38];this.keysRadiusModifierAlt=!0;this.keysRadiusModifierShift=this.keysRadiusModifierCtrl=!1;this.radiusSensibility=this.rotationSensibility=this.heightSensibility=1;this._keys=[]}a.prototype.attachControl=function(a){var b=this;a=d.b.BackCompatCameraNoPreventDefault(arguments);this._onCanvasBlurObserver||(this._scene=this.camera.getScene(),this._engine=this._scene.getEngine(),this._onCanvasBlurObserver=this._engine.onCanvasBlurObservable.add(function(){b._keys=[]}),this._onKeyboardObserver=this._scene.onKeyboardObservable.add(function(c){var f=
c.event;if(!f.metaKey)if(c.type===p.a.KEYDOWN){if(b._ctrlPressed=f.ctrlKey,b._altPressed=f.altKey,b._shiftPressed=f.shiftKey,-1!==b.keysHeightOffsetIncr.indexOf(f.keyCode)||-1!==b.keysHeightOffsetDecr.indexOf(f.keyCode)||-1!==b.keysRotationOffsetIncr.indexOf(f.keyCode)||-1!==b.keysRotationOffsetDecr.indexOf(f.keyCode)||-1!==b.keysRadiusIncr.indexOf(f.keyCode)||-1!==b.keysRadiusDecr.indexOf(f.keyCode))c=b._keys.indexOf(f.keyCode),-1===c&&b._keys.push(f.keyCode),f.preventDefault&&(a||f.preventDefault())}else if(-1!==
b.keysHeightOffsetIncr.indexOf(f.keyCode)||-1!==b.keysHeightOffsetDecr.indexOf(f.keyCode)||-1!==b.keysRotationOffsetIncr.indexOf(f.keyCode)||-1!==b.keysRotationOffsetDecr.indexOf(f.keyCode)||-1!==b.keysRadiusIncr.indexOf(f.keyCode)||-1!==b.keysRadiusDecr.indexOf(f.keyCode))c=b._keys.indexOf(f.keyCode),0<=c&&b._keys.splice(c,1),f.preventDefault&&(a||f.preventDefault())}))};a.prototype.detachControl=function(a){this._scene&&(this._onKeyboardObserver&&this._scene.onKeyboardObservable.remove(this._onKeyboardObserver),
this._onCanvasBlurObserver&&this._engine.onCanvasBlurObservable.remove(this._onCanvasBlurObserver),this._onCanvasBlurObserver=this._onKeyboardObserver=null);this._keys=[]};a.prototype.checkInputs=function(){var a=this;this._onKeyboardObserver&&this._keys.forEach(function(b){-1!==a.keysHeightOffsetIncr.indexOf(b)&&a._modifierHeightOffset()?a.camera.heightOffset+=a.heightSensibility:-1!==a.keysHeightOffsetDecr.indexOf(b)&&a._modifierHeightOffset()?a.camera.heightOffset-=a.heightSensibility:-1!==a.keysRotationOffsetIncr.indexOf(b)&&
a._modifierRotationOffset()?(a.camera.rotationOffset+=a.rotationSensibility,a.camera.rotationOffset%=360):-1!==a.keysRotationOffsetDecr.indexOf(b)&&a._modifierRotationOffset()?(a.camera.rotationOffset-=a.rotationSensibility,a.camera.rotationOffset%=360):-1!==a.keysRadiusIncr.indexOf(b)&&a._modifierRadius()?a.camera.radius+=a.radiusSensibility:-1!==a.keysRadiusDecr.indexOf(b)&&a._modifierRadius()&&(a.camera.radius-=a.radiusSensibility)})};a.prototype.getClassName=function(){return"FollowCameraKeyboardMoveInput"};
a.prototype.getSimpleName=function(){return"keyboard"};a.prototype._modifierHeightOffset=function(){return this.keysHeightOffsetModifierAlt===this._altPressed&&this.keysHeightOffsetModifierCtrl===this._ctrlPressed&&this.keysHeightOffsetModifierShift===this._shiftPressed};a.prototype._modifierRotationOffset=function(){return this.keysRotationOffsetModifierAlt===this._altPressed&&this.keysRotationOffsetModifierCtrl===this._ctrlPressed&&this.keysRotationOffsetModifierShift===this._shiftPressed};a.prototype._modifierRadius=
function(){return this.keysRadiusModifierAlt===this._altPressed&&this.keysRadiusModifierCtrl===this._ctrlPressed&&this.keysRadiusModifierShift===this._shiftPressed};Object(h.c)([Object(g.c)()],a.prototype,"keysHeightOffsetIncr",void 0);Object(h.c)([Object(g.c)()],a.prototype,"keysHeightOffsetDecr",void 0);Object(h.c)([Object(g.c)()],a.prototype,"keysHeightOffsetModifierAlt",void 0);Object(h.c)([Object(g.c)()],a.prototype,"keysHeightOffsetModifierCtrl",void 0);Object(h.c)([Object(g.c)()],a.prototype,
"keysHeightOffsetModifierShift",void 0);Object(h.c)([Object(g.c)()],a.prototype,"keysRotationOffsetIncr",void 0);Object(h.c)([Object(g.c)()],a.prototype,"keysRotationOffsetDecr",void 0);Object(h.c)([Object(g.c)()],a.prototype,"keysRotationOffsetModifierAlt",void 0);Object(h.c)([Object(g.c)()],a.prototype,"keysRotationOffsetModifierCtrl",void 0);Object(h.c)([Object(g.c)()],a.prototype,"keysRotationOffsetModifierShift",void 0);Object(h.c)([Object(g.c)()],a.prototype,"keysRadiusIncr",void 0);Object(h.c)([Object(g.c)()],
a.prototype,"keysRadiusDecr",void 0);Object(h.c)([Object(g.c)()],a.prototype,"keysRadiusModifierAlt",void 0);Object(h.c)([Object(g.c)()],a.prototype,"keysRadiusModifierCtrl",void 0);Object(h.c)([Object(g.c)()],a.prototype,"keysRadiusModifierShift",void 0);Object(h.c)([Object(g.c)()],a.prototype,"heightSensibility",void 0);Object(h.c)([Object(g.c)()],a.prototype,"rotationSensibility",void 0);Object(h.c)([Object(g.c)()],a.prototype,"radiusSensibility",void 0);return a}();n.a.FollowCameraKeyboardMoveInput=
u},kv5N:function(n,q,a){a.d(q,"a",function(){return u});var h=a("oYeq"),g=a("ADVu");n=a("xCqU");var p=a("jSHE"),d=a("YKqZ"),u=function(){function a(){this.keysUp=[38];this.keysDown=[40];this.keysLeft=[37];this.keysRight=[39];this.keysReset=[220];this.panningSensibility=50;this.zoomingSensibility=25;this.useAltToZoom=!0;this.angularSpeed=.01;this._keys=[]}a.prototype.attachControl=function(a){var b=this;a=d.b.BackCompatCameraNoPreventDefault(arguments);this._onCanvasBlurObserver||(this._scene=this.camera.getScene(),
this._engine=this._scene.getEngine(),this._onCanvasBlurObserver=this._engine.onCanvasBlurObservable.add(function(){b._keys=[]}),this._onKeyboardObserver=this._scene.onKeyboardObservable.add(function(c){var f=c.event;if(!f.metaKey)if(c.type===p.a.KEYDOWN){if(b._ctrlPressed=f.ctrlKey,b._altPressed=f.altKey,-1!==b.keysUp.indexOf(f.keyCode)||-1!==b.keysDown.indexOf(f.keyCode)||-1!==b.keysLeft.indexOf(f.keyCode)||-1!==b.keysRight.indexOf(f.keyCode)||-1!==b.keysReset.indexOf(f.keyCode))c=b._keys.indexOf(f.keyCode),
-1===c&&b._keys.push(f.keyCode),f.preventDefault&&(a||f.preventDefault())}else if(-1!==b.keysUp.indexOf(f.keyCode)||-1!==b.keysDown.indexOf(f.keyCode)||-1!==b.keysLeft.indexOf(f.keyCode)||-1!==b.keysRight.indexOf(f.keyCode)||-1!==b.keysReset.indexOf(f.keyCode))c=b._keys.indexOf(f.keyCode),0<=c&&b._keys.splice(c,1),f.preventDefault&&(a||f.preventDefault())}))};a.prototype.detachControl=function(a){this._scene&&(this._onKeyboardObserver&&this._scene.onKeyboardObservable.remove(this._onKeyboardObserver),
this._onCanvasBlurObserver&&this._engine.onCanvasBlurObservable.remove(this._onCanvasBlurObserver),this._onCanvasBlurObserver=this._onKeyboardObserver=null);this._keys=[]};a.prototype.checkInputs=function(){if(this._onKeyboardObserver)for(var a=this.camera,b=0;b<this._keys.length;b++){var d=this._keys[b];-1!==this.keysLeft.indexOf(d)?this._ctrlPressed&&this.camera._useCtrlForPanning?a.inertialPanningX-=1/this.panningSensibility:a.inertialAlphaOffset-=this.angularSpeed:-1!==this.keysUp.indexOf(d)?
this._ctrlPressed&&this.camera._useCtrlForPanning?a.inertialPanningY+=1/this.panningSensibility:this._altPressed&&this.useAltToZoom?a.inertialRadiusOffset+=1/this.zoomingSensibility:a.inertialBetaOffset-=this.angularSpeed:-1!==this.keysRight.indexOf(d)?this._ctrlPressed&&this.camera._useCtrlForPanning?a.inertialPanningX+=1/this.panningSensibility:a.inertialAlphaOffset+=this.angularSpeed:-1!==this.keysDown.indexOf(d)?this._ctrlPressed&&this.camera._useCtrlForPanning?a.inertialPanningY-=1/this.panningSensibility:
this._altPressed&&this.useAltToZoom?a.inertialRadiusOffset-=1/this.zoomingSensibility:a.inertialBetaOffset+=this.angularSpeed:-1!==this.keysReset.indexOf(d)&&a.useInputToRestoreState&&a.restoreState()}};a.prototype.getClassName=function(){return"ArcRotateCameraKeyboardMoveInput"};a.prototype.getSimpleName=function(){return"keyboard"};Object(h.c)([Object(g.c)()],a.prototype,"keysUp",void 0);Object(h.c)([Object(g.c)()],a.prototype,"keysDown",void 0);Object(h.c)([Object(g.c)()],a.prototype,"keysLeft",
void 0);Object(h.c)([Object(g.c)()],a.prototype,"keysRight",void 0);Object(h.c)([Object(g.c)()],a.prototype,"keysReset",void 0);Object(h.c)([Object(g.c)()],a.prototype,"panningSensibility",void 0);Object(h.c)([Object(g.c)()],a.prototype,"zoomingSensibility",void 0);Object(h.c)([Object(g.c)()],a.prototype,"useAltToZoom",void 0);Object(h.c)([Object(g.c)()],a.prototype,"angularSpeed",void 0);return a}();n.a.ArcRotateCameraKeyboardMoveInput=u},m0wr:function(n,q,a){a("gJ7H");a("kv5N");a("XRWu");a("17qc");
a("PbDj");a("93XQ");a("qSkO");a("iUAG");a("uXHy");a("gpYA");a("Qu+o");a("5Jap");a("p/Y1");a("Hl4A");a("s8I9");a("SQ0+");a("FjK/")},mDQ4:function(n,q,a){n=a("CAkI");var h=a("/SR9"),g=a("DBgT"),p=a("0FRC"),d=a("8MBl"),u=a("uyO6"),m=a("JIAX");n.a._setVRRigMode=function(a,b){b=b.vrCameraMetrics||d.a.GetDefault();a._rigCameras[0]._cameraRigParams.vrMetrics=b;a._rigCameras[0].viewport=new m.a(0,0,.5,1);a._rigCameras[0]._cameraRigParams.vrWorkMatrix=new h.a;a._rigCameras[0]._cameraRigParams.vrHMatrix=b.leftHMatrix;
a._rigCameras[0]._cameraRigParams.vrPreViewMatrix=b.leftPreViewMatrix;a._rigCameras[0].getProjectionMatrix=a._rigCameras[0]._getVRProjectionMatrix;a._rigCameras[1]._cameraRigParams.vrMetrics=b;a._rigCameras[1].viewport=new m.a(.5,0,.5,1);a._rigCameras[1]._cameraRigParams.vrWorkMatrix=new h.a;a._rigCameras[1]._cameraRigParams.vrHMatrix=b.rightHMatrix;a._rigCameras[1]._cameraRigParams.vrPreViewMatrix=b.rightPreViewMatrix;a._rigCameras[1].getProjectionMatrix=a._rigCameras[1]._getVRProjectionMatrix;b.multiviewEnabled&&
(a.getScene().getEngine().getCaps().multiview?(a._useMultiviewToSingleView=!0,a._rigPostProcess=new p.a("VRMultiviewToSingleview",a,b.postProcessScaleFactor)):(u.a.Warn("Multiview is not supported, falling back to standard rendering"),b.multiviewEnabled=!1));b.compensateDistortion&&(a._rigCameras[0]._rigPostProcess=new g.a("VR_Distort_Compensation_Left",a._rigCameras[0],!1,b),a._rigCameras[1]._rigPostProcess=new g.a("VR_Distort_Compensation_Right",a._rigCameras[1],!0,b))}},"p/Y1":function(n,q,a){a.d(q,
"a",function(){return m});var h=a("oYeq"),g=a("ADVu");n=a("xCqU");var p=a("jSHE"),d=a("/SR9"),u=a("YKqZ"),m=function(){function a(){this.keysUp=[38];this.keysUpward=[33];this.keysDown=[40];this.keysDownward=[34];this.keysLeft=[37];this.keysRight=[39];this._keys=[]}a.prototype.attachControl=function(a){var b=this;a=u.b.BackCompatCameraNoPreventDefault(arguments);this._onCanvasBlurObserver||(this._scene=this.camera.getScene(),this._engine=this._scene.getEngine(),this._onCanvasBlurObserver=this._engine.onCanvasBlurObservable.add(function(){b._keys=
[]}),this._onKeyboardObserver=this._scene.onKeyboardObservable.add(function(c){var d=c.event;if(!d.metaKey)if(c.type===p.a.KEYDOWN){if(-1!==b.keysUp.indexOf(d.keyCode)||-1!==b.keysDown.indexOf(d.keyCode)||-1!==b.keysLeft.indexOf(d.keyCode)||-1!==b.keysRight.indexOf(d.keyCode)||-1!==b.keysUpward.indexOf(d.keyCode)||-1!==b.keysDownward.indexOf(d.keyCode))c=b._keys.indexOf(d.keyCode),-1===c&&b._keys.push(d.keyCode),a||d.preventDefault()}else if(-1!==b.keysUp.indexOf(d.keyCode)||-1!==b.keysDown.indexOf(d.keyCode)||
-1!==b.keysLeft.indexOf(d.keyCode)||-1!==b.keysRight.indexOf(d.keyCode)||-1!==b.keysUpward.indexOf(d.keyCode)||-1!==b.keysDownward.indexOf(d.keyCode))c=b._keys.indexOf(d.keyCode),0<=c&&b._keys.splice(c,1),a||d.preventDefault()}))};a.prototype.detachControl=function(a){this._scene&&(this._onKeyboardObserver&&this._scene.onKeyboardObservable.remove(this._onKeyboardObserver),this._onCanvasBlurObserver&&this._engine.onCanvasBlurObservable.remove(this._onCanvasBlurObserver),this._onCanvasBlurObserver=
this._onKeyboardObserver=null);this._keys=[]};a.prototype.checkInputs=function(){if(this._onKeyboardObserver)for(var a=this.camera,c=0;c<this._keys.length;c++){var f=this._keys[c],g=a._computeLocalCameraSpeed();-1!==this.keysLeft.indexOf(f)?a._localDirection.copyFromFloats(-g,0,0):-1!==this.keysUp.indexOf(f)?a._localDirection.copyFromFloats(0,0,g):-1!==this.keysRight.indexOf(f)?a._localDirection.copyFromFloats(g,0,0):-1!==this.keysDown.indexOf(f)?a._localDirection.copyFromFloats(0,0,-g):-1!==this.keysUpward.indexOf(f)?
a._localDirection.copyFromFloats(0,g,0):-1!==this.keysDownward.indexOf(f)&&a._localDirection.copyFromFloats(0,-g,0);a.getScene().useRightHandedSystem&&(a._localDirection.z*=-1);a.getViewMatrix().invertToRef(a._cameraTransformMatrix);d.e.TransformNormalToRef(a._localDirection,a._cameraTransformMatrix,a._transformedDirection);a.cameraDirection.addInPlace(a._transformedDirection)}};a.prototype.getClassName=function(){return"FreeCameraKeyboardMoveInput"};a.prototype._onLostFocus=function(){this._keys=
[]};a.prototype.getSimpleName=function(){return"keyboard"};Object(h.c)([Object(g.c)()],a.prototype,"keysUp",void 0);Object(h.c)([Object(g.c)()],a.prototype,"keysUpward",void 0);Object(h.c)([Object(g.c)()],a.prototype,"keysDown",void 0);Object(h.c)([Object(g.c)()],a.prototype,"keysDownward",void 0);Object(h.c)([Object(g.c)()],a.prototype,"keysLeft",void 0);Object(h.c)([Object(g.c)()],a.prototype,"keysRight",void 0);return a}();n.a.FreeCameraKeyboardMoveInput=m},qSkO:function(n,q,a){a.d(q,"a",function(){return c});
var h=a("oYeq"),g=a("ADVu");n=a("xCqU");var p=a("98Qd"),d=a("/SR9"),u=a("SYzJ"),m=a("YKqZ"),c=function(){function a(a){this.buttons=[0,1,2];this.buttonsYaw=[-1,0,1];this.buttonsPitch=[-1,0,1];this.buttonsRoll=[2];this.activeButton=-1;this.angularSensibility=1E3;this.previousPosition=null}a.prototype.attachControl=function(a){var b=this;this.noPreventDefault=a=m.b.BackCompatCameraNoPreventDefault(arguments);this._observer=this.camera.getScene().onPointerObservable.add(function(a,c){b._pointerInput(a,
c)},p.a.POINTERDOWN|p.a.POINTERUP|p.a.POINTERMOVE);this._rollObserver=this.camera.getScene().onBeforeRenderObservable.add(function(){b.camera.rollCorrect&&b.camera.restoreRoll(b.camera.rollCorrect)})};a.prototype.detachControl=function(a){this._observer&&(this.camera.getScene().onPointerObservable.remove(this._observer),this.camera.getScene().onBeforeRenderObservable.remove(this._rollObserver),this.previousPosition=this._rollObserver=this._observer=null,this.noPreventDefault=void 0)};a.prototype.getClassName=
function(){return"FlyCameraMouseInput"};a.prototype.getSimpleName=function(){return"mouse"};a.prototype._pointerInput=function(a,b){b=a.event;var c=this.camera.getEngine();if(!(c.isInVRExclusivePointerMode||!this.touchEnabled&&"touch"===b.pointerType||a.type!==p.a.POINTERMOVE&&-1===this.buttons.indexOf(b.button))){var d=b.srcElement||b.target;if(a.type===p.a.POINTERDOWN&&d){try{d.setPointerCapture(b.pointerId)}catch(t){}this.previousPosition={x:b.clientX,y:b.clientY};this.activeButton=b.button;this.noPreventDefault||
(b.preventDefault(),this.element.focus());c.isPointerLock&&this._onMouseMove(a.event)}else if(a.type===p.a.POINTERUP&&d){try{d.releasePointerCapture(b.pointerId)}catch(t){}this.activeButton=-1;this.previousPosition=null;this.noPreventDefault||b.preventDefault()}else a.type===p.a.POINTERMOVE&&(this.previousPosition?(this.rotateCamera(b.clientX-this.previousPosition.x,b.clientY-this.previousPosition.y),this.previousPosition={x:b.clientX,y:b.clientY},this.noPreventDefault||b.preventDefault()):c.isPointerLock&&
this._onMouseMove(a.event))}};a.prototype._onMouseMove=function(a){var b=this.camera.getEngine();b.isPointerLock&&!b.isInVRExclusivePointerMode&&(this.rotateCamera(a.movementX||a.mozMovementX||a.webkitMovementX||a.msMovementX||0,a.movementY||a.mozMovementY||a.webkitMovementY||a.msMovementY||0),this.previousPosition=null,this.noPreventDefault||a.preventDefault())};a.prototype.rotateCamera=function(a,b){var c=this,f=this.camera;this.camera.getScene().useRightHandedSystem&&(a*=-1);f.parent&&0>f.parent._getWorldMatrixDeterminant()&&
(a*=-1);a/=this.angularSensibility;var g=b/this.angularSensibility;b=d.b.RotationYawPitchRoll(f.rotation.y,f.rotation.x,f.rotation.z);this.buttonsPitch.some(function(a){return a===c.activeButton})&&(g=d.b.RotationAxis(u.a.X,g),b.multiplyInPlace(g));this.buttonsYaw.some(function(a){return a===c.activeButton})&&(g=d.b.RotationAxis(u.a.Y,a),b.multiplyInPlace(g),g=f.bankedTurnLimit+f._trackRoll,f.bankedTurn&&-g<f.rotation.z&&f.rotation.z<g&&(g=d.b.RotationAxis(u.a.Z,f.bankedTurnMultiplier*-a),b.multiplyInPlace(g)));
this.buttonsRoll.some(function(a){return a===c.activeButton})&&(g=d.b.RotationAxis(u.a.Z,-a),f._trackRoll-=a,b.multiplyInPlace(g));b.toEulerAnglesToRef(f.rotation)};Object(h.c)([Object(g.c)()],a.prototype,"buttons",void 0);Object(h.c)([Object(g.c)()],a.prototype,"angularSensibility",void 0);return a}();n.a.FlyCameraMouseInput=c},qz3X:function(n,q,a){var h=a("CAkI"),g=a("JIAX");h.a._setStereoscopicRigMode=function(a){var d=a.cameraRigMode===h.a.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL||a.cameraRigMode===
h.a.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED,n=a.cameraRigMode===h.a.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED;a._rigCameras[n?1:0].viewport=new g.a(0,0,d?.5:1,d?1:.5);a._rigCameras[n?0:1].viewport=new g.a(d?.5:0,d?0:.5,d?.5:1,d?1:.5)}},s8I9:function(n,q,a){a.d(q,"a",function(){return l});var h=a("oYeq"),g=a("ADVu");n=a("xCqU");var p=a("ps+7"),d=a("98Qd"),u=a("YKqZ");q=function(){function a(){this.wheelPrecisionZ=this.wheelPrecisionY=this.wheelPrecisionX=3;this.onChangedObservable=new p.a;this._wheelDeltaZ=
this._wheelDeltaY=this._wheelDeltaX=0;this._ffMultiplier=12;this._normalize=120}a.prototype.attachControl=function(a){var b=this;a=u.b.BackCompatCameraNoPreventDefault(arguments);this._wheel=function(c){if(c.type===d.a.POINTERWHEEL){c=c.event;var f=c.deltaMode===WheelEvent.DOM_DELTA_LINE?b._ffMultiplier:1;void 0!==c.deltaY?(b._wheelDeltaX+=b.wheelPrecisionX*f*c.deltaX/b._normalize,b._wheelDeltaY-=b.wheelPrecisionY*f*c.deltaY/b._normalize,b._wheelDeltaZ+=b.wheelPrecisionZ*f*c.deltaZ/b._normalize):
void 0!==c.wheelDeltaY?(b._wheelDeltaX+=b.wheelPrecisionX*f*c.wheelDeltaX/b._normalize,b._wheelDeltaY-=b.wheelPrecisionY*f*c.wheelDeltaY/b._normalize,b._wheelDeltaZ+=b.wheelPrecisionZ*f*c.wheelDeltaZ/b._normalize):c.wheelDelta&&(b._wheelDeltaY-=b.wheelPrecisionY*c.wheelDelta/b._normalize);c.preventDefault&&(a||c.preventDefault())}};this._observer=this.camera.getScene().onPointerObservable.add(this._wheel,d.a.POINTERWHEEL)};a.prototype.detachControl=function(a){this._observer&&(this.camera.getScene().onPointerObservable.remove(this._observer),
this._wheel=this._observer=null);this.onChangedObservable&&this.onChangedObservable.clear()};a.prototype.checkInputs=function(){this.onChangedObservable.notifyObservers({wheelDeltaX:this._wheelDeltaX,wheelDeltaY:this._wheelDeltaY,wheelDeltaZ:this._wheelDeltaZ});this._wheelDeltaZ=this._wheelDeltaY=this._wheelDeltaX=0};a.prototype.getClassName=function(){return"BaseCameraMouseWheelInput"};a.prototype.getSimpleName=function(){return"mousewheel"};Object(h.c)([Object(g.c)()],a.prototype,"wheelPrecisionX",
void 0);Object(h.c)([Object(g.c)()],a.prototype,"wheelPrecisionY",void 0);Object(h.c)([Object(g.c)()],a.prototype,"wheelPrecisionZ",void 0);return a}();var m=a("/SR9"),c=a("SYzJ"),b;(function(a){a[a.MoveRelative=0]="MoveRelative";a[a.RotateRelative=1]="RotateRelative";a[a.MoveScene=2]="MoveScene"})(b||(b={}));var l=function(a){function d(){var d=null!==a&&a.apply(this,arguments)||this;d._moveRelative=m.e.Zero();d._rotateRelative=m.e.Zero();d._moveScene=m.e.Zero();d._wheelXAction=b.MoveRelative;d._wheelXActionCoordinate=
c.b.X;d._wheelYAction=b.MoveRelative;d._wheelYActionCoordinate=c.b.Z;d._wheelZAction=null;d._wheelZActionCoordinate=null;return d}Object(h.d)(d,a);d.prototype.getClassName=function(){return"FreeCameraMouseWheelInput"};Object.defineProperty(d.prototype,"wheelXMoveRelative",{get:function(){return this._wheelXAction!==b.MoveRelative?null:this._wheelXActionCoordinate},set:function(a){if(null!==a||this._wheelXAction===b.MoveRelative)this._wheelXAction=b.MoveRelative,this._wheelXActionCoordinate=a},enumerable:!1,
configurable:!0});Object.defineProperty(d.prototype,"wheelYMoveRelative",{get:function(){return this._wheelYAction!==b.MoveRelative?null:this._wheelYActionCoordinate},set:function(a){if(null!==a||this._wheelYAction===b.MoveRelative)this._wheelYAction=b.MoveRelative,this._wheelYActionCoordinate=a},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"wheelZMoveRelative",{get:function(){return this._wheelZAction!==b.MoveRelative?null:this._wheelZActionCoordinate},set:function(a){if(null!==
a||this._wheelZAction===b.MoveRelative)this._wheelZAction=b.MoveRelative,this._wheelZActionCoordinate=a},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"wheelXRotateRelative",{get:function(){return this._wheelXAction!==b.RotateRelative?null:this._wheelXActionCoordinate},set:function(a){if(null!==a||this._wheelXAction===b.RotateRelative)this._wheelXAction=b.RotateRelative,this._wheelXActionCoordinate=a},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"wheelYRotateRelative",
{get:function(){return this._wheelYAction!==b.RotateRelative?null:this._wheelYActionCoordinate},set:function(a){if(null!==a||this._wheelYAction===b.RotateRelative)this._wheelYAction=b.RotateRelative,this._wheelYActionCoordinate=a},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"wheelZRotateRelative",{get:function(){return this._wheelZAction!==b.RotateRelative?null:this._wheelZActionCoordinate},set:function(a){if(null!==a||this._wheelZAction===b.RotateRelative)this._wheelZAction=
b.RotateRelative,this._wheelZActionCoordinate=a},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"wheelXMoveScene",{get:function(){return this._wheelXAction!==b.MoveScene?null:this._wheelXActionCoordinate},set:function(a){if(null!==a||this._wheelXAction===b.MoveScene)this._wheelXAction=b.MoveScene,this._wheelXActionCoordinate=a},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"wheelYMoveScene",{get:function(){return this._wheelYAction!==b.MoveScene?null:this._wheelYActionCoordinate},
set:function(a){if(null!==a||this._wheelYAction===b.MoveScene)this._wheelYAction=b.MoveScene,this._wheelYActionCoordinate=a},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"wheelZMoveScene",{get:function(){return this._wheelZAction!==b.MoveScene?null:this._wheelZActionCoordinate},set:function(a){if(null!==a||this._wheelZAction===b.MoveScene)this._wheelZAction=b.MoveScene,this._wheelZActionCoordinate=a},enumerable:!1,configurable:!0});d.prototype.checkInputs=function(){if(0!==this._wheelDeltaX||
0!==this._wheelDeltaY||0!=this._wheelDeltaZ){this._moveRelative.setAll(0);this._rotateRelative.setAll(0);this._moveScene.setAll(0);this._updateCamera();this.camera.getScene().useRightHandedSystem&&(this._moveRelative.z*=-1);var b=m.a.Zero();this.camera.getViewMatrix().invertToRef(b);var c=m.e.Zero();m.e.TransformNormalToRef(this._moveRelative,b,c);this.camera.cameraRotation.x+=this._rotateRelative.x/200;this.camera.cameraRotation.y+=this._rotateRelative.y/200;this.camera.cameraDirection.addInPlace(c);
this.camera.cameraDirection.addInPlace(this._moveScene);a.prototype.checkInputs.call(this)}};d.prototype._updateCamera=function(){var a=this._moveRelative,d=this._rotateRelative,f=this._moveScene,e=function(e,g,h){if(0!==e&&null!==g&&null!==h){var k=null;switch(g){case b.MoveRelative:k=a;break;case b.RotateRelative:k=d;break;case b.MoveScene:k=f}switch(h){case c.b.X:k.set(e,0,0);break;case c.b.Y:k.set(0,e,0);break;case c.b.Z:k.set(0,0,e)}}};e(this._wheelDeltaX,this._wheelXAction,this._wheelXActionCoordinate);
e(this._wheelDeltaY,this._wheelYAction,this._wheelYActionCoordinate);e(this._wheelDeltaZ,this._wheelZAction,this._wheelZActionCoordinate)};Object(h.c)([Object(g.c)()],d.prototype,"wheelXMoveRelative",null);Object(h.c)([Object(g.c)()],d.prototype,"wheelYMoveRelative",null);Object(h.c)([Object(g.c)()],d.prototype,"wheelZMoveRelative",null);Object(h.c)([Object(g.c)()],d.prototype,"wheelXRotateRelative",null);Object(h.c)([Object(g.c)()],d.prototype,"wheelYRotateRelative",null);Object(h.c)([Object(g.c)()],
d.prototype,"wheelZRotateRelative",null);Object(h.c)([Object(g.c)()],d.prototype,"wheelXMoveScene",null);Object(h.c)([Object(g.c)()],d.prototype,"wheelYMoveScene",null);Object(h.c)([Object(g.c)()],d.prototype,"wheelZMoveScene",null);return d}(q);n.a.FreeCameraMouseWheelInput=l},uXHy:function(n,q,a){a.d(q,"a",function(){return u});var h=a("oYeq"),g=a("ADVu");n=a("xCqU");var p=a("98Qd"),d=a("YKqZ"),u=function(){function a(){this.axisControlRadius=!0;this.axisControlRotation=this.axisControlHeight=!1;
this.wheelPrecision=3;this.wheelDeltaPercentage=0}a.prototype.attachControl=function(a){var b=this;a=d.b.BackCompatCameraNoPreventDefault(arguments);this._wheel=function(c,d){if(c.type===p.a.POINTERWHEEL){c=c.event;d=0;var f=Math.max(-1,Math.min(1,c.deltaY||c.wheelDelta||-c.detail));b.wheelDeltaPercentage?(console.assert(1>=b.axisControlRadius+b.axisControlHeight+b.axisControlRotation,"wheelDeltaPercentage only usable when mouse wheel controlls ONE axis. Currently enabled: axisControlRadius: "+b.axisControlRadius+
", axisControlHeightOffset: "+b.axisControlHeight+", axisControlRotationOffset: "+b.axisControlRotation),b.axisControlRadius?d=.01*f*b.wheelDeltaPercentage*b.camera.radius:b.axisControlHeight?d=.01*f*b.wheelDeltaPercentage*b.camera.heightOffset:b.axisControlRotation&&(d=.01*f*b.wheelDeltaPercentage*b.camera.rotationOffset)):d=f*b.wheelPrecision;d&&(b.axisControlRadius?b.camera.radius+=d:b.axisControlHeight?b.camera.heightOffset-=d:b.axisControlRotation&&(b.camera.rotationOffset-=d));c.preventDefault&&
(a||c.preventDefault())}};this._observer=this.camera.getScene().onPointerObservable.add(this._wheel,p.a.POINTERWHEEL)};a.prototype.detachControl=function(a){this._observer&&(this.camera.getScene().onPointerObservable.remove(this._observer),this._wheel=this._observer=null)};a.prototype.getClassName=function(){return"ArcRotateCameraMouseWheelInput"};a.prototype.getSimpleName=function(){return"mousewheel"};Object(h.c)([Object(g.c)()],a.prototype,"axisControlRadius",void 0);Object(h.c)([Object(g.c)()],
a.prototype,"axisControlHeight",void 0);Object(h.c)([Object(g.c)()],a.prototype,"axisControlRotation",void 0);Object(h.c)([Object(g.c)()],a.prototype,"wheelPrecision",void 0);Object(h.c)([Object(g.c)()],a.prototype,"wheelDeltaPercentage",void 0);return a}();n.a.FollowCameraMouseWheelInput=u}}]);

var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(d){var m=0;return function(){return m<d.length?{done:!1,value:d[m++]}:{done:!0}}};$jscomp.arrayIterator=function(d){return{next:$jscomp.arrayIteratorImpl(d)}};$jscomp.makeIterator=function(d){var m="undefined"!=typeof Symbol&&Symbol.iterator&&d[Symbol.iterator];return m?m.call(d):$jscomp.arrayIterator(d)};
$jscomp.getGlobal=function(d){return"undefined"!=typeof window&&window===d?d:"undefined"!=typeof global&&null!=global?global:d};$jscomp.global=$jscomp.getGlobal(this);$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(d,m,c){d!=Array.prototype&&d!=Object.prototype&&(d[m]=c.value)};
$jscomp.polyfill=function(d,m,c,k){if(m){c=$jscomp.global;d=d.split(".");for(k=0;k<d.length-1;k++){var b=d[k];b in c||(c[b]={});c=c[b]}d=d[d.length-1];k=c[d];m=m(k);m!=k&&null!=m&&$jscomp.defineProperty(c,d,{configurable:!0,writable:!0,value:m})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(d){function m(){this.batch_=null}function c(a){return a instanceof b?a:new b(function(b,p){b(a)})}if(d&&!$jscomp.FORCE_POLYFILL_PROMISE)return d;m.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var b=this;this.asyncExecuteFunction(function(){b.executeBatch_()})}this.batch_.push(a)};var k=$jscomp.global.setTimeout;m.prototype.asyncExecuteFunction=function(a){k(a,0)};m.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var p=a[b];a[b]=null;try{p()}catch(w){this.asyncThrow_(w)}}}this.batch_=null};m.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var b=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(p){b.reject(p)}};b.prototype.createResolveAndReject_=function(){function a(a){return function(c){p||(p=!0,a.call(b,c))}}var b=this,p=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};b.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof b)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var c=null!=a;break a;case "function":c=!0;break a;default:c=!1}c?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};b.prototype.resolveToNonPromiseObj_=function(a){var b=void 0;try{b=a.then}catch(p){this.reject_(p);return}"function"==typeof b?
this.settleSameAsThenable_(b,a):this.fulfill_(a)};b.prototype.reject_=function(a){this.settle_(2,a)};b.prototype.fulfill_=function(a){this.settle_(1,a)};b.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};b.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var b=0;b<this.onSettledCallbacks_.length;++b)a.asyncExecute(this.onSettledCallbacks_[b]);
this.onSettledCallbacks_=null}};var a=new m;b.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};b.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(w){c.reject(w)}};b.prototype.then=function(a,c){function p(a,b){return"function"==typeof a?function(b){try{d(a(b))}catch(u){k(u)}}:b}var d,k,l=new b(function(a,b){d=a;k=b});this.callWhenSettled_(p(a,d),p(c,k));return l};
b.prototype.catch=function(a){return this.then(void 0,a)};b.prototype.callWhenSettled_=function(b,c){function p(){switch(d.state_){case 1:b(d.result_);break;case 2:c(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?a.asyncExecute(p):this.onSettledCallbacks_.push(p)};b.resolve=c;b.reject=function(a){return new b(function(b,c){c(a)})};b.race=function(a){return new b(function(b,p){for(var d=$jscomp.makeIterator(a),k=d.next();!k.done;k=d.next())c(k.value).callWhenSettled_(b,
p)})};b.all=function(a){var d=$jscomp.makeIterator(a),p=d.next();return p.done?c([]):new b(function(a,b){function k(b){return function(c){l[b]=c;w--;0==w&&a(l)}}var l=[],w=0;do l.push(void 0),w++,c(p.value).callWhenSettled_(k(l.length-1),b),p=d.next();while(!p.done)})};return b},"es6","es3");$jscomp.checkEs6ConformanceViaProxy=function(){try{var d={},m=Object.create(new $jscomp.global.Proxy(d,{get:function(c,k,b){return c==d&&"q"==k&&b==m}}));return!0===m.q}catch(c){return!1}};
$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(d,m){this.$jscomp$symbol$id_=d;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:m})};
$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function d(c){if(this instanceof d)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+m++,c)}var m=0;return d}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var d=$jscomp.global.Symbol.iterator;d||(d=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[d]&&$jscomp.defineProperty(Array.prototype,d,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var d=$jscomp.global.Symbol.asyncIterator;d||(d=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(d){$jscomp.initSymbolIterator();d={next:d};d[$jscomp.global.Symbol.iterator]=function(){return this};return d};$jscomp.owns=function(d,m){return Object.prototype.hasOwnProperty.call(d,m)};
$jscomp.polyfill("WeakMap",function(d){function m(){if(!d||!Object.seal)return!1;try{var a=Object.seal({}),b=Object.seal({}),c=new d([[a,2],[b,3]]);if(2!=c.get(a)||3!=c.get(b))return!1;c.delete(a);c.set(b,4);return!c.has(a)&&4==c.get(b)}catch(x){return!1}}function c(){}function k(b){if(!$jscomp.owns(b,a)){var p=new c;$jscomp.defineProperty(b,a,{value:p})}}function b(a){var b=Object[a];b&&(Object[a]=function(a){if(a instanceof c)return a;k(a);return b(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(d&&
$jscomp.ES6_CONFORMANCE)return d}else if(m())return d;var a="$jscomp_hidden_"+Math.random();b("freeze");b("preventExtensions");b("seal");var l=0,n=function(a){this.id_=(l+=Math.random()+1).toString();if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};n.prototype.set=function(b,c){k(b);if(!$jscomp.owns(b,a))throw Error("WeakMap key fail: "+b);b[a][this.id_]=c;return this};n.prototype.get=function(b){return $jscomp.owns(b,a)?b[a][this.id_]:void 0};n.prototype.has=
function(b){return $jscomp.owns(b,a)&&$jscomp.owns(b[a],this.id_)};n.prototype.delete=function(b){return $jscomp.owns(b,a)&&$jscomp.owns(b[a],this.id_)?delete b[a][this.id_]:!1};return n},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(d){function m(){if($jscomp.ASSUME_NO_NATIVE_MAP||!d||"function"!=typeof d||!d.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),b=new d($jscomp.makeIterator([[a,"s"]]));if("s"!=b.get(a)||1!=b.size||b.get({x:4})||b.set({x:4},"t")!=b||2!=b.size)return!1;var c=b.entries(),k=c.next();if(k.done||k.value[0]!=a||"s"!=k.value[1])return!1;k=c.next();return k.done||4!=k.value[0].x||"t"!=k.value[1]||!c.next().done?!1:!0}catch(F){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(d&&$jscomp.ES6_CONFORMANCE)return d}else if(m())return d;$jscomp.initSymbolIterator();var c=new WeakMap,k=function(a){this.data_={};this.head_=l();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};k.prototype.set=function(a,c){a=0===a?0:a;var d=b(this,a);d.list||(d.list=this.data_[d.id]=[]);d.entry?d.entry.value=c:(d.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,
value:c},d.list.push(d.entry),this.head_.previous.next=d.entry,this.head_.previous=d.entry,this.size++);return this};k.prototype.delete=function(a){a=b(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};k.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=l();this.size=0};k.prototype.has=function(a){return!!b(this,a).entry};
k.prototype.get=function(a){return(a=b(this,a).entry)&&a.value};k.prototype.entries=function(){return a(this,function(a){return[a.key,a.value]})};k.prototype.keys=function(){return a(this,function(a){return a.key})};k.prototype.values=function(){return a(this,function(a){return a.value})};k.prototype.forEach=function(a,b){for(var c=this.entries(),d;!(d=c.next()).done;)d=d.value,a.call(b,d[1],d[0],this)};k.prototype[Symbol.iterator]=k.prototype.entries;var b=function(a,b){var d=b&&typeof b;"object"==
d||"function"==d?c.has(b)?d=c.get(b):(d=""+ ++n,c.set(b,d)):d="p_"+b;var k=a.data_[d];if(k&&$jscomp.owns(a.data_,d))for(a=0;a<k.length;a++){var l=k[a];if(b!==b&&l.key!==l.key||b===l.key)return{id:d,list:k,index:a,entry:l}}return{id:d,list:k,index:-1,entry:void 0}},a=function(a,b){var c=a.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=a.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})},l=function(){var a={};return a.previous=
a.next=a.head=a},n=0;return k},"es6","es3");
$jscomp.polyfill("Set",function(d){function m(){if($jscomp.ASSUME_NO_NATIVE_SET||!d||"function"!=typeof d||!d.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),b=new d($jscomp.makeIterator([c]));if(!b.has(c)||1!=b.size||b.add(c)!=b||1!=b.size||b.add({x:4})!=b||2!=b.size)return!1;var a=b.entries(),l=a.next();if(l.done||l.value[0]!=c||l.value[1]!=c)return!1;l=a.next();return l.done||l.value[0]==c||4!=l.value[0].x||l.value[1]!=l.value[0]?!1:a.next().done}catch(n){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(d&&$jscomp.ES6_CONFORMANCE)return d}else if(m())return d;$jscomp.initSymbolIterator();var c=function(c){this.map_=new Map;if(c){c=$jscomp.makeIterator(c);for(var b;!(b=c.next()).done;)this.add(b.value)}this.size=this.map_.size};c.prototype.add=function(c){c=0===c?0:c;this.map_.set(c,c);this.size=this.map_.size;return this};c.prototype.delete=function(c){c=this.map_.delete(c);this.size=this.map_.size;return c};c.prototype.clear=function(){this.map_.clear();
this.size=0};c.prototype.has=function(c){return this.map_.has(c)};c.prototype.entries=function(){return this.map_.entries()};c.prototype.values=function(){return this.map_.values()};c.prototype.keys=c.prototype.values;c.prototype[Symbol.iterator]=c.prototype.values;c.prototype.forEach=function(c,b){var a=this;this.map_.forEach(function(d){return c.call(b,d,d,a)})};return c},"es6","es3");
$jscomp.iteratorFromArray=function(d,m){$jscomp.initSymbolIterator();d instanceof String&&(d+="");var c=0,k={next:function(){if(c<d.length){var b=c++;return{value:m(b,d[b]),done:!1}}k.next=function(){return{done:!0,value:void 0}};return k.next()}};k[Symbol.iterator]=function(){return k};return k};$jscomp.polyfill("Array.prototype.keys",function(d){return d?d:function(){return $jscomp.iteratorFromArray(this,function(d){return d})}},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(d){return d?d:function(d,c,k){var b=this.length||0;0>c&&(c=Math.max(0,b+c));if(null==k||k>b)k=b;k=Number(k);0>k&&(k=Math.max(0,b+k));for(c=Number(c||0);c<k;c++)this[c]=d;return this}},"es6","es3");
(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{Bush:function(d,m,c){c.d(m,"a",function(){return k});var k=function(){function b(a){this._xrSessionManager=a;this._attached=!1;this._removeOnDetach=[];this.disableAutoAttach=this.isDisposed=!1;this.xrNativeFeatureName=""}Object.defineProperty(b.prototype,"attached",{get:function(){return this._attached},enumerable:!1,configurable:!0});b.prototype.attach=function(a){var b=this;if(this.isDisposed)return!1;if(a)this.attached&&this.detach();else if(this.attached)return!1;
this._attached=!0;this._addNewAttachObserver(this._xrSessionManager.onXRFrameObservable,function(a){return b._onXRFrame(a)});return!0};b.prototype.detach=function(){if(!this._attached)return this.disableAutoAttach=!0,!1;this._attached=!1;this._removeOnDetach.forEach(function(a){a.observable.remove(a.observer)});return!0};b.prototype.dispose=function(){this.detach();this.isDisposed=!0};b.prototype.isCompatible=function(){return!0};b.prototype._addNewAttachObserver=function(a,b){this._removeOnDetach.push({observable:a,
observer:a.add(b)})};return b}()},IBM0:function(d,m,c){c.d(m,"b",function(){return k.a});c.d(m,"a",function(){return z.a});c("NIHf");c("7FyR");c("SqQr");c("0bNo");c("78Wx");c("T8jy");var k=c("Ul6c");c("HD13");c("2+CT");var b=c("whcN");d=c("Bush");var a=c("oYeq"),l=c("ps+7"),n=c("/SR9"),p=c("YKqZ"),w=function(c){function f(a,b){void 0===b&&(b={});var e=c.call(this,a)||this;e.options=b;e._direction=new n.e(0,0,-1);e._mat=new n.a;e._onSelectEnabled=!1;e._origin=new n.e(0,0,0);e.lastNativeXRHitResults=
[];e.onHitTestResultObservable=new l.a;e._onHitTestResults=function(a){var b=a.map(function(a){var b=n.a.FromArray(a.hitMatrix);e._xrSessionManager.scene.useRightHandedSystem||b.toggleModelMatrixHandInPlace();e.options.worldParentNode&&b.multiplyToRef(e.options.worldParentNode.getWorldMatrix(),b);return{xrHitResult:a,transformationMatrix:b}});e.lastNativeXRHitResults=a;e.onHitTestResultObservable.notifyObservers(b)};e._onSelect=function(a){e._onSelectEnabled&&f.XRHitTestWithSelectEvent(a,e._xrSessionManager.referenceSpace)};
e.xrNativeFeatureName="hit-test";p.b.Warn("A newer version of this plugin is available");return e}Object(a.d)(f,c);f.XRHitTestWithRay=function(a,b,e,c){return a.requestHitTest(b,e).then(function(a){return a.filter(c||function(a){return!!a.hitMatrix})})};f.XRHitTestWithSelectEvent=function(a,b){var e=a.frame.getPose(a.inputSource.targetRaySpace,b);if(!e)return Promise.resolve([]);e=new XRRay(e.transform);return this.XRHitTestWithRay(a.frame.session,e,b)};f.prototype.attach=function(){if(!c.prototype.attach.call(this))return!1;
this.options.testOnPointerDownOnly&&this._xrSessionManager.session.addEventListener("select",this._onSelect,!1);return!0};f.prototype.detach=function(){if(!c.prototype.detach.call(this))return!1;this._onSelectEnabled=!1;this._xrSessionManager.session.removeEventListener("select",this._onSelect);return!0};f.prototype.dispose=function(){c.prototype.dispose.call(this);this.onHitTestResultObservable.clear()};f.prototype._onXRFrame=function(a){this.attached&&!this.options.testOnPointerDownOnly&&(a=a.getViewerPose(this._xrSessionManager.referenceSpace))&&
(n.a.FromArrayToRef(a.transform.matrix,0,this._mat),n.e.TransformCoordinatesFromFloatsToRef(0,0,0,this._mat,this._origin),n.e.TransformCoordinatesFromFloatsToRef(0,0,-1,this._mat,this._direction),this._direction.subtractInPlace(this._origin),this._direction.normalize(),a=new XRRay({x:this._origin.x,y:this._origin.y,z:this._origin.z,w:0},{x:this._direction.x,y:this._direction.y,z:this._direction.z,w:0}),f.XRHitTestWithRay(this._xrSessionManager.session,a,this._xrSessionManager.referenceSpace).then(this._onHitTestResults))};
f.Name=b.a.HIT_TEST;f.Version=1;return f}(d.a);b.b.AddWebXRFeature(w.Name,function(a,b){return function(){return new w(a,b)}},w.Version,!1);var D=0,x=function(c){function f(a,b){void 0===b&&(b={});a=c.call(this,a)||this;a._options=b;a._lastFrameDetected=new Set;a._trackedAnchors=[];a._futureAnchors=[];a.onAnchorAddedObservable=new l.a;a.onAnchorRemovedObservable=new l.a;a.onAnchorUpdatedObservable=new l.a;a._tmpVector=new n.e;a._tmpQuaternion=new n.b;a.xrNativeFeatureName="anchors";return a}Object(a.d)(f,
c);Object.defineProperty(f.prototype,"referenceSpaceForFrameAnchors",{set:function(a){this._referenceSpaceForFrameAnchors=a},enumerable:!1,configurable:!0});f.prototype._populateTmpTransformation=function(a,b){this._tmpVector.copyFrom(a);this._tmpQuaternion.copyFrom(b);this._xrSessionManager.scene.useRightHandedSystem||(this._tmpVector.z*=-1,this._tmpQuaternion.z*=-1,this._tmpQuaternion.w*=-1);return{position:this._tmpVector,rotationQuaternion:this._tmpQuaternion}};f.prototype.addAnchorPointUsingHitTestResultAsync=
function(b,c,e){void 0===c&&(c=new n.e);void 0===e&&(e=new n.b);return Object(a.b)(this,void 0,void 0,function(){var C,f,g,d=this;return Object(a.e)(this,function(a){switch(a.label){case 0:this._populateTmpTransformation(c,e);C=new XRRigidTransform({x:this._tmpVector.x,y:this._tmpVector.y,z:this._tmpVector.z},{x:this._tmpQuaternion.x,y:this._tmpQuaternion.y,z:this._tmpQuaternion.z,w:this._tmpQuaternion.w});if(b.xrHitResult.createAnchor)return[3,1];this.detach();throw Error("Anchors not enabled in this environment/browser");
case 1:return a.trys.push([1,3,,4]),[4,b.xrHitResult.createAnchor(C)];case 2:return f=a.sent(),[2,new Promise(function(a,b){d._futureAnchors.push({nativeAnchor:f,resolved:!1,submitted:!0,xrTransformation:C,resolve:a,reject:b})})];case 3:throw g=a.sent(),Error(g);case 4:return[2]}})})};f.prototype.addAnchorAtPositionAndRotationAsync=function(b,c,e){void 0===c&&(c=new n.b);void 0===e&&(e=!1);return Object(a.b)(this,void 0,void 0,function(){var C,f,g,d=this;return Object(a.e)(this,function(a){switch(a.label){case 0:return this._populateTmpTransformation(b,
c),C=new XRRigidTransform({x:this._tmpVector.x,y:this._tmpVector.y,z:this._tmpVector.z},{x:this._tmpQuaternion.x,y:this._tmpQuaternion.y,z:this._tmpQuaternion.z,w:this._tmpQuaternion.w}),e&&this.attached&&this._xrSessionManager.currentFrame?[4,this._createAnchorAtTransformation(C,this._xrSessionManager.currentFrame)]:[3,2];case 1:return g=a.sent(),[3,3];case 2:g=void 0,a.label=3;case 3:return f=g,[2,new Promise(function(a,b){d._futureAnchors.push({nativeAnchor:f,resolved:!1,submitted:!1,xrTransformation:C,
resolve:a,reject:b})})]}})})};Object.defineProperty(f.prototype,"anchors",{get:function(){return this._trackedAnchors},enumerable:!1,configurable:!0});f.prototype.detach=function(){if(!c.prototype.detach.call(this))return!1;if(!this._options.doNotRemoveAnchorsOnSessionEnded)for(;this._trackedAnchors.length;){var a=this._trackedAnchors.pop();if(a){try{a.remove()}catch(C){}this.onAnchorRemovedObservable.notifyObservers(a)}}return!0};f.prototype.dispose=function(){this._futureAnchors.length=0;c.prototype.dispose.call(this);
this.onAnchorAddedObservable.clear();this.onAnchorRemovedObservable.clear();this.onAnchorUpdatedObservable.clear()};f.prototype._onXRFrame=function(a){var b=this;if(this.attached&&a){var c=a.trackedAnchors;if(c){var f=0;this._trackedAnchors.filter(function(a){return!c.has(a.xrAnchor)}).map(function(a){return b._trackedAnchors.indexOf(a)}).forEach(function(a){a=b._trackedAnchors.splice(a-f,1)[0];b.onAnchorRemovedObservable.notifyObservers(a);f++});c.forEach(function(c){if(b._lastFrameDetected.has(c)){var e=
b._findIndexInAnchorArray(c);e=b._trackedAnchors[e];try{b._updateAnchorWithXRFrame(c,e,a),e.attachedNode&&(e.attachedNode.rotationQuaternion=e.attachedNode.rotationQuaternion||new n.b,e.transformationMatrix.decompose(e.attachedNode.scaling,e.attachedNode.rotationQuaternion,e.attachedNode.position)),b.onAnchorUpdatedObservable.notifyObservers(e)}catch(M){p.b.Warn("Anchor could not be updated")}}else{e={id:D++,xrAnchor:c,remove:c.delete};e=b._updateAnchorWithXRFrame(c,e,a);b._trackedAnchors.push(e);
b.onAnchorAddedObservable.notifyObservers(e);var f=b._futureAnchors.filter(function(a){return a.nativeAnchor===c})[0];f&&(f.resolve(e),f.resolved=!0)}});this._lastFrameDetected=c}this._futureAnchors.forEach(function(c){c.resolved||c.submitted||(b._createAnchorAtTransformation(c.xrTransformation,a).then(function(a){c.nativeAnchor=a},function(a){c.resolved=!0;c.reject(a)}),c.submitted=!0)})}};f.prototype._findIndexInAnchorArray=function(a){for(var b=0;b<this._trackedAnchors.length;++b)if(this._trackedAnchors[b].xrAnchor===
a)return b;return-1};f.prototype._updateAnchorWithXRFrame=function(a,b,c){if(a=c.getPose(a.anchorSpace,this._xrSessionManager.referenceSpace))c=b.transformationMatrix||new n.a,n.a.FromArrayToRef(a.transform.matrix,0,c),this._xrSessionManager.scene.useRightHandedSystem||c.toggleModelMatrixHandInPlace(),b.transformationMatrix=c,this._options.worldParentNode&&c.multiplyToRef(this._options.worldParentNode.getWorldMatrix(),c);return b};f.prototype._createAnchorAtTransformation=function(b,c){var e;return Object(a.b)(this,
void 0,void 0,function(){return Object(a.e)(this,function(a){if(c.createAnchor)try{return[2,c.createAnchor(b,null!==(e=this._referenceSpaceForFrameAnchors)&&void 0!==e?e:this._xrSessionManager.referenceSpace)]}catch(K){throw Error(K);}else throw this.detach(),Error("Anchors are not enabled in your browser");})})};f.Name=b.a.ANCHOR_SYSTEM;f.Version=1;return f}(d.a);b.b.AddWebXRFeature(x.Name,function(a,b){return function(){return new x(a,b)}},x.Version);var F=0,y=function(c){function f(a,b){void 0===
b&&(b={});var e=c.call(this,a)||this;e._options=b;e._detectedPlanes=[];e._enabled=!1;e._lastFrameDetected=new Set;e.onPlaneAddedObservable=new l.a;e.onPlaneRemovedObservable=new l.a;e.onPlaneUpdatedObservable=new l.a;e.xrNativeFeatureName="plane-detection";e._xrSessionManager.session?e._init():e._xrSessionManager.onXRSessionInit.addOnce(function(){e._init()});return e}Object(a.d)(f,c);f.prototype.detach=function(){if(!c.prototype.detach.call(this))return!1;if(!this._options.doNotRemovePlanesOnSessionEnded)for(;this._detectedPlanes.length;){var a=
this._detectedPlanes.pop();a&&this.onPlaneRemovedObservable.notifyObservers(a)}return!0};f.prototype.dispose=function(){c.prototype.dispose.call(this);this.onPlaneAddedObservable.clear();this.onPlaneRemovedObservable.clear();this.onPlaneUpdatedObservable.clear()};f.prototype.isCompatible=function(){return"undefined"!==typeof XRPlane};f.prototype._onXRFrame=function(a){var b=this;if(this.attached&&this._enabled&&a){var c=a.worldInformation.detectedPlanes;if(c){var f=0;this._detectedPlanes.filter(function(a){return!c.has(a.xrPlane)}).map(function(a){return b._detectedPlanes.indexOf(a)}).forEach(function(a){a=
b._detectedPlanes.splice(a-f,1)[0];b.onPlaneRemovedObservable.notifyObservers(a);f++});c.forEach(function(c){if(b._lastFrameDetected.has(c))c.lastChangedTime===b._xrSessionManager.currentTimestamp&&(e=b.findIndexInPlaneArray(c),e=b._detectedPlanes[e],b._updatePlaneWithXRPlane(c,e,a),b.onPlaneUpdatedObservable.notifyObservers(e));else{var e={id:F++,xrPlane:c,polygonDefinition:[]};e=b._updatePlaneWithXRPlane(c,e,a);b._detectedPlanes.push(e);b.onPlaneAddedObservable.notifyObservers(e)}});this._lastFrameDetected=
c}}};f.prototype._init=function(){var a=this,b,c,f=function(){a._enabled=!0;a._detectedPlanes.length&&(a._detectedPlanes.length=0)};this._xrSessionManager.session.updateWorldTrackingState?(this._xrSessionManager.session.updateWorldTrackingState({planeDetectionState:{enabled:!0}}),f()):(null===(c=null===(b=this._xrSessionManager.session.worldTrackingState)||void 0===b?void 0:b.planeDetectionState)||void 0===c?0:c.enabled)&&f()};f.prototype._updatePlaneWithXRPlane=function(a,b,c){var e=this;b.polygonDefinition=
a.polygon.map(function(a){return new n.e(a.x,a.y,a.z*(e._xrSessionManager.scene.useRightHandedSystem?1:-1))});if(a=c.getPose(a.planeSpace,this._xrSessionManager.referenceSpace))c=b.transformationMatrix||new n.a,n.a.FromArrayToRef(a.transform.matrix,0,c),this._xrSessionManager.scene.useRightHandedSystem||c.toggleModelMatrixHandInPlace(),b.transformationMatrix=c,this._options.worldParentNode&&c.multiplyToRef(this._options.worldParentNode.getWorldMatrix(),c);return b};f.prototype.findIndexInPlaneArray=
function(a){for(var b=0;b<this._detectedPlanes.length;++b)if(this._detectedPlanes[b].xrPlane===a)return b;return-1};f.Name=b.a.PLANE_DETECTION;f.Version=1;return f}(d.a);b.b.AddWebXRFeature(y.Name,function(a,b){return function(){return new y(a,b)}},y.Version);var E=function(c){function f(a,b){void 0===b&&(b={});a=c.call(this,a)||this;a.options=b;a.onBackgroundStateChangedObservable=new l.a;return a}Object(a.d)(f,c);f.prototype.attach=function(){this._setBackgroundState(!1);return c.prototype.attach.call(this)};
f.prototype.detach=function(){this._setBackgroundState(!0);return c.prototype.detach.call(this)};f.prototype.dispose=function(){c.prototype.dispose.call(this);this.onBackgroundStateChangedObservable.clear()};f.prototype._onXRFrame=function(a){};f.prototype._setBackgroundState=function(a){var b=this._xrSessionManager.scene;if(!this.options.ignoreEnvironmentHelper)if(this.options.environmentHelperRemovalFlags){if(this.options.environmentHelperRemovalFlags.skyBox){var c=b.getMeshByName("BackgroundSkybox");
c&&c.setEnabled(a)}this.options.environmentHelperRemovalFlags.ground&&(b=b.getMeshByName("BackgroundPlane"))&&b.setEnabled(a)}else(b=b.getMeshByName("BackgroundHelper"))&&b.setEnabled(a);this.options.backgroundMeshes&&this.options.backgroundMeshes.forEach(function(b){return b.setEnabled(a)});this.onBackgroundStateChangedObservable.notifyObservers(a)};f.Name=b.a.BACKGROUND_REMOVER;f.Version=1;return f}(d.a);b.b.AddWebXRFeature(E.Name,function(a,b){return function(){return new E(a,b)}},E.Version,!0);
c("is1F");c("TTtC");var u=c("LVN+"),H=c("H22S"),J=c("uyO6");(function(){return function(){}})();var r=function(c){function f(b,f){var e=c.call(this,b)||this;e._options=f;e._attachController=function(b){if(!e._controllers[b.uniqueId])if(e._xrSessionManager.scene.isPhysicsEnabled()||J.a.Warn("physics engine not enabled, skipped. Please add this controller manually."),e._options.physicsProperties.useControllerMesh&&b.inputSource.gamepad)b.onMotionControllerInitObservable.addOnce(function(c){c.onModelLoadedObservable.addOnce(function(){var f=
new u.a(c.rootMesh,u.a.MeshImpostor,Object(a.a)({mass:0},e._options.physicsProperties)),g=b.grip||b.pointer;e._controllers[b.uniqueId]={xrController:b,impostor:f,oldPos:g.position.clone(),oldRotation:g.rotationQuaternion.clone()}})});else{var c=e._options.physicsProperties.impostorType||u.a.SphereImpostor,f=e._options.physicsProperties.impostorSize||.1;f=H.a.CreateSphere("impostor-mesh-"+b.uniqueId,{diameterX:"number"===typeof f?f:f.width,diameterY:"number"===typeof f?f:f.height,diameterZ:"number"===
typeof f?f:f.depth});f.isVisible=e._debugMode;f.isPickable=!1;f.rotationQuaternion=new n.b;var g=b.grip||b.pointer;f.position.copyFrom(g.position);f.rotationQuaternion.copyFrom(g.rotationQuaternion);c=new u.a(f,c,Object(a.a)({mass:0},e._options.physicsProperties));e._controllers[b.uniqueId]={xrController:b,impostor:c,impostorMesh:f}}};e._controllers={};e._debugMode=!1;e._delta=0;e._lastTimestamp=0;e._tmpQuaternion=new n.b;e._tmpVector=new n.e;e._options.physicsProperties||(e._options.physicsProperties=
{});return e}Object(a.d)(f,c);f.prototype._enablePhysicsDebug=function(){var a=this;this._debugMode=!0;Object.keys(this._controllers).forEach(function(b){b=a._controllers[b];b.impostorMesh&&(b.impostorMesh.isVisible=!0)})};f.prototype.addController=function(a){this._attachController(a)};f.prototype.attach=function(){var b=this;if(!c.prototype.attach.call(this))return!1;if(!this._options.xrInput)return!0;this._options.xrInput.controllers.forEach(this._attachController);this._addNewAttachObserver(this._options.xrInput.onControllerAddedObservable,
this._attachController);this._addNewAttachObserver(this._options.xrInput.onControllerRemovedObservable,function(a){b._detachController(a.uniqueId)});if(this._options.enableHeadsetImpostor){var f=this._options.headsetImpostorParams||{impostorType:u.a.SphereImpostor,restitution:.8,impostorSize:.3},e=f.impostorSize||.3;this._headsetMesh=H.a.CreateSphere("headset-mesh",{diameterX:"number"===typeof e?e:e.width,diameterY:"number"===typeof e?e:e.height,diameterZ:"number"===typeof e?e:e.depth});this._headsetMesh.rotationQuaternion=
new n.b;this._headsetMesh.isVisible=!1;this._headsetImpostor=new u.a(this._headsetMesh,f.impostorType,Object(a.a)({mass:0},f))}return!0};f.prototype.detach=function(){var a=this;if(!c.prototype.detach.call(this))return!1;Object.keys(this._controllers).forEach(function(b){a._detachController(b)});this._headsetMesh&&this._headsetMesh.dispose();return!0};f.prototype.getHeadsetImpostor=function(){return this._headsetImpostor};f.prototype.getImpostorForController=function(a){a="string"===typeof a?a:a.uniqueId;
return this._controllers[a]?this._controllers[a].impostor:null};f.prototype.setPhysicsProperties=function(b){this._options.physicsProperties=Object(a.a)(Object(a.a)({},this._options.physicsProperties),b)};f.prototype._onXRFrame=function(a){var b=this;this._delta=this._xrSessionManager.currentTimestamp-this._lastTimestamp;this._lastTimestamp=this._xrSessionManager.currentTimestamp;this._headsetMesh&&(this._headsetMesh.position.copyFrom(this._options.xrInput.xrCamera.position),this._headsetMesh.rotationQuaternion.copyFrom(this._options.xrInput.xrCamera.rotationQuaternion));
Object.keys(this._controllers).forEach(function(a){a=b._controllers[a];var c=a.xrController.grip||a.xrController.pointer,e=a.oldPos||a.impostorMesh.position,f=a.oldRotation||a.impostorMesh.rotationQuaternion;c.position.subtractToRef(e,b._tmpVector);b._tmpVector.scaleInPlace(1E3/b._delta);a.impostor.setLinearVelocity(b._tmpVector);b._debugMode&&console.log(b._tmpVector,"linear");if(!f.equalsWithEpsilon(c.rotationQuaternion)){f.conjugateInPlace().multiplyToRef(c.rotationQuaternion,b._tmpQuaternion);
var g=Math.sqrt(b._tmpQuaternion.x*b._tmpQuaternion.x+b._tmpQuaternion.y*b._tmpQuaternion.y+b._tmpQuaternion.z*b._tmpQuaternion.z);b._tmpVector.set(b._tmpQuaternion.x,b._tmpQuaternion.y,b._tmpQuaternion.z);.001>g?b._tmpVector.scaleInPlace(2):b._tmpVector.scaleInPlace(2*Math.atan2(g,b._tmpQuaternion.w)/(b._delta/1E3*g));a.impostor.setAngularVelocity(b._tmpVector);b._debugMode&&console.log(b._tmpVector,b._tmpQuaternion,"angular")}e.copyFrom(c.position);f.copyFrom(c.rotationQuaternion)})};f.prototype._detachController=
function(a){var b=this._controllers[a];b&&(b.impostorMesh&&b.impostorMesh.dispose(),delete this._controllers[a])};f.Name=b.a.PHYSICS_CONTROLLERS;f.Version=1;return f}(d.a);b.b.AddWebXRFeature(r.Name,function(a,b){return function(){return new r(a,b)}},r.Version,!0);var q=function(c){function f(a,b){void 0===b&&(b={});var e=c.call(this,a)||this;e.options=b;e._tmpMat=new n.a;e._tmpPos=new n.e;e._tmpQuat=new n.b;e.initHitTestSource=function(a){if(a){var b=new XRRay(e.options.offsetRay||{});a={space:e.options.useReferenceSpace?
a:e._xrSessionManager.viewerReferenceSpace,offsetRay:b};e.options.entityTypes&&(a.entityTypes=e.options.entityTypes);a.space?e._xrSessionManager.session.requestHitTestSource(a).then(function(a){e._xrHitTestSource&&e._xrHitTestSource.cancel();e._xrHitTestSource=a}):p.b.Warn("waiting for viewer reference space to initialize")}};e.autoCloneTransformation=!1;e.onHitTestResultObservable=new l.a;e.paused=!1;e.xrNativeFeatureName="hit-test";p.b.Warn("Hit test is an experimental and unstable feature.");return e}
Object(a.d)(f,c);f.prototype.attach=function(){var a=this;if(!c.prototype.attach.call(this)||!this._xrSessionManager.session.requestHitTestSource)return!1;this.options.disablePermanentHitTest||(this._xrSessionManager.referenceSpace&&this.initHitTestSource(this._xrSessionManager.referenceSpace),this._xrSessionManager.onXRReferenceSpaceChanged.add(this.initHitTestSource));if(this.options.enableTransientHitTest){var b=new XRRay(this.options.transientOffsetRay||{});this._xrSessionManager.session.requestHitTestSourceForTransientInput({profile:"generic-touchscreen",
offsetRay:b,entityTypes:this.options.entityTypes}).then(function(b){a._transientXrHitTestSource=b})}return!0};f.prototype.detach=function(){if(!c.prototype.detach.call(this))return!1;this._xrHitTestSource&&(this._xrHitTestSource.cancel(),this._xrHitTestSource=null);this._xrSessionManager.onXRReferenceSpaceChanged.removeCallback(this.initHitTestSource);this._transientXrHitTestSource&&(this._transientXrHitTestSource.cancel(),this._transientXrHitTestSource=null);return!0};f.prototype.dispose=function(){c.prototype.dispose.call(this);
this.onHitTestResultObservable.clear()};f.prototype._onXRFrame=function(a){var b=this;if(this.attached&&!this.paused){if(this._xrHitTestSource){var c=a.getHitTestResults(this._xrHitTestSource);this._processWebXRHitTestResult(c)}this._transientXrHitTestSource&&a.getHitTestResultsForTransientInput(this._transientXrHitTestSource).forEach(function(a){b._processWebXRHitTestResult(a.results,a.inputSource)})}};f.prototype._processWebXRHitTestResult=function(a,b){var c=this,f=[];a.forEach(function(a){var e=
a.getPose(c._xrSessionManager.referenceSpace);if(e){var g=e.transform.position,d=e.transform.orientation;c._tmpPos.set(g.x,g.y,g.z);c._tmpQuat.set(d.x,d.y,d.z,d.w);n.a.FromFloat32ArrayToRefScaled(e.transform.matrix,0,1,c._tmpMat);c._xrSessionManager.scene.useRightHandedSystem||(c._tmpPos.z*=-1,c._tmpQuat.z*=-1,c._tmpQuat.w*=-1,c._tmpMat.toggleModelMatrixHandInPlace());a={position:c.autoCloneTransformation?c._tmpPos.clone():c._tmpPos,rotationQuaternion:c.autoCloneTransformation?c._tmpQuat.clone():
c._tmpQuat,transformationMatrix:c.autoCloneTransformation?c._tmpMat.clone():c._tmpMat,inputSource:b,isTransient:!!b,xrHitResult:a};f.push(a)}});this.onHitTestResultObservable.notifyObservers(f)};f.Name=b.a.HIT_TEST;f.Version=2;return f}(d.a);b.b.AddWebXRFeature(q.Name,function(a,b){return function(){return new q(a,b)}},q.Version,!1);var g=function(c){function f(a){var b=c.call(this,a)||this;b._enabled=!1;b._featurePointCloud=[];b.onFeaturePointsAddedObservable=new l.a;b.onFeaturePointsUpdatedObservable=
new l.a;b.xrNativeFeatureName="bjsfeature-points";b._xrSessionManager.session?b._init():b._xrSessionManager.onXRSessionInit.addOnce(function(){b._init()});return b}Object(a.d)(f,c);Object.defineProperty(f.prototype,"featurePointCloud",{get:function(){return this._featurePointCloud},enumerable:!1,configurable:!0});f.prototype.detach=function(){if(!c.prototype.detach.call(this))return!1;this.featurePointCloud.length=0;return!0};f.prototype.dispose=function(){c.prototype.dispose.call(this);this._featurePointCloud.length=
0;this.onFeaturePointsUpdatedObservable.clear();this.onFeaturePointsAddedObservable.clear()};f.prototype._onXRFrame=function(a){if(this.attached&&this._enabled&&a&&(a=a.featurePointCloud)&&0!==a.length){if(0!==a.length%5)throw Error("Received malformed feature point cloud of length: "+a.length);for(var b=a.length/5,c=[],f=[],g=0;g<b;g++){var d=5*g,h=a[d+4];this._featurePointCloud[h]?c.push(h):(this._featurePointCloud[h]={position:new n.e,confidenceValue:0},f.push(h));this._featurePointCloud[h].position.x=
a[d];this._featurePointCloud[h].position.y=a[d+1];this._featurePointCloud[h].position.z=a[d+2];this._featurePointCloud[h].confidenceValue=a[d+3]}0<f.length&&this.onFeaturePointsAddedObservable.notifyObservers(f);0<c.length&&this.onFeaturePointsUpdatedObservable.notifyObservers(c)}};f.prototype._init=function(){this._xrSessionManager.session.trySetFeaturePointCloudEnabled&&this._xrSessionManager.session.trySetFeaturePointCloudEnabled(!0)&&(this._enabled=!0)};f.Name=b.a.FEATURE_POINTS;f.Version=1;return f}(d.a);
b.b.AddWebXRFeature(g.Name,function(a){return function(){return new g(a)}},g.Version);var G=c("R0D4"),A=c("Xeau"),L=c("MNkK"),B=c("cdI9"),v=c("qUIE"),I=c("SYzJ"),h=function(){function b(a,b,c,e,g){this.xrController=a;this.trackedMeshes=b;this._handMesh=c;this._rigMapping=e;this._defaultHandMesh=!1;this._transformNodeMapping=[];this.handPartsDefinition=this.generateHandPartsDefinition(a.inputSource.hand);this._scene=b[0].getScene();this._handMesh&&this._rigMapping?this._defaultHandMesh=!1:g||this._generateDefaultHandMesh();
this.xrController.motionController&&(this.xrController.motionController.rootMesh?this.xrController.motionController.rootMesh.setEnabled(!1):this.xrController.motionController.onModelLoadedObservable.add(function(a){a.rootMesh&&a.rootMesh.setEnabled(!1)}));this.xrController.onMotionControllerInitObservable.add(function(a){a.onModelLoadedObservable.add(function(a){a.rootMesh&&a.rootMesh.setEnabled(!1)});a.rootMesh&&a.rootMesh.setEnabled(!1)})}b.prototype.generateHandPartsDefinition=function(a){var b;
return b={},b.wrist=[a.WRIST],b.thumb=[a.THUMB_METACARPAL,a.THUMB_PHALANX_PROXIMAL,a.THUMB_PHALANX_DISTAL,a.THUMB_PHALANX_TIP],b.index=[a.INDEX_METACARPAL,a.INDEX_PHALANX_PROXIMAL,a.INDEX_PHALANX_INTERMEDIATE,a.INDEX_PHALANX_DISTAL,a.INDEX_PHALANX_TIP],b.middle=[a.MIDDLE_METACARPAL,a.MIDDLE_PHALANX_PROXIMAL,a.MIDDLE_PHALANX_INTERMEDIATE,a.MIDDLE_PHALANX_DISTAL,a.MIDDLE_PHALANX_TIP],b.ring=[a.RING_METACARPAL,a.RING_PHALANX_PROXIMAL,a.RING_PHALANX_INTERMEDIATE,a.RING_PHALANX_DISTAL,a.RING_PHALANX_TIP],
b.little=[a.LITTLE_METACARPAL,a.LITTLE_PHALANX_PROXIMAL,a.LITTLE_PHALANX_INTERMEDIATE,a.LITTLE_PHALANX_DISTAL,a.LITTLE_PHALANX_TIP],b};b.prototype.updateFromXRFrame=function(a,b,c){var e=this;void 0===c&&(c=2);var g=this.xrController.inputSource.hand;g&&this.trackedMeshes.forEach(function(f,d){var h=g[d];if(h&&(h=a.getJointPose(h,b))&&h.transform){var q=h.transform.position,v=h.transform.orientation;f.position.set(q.x,q.y,q.z);f.rotationQuaternion.set(v.x,v.y,v.z,v.w);h=(h.radius||.008)*c;f.scaling.set(h,
h,h);e._handMesh&&e._rigMapping&&e._rigMapping[d]&&(e._transformNodeMapping[d]=e._transformNodeMapping[d]||e._scene.getTransformNodeByName(e._rigMapping[d]),e._transformNodeMapping[d]&&(e._transformNodeMapping[d].position.copyFrom(f.position),e._transformNodeMapping[d].rotationQuaternion.copyFrom(f.rotationQuaternion),f.isVisible=!1));f.getScene().useRightHandedSystem||(f.position.z*=-1,f.rotationQuaternion.z*=-1,f.rotationQuaternion.w*=-1)}})};b.prototype.getHandPartMeshes=function(a){var b=this;
return this.handPartsDefinition[a].map(function(a){return b.trackedMeshes[a]})};b.prototype.dispose=function(){this.trackedMeshes.forEach(function(a){return a.dispose()});this._defaultHandMesh&&this._handMesh&&this._handMesh.dispose()};b.prototype._generateDefaultHandMesh=function(){return Object(a.b)(this,void 0,void 0,function(){var b,c,g,e,d,h,q,k,r,l,z,t,m,n;return Object(a.e)(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),r="right"===this.xrController.inputSource.handedness?
"right":"left",l=("right"===r?"r":"l")+"_hand_"+(this._scene.useRightHandedSystem?"r":"l")+"hs.glb",[4,G.a.ImportMeshAsync("","https://assets.babylonjs.com/meshes/HandMeshes/",l,this._scene)];case 1:return z=a.sent(),d=A.a.FromInts(116,63,203),h=A.a.FromInts(149,102,229),q=A.a.FromInts(177,130,255),k=A.a.FromInts(220,200,255),t=new L.a("leftHandShader",this._scene,{emitComments:!1}),[4,t.loadAsync("https://patrickryanms.github.io/BabylonJStextures/Demos/xrHandMesh/handsShader.json")];case 2:a.sent();
t.build(!1);t.needDepthPrePass=!0;t.transparencyMode=B.a.MATERIAL_ALPHABLEND;t.alphaMode=v.a.ALPHA_COMBINE;b=t.getBlockByName("baseColor");c=t.getBlockByName("fresnelColor");g=t.getBlockByName("fingerColor");e=t.getBlockByName("tipFresnelColor");b.value=d;c.value=h;g.value=q;e.value=k;z.meshes[1].material=t;this._defaultHandMesh=!0;this._handMesh=z.meshes[0];this._rigMapping="wrist_ thumb_metacarpal_ thumb_proxPhalanx_ thumb_distPhalanx_ thumb_tip_ index_metacarpal_ index_proxPhalanx_ index_intPhalanx_ index_distPhalanx_ index_tip_ middle_metacarpal_ middle_proxPhalanx_ middle_intPhalanx_ middle_distPhalanx_ middle_tip_ ring_metacarpal_ ring_proxPhalanx_ ring_intPhalanx_ ring_distPhalanx_ ring_tip_ little_metacarpal_ little_proxPhalanx_ little_intPhalanx_ little_distPhalanx_ little_tip_".split(" ").map(function(a){return""+
a+("right"===r?"R":"L")});if(m=this._scene.getTransformNodeByName(this._rigMapping[0]))m.parent&&m.parent.rotate(I.a.Y,Math.PI);else throw Error("could not find the wrist node");return[3,4];case 3:return n=a.sent(),p.b.Error("error loading hand mesh"),console.log(n),[3,4];case 4:return[2]}})})};return b}(),t=function(c){function g(b,d){var e=c.call(this,b)||this;e.options=d;e.onHandAddedObservable=new l.a;e.onHandRemovedObservable=new l.a;e._hands={};e._attachHand=function(b){var c,d,f,q,v,k,r,t,
l,z;if(b.inputSource.hand&&!e._hands[b.uniqueId]){var G=b.inputSource.hand,m=[],I=(null===(c=e.options.jointMeshes)||void 0===c?void 0:c.sourceMesh)||H.a.CreateSphere("jointParent",{diameter:1});I.isVisible=!(null===(d=e.options.jointMeshes)||void 0===d||!d.keepOriginalVisible);for(c=0;c<G.length;++c){d=I.createInstance(b.uniqueId+"-handJoint-"+c);if(null===(f=e.options.jointMeshes)||void 0===f?0:f.onHandJointMeshGenerated){var B=e.options.jointMeshes.onHandJointMeshGenerated(d,c,b.uniqueId);B&&B!==
d&&(d.dispose(),d=B)}d.isPickable=!1;if(null===(q=e.options.jointMeshes)||void 0===q?0:q.enablePhysics)B=e.options.jointMeshes.physicsProps||{},d.physicsImpostor=new u.a(d,void 0!==B.impostorType?B.impostorType:u.a.SphereImpostor,Object(a.a)({mass:0},B));d.rotationQuaternion=new n.b;if(null===(v=e.options.jointMeshes)||void 0===v?0:v.invisible)d.isVisible=!1;m.push(d)}q="right"===b.inputSource.handedness?"right":"left";f=(null===(k=e.options.jointMeshes)||void 0===k?void 0:k.handMeshes)&&(null===
(r=e.options.jointMeshes)||void 0===r?void 0:r.handMeshes[q]);k=(null===(t=e.options.jointMeshes)||void 0===t?void 0:t.rigMapping)&&(null===(l=e.options.jointMeshes)||void 0===l?void 0:l.rigMapping[q]);t=new h(b,m,f,k,null===(z=e.options.jointMeshes)||void 0===z?void 0:z.disableDefaultHandMesh);e._hands[b.uniqueId]={handObject:t,id:g._idCounter++};e.onHandAddedObservable.notifyObservers(t)}};e.xrNativeFeatureName="hand-tracking";return e}Object(a.d)(g,c);g.prototype.isCompatible=function(){return"undefined"!==
typeof XRHand};g.prototype.attach=function(){var a=this;if(!c.prototype.attach.call(this))return!1;this.options.xrInput.controllers.forEach(this._attachHand);this._addNewAttachObserver(this.options.xrInput.onControllerAddedObservable,this._attachHand);this._addNewAttachObserver(this.options.xrInput.onControllerRemovedObservable,function(b){a._detachHand(b.uniqueId)});return!0};g.prototype.detach=function(){var a=this;if(!c.prototype.detach.call(this))return!1;Object.keys(this._hands).forEach(function(b){a._detachHand(b)});
return!0};g.prototype.dispose=function(){c.prototype.dispose.call(this);this.onHandAddedObservable.clear()};g.prototype.getHandByControllerId=function(a){var b;return(null===(b=this._hands[a])||void 0===b?void 0:b.handObject)||null};g.prototype.getHandByHandedness=function(a){var b=this;a=Object.keys(this._hands).map(function(a){return b._hands[a].handObject.xrController.inputSource.handedness}).indexOf(a);return-1!==a?this._hands[a].handObject:null};g.prototype._onXRFrame=function(a){var b=this;
Object.keys(this._hands).forEach(function(c){var g;b._hands[c].handObject.updateFromXRFrame(a,b._xrSessionManager.referenceSpace,null===(g=b.options.jointMeshes)||void 0===g?void 0:g.scaleFactor)})};g.prototype._detachHand=function(a){this._hands[a]&&(this.onHandRemovedObservable.notifyObservers(this._hands[a].handObject),this._hands[a].handObject.dispose())};g._idCounter=0;g.Name=b.a.HAND_TRACKING;g.Version=1;return g}(d.a);b.b.AddWebXRFeature(t.Name,function(a,b){return function(){return new t(a,
b)}},t.Version,!1);var z=c("dcOm")},J7JH:function(d,m,c){c.d(m,"a",function(){return k});var k=function(){function b(){this._alphaBlend=this._isBlendConstantsDirty=this._isBlendEquationParametersDirty=this._isBlendFunctionParametersDirty=this._isAlphaBlendDirty=!1;this._blendFunctionParameters=Array(4);this._blendEquationParameters=Array(2);this._blendConstants=Array(4);this.reset()}Object.defineProperty(b.prototype,"isDirty",{get:function(){return this._isAlphaBlendDirty||this._isBlendFunctionParametersDirty},
enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"alphaBlend",{get:function(){return this._alphaBlend},set:function(a){this._alphaBlend!==a&&(this._alphaBlend=a,this._isAlphaBlendDirty=!0)},enumerable:!1,configurable:!0});b.prototype.setAlphaBlendConstants=function(a,b,c,d){if(this._blendConstants[0]!==a||this._blendConstants[1]!==b||this._blendConstants[2]!==c||this._blendConstants[3]!==d)this._blendConstants[0]=a,this._blendConstants[1]=b,this._blendConstants[2]=c,this._blendConstants[3]=
d,this._isBlendConstantsDirty=!0};b.prototype.setAlphaBlendFunctionParameters=function(a,b,c,d){if(this._blendFunctionParameters[0]!==a||this._blendFunctionParameters[1]!==b||this._blendFunctionParameters[2]!==c||this._blendFunctionParameters[3]!==d)this._blendFunctionParameters[0]=a,this._blendFunctionParameters[1]=b,this._blendFunctionParameters[2]=c,this._blendFunctionParameters[3]=d,this._isBlendFunctionParametersDirty=!0};b.prototype.setAlphaEquationParameters=function(a,b){if(this._blendEquationParameters[0]!==
a||this._blendEquationParameters[1]!==b)this._blendEquationParameters[0]=a,this._blendEquationParameters[1]=b,this._isBlendEquationParametersDirty=!0};b.prototype.reset=function(){this._alphaBlend=!1;this._blendFunctionParameters[0]=null;this._blendFunctionParameters[1]=null;this._blendFunctionParameters[2]=null;this._blendFunctionParameters[3]=null;this._blendEquationParameters[0]=null;this._blendEquationParameters[1]=null;this._blendConstants[0]=null;this._blendConstants[1]=null;this._blendConstants[2]=
null;this._blendConstants[3]=null;this._isAlphaBlendDirty=!0;this._isBlendConstantsDirty=this._isBlendEquationParametersDirty=this._isBlendFunctionParametersDirty=!1};b.prototype.apply=function(a){this.isDirty&&(this._isAlphaBlendDirty&&(this._alphaBlend?a.enable(a.BLEND):a.disable(a.BLEND),this._isAlphaBlendDirty=!1),this._isBlendFunctionParametersDirty&&(a.blendFuncSeparate(this._blendFunctionParameters[0],this._blendFunctionParameters[1],this._blendFunctionParameters[2],this._blendFunctionParameters[3]),
this._isBlendFunctionParametersDirty=!1),this._isBlendEquationParametersDirty&&(a.blendEquationSeparate(this._blendEquationParameters[0],this._blendEquationParameters[1]),this._isBlendEquationParametersDirty=!1),this._isBlendConstantsDirty&&(a.blendColor(this._blendConstants[0],this._blendConstants[1],this._blendConstants[2],this._blendConstants[3]),this._isBlendConstantsDirty=!1))};return b}()},Rz30:function(d,m,c){c("J7JH");c("nNNi");c("hLnk")},TTtC:function(d,m,c){c.d(m,"a",function(){return u});
var k=c("oYeq"),b=c("whcN"),a=c("/SR9"),l=c("Xeau"),n=c("SYzJ"),p=c("kdvT"),w=c("5xLc"),D=c("s3JK"),x=c("2/Cc"),F=c("Q86s");d=c("Bush");var y=c("zRBM"),E=c("JIAX"),u=function(c){function d(b,q){var g=c.call(this,b)||this;g._options=q;g._attachController=function(b){if(!g._controllers[b.uniqueId]){var c=g._generateNewMeshPair(b.pointer);g._controllers[b.uniqueId]={xrController:b,laserPointer:c.laserPointer,selectionMesh:c.selectionMesh,meshUnderPointer:null,pick:null,tmpRay:new x.a(new a.e,new a.e),
id:d._idCounter++};g._attachedController?!g._options.enablePointerSelectionOnAllControllers&&g._options.preferredHandedness&&b.inputSource.handedness===g._options.preferredHandedness&&(g._attachedController=b.uniqueId):g._options.enablePointerSelectionOnAllControllers||(g._attachedController=b.uniqueId);switch(b.inputSource.targetRayMode){case "tracked-pointer":return g._attachTrackedPointerRayMode(b);case "gaze":return g._attachGazeMode(b);case "screen":return g._attachScreenRayMode(b)}}};g._controllers=
{};g._tmpVectorForPickCompare=new a.e;g.disablePointerLighting=!0;g.disableSelectionMeshLighting=!0;g.displayLaserPointer=!0;g.displaySelectionMesh=!0;g.laserPointerPickedColor=new l.a(.9,.9,.9);g.laserPointerDefaultColor=new l.a(.7,.7,.7);g.selectionMeshDefaultColor=new l.a(.8,.8,.8);g.selectionMeshPickedColor=new l.a(.3,.3,1);g._identityMatrix=a.a.Identity();g._screenCoordinatesRef=a.e.Zero();g._viewportRef=new E.a(0,0,0,0);g._scene=g._xrSessionManager.scene;return g}Object(k.d)(d,c);d.prototype.attach=
function(){var b=this;if(!c.prototype.attach.call(this))return!1;this._options.xrInput.controllers.forEach(this._attachController);this._addNewAttachObserver(this._options.xrInput.onControllerAddedObservable,this._attachController);this._addNewAttachObserver(this._options.xrInput.onControllerRemovedObservable,function(a){b._detachController(a.uniqueId)});this._scene.constantlyUpdateMeshUnderPointer=!0;if(this._options.gazeCamera){var q=this._options.gazeCamera,g=this._generateNewMeshPair(q);this._controllers.camera=
{webXRCamera:q,laserPointer:g.laserPointer,selectionMesh:g.selectionMesh,meshUnderPointer:null,pick:null,tmpRay:new x.a(new a.e,new a.e),id:d._idCounter++};this._attachGazeMode()}return!0};d.prototype.detach=function(){var a=this;if(!c.prototype.detach.call(this))return!1;Object.keys(this._controllers).forEach(function(b){a._detachController(b)});return!0};d.prototype.getMeshUnderPointer=function(a){return this._controllers[a]?this._controllers[a].meshUnderPointer:null};d.prototype.getXRControllerByPointerId=
function(a){for(var b=Object.keys(this._controllers),c=0;c<b.length;++c)if(this._controllers[b[c]].id===a)return this._controllers[b[c]].xrController||null;return null};d.prototype._onXRFrame=function(b){var c=this;Object.keys(this._controllers).forEach(function(b){var d=c._controllers[b];if(c._options.enablePointerSelectionOnAllControllers||b===c._attachedController){d.laserPointer.isVisible=c.displayLaserPointer;if(d.xrController)b=d.xrController.pointer.position,d.xrController.getWorldPointerRayToRef(d.tmpRay);
else if(d.webXRCamera)b=d.webXRCamera.position,d.webXRCamera.getForwardRayToRef(d.tmpRay);else return;c._options.maxPointerDistance&&(d.tmpRay.length=c._options.maxPointerDistance);if(!c._options.disableScenePointerVectorUpdate&&b){var g=c._xrSessionManager.scene,q=c._options.xrInput.xrCamera;q&&(q.viewport.toGlobalToRef(g.getEngine().getRenderWidth(),g.getEngine().getRenderHeight(),c._viewportRef),a.e.ProjectToRef(b,c._identityMatrix,g.getTransformMatrix(),c._viewportRef,c._screenCoordinatesRef),
g.pointerX=c._screenCoordinatesRef.x,g.pointerY=c._screenCoordinatesRef.y)}d.pick=c._scene.pickWithRay(d.tmpRay,c._scene.pointerMovePredicate||c.raySelectionPredicate);if((b=d.pick)&&b.pickedPoint&&b.hit){c._updatePointerDistance(d.laserPointer,b.distance);d.selectionMesh.position.copyFrom(b.pickedPoint);d.selectionMesh.scaling.x=Math.sqrt(b.distance);d.selectionMesh.scaling.y=Math.sqrt(b.distance);d.selectionMesh.scaling.z=Math.sqrt(b.distance);g=c._convertNormalToDirectionOfRay(b.getNormal(!0),
d.tmpRay);d.selectionMesh.position.copyFrom(b.pickedPoint);if(g){q=a.e.Cross(n.a.Y,g);var k=a.e.Cross(g,q);a.e.RotationFromAxisToRef(k,g,q,d.selectionMesh.rotation);d.selectionMesh.position.addInPlace(g.scale(.001))}d.selectionMesh.isVisible=c.displaySelectionMesh;d.meshUnderPointer=b.pickedMesh}else d.selectionMesh.isVisible=!1,c._updatePointerDistance(d.laserPointer,1),d.meshUnderPointer=null}else d.selectionMesh.isVisible=!1,d.laserPointer.isVisible=!1,d.pick=null})};d.prototype._attachGazeMode=
function(a){var b=this,c=this._controllers[a&&a.uniqueId||"camera"],d=this._options.timeToSelect||3E3,k=this._options.useUtilityLayer?this._options.customUtilityLayerScene||y.a.DefaultUtilityLayer.utilityLayerScene:this._scene,l=new F.a,r=D.a.CreateTorus("selection",{diameter:.0525,thickness:.015,tessellation:20},k);r.isVisible=!1;r.isPickable=!1;r.parent=c.selectionMesh;var v=0,m=!1;c.onFrameObserver=this._xrSessionManager.onXRFrameObservable.add(function(){if(c.pick){c.laserPointer.material.alpha=
0;r.isVisible=!1;if(c.pick.hit)if(b._pickingMoved(l,c.pick))m&&(b._options.disablePointerUpOnTouchOut||b._scene.simulatePointerUp(c.pick,{pointerId:c.id})),m=!1,v=0;else if(v>d/10&&(r.isVisible=!0),v+=b._scene.getEngine().getDeltaTime(),v>=d)b._scene.simulatePointerDown(c.pick,{pointerId:c.id}),m=!0,b._options.disablePointerUpOnTouchOut&&b._scene.simulatePointerUp(c.pick,{pointerId:c.id}),r.isVisible=!1;else{var a=1-v/d;r.scaling.set(a,a,a)}else m=!1,v=0;b._scene.simulatePointerMove(c.pick,{pointerId:c.id});
l=c.pick}});void 0!==this._options.renderingGroupId&&(r.renderingGroupId=this._options.renderingGroupId);a&&a.onDisposeObservable.addOnce(function(){c.pick&&!b._options.disablePointerUpOnTouchOut&&m&&b._scene.simulatePointerUp(c.pick,{pointerId:c.id});r.dispose()})};d.prototype._attachScreenRayMode=function(a){var b=this,c=this._controllers[a.uniqueId],d=!1;c.onFrameObserver=this._xrSessionManager.onXRFrameObservable.add(function(){!c.pick||b._options.disablePointerUpOnTouchOut&&d||(d?b._scene.simulatePointerMove(c.pick,
{pointerId:c.id}):(b._scene.simulatePointerDown(c.pick,{pointerId:c.id}),d=!0,b._options.disablePointerUpOnTouchOut&&b._scene.simulatePointerUp(c.pick,{pointerId:c.id})))});a.onDisposeObservable.addOnce(function(){c.pick&&d&&!b._options.disablePointerUpOnTouchOut&&b._scene.simulatePointerUp(c.pick,{pointerId:c.id})})};d.prototype._attachTrackedPointerRayMode=function(a){var b=this,c=this._controllers[a.uniqueId];if(this._options.forceGazeMode)return this._attachGazeMode(a);c.onFrameObserver=this._xrSessionManager.onXRFrameObservable.add(function(){c.laserPointer.material.disableLighting=
b.disablePointerLighting;c.selectionMesh.material.disableLighting=b.disableSelectionMeshLighting;c.pick&&b._scene.simulatePointerMove(c.pick,{pointerId:c.id})});if(a.inputSource.gamepad){var d=function(d){b._options.overrideButtonId&&(c.selectionComponent=d.getComponent(b._options.overrideButtonId));c.selectionComponent||(c.selectionComponent=d.getMainComponent());c.onButtonChangedObserver=c.selectionComponent.onButtonStateChangedObservable.add(function(d){if(d.changes.pressed)if(d=d.changes.pressed.current,
c.pick){if(b._options.enablePointerSelectionOnAllControllers||a.uniqueId===b._attachedController)d?(b._scene.simulatePointerDown(c.pick,{pointerId:c.id}),c.selectionMesh.material.emissiveColor=b.selectionMeshPickedColor,c.laserPointer.material.emissiveColor=b.laserPointerPickedColor):(b._scene.simulatePointerUp(c.pick,{pointerId:c.id}),c.selectionMesh.material.emissiveColor=b.selectionMeshDefaultColor,c.laserPointer.material.emissiveColor=b.laserPointerDefaultColor)}else!d||b._options.enablePointerSelectionOnAllControllers||
b._options.disableSwitchOnClick||(b._attachedController=a.uniqueId)})};a.motionController?d(a.motionController):a.onMotionControllerInitObservable.add(d)}else{d=function(a){c.xrController&&a.inputSource===c.xrController.inputSource&&c.pick&&(b._scene.simulatePointerDown(c.pick,{pointerId:c.id}),c.selectionMesh.material.emissiveColor=b.selectionMeshPickedColor,c.laserPointer.material.emissiveColor=b.laserPointerPickedColor)};var k=function(a){c.xrController&&a.inputSource===c.xrController.inputSource&&
c.pick&&(b._scene.simulatePointerUp(c.pick,{pointerId:c.id}),c.selectionMesh.material.emissiveColor=b.selectionMeshDefaultColor,c.laserPointer.material.emissiveColor=b.laserPointerDefaultColor)};c.eventListeners={selectend:k,selectstart:d};this._xrSessionManager.session.addEventListener("selectstart",d);this._xrSessionManager.session.addEventListener("selectend",k)}};d.prototype._convertNormalToDirectionOfRay=function(b,c){b&&Math.acos(a.e.Dot(b,c.direction))<Math.PI/2&&b.scaleInPlace(-1);return b};
d.prototype._detachController=function(a){var b=this,c=this._controllers[a];c&&(c.selectionComponent&&c.onButtonChangedObserver&&c.selectionComponent.onButtonStateChangedObservable.remove(c.onButtonChangedObserver),c.onFrameObserver&&this._xrSessionManager.onXRFrameObservable.remove(c.onFrameObserver),c.eventListeners&&Object.keys(c.eventListeners).forEach(function(a){var d=c.eventListeners&&c.eventListeners[a];d&&b._xrSessionManager.session.removeEventListener(a,d)}),c.selectionMesh.dispose(),c.laserPointer.dispose(),
delete this._controllers[a],this._attachedController===a&&(a=Object.keys(this._controllers),this._attachedController=a.length?a[0]:""))};d.prototype._generateNewMeshPair=function(a){var b=this._options.useUtilityLayer?this._options.customUtilityLayerScene||y.a.DefaultUtilityLayer.utilityLayerScene:this._scene,c=w.a.CreateCylinder("laserPointer",{height:1,diameterTop:2E-4,diameterBottom:.004,tessellation:20,subdivisions:1},b);c.parent=a;a=new p.a("laserPointerMat",b);a.emissiveColor=this.laserPointerDefaultColor;
a.alpha=.7;c.material=a;c.rotation.x=Math.PI/2;this._updatePointerDistance(c,1);c.isPickable=!1;a=D.a.CreateTorus("gazeTracker",{diameter:.0105,thickness:.0075,tessellation:20},b);a.bakeCurrentTransformIntoVertices();a.isPickable=!1;a.isVisible=!1;b=new p.a("targetMat",b);b.specularColor=l.a.Black();b.emissiveColor=this.selectionMeshDefaultColor;b.backFaceCulling=!1;a.material=b;void 0!==this._options.renderingGroupId&&(c.renderingGroupId=this._options.renderingGroupId,a.renderingGroupId=this._options.renderingGroupId);
return{laserPointer:c,selectionMesh:a}};d.prototype._pickingMoved=function(a,b){var c;if(!(a.hit&&b.hit&&a.pickedMesh&&a.pickedPoint&&b.pickedMesh&&b.pickedPoint)||a.pickedMesh!==b.pickedMesh)return!0;null===(c=a.pickedPoint)||void 0===c?void 0:c.subtractToRef(b.pickedPoint,this._tmpVectorForPickCompare);this._tmpVectorForPickCompare.set(Math.abs(this._tmpVectorForPickCompare.x),Math.abs(this._tmpVectorForPickCompare.y),Math.abs(this._tmpVectorForPickCompare.z));a=.01*(this._options.gazeModePointerMovedFactor||
1)*b.distance;return this._tmpVectorForPickCompare.length()>a?!0:!1};d.prototype._updatePointerDistance=function(a,b){void 0===b&&(b=100);a.scaling.y=b;this._scene.useRightHandedSystem&&(b*=-1);a.position.z=b/2+.05};Object.defineProperty(d.prototype,"lasterPointerDefaultColor",{get:function(){return this.laserPointerDefaultColor},enumerable:!1,configurable:!0});d._idCounter=200;d.Name=b.a.POINTER_SELECTION;d.Version=1;return d}(d.a);b.b.AddWebXRFeature(u.Name,function(a,b){return function(){return new u(a,
b)}},u.Version,!0)},hLnk:function(d,m,c){c.d(m,"a",function(){return k});var k=function(){function b(){this._isStencilOpDirty=this._isStencilFuncDirty=this._isStencilMaskDirty=this._isStencilTestDirty=!1;this.reset()}Object.defineProperty(b.prototype,"isDirty",{get:function(){return this._isStencilTestDirty||this._isStencilMaskDirty||this._isStencilFuncDirty||this._isStencilOpDirty},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"stencilFunc",{get:function(){return this._stencilFunc},
set:function(a){this._stencilFunc!==a&&(this._stencilFunc=a,this._isStencilFuncDirty=!0)},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"stencilFuncRef",{get:function(){return this._stencilFuncRef},set:function(a){this._stencilFuncRef!==a&&(this._stencilFuncRef=a,this._isStencilFuncDirty=!0)},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"stencilFuncMask",{get:function(){return this._stencilFuncMask},set:function(a){this._stencilFuncMask!==a&&(this._stencilFuncMask=
a,this._isStencilFuncDirty=!0)},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"stencilOpStencilFail",{get:function(){return this._stencilOpStencilFail},set:function(a){this._stencilOpStencilFail!==a&&(this._stencilOpStencilFail=a,this._isStencilOpDirty=!0)},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"stencilOpDepthFail",{get:function(){return this._stencilOpDepthFail},set:function(a){this._stencilOpDepthFail!==a&&(this._stencilOpDepthFail=a,this._isStencilOpDirty=
!0)},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"stencilOpStencilDepthPass",{get:function(){return this._stencilOpStencilDepthPass},set:function(a){this._stencilOpStencilDepthPass!==a&&(this._stencilOpStencilDepthPass=a,this._isStencilOpDirty=!0)},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"stencilMask",{get:function(){return this._stencilMask},set:function(a){this._stencilMask!==a&&(this._stencilMask=a,this._isStencilMaskDirty=!0)},enumerable:!1,configurable:!0});
Object.defineProperty(b.prototype,"stencilTest",{get:function(){return this._stencilTest},set:function(a){this._stencilTest!==a&&(this._stencilTest=a,this._isStencilTestDirty=!0)},enumerable:!1,configurable:!0});b.prototype.reset=function(){this._stencilTest=!1;this._stencilMask=255;this._stencilFunc=b.ALWAYS;this._stencilFuncRef=1;this._stencilFuncMask=255;this._stencilOpDepthFail=this._stencilOpStencilFail=b.KEEP;this._stencilOpStencilDepthPass=b.REPLACE;this._isStencilOpDirty=this._isStencilFuncDirty=
this._isStencilMaskDirty=this._isStencilTestDirty=!0};b.prototype.apply=function(a){this.isDirty&&(this._isStencilTestDirty&&(this.stencilTest?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this._isStencilTestDirty=!1),this._isStencilMaskDirty&&(a.stencilMask(this.stencilMask),this._isStencilMaskDirty=!1),this._isStencilFuncDirty&&(a.stencilFunc(this.stencilFunc,this.stencilFuncRef,this.stencilFuncMask),this._isStencilFuncDirty=!1),this._isStencilOpDirty&&(a.stencilOp(this.stencilOpStencilFail,
this.stencilOpDepthFail,this.stencilOpStencilDepthPass),this._isStencilOpDirty=!1))};b.ALWAYS=519;b.KEEP=7680;b.REPLACE=7681;return b}()},is1F:function(d,m,c){c.d(m,"a",function(){return A});var k=c("oYeq"),b=c("whcN"),a=c("UlYS"),l=c("/SR9"),n=c("2/Cc"),p=c("WrCc"),w=c("5xLc"),D=c("4SJX"),x=c("mBE3"),F=c("SYzJ"),y=c("kdvT"),E=c("bnDv"),u=c("s3JK"),H=c("Gldd"),J=c("IIC5");d=c("Bush");var r=c("Xeau"),q=c("zRBM"),g=c("98Qd"),G=c("2Z9k"),A=function(c){function d(b,d){var h=c.call(this,b)||this;h._options=
d;h._controllers={};h._snappedToPoint=!1;h._tmpRay=new n.a(new l.e,new l.e);h._tmpVector=new l.e;h._tmpQuaternion=new l.b;h.backwardsMovementEnabled=!0;h.backwardsTeleportationDistance=.7;h.parabolicCheckRadius=5;h.parabolicRayEnabled=!0;h.straightRayEnabled=!0;h.rotationAngle=Math.PI/8;h._rotationEnabled=!0;h._attachController=function(b){if(!(h._controllers[b.uniqueId]||h._options.forceHandedness&&b.inputSource.handedness!==h._options.forceHandedness)){h._controllers[b.uniqueId]={xrController:b,
teleportationState:{forward:!1,backwards:!1,rotating:!1,currentRotation:0,baseRotation:0}};var c=h._controllers[b.uniqueId];if("tracked-pointer"===c.xrController.inputSource.targetRayMode&&c.xrController.inputSource.gamepad){var d=function(){if(b.motionController){var d=b.motionController.getComponentOfType(a.a.THUMBSTICK_TYPE)||b.motionController.getComponentOfType(a.a.TOUCHPAD_TYPE);if(!d||h._options.useMainComponentOnly){var g=b.motionController.getMainComponent();g&&(c.teleportationComponent=
g,c.onButtonChangedObserver=g.onButtonStateChangedObservable.add(function(){g.changes.pressed&&(g.changes.pressed.current?(c.teleportationState.forward=!0,h._currentTeleportationControllerId=c.xrController.uniqueId,c.teleportationState.baseRotation=h._options.xrInput.xrCamera.rotationQuaternion.toEulerAngles().y,c.teleportationState.currentRotation=0,Object(G.a)({timeout:h._options.timeToTeleport||3E3,contextObservable:h._xrSessionManager.onXRFrameObservable,breakCondition:function(){return!g.pressed},
onEnded:function(){h._currentTeleportationControllerId===c.xrController.uniqueId&&c.teleportationState.forward&&h._teleportForward(b.uniqueId)}})):(c.teleportationState.forward=!1,h._currentTeleportationControllerId=""))}))}else c.teleportationComponent=d,c.onAxisChangedObserver=d.onAxisValueChangedObservable.add(function(a){.7>=a.y&&c.teleportationState.backwards&&(c.teleportationState.backwards=!1);if(.7<a.y&&!c.teleportationState.forward&&h.backwardsMovementEnabled&&!h.snapPointsOnly&&!c.teleportationState.backwards){c.teleportationState.backwards=
!0;h._tmpQuaternion.copyFrom(h._options.xrInput.xrCamera.rotationQuaternion);h._tmpQuaternion.toEulerAnglesToRef(h._tmpVector);h._tmpVector.x=0;h._tmpVector.z=0;l.b.FromEulerVectorToRef(h._tmpVector,h._tmpQuaternion);h._tmpVector.set(0,0,h.backwardsTeleportationDistance*(h._xrSessionManager.scene.useRightHandedSystem?1:-1));h._tmpVector.rotateByQuaternionToRef(h._tmpQuaternion,h._tmpVector);h._tmpVector.addInPlace(h._options.xrInput.xrCamera.position);h._tmpRay.origin.copyFrom(h._tmpVector);h._tmpRay.length=
h._options.xrInput.xrCamera.realWorldHeight+.1;h._tmpRay.direction.set(0,-1,0);var d=h._xrSessionManager.scene.pickWithRay(h._tmpRay,function(a){return-1!==h._floorMeshes.indexOf(a)});d&&d.pickedPoint&&(h._options.xrInput.xrCamera.position.x=d.pickedPoint.x,h._options.xrInput.xrCamera.position.z=d.pickedPoint.z)}-.7>a.y&&!h._currentTeleportationControllerId&&!c.teleportationState.rotating&&(c.teleportationState.forward=!0,h._currentTeleportationControllerId=c.xrController.uniqueId,c.teleportationState.baseRotation=
h._options.xrInput.xrCamera.rotationQuaternion.toEulerAngles().y);a.x?c.teleportationState.forward?h._currentTeleportationControllerId===c.xrController.uniqueId&&(h.rotationEnabled?setTimeout(function(){c.teleportationState.currentRotation=Math.atan2(a.x,a.y*(h._xrSessionManager.scene.useRightHandedSystem?1:-1))}):c.teleportationState.currentRotation=0):!c.teleportationState.rotating&&.7<Math.abs(a.x)&&(c.teleportationState.rotating=!0,h._options.xrInput.xrCamera.rotationQuaternion.multiplyInPlace(l.b.FromEulerAngles(0,
h.rotationAngle*(0<a.x?1:-1)*(h._xrSessionManager.scene.useRightHandedSystem?-1:1),0))):c.teleportationState.rotating=!1;0===a.x&&0===a.y&&c.teleportationState.forward&&h._teleportForward(b.uniqueId)})}};b.motionController?d():b.onMotionControllerInitObservable.addOnce(function(){d()})}else h._xrSessionManager.scene.onPointerObservable.add(function(a){a.type===g.a.POINTERDOWN?(c.teleportationState.forward=!0,h._currentTeleportationControllerId=c.xrController.uniqueId,c.teleportationState.baseRotation=
h._options.xrInput.xrCamera.rotationQuaternion.toEulerAngles().y,c.teleportationState.currentRotation=0,Object(G.a)({timeout:h._options.timeToTeleport||3E3,contextObservable:h._xrSessionManager.onXRFrameObservable,onEnded:function(){h._currentTeleportationControllerId===c.xrController.uniqueId&&c.teleportationState.forward&&h._teleportForward(b.uniqueId)}})):a.type===g.a.POINTERUP&&(c.teleportationState.forward=!1,h._currentTeleportationControllerId="")})}};h._options.teleportationTargetMesh||h._createDefaultTargetMesh();
h._floorMeshes=h._options.floorMeshes||[];h._snapToPositions=h._options.snapPositions||[];h._setTargetMeshVisibility(!1);return h}Object(k.d)(d,c);Object.defineProperty(d.prototype,"rotationEnabled",{get:function(){return this._rotationEnabled},set:function(a){this._rotationEnabled=a;if(this._options.teleportationTargetMesh){var b=this._options.teleportationTargetMesh.getChildMeshes(!1,function(a){return"rotationCone"===a.name});b[0]&&b[0].setEnabled(a)}},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,
"teleportationTargetMesh",{get:function(){return this._options.teleportationTargetMesh||null},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"snapPointsOnly",{get:function(){return!!this._options.snapPointsOnly},set:function(a){this._options.snapPointsOnly=a},enumerable:!1,configurable:!0});d.prototype.addFloorMesh=function(a){this._floorMeshes.push(a)};d.prototype.addSnapPoint=function(a){this._snapToPositions.push(a)};d.prototype.attach=function(){var a=this;if(!c.prototype.attach.call(this))return!1;
this._currentTeleportationControllerId="";this._options.xrInput.controllers.forEach(this._attachController);this._addNewAttachObserver(this._options.xrInput.onControllerAddedObservable,this._attachController);this._addNewAttachObserver(this._options.xrInput.onControllerRemovedObservable,function(b){a._detachController(b.uniqueId)});return!0};d.prototype.detach=function(){var a=this;if(!c.prototype.detach.call(this))return!1;Object.keys(this._controllers).forEach(function(b){a._detachController(b)});
this._setTargetMeshVisibility(!1);this._currentTeleportationControllerId="";this._controllers={};return!0};d.prototype.dispose=function(){c.prototype.dispose.call(this);this._options.teleportationTargetMesh&&this._options.teleportationTargetMesh.dispose(!1,!0)};d.prototype.removeFloorMesh=function(a){a=this._floorMeshes.indexOf(a);-1!==a&&this._floorMeshes.splice(a,1)};d.prototype.removeFloorMeshByName=function(a){(a=this._xrSessionManager.scene.getMeshByName(a))&&this.removeFloorMesh(a)};d.prototype.removeSnapPoint=
function(a){var b=this._snapToPositions.indexOf(a);if(-1===b)for(var c=0;c<this._snapToPositions.length;++c)if(this._snapToPositions[c].equals(a)){b=c;break}return-1!==b?(this._snapToPositions.splice(b,1),!0):!1};d.prototype.setSelectionFeature=function(a){this._selectionFeature=a};d.prototype._onXRFrame=function(a){var b=this,c=this._xrSessionManager.currentFrame;a=this._xrSessionManager.scene;if(this.attach&&c)if(c=this._options.teleportationTargetMesh,this._currentTeleportationControllerId){if(c){c.rotationQuaternion=
c.rotationQuaternion||new l.b;var d=this._controllers[this._currentTeleportationControllerId];if(d&&d.teleportationState.forward){l.b.RotationYawPitchRollToRef(d.teleportationState.currentRotation+d.teleportationState.baseRotation,0,0,c.rotationQuaternion);c=!1;d.xrController.getWorldPointerRayToRef(this._tmpRay);if(this.straightRayEnabled){var g=a.pickWithRay(this._tmpRay,function(a){if(b._options.pickBlockerMeshes&&-1!==b._options.pickBlockerMeshes.indexOf(a))return!0;a=b._floorMeshes.indexOf(a);
return-1===a?!1:b._floorMeshes[a].absolutePosition.y<b._options.xrInput.xrCamera.position.y});if(g&&g.pickedMesh&&this._options.pickBlockerMeshes&&-1!==this._options.pickBlockerMeshes.indexOf(g.pickedMesh))return;g&&g.pickedPoint&&(c=!0,this._setTargetMeshPosition(g.pickedPoint),this._setTargetMeshVisibility(!0),this._showParabolicPath(g))}if(this.parabolicRayEnabled&&!c){d=d.xrController.pointer.rotationQuaternion.toEulerAngles().x;d=this.parabolicCheckRadius*(1+(Math.PI/2-Math.abs(d)));this._tmpRay.origin.addToRef(this._tmpRay.direction.scale(2*
d),this._tmpVector);this._tmpVector.y=this._tmpRay.origin.y;this._tmpRay.origin.addInPlace(this._tmpRay.direction.scale(d));this._tmpVector.subtractToRef(this._tmpRay.origin,this._tmpRay.direction);this._tmpRay.direction.normalize();if((g=a.pickWithRay(this._tmpRay,function(a){return b._options.pickBlockerMeshes&&-1!==b._options.pickBlockerMeshes.indexOf(a)?!0:-1!==b._floorMeshes.indexOf(a)}))&&g.pickedMesh&&this._options.pickBlockerMeshes&&-1!==this._options.pickBlockerMeshes.indexOf(g.pickedMesh))return;
g&&g.pickedPoint&&(c=!0,this._setTargetMeshPosition(g.pickedPoint),this._setTargetMeshVisibility(!0),this._showParabolicPath(g))}this._setTargetMeshVisibility(c)}else this._setTargetMeshVisibility(!1)}}else this._setTargetMeshVisibility(!1)};d.prototype._createDefaultTargetMesh=function(){this._options.defaultTargetMeshOptions=this._options.defaultTargetMeshOptions||{};var a=this._options.useUtilityLayer?this._options.customUtilityLayerScene||q.a.DefaultUtilityLayer.utilityLayerScene:this._xrSessionManager.scene,
b=E.a.CreateGround("teleportationTarget",{width:2,height:2,subdivisions:2},a);b.isPickable=!1;var c=new p.a("teleportationPlaneDynamicTexture",512,a,!0);c.hasAlpha=!0;var d=c.getContext();d.beginPath();d.arc(256,256,200,0,2*Math.PI,!1);d.fillStyle=this._options.defaultTargetMeshOptions.teleportationFillColor||"#444444";d.fill();d.lineWidth=10;d.strokeStyle=this._options.defaultTargetMeshOptions.teleportationBorderColor||"#FFFFFF";d.stroke();d.closePath();c.update();d=new y.a("teleportationPlaneMaterial",
a);d.diffuseTexture=c;b.material=d;c=u.a.CreateTorus("torusTeleportation",{diameter:.75,thickness:.1,tessellation:20},a);c.isPickable=!1;c.parent=b;if(!this._options.defaultTargetMeshOptions.disableAnimation){d=new x.a("animationInnerCircle","position.y",30,x.a.ANIMATIONTYPE_FLOAT,x.a.ANIMATIONLOOPMODE_CYCLE);var g=[];g.push({frame:0,value:0});g.push({frame:30,value:.4});g.push({frame:60,value:0});d.setKeys(g);g=new D.e;g.setEasingMode(D.c.EASINGMODE_EASEINOUT);d.setEasingFunction(g);c.animations=
[];c.animations.push(d);a.beginAnimation(c,0,60,!0)}d=w.a.CreateCylinder("rotationCone",{diameterTop:0,tessellation:4},a);d.isPickable=!1;d.scaling.set(.5,.12,.2);d.rotate(F.a.X,Math.PI/2);d.position.z=.6;d.parent=c;this._options.defaultTargetMeshOptions.torusArrowMaterial?(c.material=this._options.defaultTargetMeshOptions.torusArrowMaterial,d.material=this._options.defaultTargetMeshOptions.torusArrowMaterial):(a=new y.a("torusConsMat",a),a.disableLighting=!!this._options.defaultTargetMeshOptions.disableLighting,
a.disableLighting?a.emissiveColor=new r.a(.3,.3,1):a.diffuseColor=new r.a(.3,.3,1),a.alpha=.9,c.material=a,this._teleportationRingMaterial=d.material=a);void 0!==this._options.renderingGroupId&&(b.renderingGroupId=this._options.renderingGroupId,c.renderingGroupId=this._options.renderingGroupId,d.renderingGroupId=this._options.renderingGroupId);this._options.teleportationTargetMesh=b};d.prototype._detachController=function(a){var b=this._controllers[a];b&&(b.teleportationComponent&&(b.onAxisChangedObserver&&
b.teleportationComponent.onAxisValueChangedObservable.remove(b.onAxisChangedObserver),b.onButtonChangedObserver&&b.teleportationComponent.onButtonStateChangedObservable.remove(b.onButtonChangedObserver)),delete this._controllers[a])};d.prototype._findClosestSnapPointWithRadius=function(a,b){void 0===b&&(b=this._options.snapToPositionRadius||.8);var c=null,d=Number.MAX_VALUE;if(this._snapToPositions.length){var g=b*b;this._snapToPositions.forEach(function(b){var f=l.e.DistanceSquared(b,a);f<=g&&f<
d&&(d=f,c=b)})}return c};d.prototype._setTargetMeshPosition=function(a){if(this._options.teleportationTargetMesh){var b=this._findClosestSnapPointWithRadius(a);this._snappedToPoint=!!b;this.snapPointsOnly&&!this._snappedToPoint&&this._teleportationRingMaterial?this._teleportationRingMaterial.diffuseColor.set(1,.3,.3):this.snapPointsOnly&&this._snappedToPoint&&this._teleportationRingMaterial&&this._teleportationRingMaterial.diffuseColor.set(.3,.3,1);this._options.teleportationTargetMesh.position.copyFrom(b||
a);this._options.teleportationTargetMesh.position.y+=.01}};d.prototype._setTargetMeshVisibility=function(a){this._options.teleportationTargetMesh&&this._options.teleportationTargetMesh.isVisible!==a&&(this._options.teleportationTargetMesh.isVisible=a,this._options.teleportationTargetMesh.getChildren(void 0,!1).forEach(function(b){b.isVisible=a}),a?this._selectionFeature&&this._selectionFeature.detach():(this._quadraticBezierCurve&&(this._quadraticBezierCurve.dispose(),this._quadraticBezierCurve=null),
this._selectionFeature&&this._selectionFeature.attach()))};d.prototype._showParabolicPath=function(a){a.pickedPoint&&(a=H.b.CreateQuadraticBezier(this._controllers[this._currentTeleportationControllerId].xrController.pointer.absolutePosition,a.ray.origin,a.pickedPoint,25),this._quadraticBezierCurve=this._options.generateRayPathMesh?this._options.generateRayPathMesh(a.getPoints()):J.a.CreateLines("teleportation path line",{points:a.getPoints(),instance:this._quadraticBezierCurve,updatable:!0}),this._quadraticBezierCurve.isPickable=
!1)};d.prototype._teleportForward=function(a){if((a=this._controllers[a])&&a.teleportationState.forward&&(a.teleportationState.forward=!1,this._currentTeleportationControllerId="",(!this.snapPointsOnly||this._snappedToPoint)&&this._options.teleportationTargetMesh&&this._options.teleportationTargetMesh.isVisible)){var b=this._options.xrInput.xrCamera.realWorldHeight;this._options.xrInput.xrCamera.onBeforeCameraTeleport.notifyObservers(this._options.xrInput.xrCamera.position);this._options.xrInput.xrCamera.position.copyFrom(this._options.teleportationTargetMesh.position);
this._options.xrInput.xrCamera.position.y+=b;this._options.xrInput.xrCamera.rotationQuaternion.multiplyInPlace(l.b.FromEulerAngles(0,a.teleportationState.currentRotation-(this._xrSessionManager.scene.useRightHandedSystem?Math.PI:0),0));this._options.xrInput.xrCamera.onAfterCameraTeleport.notifyObservers(this._options.xrInput.xrCamera.position)}};d.Name=b.a.TELEPORTATION;d.Version=1;return d}(d.a);b.b.AddWebXRFeature(A.Name,function(a,b){return function(){return new A(a,b)}},A.Version,!0)},nNNi:function(d,
m,c){c.d(m,"a",function(){return k});var k=function(){function b(){this._isFrontFaceDirty=this._isZOffsetDirty=this._isCullDirty=this._isCullFaceDirty=this._isDepthFuncDirty=this._isDepthMaskDirty=this._isDepthTestDirty=!1;this.reset()}Object.defineProperty(b.prototype,"isDirty",{get:function(){return this._isDepthFuncDirty||this._isDepthTestDirty||this._isDepthMaskDirty||this._isCullFaceDirty||this._isCullDirty||this._isZOffsetDirty||this._isFrontFaceDirty},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,
"zOffset",{get:function(){return this._zOffset},set:function(a){this._zOffset!==a&&(this._zOffset=a,this._isZOffsetDirty=!0)},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"cullFace",{get:function(){return this._cullFace},set:function(a){this._cullFace!==a&&(this._cullFace=a,this._isCullFaceDirty=!0)},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"cull",{get:function(){return this._cull},set:function(a){this._cull!==a&&(this._cull=a,this._isCullDirty=!0)},enumerable:!1,
configurable:!0});Object.defineProperty(b.prototype,"depthFunc",{get:function(){return this._depthFunc},set:function(a){this._depthFunc!==a&&(this._depthFunc=a,this._isDepthFuncDirty=!0)},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"depthMask",{get:function(){return this._depthMask},set:function(a){this._depthMask!==a&&(this._depthMask=a,this._isDepthMaskDirty=!0)},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"depthTest",{get:function(){return this._depthTest},
set:function(a){this._depthTest!==a&&(this._depthTest=a,this._isDepthTestDirty=!0)},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"frontFace",{get:function(){return this._frontFace},set:function(a){this._frontFace!==a&&(this._frontFace=a,this._isFrontFaceDirty=!0)},enumerable:!1,configurable:!0});b.prototype.reset=function(){this._depthTest=this._depthMask=!0;this._cull=this._cullFace=this._depthFunc=null;this._zOffset=0;this._frontFace=null;this._isDepthMaskDirty=this._isDepthTestDirty=
!0;this._isFrontFaceDirty=this._isZOffsetDirty=this._isCullDirty=this._isCullFaceDirty=this._isDepthFuncDirty=!1};b.prototype.apply=function(a){this.isDirty&&(this._isCullDirty&&(this.cull?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this._isCullDirty=!1),this._isCullFaceDirty&&(a.cullFace(this.cullFace),this._isCullFaceDirty=!1),this._isDepthMaskDirty&&(a.depthMask(this.depthMask),this._isDepthMaskDirty=!1),this._isDepthTestDirty&&(this.depthTest?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this._isDepthTestDirty=
!1),this._isDepthFuncDirty&&(a.depthFunc(this.depthFunc),this._isDepthFuncDirty=!1),this._isZOffsetDirty&&(this.zOffset?(a.enable(a.POLYGON_OFFSET_FILL),a.polygonOffset(this.zOffset,0)):a.disable(a.POLYGON_OFFSET_FILL),this._isZOffsetDirty=!1),this._isFrontFaceDirty&&(a.frontFace(this.frontFace),this._isFrontFaceDirty=!1))};return b}()}}]);

var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(n){var r=0;return function(){return r<n.length?{done:!1,value:n[r++]}:{done:!0}}};$jscomp.arrayIterator=function(n){return{next:$jscomp.arrayIteratorImpl(n)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(n,r,b){n!=Array.prototype&&n!=Object.prototype&&(n[r]=b.value)};$jscomp.getGlobal=function(n){return"undefined"!=typeof window&&window===n?n:"undefined"!=typeof global&&null!=global?global:n};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(n,r){this.$jscomp$symbol$id_=n;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:r})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function n(b){if(this instanceof n)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(b||"")+"_"+r++,b)}var r=0;return n}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var n=$jscomp.global.Symbol.iterator;n||(n=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[n]&&$jscomp.defineProperty(Array.prototype,n,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var n=$jscomp.global.Symbol.asyncIterator;n||(n=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(n){$jscomp.initSymbolIterator();n={next:n};n[$jscomp.global.Symbol.iterator]=function(){return this};return n};
$jscomp.iteratorFromArray=function(n,r){$jscomp.initSymbolIterator();n instanceof String&&(n+="");var b=0,l={next:function(){if(b<n.length){var h=b++;return{value:r(h,n[h]),done:!1}}l.next=function(){return{done:!0,value:void 0}};return l.next()}};l[Symbol.iterator]=function(){return l};return l};
$jscomp.polyfill=function(n,r,b,l){if(r){b=$jscomp.global;n=n.split(".");for(l=0;l<n.length-1;l++){var h=n[l];h in b||(b[h]={});b=b[h]}n=n[n.length-1];l=b[n];r=r(l);r!=l&&null!=r&&$jscomp.defineProperty(b,n,{configurable:!0,writable:!0,value:r})}};$jscomp.polyfill("Array.prototype.keys",function(n){return n?n:function(){return $jscomp.iteratorFromArray(this,function(n){return n})}},"es6","es3");
$jscomp.makeIterator=function(n){var r="undefined"!=typeof Symbol&&Symbol.iterator&&n[Symbol.iterator];return r?r.call(n):$jscomp.arrayIterator(n)};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(n){function r(){this.batch_=null}function b(b){return b instanceof h?b:new h(function(m,a){m(b)})}if(n&&!$jscomp.FORCE_POLYFILL_PROMISE)return n;r.prototype.asyncExecute=function(b){if(null==this.batch_){this.batch_=[];var m=this;this.asyncExecuteFunction(function(){m.executeBatch_()})}this.batch_.push(b)};var l=$jscomp.global.setTimeout;r.prototype.asyncExecuteFunction=function(b){l(b,0)};r.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var b=
this.batch_;this.batch_=[];for(var m=0;m<b.length;++m){var a=b[m];b[m]=null;try{a()}catch(q){this.asyncThrow_(q)}}}this.batch_=null};r.prototype.asyncThrow_=function(b){this.asyncExecuteFunction(function(){throw b;})};var h=function(b){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var m=this.createResolveAndReject_();try{b(m.resolve,m.reject)}catch(a){m.reject(a)}};h.prototype.createResolveAndReject_=function(){function b(q){return function(g){a||(a=!0,q.call(m,g))}}var m=this,a=!1;
return{resolve:b(this.resolveTo_),reject:b(this.reject_)}};h.prototype.resolveTo_=function(b){if(b===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(b instanceof h)this.settleSameAsPromise_(b);else{a:switch(typeof b){case "object":var m=null!=b;break a;case "function":m=!0;break a;default:m=!1}m?this.resolveToNonPromiseObj_(b):this.fulfill_(b)}};h.prototype.resolveToNonPromiseObj_=function(b){var m=void 0;try{m=b.then}catch(a){this.reject_(a);return}"function"==typeof m?
this.settleSameAsThenable_(m,b):this.fulfill_(b)};h.prototype.reject_=function(b){this.settle_(2,b)};h.prototype.fulfill_=function(b){this.settle_(1,b)};h.prototype.settle_=function(b,m){if(0!=this.state_)throw Error("Cannot settle("+b+", "+m+"): Promise already settled in state"+this.state_);this.state_=b;this.result_=m;this.executeOnSettledCallbacks_()};h.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var b=0;b<this.onSettledCallbacks_.length;++b)v.asyncExecute(this.onSettledCallbacks_[b]);
this.onSettledCallbacks_=null}};var v=new r;h.prototype.settleSameAsPromise_=function(b){var m=this.createResolveAndReject_();b.callWhenSettled_(m.resolve,m.reject)};h.prototype.settleSameAsThenable_=function(b,m){var a=this.createResolveAndReject_();try{b.call(m,a.resolve,a.reject)}catch(q){a.reject(q)}};h.prototype.then=function(b,m){function a(d,a){return"function"==typeof d?function(c){try{q(d(c))}catch(k){g(k)}}:a}var q,g,e=new h(function(a,e){q=a;g=e});this.callWhenSettled_(a(b,q),a(m,g));return e};
h.prototype.catch=function(b){return this.then(void 0,b)};h.prototype.callWhenSettled_=function(b,m){function a(){switch(q.state_){case 1:b(q.result_);break;case 2:m(q.result_);break;default:throw Error("Unexpected state: "+q.state_);}}var q=this;null==this.onSettledCallbacks_?v.asyncExecute(a):this.onSettledCallbacks_.push(a)};h.resolve=b;h.reject=function(b){return new h(function(m,a){a(b)})};h.race=function(l){return new h(function(m,a){for(var q=$jscomp.makeIterator(l),g=q.next();!g.done;g=q.next())b(g.value).callWhenSettled_(m,
a)})};h.all=function(l){var m=$jscomp.makeIterator(l),a=m.next();return a.done?b([]):new h(function(q,g){function e(c){return function(a){d[c]=a;p--;0==p&&q(d)}}var d=[],p=0;do d.push(void 0),p++,b(a.value).callWhenSettled_(e(d.length-1),g),a=m.next();while(!a.done)})};return h},"es6","es3");
(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{"+z/8":function(n,r,b){b.d(r,"a",function(){return F.a});r=b("WIi2");b("OFzk");var l=b("oYeq"),h=b("/SR9");n=b("WHS4");b("83xy");var v=function(c){function a(a,d,e){void 0===e&&(e=null);d=c.call(this,d)||this;if(!a)return d;d._textureMatrix=h.a.Identity();d.name=a;d.url=a;d._onLoad=e;d._texture=d._getFromCache(a,!0);d._texture?d._triggerOnLoad():(a=d.getScene())?a.useDelayedTextureLoading?d.delayLoadState=4:d.loadTexture():d.loadTexture();
return d}Object(l.d)(a,c);a.prototype._triggerOnLoad=function(){this._onLoad&&this._onLoad()};a.prototype.getTextureMatrix=function(){return this._textureMatrix};a.prototype.load3dlTexture=function(){var c=this,d=this._getEngine(),e;this._texture=e=1===d.webGLVersion?d.createRawTexture(null,1,1,5,!1,!1,2,null,0):d.createRawTexture3D(null,1,1,1,5,!1,!1,2,null,0);this.isCube=this._texture.isReady=!1;this.is3D=1<d.webGLVersion;this.wrapR=this.wrapV=this.wrapU=0;this.anisotropicFilteringLevel=1;var k=
function(A){if("string"===typeof A){var k=null,u=null;A=A.split("\n");for(var f=0,p=0,b=0,w=0,g=0,q=0;q<A.length;q++){var y=A[q];if(a._noneEmptyLineRegex.test(y)&&0!==y.indexOf("#")){var m=y.split(" ");if(0===f)f=m.length,k=new Uint8Array(f*f*f*4),u=new Float32Array(f*f*f*4);else if(0!=f){y=Math.max(parseInt(m[0]),0);var B=Math.max(parseInt(m[1]),0);m=Math.max(parseInt(m[2]),0);g=Math.max(y,g);g=Math.max(B,g);g=Math.max(m,g);var h=4*(p+w*f+b*f*f);u&&(u[h+0]=y,u[h+1]=B,u[h+2]=m);b++;0==b%f&&(w++,b=
0,0==w%f&&(p++,w=0))}}}if(u&&k)for(q=0;q<u.length;q++)k[q]=0<q&&0===(q+1)%4?255:u[q]/g*255;e.is3D?(e.updateSize(f,f,f),d.updateRawTexture3D(e,k,5,!1)):(e.updateSize(f*f,f),d.updateRawTexture(e,k,5,!1));e.isReady=!0;c._triggerOnLoad()}},u=this.getScene();u?u._loadFile(this.url,k):d._loadFile(this.url,k);return this._texture};a.prototype.loadTexture=function(){this.url&&this.url.toLocaleLowerCase().indexOf(".3dl")==this.url.length-4&&this.load3dlTexture()};a.prototype.clone=function(){var c=new a(this.url,
this.getScene()||this._getEngine());c.level=this.level;return c};a.prototype.delayLoad=function(){4===this.delayLoadState&&(this.delayLoadState=1,(this._texture=this._getFromCache(this.url,!0))||this.loadTexture())};a.Parse=function(c,d){var e=null;c.name&&!c.isRenderTarget&&(e=new a(c.name,d),e.name=c.name,e.level=c.level);return e};a.prototype.serialize=function(){if(!this.name)return null;var c={};c.name=this.name;c.level=this.level;c.customType="BABYLON.ColorGradingTexture";return c};a._noneEmptyLineRegex=
/\S+/;return a}(r.a);n.a.RegisteredTypes["BABYLON.ColorGradingTexture"]=v;b("Z+J3");var t=b("WrCc");b("VUtr");b("h5cR");b("/vHJ");b("vD8D");b("gXZW");(function(c){function a(d,e,f){var k=c.call(this,f.scene||f.engine)||this;if(!e||!f.engine&&!f.scene)return k;f=Object(l.a)(Object(l.a)({},a.DefaultOptions),f);k._generateMipMaps=f.generateMipMaps;k._samplingMode=f.samplingMode;k._textureMatrix=h.a.Identity();k.name=d;k.element=e;k._isVideo=e instanceof HTMLVideoElement;k.anisotropicFilteringLevel=1;
k._createInternalTexture();return k}Object(l.d)(a,c);a.prototype._createInternalTexture=function(){if(this._isVideo){var c=this.element.videoWidth;var a=this.element.videoHeight}else c=this.element.width,a=this.element.height;var d=this._getEngine();d&&(this._texture=d.createDynamicTexture(c,a,this._generateMipMaps,this._samplingMode));this.update()};a.prototype.getTextureMatrix=function(){return this._textureMatrix};a.prototype.update=function(c){void 0===c&&(c=null);var a=this._getEngine();if(null!=
this._texture&&null!=a)if(this._isVideo){var d=this.element;d.readyState<d.HAVE_CURRENT_DATA||a.updateVideoTexture(this._texture,d,null===c?!0:c)}else a.updateDynamicTexture(this._texture,this.element,null===c?!0:c,!1)};a.DefaultOptions={generateMipMaps:!1,samplingMode:2,engine:null,scene:null};return a})(r.a);b("k2R8");b("Uh4t");b("obT0");b("5qAZ");var m=b("Pro5"),a=b("qUIE"),q=b("X2Ve");r=function(){function c(){this.supportCascades=!1}c.prototype.canLoad=function(c){return q.a.EndsWith(c,".tga")};
c.prototype.loadCubeData=function(c,a,d,e,f){throw".env not supported in Cube.";};c.prototype.loadData=function(c,a,d){var e=new Uint8Array(c.buffer,c.byteOffset,c.byteLength);c=m.a.GetTGAHeader(e);d(c.width,c.height,a.generateMipMaps,!1,function(){m.a.UploadContent(a,e)})};return c}();a.a._TextureLoaders.push(new r);var g=b("HpoW"),e=b("YKqZ");r=function(){function c(){this.supportCascades=!1}c.prototype.canLoad=function(c){return q.a.EndsWith(c,".basis")};c.prototype.loadCubeData=function(c,a,d,
f,k){Array.isArray(c)||(d=a.getEngine().getCaps(),g.a.TranscodeAsync(c,{supportedCompressionFormats:{etc1:d.etc1?!0:!1,s3tc:d.s3tc?!0:!1,pvrtc:d.pvrtc?!0:!1,etc2:d.etc2?!0:!1}}).then(function(c){var d=1<c.fileInfo.images[0].levels.length&&a.generateMipMaps;g.a.LoadTextureFromTranscodeResult(a,c);a.getEngine()._setCubeMapTextureParams(a,d);a.isReady=!0;a.onLoadedObservable.notifyObservers(a);a.onLoadedObservable.clear();f&&f()}).catch(function(c){e.b.Warn("Failed to transcode Basis file, transcoding may not be supported on this device");
a.isReady=!0}))};c.prototype.loadData=function(c,a,d){var f=a.getEngine().getCaps();g.a.TranscodeAsync(c,{supportedCompressionFormats:{etc1:f.etc1?!0:!1,s3tc:f.s3tc?!0:!1,pvrtc:f.pvrtc?!0:!1,etc2:f.etc2?!0:!1}}).then(function(c){var e=c.fileInfo.images[0].levels[0];d(e.width,e.height,1<c.fileInfo.images[0].levels.length&&a.generateMipMaps,-1!==c.format,function(){g.a.LoadTextureFromTranscodeResult(a,c)})}).catch(function(c){e.b.Warn("Failed to transcode Basis file, transcoding may not be supported on this device");
d(0,0,!1,!1,function(){})})};return c}();a.a._TextureLoaders.push(new r);b("JUU8");b("RWrB");var d=b("y4Ty"),p=b("aCSs"),c=b("Xeau"),k=function(){return function(c,a,d){this.id=c;this.scale=a;this.offset=d}}(),u=b("uyO6");(function(){function f(a,e,k,u){var p,b,w,g,q,A,m,y,h,B,l,t,C;this.name=a;this.meshes=e;this.scene=u;this.options=k;this.options.map=null!==(p=this.options.map)&&void 0!==p?p:"ambientTexture bumpTexture diffuseTexture emissiveTexture lightmapTexture opacityTexture reflectionTexture refractionTexture specularTexture".split(" ");
this.options.uvsIn=null!==(b=this.options.uvsIn)&&void 0!==b?b:d.b.UVKind;this.options.uvsOut=null!==(w=this.options.uvsOut)&&void 0!==w?w:d.b.UVKind;this.options.layout=null!==(g=this.options.layout)&&void 0!==g?g:f.LAYOUT_STRIP;this.options.layout===f.LAYOUT_COLNUM&&(this.options.colnum=null!==(q=this.options.colnum)&&void 0!==q?q:8);this.options.updateInputMeshes=null!==(A=this.options.updateInputMeshes)&&void 0!==A?A:!0;this.options.disposeSources=null!==(m=this.options.disposeSources)&&void 0!==
m?m:!0;this._expecting=0;this.options.fillBlanks=null!==(y=this.options.fillBlanks)&&void 0!==y?y:!0;!0===this.options.fillBlanks&&(this.options.customFillColor=null!==(h=this.options.customFillColor)&&void 0!==h?h:"black");this.options.frameSize=null!==(B=this.options.frameSize)&&void 0!==B?B:256;this.options.paddingRatio=null!==(l=this.options.paddingRatio)&&void 0!==l?l:.0115;this._paddingValue=Math.ceil(this.options.frameSize*this.options.paddingRatio);0!==this._paddingValue%2&&this._paddingValue++;
this.options.paddingMode=null!==(t=this.options.paddingMode)&&void 0!==t?t:f.SUBUV_WRAP;this.options.paddingMode===f.SUBUV_COLOR&&(this.options.paddingColor=null!==(C=this.options.paddingColor)&&void 0!==C?C:new c.b(0,0,0,1));this.sets={};this.frames=[];return this}f.prototype._createFrames=function(d){for(var f=this,k=this._calculateSize(),u=(new h.d(1,1)).divide(k),b=0,w=this._expecting,g=this.meshes.length,q=Object.keys(this.sets),m=0;m<q.length;m++){var y=q[m],l=new t.a(this.name+".TexturePack."+
y+"Set",{width:k.x,height:k.y},this.scene,!0,p.a.TRILINEAR_SAMPLINGMODE,a.a.TEXTUREFORMAT_RGBA),C=l.getContext();C.fillStyle="rgba(0,0,0,0)";C.fillRect(0,0,k.x,k.y);l.update(!1);this.sets[y]=l}var n=this.options.frameSize||256,z=this._paddingValue,r=n+2*z;for(m=0;m<g;m++){var F=this.meshes[m].material;y=function(a){var p=new t.a("temp",r,v.scene,!0),g=p.getContext(),A=v._getFrameOffset(m),y=function(){b++;p.update(!1);var c=g.getImageData(0,0,r,r),a=f.sets[h];a.getContext().putImageData(c,k.x*A.x,
k.y*A.y);p.dispose();a.update(!1);b==w&&(f._calculateMeshUVFrames(n,z,k,u,f.options.updateInputMeshes||!1),d())},h=q[a]||"_blank";if(F&&null!==F[h]){a=F[h];var x=new Image;x.src=a instanceof t.a?a.getContext().canvas.toDataURL("image/png"):a.url;e.b.SetCorsBehavior(x.src,x);x.onload=function(){g.fillStyle="rgba(0,0,0,0)";g.fillRect(0,0,r,r);p.update(!1);g.setTransform(1,0,0,-1,0,0);var a=[0,0,1,0,1,1,0,1,-1,1,-1,0,-2,0,-1,1,-1];switch(f.options.paddingMode){case 0:for(var d=0;9>d;d++)g.drawImage(x,
0,0,x.width,x.height,z+n*a[d],z+n*a[d+1]-r,n,n);break;case 1:for(d=0;d<z;d++)g.drawImage(x,0,0,x.width,x.height,d+n*a[0],z-r,n,n),g.drawImage(x,0,0,x.width,x.height,2*z-d,z-r,n,n),g.drawImage(x,0,0,x.width,x.height,z,d-r,n,n),g.drawImage(x,0,0,x.width,x.height,z,2*z-d-r,n,n);g.drawImage(x,0,0,x.width,x.height,z+n*a[0],z+n*a[1]-r,n,n);break;case 2:g.fillStyle=(f.options.paddingColor||c.a.Black()).toHexString(),g.fillRect(0,0,r,-r),g.clearRect(z,z,n,n),g.drawImage(x,0,0,x.width,x.height,z+n*a[0],z+
n*a[1]-r,n,n)}g.setTransform(1,0,0,1,0,0);y()}}else g.fillStyle="rgba(0,0,0,0)",v.options.fillBlanks&&(g.fillStyle=v.options.customFillColor),g.fillRect(0,0,r,r),y()};var v=this;for(l=0;l<q.length;l++)y(l)}};f.prototype._calculateSize=function(){var c=this.meshes.length||0,a=this.options.frameSize||0,d=this._paddingValue||0;switch(this.options.layout){case 0:return new h.d(a*c+2*d*c,a+2*d);case 1:var f=Math.max(2,Math.ceil(Math.sqrt(c)));a=a*f+2*d*f;return new h.d(a,a);case 2:return f=this.options.colnum||
1,c=Math.max(1,Math.ceil(c/f)),new h.d(a*f+2*d*f,a*c+2*d*c)}return h.d.Zero()};f.prototype._calculateMeshUVFrames=function(c,a,d,f,e){for(var u=this.meshes.length,p=0;p<u;p++){var b=this.meshes[p],g=new h.d(c/d.x,c/d.y),w=f.clone().scale(a);w=this._getFrameOffset(p).add(w);g=new k(p,g,w);this.frames.push(g);e&&(this._updateMeshUV(b,p),this._updateTextureReferences(b))}};f.prototype._getFrameOffset=function(c){var a=this.meshes.length;switch(this.options.layout){case 0:return new h.d(1/a*c,0);case 1:var d=
Math.max(2,Math.ceil(Math.sqrt(a)));a=Math.floor(c/d);var f=1/d;return new h.d((c-a*d)*f,a*f);case 2:f=this.options.colnum||1;var e=Math.max(1,Math.ceil(a/f));d=Math.floor(c/e);a=c-d*e;f=new h.d(1/f,1/e);return new h.d(d*f.x,a*f.y)}return h.d.Zero()};f.prototype._updateMeshUV=function(c,a){a=this.frames[a];var f=c.getVerticesData(this.options.uvsIn||d.b.UVKind),e=[],k=0;f.length&&(k=f.length||0);for(var u=0;u<k;u+=2)e.push(f[u]*a.scale.x+a.offset.x,f[u+1]*a.scale.y+a.offset.y);c.setVerticesData(this.options.uvsOut||
d.b.UVKind,e)};f.prototype._updateTextureReferences=function(c,a){void 0===a&&(a=!1);c=c.material;for(var d=Object.keys(this.sets),f=0;f<d.length;f++){var e=d[f];if(a){if(null!==c[e]){var k=c[e];k.dispose&&k.dispose()}c[e]=this.sets[e]}else{if(!c)break;null!==c[e]&&(k=c[e],k.dispose&&k.dispose(),c[e]=this.sets[e])}}};f.prototype.setMeshToFrame=function(c,a,d){void 0===d&&(d=!1);this._updateMeshUV(c,a);d&&this._updateTextureReferences(c,!0)};f.prototype.processAsync=function(){var c=this;return new Promise(function(a,
d){try{if(0===c.meshes.length)a();else for(var f=0,e=function(d){d=c.meshes[d];var e=d.material;if(!e)return f++,f===c.meshes.length?{value:c._createFrames(a)}:"continue";e.forceCompilationAsync(d).then(function(){f++;if(c.options.map){for(var d=0;d<c.options.map.length;d++)null!==e[c.options.map[d]]&&(c.sets[c.options.map[d]]||(c.sets[c.options.map[d]]=!0),c._expecting++);f===c.meshes.length&&c._createFrames(a)}})},k=0;k<c.meshes.length;k++){var u=e(k);if("object"===typeof u)return u.value}}catch(x){return d(x)}})};
f.prototype.dispose=function(){for(var c=Object.keys(this.sets),a=0;a<c.length;a++)this.sets[c[a]].dispose()};f.prototype.download=function(c,a){var d=this;void 0===c&&(c="png");void 0===a&&(a=1);setTimeout(function(){var f={name:d.name,sets:{},options:{},frames:[]},e=Object.keys(d.sets),k=Object.keys(d.options);try{for(var p=0;p<e.length;p++){var b=e[p];f.sets[b]=d.sets[b].getContext().canvas.toDataURL("image/"+c,a)}for(p=0;p<k.length;p++){var g=k[p];f.options[g]=d.options[g]}for(p=0;p<d.frames.length;p++){var w=
d.frames[p];f.frames.push(w.scale.x,w.scale.y,w.offset.x,w.offset.y)}}catch(I){u.a.Warn("Unable to download: "+I);return}f="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(f,null,4));e=document.createElement("a");e.setAttribute("href",f);e.setAttribute("download",d.name+"_texurePackage.json");document.body.appendChild(e);e.click();e.remove()},0)};f.prototype.updateFromJSON=function(c){try{var a=JSON.parse(c);this.name=a.name;var d=Object.keys(a.options);for(c=0;c<d.length;c++)this.options[d[c]]=
a.options[d[c]];for(c=0;c<a.frames.length;c+=4){var f=new k(c/4,new h.d(a.frames[c],a.frames[c+1]),new h.d(a.frames[c+2],a.frames[c+3]));this.frames.push(f)}var e=Object.keys(a.sets);for(c=0;c<e.length;c++){var b=new p.a(a.sets[e[c]],this.scene,!1,!1);this.sets[e[c]]=b}}catch(H){u.a.Warn("Unable to update from JSON: "+H)}};f.LAYOUT_STRIP=0;f.LAYOUT_POWER2=1;f.LAYOUT_COLNUM=2;f.SUBUV_WRAP=0;f.SUBUV_EXTEND=1;f.SUBUV_COLOR=2;return f})();r=b("jpcn");var f=b("Ksm9");(function(a){function d(c,d,f,e,k,
p){c=a.call(this,c,f,null,e,k,p)||this;c._animate=!0;c._time=0;c._texturePath=d;c._loadJson(d);c.refreshRate=1;return c}Object(l.d)(d,a);d.prototype._loadJson=function(c){var a=this,d=function(){try{a.setFragment(a._texturePath)}catch(G){u.a.Error("No json or ShaderStore or DOM element found for CustomProceduralTexture")}};c+="/config.json";var e=new f.a;e.open("GET",c);e.addEventListener("load",function(){if(200===e.status||e.responseText&&0<e.responseText.length)try{a._config=JSON.parse(e.response),
a.updateShaderUniforms(),a.updateTextures(),a.setFragment(a._texturePath+"/custom"),a._animate=a._config.animate,a.refreshRate=a._config.refreshrate}catch(G){d()}else d()},!1);e.addEventListener("error",function(){d()},!1);try{e.send()}catch(G){u.a.Error("CustomProceduralTexture: Error on XHR send request.")}};d.prototype.isReady=function(){if(!a.prototype.isReady.call(this))return!1;for(var c in this._textures)if(!this._textures[c].isReady())return!1;return!0};d.prototype.render=function(c){var d=
this.getScene();this._animate&&d&&(this._time+=.03*d.getAnimationRatio(),this.updateShaderUniforms());a.prototype.render.call(this,c)};d.prototype.updateTextures=function(){for(var c=0;c<this._config.sampler2Ds.length;c++)this.setTexture(this._config.sampler2Ds[c].sample2Dname,new p.a(this._texturePath+"/"+this._config.sampler2Ds[c].textureRelativeUrl,this.getScene()))};d.prototype.updateShaderUniforms=function(){if(this._config)for(var a=0;a<this._config.uniforms.length;a++){var d=this._config.uniforms[a];
switch(d.type){case "float":this.setFloat(d.name,d.value);break;case "color3":this.setColor3(d.name,new c.a(d.r,d.g,d.b));break;case "color4":this.setColor4(d.name,new c.b(d.r,d.g,d.b,d.a));break;case "vector2":this.setVector2(d.name,new h.d(d.x,d.y));break;case "vector3":this.setVector3(d.name,new h.e(d.x,d.y,d.z))}}this.setFloat("time",this._time)};Object.defineProperty(d.prototype,"animate",{get:function(){return this._animate},set:function(c){this._animate=c},enumerable:!1,configurable:!0});return d})(r.a);
var w=b("e2Mr");b("V3id");r=function(c){function a(a,d,f,e,k){void 0===d&&(d=256);void 0===f&&(f=w.a.LastCreatedScene);a=c.call(this,a,d,"noise",f,e,k)||this;a.time=0;a.brightness=.2;a.octaves=3;a.persistence=.8;a.animationSpeedFactor=1;a.autoClear=!1;a._updateShaderUniforms();return a}Object(l.d)(a,c);a.prototype._updateShaderUniforms=function(){var c=this.getScene();c&&(this.time+=c.getAnimationRatio()*this.animationSpeedFactor*.01,this.setFloat("brightness",this.brightness),this.setFloat("persistence",
this.persistence),this.setFloat("timeScale",this.time))};a.prototype._getDefines=function(){return"#define OCTAVES "+(this.octaves|0)};a.prototype.render=function(a){this._updateShaderUniforms();c.prototype.render.call(this,a)};a.prototype.serialize=function(){var c={customType:"BABYLON.NoiseProceduralTexture"};c.brightness=this.brightness;c.octaves=this.octaves;c.persistence=this.persistence;c.animationSpeedFactor=this.animationSpeedFactor;c.size=this.getSize().width;c.generateMipMaps=this._generateMipMaps;
c.time=this.time;return c};a.prototype.clone=function(){var c=this.getSize();c=new a(this.name,c.width,this.getScene(),this._fallbackTexture?this._fallbackTexture:void 0,this._generateMipMaps);c.hasAlpha=this.hasAlpha;c.level=this.level;c.coordinatesMode=this.coordinatesMode;c.brightness=this.brightness;c.octaves=this.octaves;c.persistence=this.persistence;c.animationSpeedFactor=this.animationSpeedFactor;c.time=this.time;return c};a.Parse=function(c,d){var f;d=new a(c.name,c.size,d,void 0,c.generateMipMaps);
d.brightness=c.brightness;d.octaves=c.octaves;d.persistence=c.persistence;d.animationSpeedFactor=c.animationSpeedFactor;d.time=null!==(f=c.time)&&void 0!==f?f:0;return d};return a}(r.a);n.a.RegisteredTypes["BABYLON.NoiseProceduralTexture"]=r;b("Irc+");b("o7xM");b("T5W1");(function(c){function a(a,d,f,e,k,u,b,g,w,q){void 0===b&&(b=!0);void 0===g&&(g=!1);void 0===w&&(w=p.a.TRILINEAR_SAMPLINGMODE);void 0===q&&(q=0);var m=c.call(this,null,u,!b,g)||this;m.format=k;m._texture=u.getEngine().createRawTexture2DArray(a,
d,f,e,k,b,g,w,null,q);m.is2DArray=!0;return m}Object(l.d)(a,c);a.prototype.update=function(c){this._texture&&this._getEngine().updateRawTexture2DArray(this._texture,c,this._texture.format,this._texture.invertY,null,this._texture.type)};return a})(p.a);(function(c){function a(a,d,f,e,k,u,b,g,w,q){void 0===b&&(b=!0);void 0===g&&(g=!1);void 0===w&&(w=p.a.TRILINEAR_SAMPLINGMODE);void 0===q&&(q=0);var m=c.call(this,null,u,!b,g)||this;m.format=k;m._texture=u.getEngine().createRawTexture3D(a,d,f,e,k,b,g,
w,null,q);m.is3D=!0;return m}Object(l.d)(a,c);a.prototype.update=function(c){this._texture&&this._getEngine().updateRawTexture3D(this._texture,c,this._texture.format,this._texture.invertY,null,this._texture.type)};return a})(p.a);var C=b("j2cH"),F=b("srWW");(function(c){function a(a,d,f,e){var k=c.call(this,a,d,f,e,!0)||this;k.refractionPlane=new C.a(0,1,0,1);k.depth=2;k.onBeforeRenderObservable.add(function(){f.clipPlane=k.refractionPlane});k.onAfterRenderObservable.add(function(){f.clipPlane=null});
return k}Object(l.d)(a,c);a.prototype.clone=function(){var c=this.getScene();if(!c)return this;var d=this.getSize();c=new a(this.name,d.width,c,this._generateMipMaps);c.hasAlpha=this.hasAlpha;c.level=this.level;c.refractionPlane=this.refractionPlane.clone();this.renderList&&(c.renderList=this.renderList.slice(0));c.depth=this.depth;return c};a.prototype.serialize=function(){if(!this.name)return null;var a=c.prototype.serialize.call(this);a.mirrorPlane=this.refractionPlane.asArray();a.depth=this.depth;
return a};return a})(F.a);b("c/3c")},"/vHJ":function(n,r,b){b.d(r,"a",function(){return e});var l=b("oYeq"),h=b("/SR9");n=b("WIi2");var v=b("aCSs"),t=b("uyjK"),m=b("t8Py");r=b("WHS4");var a=b("YKqZ"),q=b("MhaC"),g=b("h5cR");b("83xy");b("OFzk");var e=function(d){function e(c,e,u,f,b,g,p,q,m){void 0===f&&(f=!1);void 0===b&&(b=!0);void 0===g&&(g=!1);void 0===p&&(p=!1);void 0===q&&(q=null);void 0===m&&(m=null);var k;e=d.call(this,e)||this;e._generateHarmonics=!0;e._onLoad=null;e._onError=null;e._isBlocking=
!0;e._rotationY=0;e.boundingBoxPosition=h.e.Zero();if(!c)return e;e._coordinatesMode=v.a.CUBIC_MODE;e.name=c;e.url=c;e.hasAlpha=!1;e.isCube=!0;e._textureMatrix=h.a.Identity();e._prefilterOnLoad=p;e._onLoad=q;e._onError=m;e.gammaSpace=g;e._noMipmap=f;e._size=u;e._generateHarmonics=b;e._texture=e._getFromCache(c,e._noMipmap);e._texture?q&&(e._texture.isReady?a.b.SetImmediate(function(){return q()}):e._texture.onLoadedObservable.add(q)):(null===(k=e.getScene())||void 0===k?0:k.useDelayedTextureLoading)?
e.delayLoadState=4:e.loadTexture();return e}Object(l.d)(e,d);Object.defineProperty(e.prototype,"isBlocking",{get:function(){return this._isBlocking},set:function(c){this._isBlocking=c},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"rotationY",{get:function(){return this._rotationY},set:function(c){this._rotationY=c;this.setReflectionTextureMatrix(h.a.RotationY(this._rotationY))},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"boundingBoxSize",{get:function(){return this._boundingBoxSize},
set:function(c){this._boundingBoxSize&&this._boundingBoxSize.equals(c)||(this._boundingBoxSize=c,(c=this.getScene())&&c.markAllMaterialsAsDirty(1))},enumerable:!1,configurable:!0});e.prototype.getClassName=function(){return"HDRCubeTexture"};e.prototype.loadTexture=function(){var c=this,a=this._getEngine();if(2<=this._getEngine().webGLVersion&&this._prefilterOnLoad){var d=this._onLoad,f=new g.a(a);this._onLoad=function(){f.prefilter(c,d)}}this._texture=a.createRawCubeTextureFromUrl(this.url,this.getScene(),
this._size,4,a.getCaps().textureFloat?1:0,this._noMipmap,function(d){c.lodGenerationOffset=0;c.lodGenerationScale=.8;d=t.a.GetCubeMapTextureData(d,c._size);if(c._generateHarmonics){var f=m.a.ConvertCubeMapToSphericalPolynomial(d);c.sphericalPolynomial=f}f=[];for(var k=null,u=0;6>u;u++){a.getCaps().textureFloat||(k=new ArrayBuffer(c._size*c._size*3),k=new Uint8Array(k));var b=d[e._facesMapping[u]];if(c.gammaSpace||k)for(var g=0;g<c._size*c._size;g++)if(c.gammaSpace&&(b[3*g]=Math.pow(b[3*g],q.b),b[3*
g+1]=Math.pow(b[3*g+1],q.b),b[3*g+2]=Math.pow(b[3*g+2],q.b)),k){var p=Math.max(255*b[3*g],0),w=Math.max(255*b[3*g+1],0),h=Math.max(255*b[3*g+2],0),l=Math.max(Math.max(p,w),h);255<l&&(l=255/l,p*=l,w*=l,h*=l);k[3*g]=p;k[3*g+1]=w;k[3*g+2]=h}k?f.push(k):f.push(b)}return f},null,this._onLoad,this._onError)};e.prototype.clone=function(){var c=new e(this.url,this.getScene()||this._getEngine(),this._size,this._noMipmap,this._generateHarmonics,this.gammaSpace);c.level=this.level;c.wrapU=this.wrapU;c.wrapV=
this.wrapV;c.coordinatesIndex=this.coordinatesIndex;c.coordinatesMode=this.coordinatesMode;return c};e.prototype.delayLoad=function(){4===this.delayLoadState&&(this.delayLoadState=1,(this._texture=this._getFromCache(this.url,this._noMipmap))||this.loadTexture())};e.prototype.getReflectionTextureMatrix=function(){return this._textureMatrix};e.prototype.setReflectionTextureMatrix=function(c){var a=this,d;this._textureMatrix=c;c.updateFlag!==this._textureMatrix.updateFlag&&c.isIdentity()!==this._textureMatrix.isIdentity()&&
(null===(d=this.getScene())||void 0===d?void 0:d.markAllMaterialsAsDirty(1,function(c){return-1!==c.getActiveTextures().indexOf(a)}))};e.Parse=function(c,a,d){var f=null;c.name&&!c.isRenderTarget&&(f=new e(d+c.name,a,c.size,c.noMipmap,c.generateHarmonics,c.useInGammaSpace),f.name=c.name,f.hasAlpha=c.hasAlpha,f.level=c.level,f.coordinatesMode=c.coordinatesMode,f.isBlocking=c.isBlocking);f&&(c.boundingBoxPosition&&(f.boundingBoxPosition=h.e.FromArray(c.boundingBoxPosition)),c.boundingBoxSize&&(f.boundingBoxSize=
h.e.FromArray(c.boundingBoxSize)),c.rotationY&&(f.rotationY=c.rotationY));return f};e.prototype.serialize=function(){if(!this.name)return null;var c={};c.name=this.name;c.hasAlpha=this.hasAlpha;c.isCube=!0;c.level=this.level;c.size=this._size;c.coordinatesMode=this.coordinatesMode;c.useInGammaSpace=this.gammaSpace;c.generateHarmonics=this._generateHarmonics;c.customType="BABYLON.HDRCubeTexture";c.noMipmap=this._noMipmap;c.isBlocking=this._isBlocking;c.rotationY=this._rotationY;return c};e._facesMapping=
"right left up down front back".split(" ");return e}(n.a);r.a.RegisteredTypes["BABYLON.HDRCubeTexture"]=e},"0YF5":function(n,r,b){b.d(r,"a",function(){return t});var l=b("oYeq"),h=b("ADVu"),v=b("Xeau"),t=function(){function b(){this._dirty=!0;this._tempColor=new v.b(0,0,0,0);this._globalCurve=new v.b(0,0,0,0);this._highlightsCurve=new v.b(0,0,0,0);this._midtonesCurve=new v.b(0,0,0,0);this._shadowsCurve=new v.b(0,0,0,0);this._positiveCurve=new v.b(0,0,0,0);this._negativeCurve=new v.b(0,0,0,0);this._globalHue=
30;this._globalExposure=this._globalSaturation=this._globalDensity=0;this._highlightsHue=30;this._highlightsExposure=this._highlightsSaturation=this._highlightsDensity=0;this._midtonesHue=30;this._midtonesExposure=this._midtonesSaturation=this._midtonesDensity=0;this._shadowsHue=30;this._shadowsExposure=this._shadowsSaturation=this._shadowsDensity=0}Object.defineProperty(b.prototype,"globalHue",{get:function(){return this._globalHue},set:function(a){this._globalHue=a;this._dirty=!0},enumerable:!1,
configurable:!0});Object.defineProperty(b.prototype,"globalDensity",{get:function(){return this._globalDensity},set:function(a){this._globalDensity=a;this._dirty=!0},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"globalSaturation",{get:function(){return this._globalSaturation},set:function(a){this._globalSaturation=a;this._dirty=!0},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"globalExposure",{get:function(){return this._globalExposure},set:function(a){this._globalExposure=
a;this._dirty=!0},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"highlightsHue",{get:function(){return this._highlightsHue},set:function(a){this._highlightsHue=a;this._dirty=!0},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"highlightsDensity",{get:function(){return this._highlightsDensity},set:function(a){this._highlightsDensity=a;this._dirty=!0},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"highlightsSaturation",{get:function(){return this._highlightsSaturation},
set:function(a){this._highlightsSaturation=a;this._dirty=!0},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"highlightsExposure",{get:function(){return this._highlightsExposure},set:function(a){this._highlightsExposure=a;this._dirty=!0},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"midtonesHue",{get:function(){return this._midtonesHue},set:function(a){this._midtonesHue=a;this._dirty=!0},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"midtonesDensity",
{get:function(){return this._midtonesDensity},set:function(a){this._midtonesDensity=a;this._dirty=!0},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"midtonesSaturation",{get:function(){return this._midtonesSaturation},set:function(a){this._midtonesSaturation=a;this._dirty=!0},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"midtonesExposure",{get:function(){return this._midtonesExposure},set:function(a){this._midtonesExposure=a;this._dirty=!0},enumerable:!1,configurable:!0});
Object.defineProperty(b.prototype,"shadowsHue",{get:function(){return this._shadowsHue},set:function(a){this._shadowsHue=a;this._dirty=!0},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"shadowsDensity",{get:function(){return this._shadowsDensity},set:function(a){this._shadowsDensity=a;this._dirty=!0},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"shadowsSaturation",{get:function(){return this._shadowsSaturation},set:function(a){this._shadowsSaturation=a;this._dirty=
!0},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"shadowsExposure",{get:function(){return this._shadowsExposure},set:function(a){this._shadowsExposure=a;this._dirty=!0},enumerable:!1,configurable:!0});b.prototype.getClassName=function(){return"ColorCurves"};b.Bind=function(a,b,g,e,d){void 0===g&&(g="vCameraColorCurvePositive");void 0===e&&(e="vCameraColorCurveNeutral");void 0===d&&(d="vCameraColorCurveNegative");a._dirty&&(a._dirty=!1,a.getColorGradingDataToRef(a._globalHue,a._globalDensity,
a._globalSaturation,a._globalExposure,a._globalCurve),a.getColorGradingDataToRef(a._highlightsHue,a._highlightsDensity,a._highlightsSaturation,a._highlightsExposure,a._tempColor),a._tempColor.multiplyToRef(a._globalCurve,a._highlightsCurve),a.getColorGradingDataToRef(a._midtonesHue,a._midtonesDensity,a._midtonesSaturation,a._midtonesExposure,a._tempColor),a._tempColor.multiplyToRef(a._globalCurve,a._midtonesCurve),a.getColorGradingDataToRef(a._shadowsHue,a._shadowsDensity,a._shadowsSaturation,a._shadowsExposure,
a._tempColor),a._tempColor.multiplyToRef(a._globalCurve,a._shadowsCurve),a._highlightsCurve.subtractToRef(a._midtonesCurve,a._positiveCurve),a._midtonesCurve.subtractToRef(a._shadowsCurve,a._negativeCurve));b&&(b.setFloat4(g,a._positiveCurve.r,a._positiveCurve.g,a._positiveCurve.b,a._positiveCurve.a),b.setFloat4(e,a._midtonesCurve.r,a._midtonesCurve.g,a._midtonesCurve.b,a._midtonesCurve.a),b.setFloat4(d,a._negativeCurve.r,a._negativeCurve.g,a._negativeCurve.b,a._negativeCurve.a))};b.PrepareUniforms=
function(a){a.push("vCameraColorCurveNeutral","vCameraColorCurvePositive","vCameraColorCurveNegative")};b.prototype.getColorGradingDataToRef=function(a,q,g,e,d){null!=a&&(a=b.clamp(a,0,360),q=b.clamp(q,-100,100),g=b.clamp(g,-100,100),e=b.clamp(e,-100,100),q=b.applyColorGradingSliderNonlinear(q),q*=.5,e=b.applyColorGradingSliderNonlinear(e),0>q&&(q*=-1,a=(a+180)%360),b.fromHSBToRef(a,q,50+.25*e,d),d.scaleToRef(2,d),d.a=1+.01*g)};b.applyColorGradingSliderNonlinear=function(a){a/=100;var b=Math.abs(a);
b=Math.pow(b,2);0>a&&(b*=-1);return 100*b};b.fromHSBToRef=function(a,q,g,e){var d=b.clamp(a,0,360);q=b.clamp(q/100,0,1);g=b.clamp(g/100,0,1);if(0===q)e.r=g,e.g=g,e.b=g;else{d/=60;a=Math.floor(d);var p=d-a;d=g*(1-q);var c=g*(1-q*p);q=g*(1-q*(1-p));switch(a){case 0:e.r=g;e.g=q;e.b=d;break;case 1:e.r=c;e.g=g;e.b=d;break;case 2:e.r=d;e.g=g;e.b=q;break;case 3:e.r=d;e.g=c;e.b=g;break;case 4:e.r=q;e.g=d;e.b=g;break;default:e.r=g,e.g=d,e.b=c}}e.a=1};b.clamp=function(a,b,g){return Math.min(Math.max(a,b),g)};
b.prototype.clone=function(){return h.a.Clone(function(){return new b},this)};b.prototype.serialize=function(){return h.a.Serialize(this)};b.Parse=function(a){return h.a.Parse(function(){return new b},a,null,null)};Object(l.c)([Object(h.c)()],b.prototype,"_globalHue",void 0);Object(l.c)([Object(h.c)()],b.prototype,"_globalDensity",void 0);Object(l.c)([Object(h.c)()],b.prototype,"_globalSaturation",void 0);Object(l.c)([Object(h.c)()],b.prototype,"_globalExposure",void 0);Object(l.c)([Object(h.c)()],
b.prototype,"_highlightsHue",void 0);Object(l.c)([Object(h.c)()],b.prototype,"_highlightsDensity",void 0);Object(l.c)([Object(h.c)()],b.prototype,"_highlightsSaturation",void 0);Object(l.c)([Object(h.c)()],b.prototype,"_highlightsExposure",void 0);Object(l.c)([Object(h.c)()],b.prototype,"_midtonesHue",void 0);Object(l.c)([Object(h.c)()],b.prototype,"_midtonesDensity",void 0);Object(l.c)([Object(h.c)()],b.prototype,"_midtonesSaturation",void 0);Object(l.c)([Object(h.c)()],b.prototype,"_midtonesExposure",
void 0);return b}();h.a._ColorCurvesParser=t.Parse},"5qAZ":function(n,r,b){var l=b("xChT"),h=b("GFqQ");n=b("qUIE");var v=b("X2Ve"),t=b("uyO6");b=function(){function b(){this.supportCascades=!1}b.prototype.canLoad=function(a,b){return v.a.EndsWith(a,".ktx")||v.a.EndsWith(a,".ktx2")||"image/ktx"===b||"image/ktx2"===b};b.prototype.loadCubeData=function(a,b,g,e,d){Array.isArray(a)||(b._invertVScale=!b.invertY,g=b.getEngine(),a=new l.a(a,6),d=1<a.numberOfMipmapLevels&&b.generateMipMaps,g._unpackFlipY(!0),
a.uploadLevels(b,b.generateMipMaps),b.width=a.pixelWidth,b.height=a.pixelHeight,g._setCubeMapTextureParams(b,d),b.isReady=!0,b.onLoadedObservable.notifyObservers(b),b.onLoadedObservable.clear(),e&&e())};b.prototype.loadData=function(a,b,g,e){if(l.a.IsValid(a)){b._invertVScale=!b.invertY;var d=new l.a(a,1);g(d.pixelWidth,d.pixelHeight,b.generateMipMaps,!0,function(){d.uploadLevels(b,b.generateMipMaps)},d.isInvalid)}else h.a.IsValid(a)?(new h.a(b.getEngine())).uploadAsync(a,b,e).then(function(){g(b.width,
b.height,b.generateMipMaps,!0,function(){},!1)},function(a){t.a.Warn("Failed to load KTX2 texture data: "+a.message);g(0,0,!1,!1,function(){},!0)}):(t.a.Error("texture missing KTX identifier"),g(0,0,!1,!1,function(){},!0))};return b}();n.a._TextureLoaders.unshift(new b)},"9DX3":function(n,r,b){b.d(r,"a",function(){return l});var l=function(){return function(){}}()},Als7:function(n,r,b){b.d(r,"a",function(){return v});var l=b("oYeq");n=b("srWW");var h=b("k2R8"),v=function(b){function m(a,q){void 0===
q&&(q=512);q=b.call(this,"multiview rtt",q,a,!1,!0,h.b.Unknown,!1,void 0,!1,!1,!0,void 0,!0)||this;a=a.getEngine().createMultiviewRenderTargetTexture(q.getRenderWidth(),q.getRenderHeight());a.isMultiview=!0;a.format=5;q._texture=a;q.samples=q._getEngine().getCaps().maxSamples||q.samples;return q}Object(l.d)(m,b);m.prototype._bindFrameBuffer=function(a){this._texture&&this.getScene().getEngine().bindMultiviewFramebuffer(this._texture)};m.prototype.getViewCount=function(){return 2};return m}(n.a)},
"Irc+":function(n,r,b){b.d(r,"a",function(){return v});var l=b("YKqZ"),h=b("Yap0"),v=function(){function b(b){this.name=h.a.NAME_PROCEDURALTEXTURE;this.scene=b;this.scene.proceduralTextures=[]}b.prototype.register=function(){this.scene._beforeClearStage.registerStep(h.a.STEP_BEFORECLEAR_PROCEDURALTEXTURE,this,this._beforeClear)};b.prototype.rebuild=function(){};b.prototype.dispose=function(){};b.prototype._beforeClear=function(){if(this.scene.proceduralTexturesEnabled){l.b.StartPerformanceCounter("Procedural textures",
0<this.scene.proceduralTextures.length);for(var b=0;b<this.scene.proceduralTextures.length;b++){var a=this.scene.proceduralTextures[b];a._shouldRender()&&a.render()}l.b.EndPerformanceCounter("Procedural textures",0<this.scene.proceduralTextures.length)}};return b}()},JUU8:function(n,r,b){b.d(r,"a",function(){return a});var l=b("oYeq"),h=b("/SR9"),v=b("aCSs");n=b("srWW");var t=b("AGTA"),m=b("j2cH"),a=function(a){function b(b,d,g,c,k,u,f){void 0===k&&(k=0);void 0===u&&(u=v.a.BILINEAR_SAMPLINGMODE);
void 0===f&&(f=!0);var e=a.call(this,b,d,g,c,!0,k,!1,u,f)||this;e.scene=g;e.mirrorPlane=new m.a(0,1,0,1);e._transformMatrix=h.a.Zero();e._mirrorMatrix=h.a.Zero();e._adaptiveBlurKernel=0;e._blurKernelX=0;e._blurKernelY=0;e._blurRatio=1;e.ignoreCameraViewport=!0;e._updateGammaSpace();e._imageProcessingConfigChangeObserver=g.imageProcessingConfiguration.onUpdateParameters.add(function(){e._updateGammaSpace});e.onBeforeRenderObservable.add(function(){h.a.ReflectionToRef(e.mirrorPlane,e._mirrorMatrix);
e._savedViewMatrix=g.getViewMatrix();e._mirrorMatrix.multiplyToRef(e._savedViewMatrix,e._transformMatrix);g.setTransformMatrix(e._transformMatrix,g.getProjectionMatrix());g.clipPlane=e.mirrorPlane;g.getEngine().cullBackFaces=!1;g._mirroredCameraPosition=h.e.TransformCoordinates(g.activeCamera.globalPosition,e._mirrorMatrix)});e.onAfterRenderObservable.add(function(){g.setTransformMatrix(e._savedViewMatrix,g.getProjectionMatrix());g.getEngine().cullBackFaces=!0;g._mirroredCameraPosition=null;g.clipPlane=
null});return e}Object(l.d)(b,a);Object.defineProperty(b.prototype,"blurRatio",{get:function(){return this._blurRatio},set:function(a){this._blurRatio!==a&&(this._blurRatio=a,this._preparePostProcesses())},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"adaptiveBlurKernel",{set:function(a){this._adaptiveBlurKernel=a;this._autoComputeBlurKernel()},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"blurKernel",{set:function(a){this.blurKernelY=this.blurKernelX=a},
enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"blurKernelX",{get:function(){return this._blurKernelX},set:function(a){this._blurKernelX!==a&&(this._blurKernelX=a,this._preparePostProcesses())},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"blurKernelY",{get:function(){return this._blurKernelY},set:function(a){this._blurKernelY!==a&&(this._blurKernelY=a,this._preparePostProcesses())},enumerable:!1,configurable:!0});b.prototype._autoComputeBlurKernel=function(){var a=
this.getScene().getEngine(),d=this.getRenderWidth()/a.getRenderWidth();a=this.getRenderHeight()/a.getRenderHeight();this.blurKernelX=this._adaptiveBlurKernel*d;this.blurKernelY=this._adaptiveBlurKernel*a};b.prototype._onRatioRescale=function(){this._sizeRatio&&(this.resize(this._initialSizeParameter),this._adaptiveBlurKernel||this._preparePostProcesses());this._adaptiveBlurKernel&&this._autoComputeBlurKernel()};b.prototype._updateGammaSpace=function(){this.gammaSpace=!this.scene.imageProcessingConfiguration.isEnabled||
!this.scene.imageProcessingConfiguration.applyByPostProcess};b.prototype._preparePostProcesses=function(){this.clearPostProcesses(!0);if(this._blurKernelX&&this._blurKernelY){var a=this.getScene().getEngine(),d=a.getCaps().textureFloatRender?1:2;this._blurX=new t.a("horizontal blur",new h.d(1,0),this._blurKernelX,this._blurRatio,null,v.a.BILINEAR_SAMPLINGMODE,a,!1,d);this._blurX.autoClear=!1;1===this._blurRatio&&2>this.samples&&this._texture?this._blurX.inputTexture=this._texture:this._blurX.alwaysForcePOT=
!0;this._blurY=new t.a("vertical blur",new h.d(0,1),this._blurKernelY,this._blurRatio,null,v.a.BILINEAR_SAMPLINGMODE,a,!1,d);this._blurY.autoClear=!1;this._blurY.alwaysForcePOT=1!==this._blurRatio;this.addPostProcess(this._blurX);this.addPostProcess(this._blurY)}else this._blurY&&(this.removePostProcess(this._blurY),this._blurY.dispose(),this._blurY=null),this._blurX&&(this.removePostProcess(this._blurX),this._blurX.dispose(),this._blurX=null)};b.prototype.clone=function(){var a=this.getScene();if(!a)return this;
var d=this.getSize();a=new b(this.name,d.width,a,this._renderTargetOptions.generateMipMaps,this._renderTargetOptions.type,this._renderTargetOptions.samplingMode,this._renderTargetOptions.generateDepthBuffer);a.hasAlpha=this.hasAlpha;a.level=this.level;a.mirrorPlane=this.mirrorPlane.clone();this.renderList&&(a.renderList=this.renderList.slice(0));return a};b.prototype.serialize=function(){if(!this.name)return null;var b=a.prototype.serialize.call(this);b.mirrorPlane=this.mirrorPlane.asArray();return b};
b.prototype.dispose=function(){a.prototype.dispose.call(this);this.scene.imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingConfigChangeObserver)};return b}(n.a);v.a._CreateMirror=function(b,g,e,d){return new a(b,g,e,d)}},OFzk:function(n,r,b){var l=b("t8Py");n=b("WIi2");Object.defineProperty(n.a.prototype,"sphericalPolynomial",{get:function(){if(this._texture){if(this._texture._sphericalPolynomial)return this._texture._sphericalPolynomial;if(this._texture.isReady)return this._texture._sphericalPolynomial=
l.a.ConvertCubeMapTextureToSphericalPolynomial(this),this._texture._sphericalPolynomial}return null},set:function(b){this._texture&&(this._texture._sphericalPolynomial=b)},enumerable:!0,configurable:!0})},RWrB:function(n,r,b){b.d(r,"a",function(){return v});var l=b("oYeq"),h=b("aCSs");n=b("srWW");b("+0P/");var v=function(b){function m(a,q,g,e,d){var p=d&&d.generateMipMaps?d.generateMipMaps:!1,c=d&&d.generateDepthTexture?d.generateDepthTexture:!1;a=b.call(this,a,q,e,p,d&&void 0!==d.doNotChangeAspectRatio?
d.doNotChangeAspectRatio:!0)||this;if(a.isSupported){e=[];var k=[];a._initTypes(g,e,k,d);var u=d&&void 0!==d.generateDepthBuffer?d.generateDepthBuffer:!0;d=d&&void 0!==d.generateStencilBuffer?d.generateStencilBuffer:!1;a._size=q;a._multiRenderTargetOptions={samplingModes:k,generateMipMaps:p,generateDepthBuffer:u,generateStencilBuffer:d,generateDepthTexture:c,types:e,textureCount:g};a._count=g;a._createInternalTextures();a._createTextures();return a}a.dispose()}Object(l.d)(m,b);Object.defineProperty(m.prototype,
"isSupported",{get:function(){return 1<this._getEngine().webGLVersion||this._getEngine().getCaps().drawBuffersExtension},enumerable:!1,configurable:!0});Object.defineProperty(m.prototype,"textures",{get:function(){return this._textures},enumerable:!1,configurable:!0});Object.defineProperty(m.prototype,"count",{get:function(){return this._count},enumerable:!1,configurable:!0});Object.defineProperty(m.prototype,"depthTexture",{get:function(){return this._textures[this._textures.length-1]},enumerable:!1,
configurable:!0});Object.defineProperty(m.prototype,"wrapU",{set:function(a){if(this._textures)for(var b=0;b<this._textures.length;b++)this._textures[b].wrapU=a},enumerable:!1,configurable:!0});Object.defineProperty(m.prototype,"wrapV",{set:function(a){if(this._textures)for(var b=0;b<this._textures.length;b++)this._textures[b].wrapV=a},enumerable:!1,configurable:!0});m.prototype._initTypes=function(a,b,g,e){for(var d=0;d<a;d++)e&&e.types&&void 0!==e.types[d]?b.push(e.types[d]):b.push(e&&e.defaultType?
e.defaultType:0),e&&e.samplingModes&&void 0!==e.samplingModes[d]?g.push(e.samplingModes[d]):g.push(h.a.BILINEAR_SAMPLINGMODE)};m.prototype._rebuild=function(a){void 0===a&&(a=!1);this.releaseInternalTextures();this._createInternalTextures();a&&this._createTextures();for(a=0;a<this._internalTextures.length;a++)this._textures[a]._texture=this._internalTextures[a];this._texture=this._internalTextures[0];1!==this.samples&&this._getEngine().updateMultipleRenderTargetTextureSampleCount(this._internalTextures,
this.samples)};m.prototype._createInternalTextures=function(){this._internalTextures=this._getEngine().createMultipleRenderTarget(this._size,this._multiRenderTargetOptions)};m.prototype._createTextures=function(){this._textures=[];for(var a=0;a<this._internalTextures.length;a++){var b=new h.a(null,this.getScene());b._texture=this._internalTextures[a];this._textures.push(b)}this._texture=this._internalTextures[0]};m.prototype.replaceTexture=function(a,b){a._texture&&(this._textures[b]=a,this._internalTextures[b]=
a._texture)};Object.defineProperty(m.prototype,"samples",{get:function(){return this._samples},set:function(a){this._samples!==a&&(this._samples=this._getEngine().updateMultipleRenderTargetTextureSampleCount(this._internalTextures,a))},enumerable:!1,configurable:!0});m.prototype.resize=function(a){this._size=a;this._rebuild()};m.prototype.updateCount=function(a,b){this._count=this._multiRenderTargetOptions.textureCount=a;var g=[],e=[];this._initTypes(a,g,e,b);this._multiRenderTargetOptions.types=
g;this._multiRenderTargetOptions.samplingModes=e;this._rebuild(!0)};m.prototype.unbindFrameBuffer=function(a,b){var g=this;a.unBindMultiColorAttachmentFramebuffer(this._internalTextures,this.isCube,function(){g.onAfterRenderObservable.notifyObservers(b)})};m.prototype.dispose=function(){this.releaseInternalTextures();b.prototype.dispose.call(this)};m.prototype.releaseInternalTextures=function(){if(this._internalTextures)for(var a=this._internalTextures.length-1;0<=a;a--)void 0!==this._internalTextures[a]&&
(this._internalTextures[a].dispose(),this._internalTextures.splice(a,1))};return m}(n.a)},T5W1:function(n,r,b){b.d(r,"a",function(){return v});var l=b("oYeq"),h=b("aCSs");b("83xy");var v=function(b){function m(a,q,g,e,d,p,c,k,u){void 0===p&&(p=!0);void 0===c&&(c=!1);void 0===k&&(k=3);void 0===u&&(u=0);d=b.call(this,null,d,!p,c)||this;d.format=e;if(!d._engine)return d;d._texture=d._engine.createRawTexture(a,q,g,e,p,c,k,null,u);d.wrapU=h.a.CLAMP_ADDRESSMODE;d.wrapV=h.a.CLAMP_ADDRESSMODE;return d}Object(l.d)(m,
b);m.prototype.update=function(a){this._getEngine().updateRawTexture(this._texture,a,this._texture.format,this._texture.invertY,null,this._texture.type)};m.CreateLuminanceTexture=function(a,b,g,e,d,p,c){void 0===d&&(d=!0);void 0===p&&(p=!1);void 0===c&&(c=3);return new m(a,b,g,1,e,d,p,c)};m.CreateLuminanceAlphaTexture=function(a,b,g,e,d,p,c){void 0===d&&(d=!0);void 0===p&&(p=!1);void 0===c&&(c=3);return new m(a,b,g,2,e,d,p,c)};m.CreateAlphaTexture=function(a,b,g,e,d,p,c){void 0===d&&(d=!0);void 0===
p&&(p=!1);void 0===c&&(c=3);return new m(a,b,g,0,e,d,p,c)};m.CreateRGBTexture=function(a,b,g,e,d,p,c,k){void 0===d&&(d=!0);void 0===p&&(p=!1);void 0===c&&(c=3);void 0===k&&(k=0);return new m(a,b,g,4,e,d,p,c,k)};m.CreateRGBATexture=function(a,b,g,e,d,p,c,k){void 0===d&&(d=!0);void 0===p&&(p=!1);void 0===c&&(c=3);void 0===k&&(k=0);return new m(a,b,g,5,e,d,p,c,k)};m.CreateRTexture=function(a,b,g,e,d,p,c,k){void 0===d&&(d=!0);void 0===p&&(p=!1);void 0===c&&(c=h.a.TRILINEAR_SAMPLINGMODE);void 0===k&&(k=
1);return new m(a,b,g,6,e,d,p,c,k)};return m}(h.a)},Uh4t:function(n,r,b){var l=b("TUvE");n=b("qUIE");var h=b("zB3A"),v=b("X2Ve");b=function(){function b(){this.supportCascades=!0}b.prototype.canLoad=function(b){return v.a.EndsWith(b,".dds")};b.prototype.loadCubeData=function(b,a,q,g,e){e=a.getEngine();var d=!1;if(Array.isArray(b))for(q=0;q<b.length;q++){var p=b[q];var c=h.a.GetDDSInfo(p);a.width=c.width;a.height=c.height;d=(c.isRGB||c.isLuminance||1<c.mipmapCount)&&a.generateMipMaps;e._unpackFlipY(c.isCompressed);
h.a.UploadDDSLevels(e,a,p,c,d,6,-1,q);c.isFourCC||1!==c.mipmapCount||e.generateMipMapsForCubemap(a)}else c=h.a.GetDDSInfo(b),a.width=c.width,a.height=c.height,q&&(c.sphericalPolynomial=new l.b),d=(c.isRGB||c.isLuminance||1<c.mipmapCount)&&a.generateMipMaps,e._unpackFlipY(c.isCompressed),h.a.UploadDDSLevels(e,a,b,c,d,6),c.isFourCC||1!==c.mipmapCount||e.generateMipMapsForCubemap(a,!1);e._setCubeMapTextureParams(a,d);a.isReady=!0;a.onLoadedObservable.notifyObservers(a);a.onLoadedObservable.clear();g&&
g({isDDS:!0,width:a.width,info:c,data:b,texture:a})};b.prototype.loadData=function(b,a,q){var g=h.a.GetDDSInfo(b),e=(g.isRGB||g.isLuminance||1<g.mipmapCount)&&a.generateMipMaps&&1===g.width>>g.mipmapCount-1;q(g.width,g.height,e,g.isFourCC,function(){h.a.UploadDDSLevels(a.getEngine(),a,b,g,e,1)})};return b}();n.a._TextureLoaders.push(new b)},VUtr:function(n,r,b){b.d(r,"a",function(){return m});var l=b("oYeq"),h=b("wNcN");n=b("WIi2");var v=b("aCSs"),t=b("YKqZ");b("83xy");var m=function(a){function b(b,
e,d,p,c,k,u){void 0===p&&(p=!1);void 0===c&&(c=!0);void 0===k&&(k=null);void 0===u&&(u=null);var f=a.call(this,e)||this;f._onLoad=null;f._onError=null;if(!b)throw Error("Image url is not set");f._coordinatesMode=v.a.CUBIC_MODE;f.name=b;f.url=b;f._size=d;f._noMipmap=p;f.gammaSpace=c;f._onLoad=k;f._onError=u;f.hasAlpha=!1;f.isCube=!0;f._texture=f._getFromCache(b,f._noMipmap);f._texture?k&&(f._texture.isReady?t.b.SetImmediate(function(){return k()}):f._texture.onLoadedObservable.add(k)):e.useDelayedTextureLoading?
f.delayLoadState=4:f.loadImage(f.loadTexture.bind(f),f._onError);return f}Object(l.d)(b,a);b.prototype.loadImage=function(a,b){var d=this,e=document.createElement("canvas"),c=new Image;c.addEventListener("load",function(){d._width=c.width;d._height=c.height;e.width=d._width;e.height=d._height;var b=e.getContext("2d");b.drawImage(c,0,0);b=b.getImageData(0,0,c.width,c.height);d._buffer=b.data.buffer;e.remove();a()});c.addEventListener("error",function(c){b&&b(d.getClassName()+" could not be loaded",
c)});c.src=this.url};b.prototype.loadTexture=function(){var a=this,e=this.getScene();e&&(this._texture=e.getEngine().createRawCubeTextureFromUrl(this.url,e,this._size,4,e.getEngine().getCaps().textureFloat?1:7,this._noMipmap,function(){var d=a.getFloat32ArrayFromArrayBuffer(a._buffer);d=h.a.ConvertPanoramaToCubemap(d,a._width,a._height,a._size);for(var e=[],c=0;6>c;c++)e.push(d[b._FacesMapping[c]]);return e},null,this._onLoad,this._onError))};b.prototype.getFloat32ArrayFromArrayBuffer=function(a){for(var b=
new DataView(a),d=new Float32Array(3*a.byteLength/4),g=0,c=0;c<a.byteLength;c++)0!==(c+1)%4&&(d[g++]=b.getUint8(c)/255);return d};b.prototype.getClassName=function(){return"EquiRectangularCubeTexture"};b.prototype.clone=function(){var a=this.getScene();if(!a)return this;a=new b(this.url,a,this._size,this._noMipmap,this.gammaSpace);a.level=this.level;a.wrapU=this.wrapU;a.wrapV=this.wrapV;a.coordinatesIndex=this.coordinatesIndex;a.coordinatesMode=this.coordinatesMode;return a};b._FacesMapping="right left up down front back".split(" ");
return b}(n.a)},WIi2:function(n,r,b){b.d(r,"a",function(){return g});var l=b("oYeq"),h=b("ADVu"),v=b("ps+7"),t=b("/SR9"),m=b("e2Mr"),a=b("FQ8M");b("TFEU");var q=b("/sJ5"),g=function(b){function d(a){var c=b.call(this,null)||this;c.metadata=null;c.reservedDataStore=null;c._hasAlpha=!1;c.getAlphaFromRGB=!1;c.level=1;c.coordinatesIndex=0;c._coordinatesMode=0;c.wrapR=1;c.anisotropicFilteringLevel=d.DEFAULT_ANISOTROPIC_FILTERING_LEVEL;c._isCube=!1;c._gammaSpace=!0;c.invertZ=!1;c.lodLevelInAlpha=!1;c.isRenderTarget=
!1;c._prefiltered=!1;c.animations=[];c.onDisposeObservable=new v.a;c._onDisposeObserver=null;c._scene=null;c._texture=null;c._uid=null;a?d._isScene(a)?c._scene=a:c._engine=a:c._scene=m.a.LastCreatedScene;c._scene&&(c.uniqueId=c._scene.getUniqueId(),c._scene.addTexture(c),c._engine=c._scene.getEngine());c._uid=null;return c}Object(l.d)(d,b);Object.defineProperty(d.prototype,"hasAlpha",{get:function(){return this._hasAlpha},set:function(a){this._hasAlpha!==a&&(this._hasAlpha=a,this._scene&&this._scene.markAllMaterialsAsDirty(17))},
enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"coordinatesMode",{get:function(){return this._coordinatesMode},set:function(a){this._coordinatesMode!==a&&(this._coordinatesMode=a,this._scene&&this._scene.markAllMaterialsAsDirty(1))},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"wrapU",{get:function(){return this._wrapU},set:function(a){this._wrapU=a},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"wrapV",{get:function(){return this._wrapV},
set:function(a){this._wrapV=a},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"isCube",{get:function(){return this._texture?this._texture.isCube:this._isCube},set:function(a){this._texture?this._texture.isCube=a:this._isCube=a},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"is3D",{get:function(){return this._texture?this._texture.is3D:!1},set:function(a){this._texture&&(this._texture.is3D=a)},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,
"is2DArray",{get:function(){return this._texture?this._texture.is2DArray:!1},set:function(a){this._texture&&(this._texture.is2DArray=a)},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"gammaSpace",{get:function(){if(!this._texture)return this._gammaSpace;null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace);return this._texture._gammaSpace},set:function(a){if(this._texture){if(this._texture._gammaSpace===a)return;this._texture._gammaSpace=a}else{if(this._gammaSpace===
a)return;this._gammaSpace=a}this._markAllSubMeshesAsTexturesDirty()},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"isRGBD",{get:function(){return null!=this._texture&&this._texture._isRGBD},set:function(a){this._texture&&(this._texture._isRGBD=a)},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"noMipmap",{get:function(){return!1},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"lodGenerationOffset",{get:function(){return this._texture?this._texture._lodGenerationOffset:
0},set:function(a){this._texture&&(this._texture._lodGenerationOffset=a)},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"lodGenerationScale",{get:function(){return this._texture?this._texture._lodGenerationScale:0},set:function(a){this._texture&&(this._texture._lodGenerationScale=a)},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"linearSpecularLOD",{get:function(){return this._texture?this._texture._linearSpecularLOD:!1},set:function(a){this._texture&&(this._texture._linearSpecularLOD=
a)},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"irradianceTexture",{get:function(){return this._texture?this._texture._irradianceTexture:null},set:function(a){this._texture&&(this._texture._irradianceTexture=a)},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"uid",{get:function(){this._uid||(this._uid=a.a.RandomId());return this._uid},enumerable:!1,configurable:!0});d.prototype.toString=function(){return this.name};d.prototype.getClassName=function(){return"BaseTexture"};
Object.defineProperty(d.prototype,"onDispose",{set:function(a){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver);this._onDisposeObserver=this.onDisposeObservable.add(a)},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"isBlocking",{get:function(){return!0},enumerable:!1,configurable:!0});d.prototype.getScene=function(){return this._scene};d.prototype._getEngine=function(){return this._engine};d.prototype.checkTransformsAreIdentical=function(a){return null!==
a};d.prototype.getTextureMatrix=function(){return t.a.IdentityReadOnly};d.prototype.getReflectionTextureMatrix=function(){return t.a.IdentityReadOnly};d.prototype.isReadyOrNotBlocking=function(){return!this.isBlocking||this.isReady()};d.prototype.scale=function(a){};Object.defineProperty(d.prototype,"canRescale",{get:function(){return!1},enumerable:!1,configurable:!0});d.prototype._getFromCache=function(a,c,b,d){var e=this._getEngine();if(!e)return null;e=e.getLoadedTexturesCache();for(var k=0;k<
e.length;k++){var u=e[k];if(!(void 0!==d&&d!==u.invertY||u.url!==a||u.generateMipMaps!==!c||b&&b!==u.samplingMode))return u.incrementReferences(),u}return null};d.prototype._rebuild=function(){};d.prototype.clone=function(){return null};Object.defineProperty(d.prototype,"textureType",{get:function(){return this._texture?void 0!==this._texture.type?this._texture.type:0:0},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"textureFormat",{get:function(){return this._texture?void 0!==
this._texture.format?this._texture.format:5:5},enumerable:!1,configurable:!0});d.prototype._markAllSubMeshesAsTexturesDirty=function(){var a=this.getScene();a&&a.markAllMaterialsAsDirty(1)};d.prototype.readPixels=function(a,c,b){void 0===a&&(a=0);void 0===c&&(c=0);void 0===b&&(b=null);if(!this._texture)return null;var d=this.getSize(),e=d.width;d=d.height;var k=this._getEngine();if(!k)return null;0!=c&&(e/=Math.pow(2,c),d/=Math.pow(2,c),e=Math.round(e),d=Math.round(d));try{return this._texture.isCube?
k._readTexturePixels(this._texture,e,d,a,c,b):k._readTexturePixels(this._texture,e,d,-1,c,b)}catch(C){return null}};Object.defineProperty(d.prototype,"_lodTextureHigh",{get:function(){return this._texture?this._texture._lodTextureHigh:null},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"_lodTextureMid",{get:function(){return this._texture?this._texture._lodTextureMid:null},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"_lodTextureLow",{get:function(){return this._texture?
this._texture._lodTextureLow:null},enumerable:!1,configurable:!0});d.prototype.dispose=function(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this);this._scene._removePendingData(this);var a=this._scene.textures.indexOf(this);0<=a&&this._scene.textures.splice(a,1);this._scene.onTextureRemovedObservable.notifyObservers(this);this._scene=null}this.onDisposeObservable.notifyObservers(this);this.onDisposeObservable.clear();b.prototype.dispose.call(this)};d.prototype.serialize=
function(){if(!this.name)return null;var a=h.a.Serialize(this);h.a.AppendSerializedAnimations(this,a);return a};d.WhenAllReady=function(a,c){var b=a.length;if(0===b)c();else for(var d=0;d<a.length;d++){var e=a[d];e.isReady()?0===--b&&c():(e=e.onLoadObservable)&&e.addOnce(function(){0===--b&&c()})}};d._isScene=function(a){return"Scene"===a.getClassName()};d.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4;Object(l.c)([Object(h.c)()],d.prototype,"uniqueId",void 0);Object(l.c)([Object(h.c)()],d.prototype,"name",
void 0);Object(l.c)([Object(h.c)()],d.prototype,"metadata",void 0);Object(l.c)([Object(h.c)("hasAlpha")],d.prototype,"_hasAlpha",void 0);Object(l.c)([Object(h.c)()],d.prototype,"getAlphaFromRGB",void 0);Object(l.c)([Object(h.c)()],d.prototype,"level",void 0);Object(l.c)([Object(h.c)()],d.prototype,"coordinatesIndex",void 0);Object(l.c)([Object(h.c)("coordinatesMode")],d.prototype,"_coordinatesMode",void 0);Object(l.c)([Object(h.c)()],d.prototype,"wrapU",null);Object(l.c)([Object(h.c)()],d.prototype,
"wrapV",null);Object(l.c)([Object(h.c)()],d.prototype,"wrapR",void 0);Object(l.c)([Object(h.c)()],d.prototype,"anisotropicFilteringLevel",void 0);Object(l.c)([Object(h.c)()],d.prototype,"isCube",null);Object(l.c)([Object(h.c)()],d.prototype,"is3D",null);Object(l.c)([Object(h.c)()],d.prototype,"is2DArray",null);Object(l.c)([Object(h.c)()],d.prototype,"gammaSpace",null);Object(l.c)([Object(h.c)()],d.prototype,"invertZ",void 0);Object(l.c)([Object(h.c)()],d.prototype,"lodLevelInAlpha",void 0);Object(l.c)([Object(h.c)()],
d.prototype,"lodGenerationOffset",null);Object(l.c)([Object(h.c)()],d.prototype,"lodGenerationScale",null);Object(l.c)([Object(h.c)()],d.prototype,"linearSpecularLOD",null);Object(l.c)([Object(h.m)()],d.prototype,"irradianceTexture",null);Object(l.c)([Object(h.c)()],d.prototype,"isRenderTarget",void 0);return d}(function(){function a(a){this.wrapR=this._wrapV=this._wrapU=1;this.anisotropicFilteringLevel=4;this.delayLoadState=0;this._engine=this._texture=null;this._cachedSize=q.a.Zero();this._cachedBaseSize=
q.a.Zero();if(this._texture=a)this._engine=this._texture.getEngine()}Object.defineProperty(a.prototype,"wrapU",{get:function(){return this._wrapU},set:function(a){this._wrapU=a},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"wrapV",{get:function(){return this._wrapV},set:function(a){this._wrapV=a},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"coordinatesMode",{get:function(){return 0},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"isCube",
{get:function(){return this._texture?this._texture.isCube:!1},set:function(a){this._texture&&(this._texture.isCube=a)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"is3D",{get:function(){return this._texture?this._texture.is3D:!1},set:function(a){this._texture&&(this._texture.is3D=a)},enumerable:!1,configurable:!0});Object.defineProperty(a.prototype,"is2DArray",{get:function(){return this._texture?this._texture.is2DArray:!1},set:function(a){this._texture&&(this._texture.is2DArray=
a)},enumerable:!1,configurable:!0});a.prototype.getClassName=function(){return"ThinTexture"};a.prototype.isReady=function(){return 4===this.delayLoadState?(this.delayLoad(),!1):this._texture?this._texture.isReady:!1};a.prototype.delayLoad=function(){};a.prototype.getInternalTexture=function(){return this._texture};a.prototype.getSize=function(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;this._texture._size&&
(this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size)}return this._cachedSize};a.prototype.getBaseSize=function(){if(!this.isReady()||!this._texture)return this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize;if(this._texture._size)return this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize;this._cachedBaseSize.width=this._texture.baseWidth;this._cachedBaseSize.height=this._texture.baseHeight;
return this._cachedBaseSize};a.prototype.updateSamplingMode=function(a){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(a,this._texture)};a.prototype.releaseInternalTexture=function(){this._texture&&(this._texture.dispose(),this._texture=null)};a.prototype.dispose=function(){this._texture&&(this.releaseInternalTexture(),this._engine=null)};return a}())},WrCc:function(n,r,b){b.d(r,"a",function(){return m});var l=b("oYeq"),h=b("uyO6"),v=b("aCSs");b("vD8D");var t=b("O3Sr"),m=function(a){function b(b,
e,d,p,c,k,u){void 0===d&&(d=null);void 0===c&&(c=3);void 0===k&&(k=5);d=a.call(this,null,d,!p,u,c,void 0,void 0,void 0,void 0,k)||this;d.name=b;d.wrapU=v.a.CLAMP_ADDRESSMODE;d.wrapV=v.a.CLAMP_ADDRESSMODE;d._generateMipMaps=p;b=d._getEngine();if(!b)return d;e.getContext?(d._canvas=e,d._texture=b.createDynamicTexture(e.width,e.height,p,c)):(d._canvas=t.a.CreateCanvas(1,1),d._texture=e.width||0===e.width?b.createDynamicTexture(e.width,e.height,p,c):b.createDynamicTexture(e,e,p,c));e=d.getSize();d._canvas.width=
e.width;d._canvas.height=e.height;d._context=d._canvas.getContext("2d");return d}Object(l.d)(b,a);b.prototype.getClassName=function(){return"DynamicTexture"};Object.defineProperty(b.prototype,"canRescale",{get:function(){return!0},enumerable:!1,configurable:!0});b.prototype._recreate=function(a){this._canvas.width=a.width;this._canvas.height=a.height;this.releaseInternalTexture();this._texture=this._getEngine().createDynamicTexture(a.width,a.height,this._generateMipMaps,this.samplingMode)};b.prototype.scale=
function(a){var b=this.getSize();b.width*=a;b.height*=a;this._recreate(b)};b.prototype.scaleTo=function(a,b){var d=this.getSize();d.width=a;d.height=b;this._recreate(d)};b.prototype.getContext=function(){return this._context};b.prototype.clear=function(){var a=this.getSize();this._context.fillRect(0,0,a.width,a.height)};b.prototype.update=function(a,b){void 0===b&&(b=!1);this._getEngine().updateDynamicTexture(this._texture,this._canvas,void 0===a?!0:a,b,this._format||void 0)};b.prototype.drawText=
function(a,b,d,p,c,k,u,f){void 0===f&&(f=!0);var e=this.getSize();k&&(this._context.fillStyle=k,this._context.fillRect(0,0,e.width,e.height));this._context.font=p;if(null===b||void 0===b)b=this._context.measureText(a),b=(e.width-b.width)/2;if(null===d||void 0===d)d=parseInt(p.replace(/\D/g,"")),d=e.height/2+d/3.65;this._context.fillStyle=c||"";this._context.fillText(a,b,d);f&&this.update(u)};b.prototype.clone=function(){var a=this.getScene();if(!a)return this;var e=this.getSize();a=new b(this.name,
e,a,this._generateMipMaps);a.hasAlpha=this.hasAlpha;a.level=this.level;a.wrapU=this.wrapU;a.wrapV=this.wrapV;return a};b.prototype.serialize=function(){var b=this.getScene();b&&!b.isReady()&&h.a.Warn("The scene must be ready before serializing the dynamic texture");b=a.prototype.serialize.call(this);this._IsCanvasElement(this._canvas)&&(b.base64String=this._canvas.toDataURL());b.invertY=this._invertY;b.samplingMode=this.samplingMode;return b};b.prototype._IsCanvasElement=function(a){return void 0!==
a.toDataURL};b.prototype._rebuild=function(){this.update()};return b}(v.a)},"Z+J3":function(n,r,b){b.d(r,"a",function(){return e});var l=b("oYeq"),h=b("ADVu"),v=b("YKqZ"),t=b("/SR9");n=b("WIi2");var m=b("aCSs"),a=b("WHS4");b("99gS");var q=b("X2Ve"),g=b("ps+7"),e=function(b){function d(a,d,e,f,w,p,h,q,l,n,r,D,E,G){void 0===e&&(e=null);void 0===f&&(f=!1);void 0===w&&(w=null);void 0===p&&(p=null);void 0===h&&(h=null);void 0===q&&(q=5);void 0===l&&(l=!1);void 0===n&&(n=null);void 0===r&&(r=!1);void 0===
D&&(D=.8);void 0===E&&(E=0);var c,k=b.call(this,d)||this;k.onLoadObservable=new g.a;k.boundingBoxPosition=t.e.Zero();k._rotationY=0;k._files=null;k._forcedExtension=null;k._extensions=null;k.name=a;k.url=a;k._noMipmap=f;k.hasAlpha=!1;k._format=q;k.isCube=!0;k._textureMatrix=t.a.Identity();k._createPolynomials=r;k.coordinatesMode=m.a.CUBIC_MODE;k._extensions=e;k._files=w;k._forcedExtension=n;k._loaderOptions=G;if(!a&&!w)return k;d=a.lastIndexOf(".");r=n?n:-1<d?a.substring(d).toLowerCase():"";d=".dds"===
r;if(r=".env"===r)k.gammaSpace=!1,k._prefiltered=!1,k.anisotropicFilteringLevel=1;else if(k._prefiltered=l)k.gammaSpace=!1,k.anisotropicFilteringLevel=1;k._texture=k._getFromCache(a,f);if(!w&&(r||d||e||(e="_px.jpg _py.jpg _pz.jpg _nx.jpg _ny.jpg _nz.jpg".split(" ")),w=[],e))for(d=0;d<e.length;d++)w.push(a+e[d]);k._files=w;k._texture?k._texture.isReady?v.b.SetImmediate(function(){k.onLoadObservable.notifyObservers(k);p&&p()}):k._texture.onLoadedObservable.add(function(){k.onLoadObservable.notifyObservers(k);
p&&p()}):(e=k.getScene(),(null===e||void 0===e?0:e.useDelayedTextureLoading)?k.delayLoadState=4:(k._texture=l?k._getEngine().createPrefilteredCubeTexture(a,e,D,E,p,h,q,n,k._createPolynomials):k._getEngine().createCubeTexture(a,e,w,f,p,h,k._format,n,!1,D,E,null,G),null===(c=k._texture)||void 0===c?void 0:c.onLoadedObservable.add(function(){return k.onLoadObservable.notifyObservers(k)})));return k}Object(l.d)(d,b);Object.defineProperty(d.prototype,"boundingBoxSize",{get:function(){return this._boundingBoxSize},
set:function(a){this._boundingBoxSize&&this._boundingBoxSize.equals(a)||(this._boundingBoxSize=a,(a=this.getScene())&&a.markAllMaterialsAsDirty(1))},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"rotationY",{get:function(){return this._rotationY},set:function(a){this._rotationY=a;this.setReflectionTextureMatrix(t.a.RotationY(this._rotationY))},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"noMipmap",{get:function(){return this._noMipmap},enumerable:!1,configurable:!0});
d.CreateFromImages=function(a,b,e){var c="";a.forEach(function(a){return c+=a});return new d(c,b,null,e,a)};d.CreateFromPrefilteredData=function(a,b,e,f){void 0===e&&(e=null);void 0===f&&(f=!0);var c=b.useDelayedTextureLoading;b.useDelayedTextureLoading=!1;a=new d(a,b,null,!1,null,null,null,void 0,!0,e,f);b.useDelayedTextureLoading=c;return a};d.prototype.getClassName=function(){return"CubeTexture"};d.prototype.updateURL=function(a,b,d,e){var c;void 0===e&&(e=!1);this.url&&(this.releaseInternalTexture(),
null===(c=this.getScene())||void 0===c?void 0:c.markAllMaterialsAsDirty(1));if(!this.name||q.a.StartsWith(this.name,"data:"))this.name=a;this.url=a;this.delayLoadState=4;if(this._prefiltered=e)this.gammaSpace=!1,this.anisotropicFilteringLevel=1;this._forcedExtension=b||null;d&&(this._delayedOnLoad=d);this.delayLoad(b)};d.prototype.delayLoad=function(a){var c=this,b;if(4===this.delayLoadState&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap),!this._texture)){var d=this.getScene();
this._texture=this._prefiltered?this._getEngine().createPrefilteredCubeTexture(this.url,d,.8,0,this._delayedOnLoad,void 0,this._format,a,this._createPolynomials):this._getEngine().createCubeTexture(this.url,d,this._files,this._noMipmap,this._delayedOnLoad,null,this._format,a,!1,0,0,null,this._loaderOptions);null===(b=this._texture)||void 0===b?void 0:b.onLoadedObservable.add(function(){return c.onLoadObservable.notifyObservers(c)})}};d.prototype.getReflectionTextureMatrix=function(){return this._textureMatrix};
d.prototype.setReflectionTextureMatrix=function(a){var c=this,b;a.updateFlag!==this._textureMatrix.updateFlag&&(a.isIdentity()!==this._textureMatrix.isIdentity()&&(null===(b=this.getScene())||void 0===b?void 0:b.markAllMaterialsAsDirty(1,function(a){return-1!==a.getActiveTextures().indexOf(c)})),this._textureMatrix=a)};d.Parse=function(c,b,e){var f=h.a.Parse(function(){var a=!1;c.prefiltered&&(a=c.prefiltered);return new d(e+c.name,b,c.extensions,!1,c.files||null,null,null,void 0,a,c.forcedExtension)},
c,b);c.boundingBoxPosition&&(f.boundingBoxPosition=t.e.FromArray(c.boundingBoxPosition));c.boundingBoxSize&&(f.boundingBoxSize=t.e.FromArray(c.boundingBoxSize));if(c.animations)for(var k=0;k<c.animations.length;k++){var u=c.animations[k],g=a.a.GetClass("BABYLON.Animation");g&&f.animations.push(g.Parse(u))}return f};d.prototype.clone=function(){var a=this,b=0,e=h.a.Clone(function(){var c=new d(a.url,a.getScene()||a._getEngine(),a._extensions,a._noMipmap,a._files);b=c.uniqueId;return c},this);e.uniqueId=
b;return e};Object(l.c)([Object(h.c)()],d.prototype,"url",void 0);Object(l.c)([Object(h.c)("rotationY")],d.prototype,"rotationY",null);Object(l.c)([Object(h.c)("files")],d.prototype,"_files",void 0);Object(l.c)([Object(h.c)("forcedExtension")],d.prototype,"_forcedExtension",void 0);Object(l.c)([Object(h.c)("extensions")],d.prototype,"_extensions",void 0);Object(l.c)([Object(h.j)("textureMatrix")],d.prototype,"_textureMatrix",void 0);return d}(n.a);m.a._CubeTextureParser=e.Parse;a.a.RegisteredTypes["BABYLON.CubeTexture"]=
e},aCSs:function(n,r,b){b.d(r,"a",function(){return c});var l=b("oYeq"),h=b("ADVu"),v=b("ps+7"),t=b("/SR9");n=b("WIi2");var m=b("WHS4"),a=b("n5HA"),q=b("vYHP"),g=b("4HJg"),e=b("j2cH"),d=b("X2Ve"),p=b("/ICB"),c=function(c){function b(a,d,e,k,g,p,u,h,l,m,n,r){void 0===e&&(e=!1);void 0===k&&(k=!0);void 0===g&&(g=b.TRILINEAR_SAMPLINGMODE);void 0===p&&(p=null);void 0===u&&(u=null);void 0===h&&(h=null);void 0===l&&(l=!1);var f=c.call(this,d)||this;f.url=null;f.uOffset=0;f.vOffset=0;f.uScale=1;f.vScale=
1;f.uAng=0;f.vAng=0;f.wAng=0;f.uRotationCenter=.5;f.vRotationCenter=.5;f.wRotationCenter=.5;f.homogeneousRotationInUVTransform=!1;f.inspectableCustomProperties=null;f._noMipmap=!1;f._invertY=!1;f._rowGenerationMatrix=null;f._cachedTextureMatrix=null;f._projectionModeMatrix=null;f._t0=null;f._t1=null;f._t2=null;f._cachedUOffset=-1;f._cachedVOffset=-1;f._cachedUScale=0;f._cachedVScale=0;f._cachedUAng=-1;f._cachedVAng=-1;f._cachedWAng=-1;f._cachedProjectionMatrixId=-1;f._cachedURotationCenter=-1;f._cachedVRotationCenter=
-1;f._cachedWRotationCenter=-1;f._cachedHomogeneousRotationInUVTransform=!1;f._cachedCoordinatesMode=-1;f._initialSamplingMode=b.BILINEAR_SAMPLINGMODE;f._buffer=null;f._deleteBuffer=!1;f._format=null;f._delayedOnLoad=null;f._delayedOnError=null;f.onLoadObservable=new v.a;f._isBlocking=!0;f.name=a||"";f.url=a;f._noMipmap=e;f._invertY=k;f._initialSamplingMode=g;f._buffer=h;f._deleteBuffer=l;f._mimeType=n;f._loaderOptions=r;m&&(f._format=m);var w=f.getScene();a=f._getEngine();if(!a)return f;a.onBeforeTextureInitObservable.notifyObservers(f);
var t=function(){f._texture&&(f._texture._invertVScale&&(f.vScale*=-1,f.vOffset+=1),null!==f._texture._cachedWrapU&&(f.wrapU=f._texture._cachedWrapU,f._texture._cachedWrapU=null),null!==f._texture._cachedWrapV&&(f.wrapV=f._texture._cachedWrapV,f._texture._cachedWrapV=null),null!==f._texture._cachedWrapR&&(f.wrapR=f._texture._cachedWrapR,f._texture._cachedWrapR=null));f.onLoadObservable.hasObservers()&&f.onLoadObservable.notifyObservers(f);p&&p();!f.isBlocking&&w&&w.resetCachedMaterial()};if(!f.url)return f._delayedOnLoad=
t,f._delayedOnError=u,f;f._texture=f._getFromCache(f.url,e,g,k);f._texture?f._texture.isReady?q.a.SetImmediate(function(){return t()}):f._texture.onLoadedObservable.add(t):w&&w.useDelayedTextureLoading?(f.delayLoadState=4,f._delayedOnLoad=t,f._delayedOnError=u):(f._texture=a.createTexture(f.url,e,k,w,g,t,u,f._buffer,void 0,f._format,null,n,r),l&&(f._buffer=null));return f}Object(l.d)(b,c);Object.defineProperty(b.prototype,"noMipmap",{get:function(){return this._noMipmap},enumerable:!1,configurable:!0});
Object.defineProperty(b.prototype,"mimeType",{get:function(){return this._mimeType},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"isBlocking",{get:function(){return this._isBlocking},set:function(a){this._isBlocking=a},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"samplingMode",{get:function(){return this._texture?this._texture.samplingMode:this._initialSamplingMode},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"invertY",{get:function(){return this._invertY},
enumerable:!1,configurable:!0});b.prototype.updateURL=function(a,b,c){void 0===b&&(b=null);this.url&&(this.releaseInternalTexture(),this.getScene().markAllMaterialsAsDirty(1));if(!this.name||d.a.StartsWith(this.name,"data:"))this.name=a;this.url=a;this._buffer=b;this.delayLoadState=4;c&&(this._delayedOnLoad=c);this.delayLoad()};b.prototype.delayLoad=function(){if(4===this.delayLoadState){var a=this.getScene();a&&(this.delayLoadState=1,(this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,
this._invertY))?this._delayedOnLoad&&(this._texture.isReady?q.a.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=a.getEngine().createTexture(this.url,this._noMipmap,this._invertY,a,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,null,this._mimeType,this._loaderOptions),this._deleteBuffer&&(this._buffer=null)),this._delayedOnError=this._delayedOnLoad=null)}};b.prototype._prepareRowForTextureGeneration=
function(a,b,c,d){a*=this._cachedUScale;b*=this._cachedVScale;a-=this.uRotationCenter*this._cachedUScale;b-=this.vRotationCenter*this._cachedVScale;c-=this.wRotationCenter;t.e.TransformCoordinatesFromFloatsToRef(a,b,c,this._rowGenerationMatrix,d);d.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset;d.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset;d.z+=this.wRotationCenter};b.prototype.checkTransformsAreIdentical=function(a){return null!==a&&this.uOffset===a.uOffset&&this.vOffset===
a.vOffset&&this.uScale===a.uScale&&this.vScale===a.vScale&&this.uAng===a.uAng&&this.vAng===a.vAng&&this.wAng===a.wAng};b.prototype.getTextureMatrix=function(a){var b=this;void 0===a&&(a=1);if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*a===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&
this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset;this._cachedVOffset=this.vOffset;this._cachedUScale=this.uScale*a;this._cachedVScale=this.vScale;this._cachedUAng=this.uAng;this._cachedVAng=this.vAng;this._cachedWAng=this.wAng;this._cachedURotationCenter=this.uRotationCenter;this._cachedVRotationCenter=this.vRotationCenter;this._cachedWRotationCenter=
this.wRotationCenter;this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform;this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=t.a.Zero(),this._rowGenerationMatrix=new t.a,this._t0=t.e.Zero(),this._t1=t.e.Zero(),this._t2=t.e.Zero());t.a.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix);this.homogeneousRotationInUVTransform?(t.a.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,
t.c.Matrix[0]),t.a.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,t.c.Matrix[1]),t.a.ScalingToRef(this._cachedUScale,this._cachedVScale,0,t.c.Matrix[2]),t.a.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,t.c.Matrix[3]),t.c.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(t.c.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(t.c.Matrix[2],
this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(t.c.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.subtractInPlace(this._t0),this._t2.subtractInPlace(this._t0),t.a.FromValuesToRef(this._t1.x,
this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));a=this.getScene();if(!a)return this._cachedTextureMatrix;a.markAllMaterialsAsDirty(1,function(a){return a.hasTexture(b)});return this._cachedTextureMatrix};b.prototype.getReflectionTextureMatrix=function(){var a=this,c=this.getScene();if(!c)return this._cachedTextureMatrix;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale===this._cachedUScale&&
this.vScale===this._cachedVScale&&this.coordinatesMode===this._cachedCoordinatesMode)if(this.coordinatesMode===b.PROJECTION_MODE){if(this._cachedProjectionMatrixId===c.getProjectionMatrix().updateFlag)return this._cachedTextureMatrix}else return this._cachedTextureMatrix;this._cachedTextureMatrix||(this._cachedTextureMatrix=t.a.Zero());this._projectionModeMatrix||(this._projectionModeMatrix=t.a.Zero());this._cachedUOffset=this.uOffset;this._cachedVOffset=this.vOffset;this._cachedUScale=this.uScale;
this._cachedVScale=this.vScale;this._cachedCoordinatesMode=this.coordinatesMode;switch(this.coordinatesMode){case b.PLANAR_MODE:t.a.IdentityToRef(this._cachedTextureMatrix);this._cachedTextureMatrix[0]=this.uScale;this._cachedTextureMatrix[5]=this.vScale;this._cachedTextureMatrix[12]=this.uOffset;this._cachedTextureMatrix[13]=this.vOffset;break;case b.PROJECTION_MODE:t.a.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);var d=c.getProjectionMatrix();this._cachedProjectionMatrixId=
d.updateFlag;d.multiplyToRef(this._projectionModeMatrix,this._cachedTextureMatrix);break;default:t.a.IdentityToRef(this._cachedTextureMatrix)}c.markAllMaterialsAsDirty(1,function(b){return-1!==b.getActiveTextures().indexOf(a)});return this._cachedTextureMatrix};b.prototype.clone=function(){var a=this;return h.a.Clone(function(){return new b(a._texture?a._texture.url:null,a.getScene(),a._noMipmap,a._invertY,a.samplingMode,void 0,void 0,a._texture?a._texture._buffer:void 0)},this)};b.prototype.serialize=
function(){var a=this.name;!b.SerializeBuffers&&d.a.StartsWith(this.name,"data:")&&(this.name="");d.a.StartsWith(this.name,"data:")&&this.url===this.name&&(this.url="");var e=c.prototype.serialize.call(this);if(!e)return null;if(b.SerializeBuffers||b.ForceSerializeBuffers)"string"===typeof this._buffer&&"data:"===this._buffer.substr(0,5)?(e.base64String=this._buffer,e.name=e.name.replace("data:","")):this.url&&d.a.StartsWith(this.url,"data:")&&this._buffer instanceof Uint8Array?e.base64String="data:image/png;base64,"+
d.a.EncodeArrayBufferToBase64(this._buffer):b.ForceSerializeBuffers&&(e.base64String=p.a.GenerateBase64StringFromTexture(this));e.invertY=this._invertY;e.samplingMode=this.samplingMode;this.name=a;return e};b.prototype.getClassName=function(){return"Texture"};b.prototype.dispose=function(){c.prototype.dispose.call(this);this.onLoadObservable.clear();this._delayedOnError=this._delayedOnLoad=null};b.Parse=function(a,c,k){if(a.customType){var f=g.a.Instantiate(a.customType).Parse(a,c,k);a.samplingMode&&
f.updateSamplingMode&&f._samplingMode&&f._samplingMode!==a.samplingMode&&f.updateSamplingMode(a.samplingMode);return f}if(a.isCube&&!a.isRenderTarget)return b._CubeTextureParser(a,c,k);if(!a.name&&!a.isRenderTarget)return null;var w=function(){p&&p._texture&&(p._texture._cachedWrapU=null,p._texture._cachedWrapV=null,p._texture._cachedWrapR=null);if(a.samplingMode){var b=a.samplingMode;p&&p.samplingMode!==b&&p.updateSamplingMode(b)}if(p&&a.animations)for(b=0;b<a.animations.length;b++){var c=a.animations[b],
d=m.a.GetClass("BABYLON.Animation");d&&p.animations.push(d.Parse(c))}},p=h.a.Parse(function(){var f=!0;a.noMipmap&&(f=!1);if(a.mirrorPlane){var g=b._CreateMirror(a.name,a.renderTargetSize,c,f);g._waitingRenderList=a.renderList;g.mirrorPlane=e.a.FromArray(a.mirrorPlane);w();return g}if(a.isRenderTarget){g=null;if(a.isCube){if(c.reflectionProbes)for(f=0;f<c.reflectionProbes.length;f++){var p=c.reflectionProbes[f];if(p.name===a.name)return p.cubeTexture}}else g=b._CreateRenderTargetTexture(a.name,a.renderTargetSize,
c,f),g._waitingRenderList=a.renderList;w();return g}if(a.base64String)g=b.CreateFromBase64String(a.base64String,a.name,c,!f,a.invertY,void 0,w);else{g=a.name&&0<a.name.indexOf("://")?a.name:k+a.name;if(d.a.StartsWith(a.url,"data:")||b.UseSerializedUrlIfAny&&a.url)g=a.url;g=new b(g,c,!f,a.invertY,void 0,w)}return g},a,c);return p};b.CreateFromBase64String=function(a,c,d,e,k,g,p,u,h){void 0===g&&(g=b.TRILINEAR_SAMPLINGMODE);void 0===p&&(p=null);void 0===u&&(u=null);void 0===h&&(h=5);return new b("data:"+
c,d,e,k,g,p,u,a,!1,h)};b.LoadFromDataString=function(a,c,d,e,k,g,p,u,h,q){void 0===e&&(e=!1);void 0===k&&(k=!1);void 0===g&&(g=!0);void 0===p&&(p=b.TRILINEAR_SAMPLINGMODE);void 0===u&&(u=null);void 0===h&&(h=null);void 0===q&&(q=5);"data:"!==a.substr(0,5)&&(a="data:"+a);return new b(a,d,k,g,p,u,h,c,e,q)};b.SerializeBuffers=!0;b.ForceSerializeBuffers=!1;b._CubeTextureParser=function(b,c,d){throw a.a.WarnImport("CubeTexture");};b._CreateMirror=function(b,c,d,e){throw a.a.WarnImport("MirrorTexture");
};b._CreateRenderTargetTexture=function(b,c,d,e){throw a.a.WarnImport("RenderTargetTexture");};b.NEAREST_SAMPLINGMODE=1;b.NEAREST_NEAREST_MIPLINEAR=8;b.BILINEAR_SAMPLINGMODE=2;b.LINEAR_LINEAR_MIPNEAREST=11;b.TRILINEAR_SAMPLINGMODE=3;b.LINEAR_LINEAR_MIPLINEAR=3;b.NEAREST_NEAREST_MIPNEAREST=4;b.NEAREST_LINEAR_MIPNEAREST=5;b.NEAREST_LINEAR_MIPLINEAR=6;b.NEAREST_LINEAR=7;b.NEAREST_NEAREST=1;b.LINEAR_NEAREST_MIPNEAREST=9;b.LINEAR_NEAREST_MIPLINEAR=10;b.LINEAR_LINEAR=2;b.LINEAR_NEAREST=12;b.EXPLICIT_MODE=
0;b.SPHERICAL_MODE=1;b.PLANAR_MODE=2;b.CUBIC_MODE=3;b.PROJECTION_MODE=4;b.SKYBOX_MODE=5;b.INVCUBIC_MODE=6;b.EQUIRECTANGULAR_MODE=7;b.FIXED_EQUIRECTANGULAR_MODE=8;b.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9;b.CLAMP_ADDRESSMODE=0;b.WRAP_ADDRESSMODE=1;b.MIRROR_ADDRESSMODE=2;b.UseSerializedUrlIfAny=!1;Object(l.c)([Object(h.c)()],b.prototype,"url",void 0);Object(l.c)([Object(h.c)()],b.prototype,"uOffset",void 0);Object(l.c)([Object(h.c)()],b.prototype,"vOffset",void 0);Object(l.c)([Object(h.c)()],b.prototype,
"uScale",void 0);Object(l.c)([Object(h.c)()],b.prototype,"vScale",void 0);Object(l.c)([Object(h.c)()],b.prototype,"uAng",void 0);Object(l.c)([Object(h.c)()],b.prototype,"vAng",void 0);Object(l.c)([Object(h.c)()],b.prototype,"wAng",void 0);Object(l.c)([Object(h.c)()],b.prototype,"uRotationCenter",void 0);Object(l.c)([Object(h.c)()],b.prototype,"vRotationCenter",void 0);Object(l.c)([Object(h.c)()],b.prototype,"wRotationCenter",void 0);Object(l.c)([Object(h.c)()],b.prototype,"homogeneousRotationInUVTransform",
void 0);Object(l.c)([Object(h.c)()],b.prototype,"isBlocking",null);return b}(n.a);m.a.RegisteredTypes["BABYLON.Texture"]=c;h.a._TextureParser=c.Parse},"c/3c":function(n,r,b){b.d(r,"a",function(){return a});var l=b("oYeq"),h=b("ps+7"),v=b("YKqZ"),t=b("uyO6"),m=b("aCSs");b("gXZW");b("vD8D");var a=function(a){function b(b,d,g,c,k,u,f){void 0===c&&(c=!1);void 0===k&&(k=!1);void 0===u&&(u=m.a.TRILINEAR_SAMPLINGMODE);void 0===f&&(f={autoPlay:!0,loop:!0,autoUpdateTexture:!0});var e=a.call(this,null,g,!c,
k)||this;e._onUserActionRequestedObservable=null;e._stillImageCaptured=!1;e._displayingPosterTexture=!1;e._frameId=-1;e._currentSrc=null;e._createInternalTexture=function(){if(null!=e._texture)if(e._displayingPosterTexture)e._texture.dispose(),e._displayingPosterTexture=!1;else return;!e._getEngine().needPOTTextures||v.b.IsExponentOfTwo(e.video.videoWidth)&&v.b.IsExponentOfTwo(e.video.videoHeight)?(e.wrapU=m.a.WRAP_ADDRESSMODE,e.wrapV=m.a.WRAP_ADDRESSMODE):(e.wrapU=m.a.CLAMP_ADDRESSMODE,e.wrapV=m.a.CLAMP_ADDRESSMODE,
e._generateMipMaps=!1);e._texture=e._getEngine().createDynamicTexture(e.video.videoWidth,e.video.videoHeight,e._generateMipMaps,e.samplingMode);if(e.video.autoplay||e._settings.poster)e._texture.isReady=!0,e._updateInternalTexture(),e.onLoadObservable.hasObservers()&&e.onLoadObservable.notifyObservers(e);else{var a=e.video.onplaying,b=!1,c=e.video.muted;e.video.muted=!0;e.video.onplaying=function(){e.video.muted=c;e.video.onplaying=a;e._texture.isReady=!0;e._updateInternalTexture();b||e.video.pause();
e.onLoadObservable.hasObservers()&&e.onLoadObservable.notifyObservers(e)};var d=e.video.play();d?d.then(function(){}).catch(function(){b=!0;e._onUserActionRequestedObservable&&e._onUserActionRequestedObservable.hasObservers()&&e._onUserActionRequestedObservable.notifyObservers(e)}):(e.video.onplaying=a,e._texture.isReady=!0,e._updateInternalTexture(),e.onLoadObservable.hasObservers()&&e.onLoadObservable.notifyObservers(e))}};e.reset=function(){null==e._texture||e._displayingPosterTexture||(e._texture.dispose(),
e._texture=null)};e._updateInternalTexture=function(){if(null!=e._texture&&e._texture.isReady&&!(e.video.readyState<e.video.HAVE_CURRENT_DATA||e._displayingPosterTexture)){var a=e.getScene().getFrameId();e._frameId!==a&&(e._frameId=a,e._getEngine().updateVideoTexture(e._texture,e.video,e._invertY))}};e._generateMipMaps=c;e._initialSamplingMode=u;e.autoUpdateTexture=f.autoUpdateTexture;e._currentSrc=d;e.name=b||e._getName(d);e.video=e._getVideo(d);e._settings=f;f.poster&&(e.video.poster=f.poster);
void 0!==f.autoPlay&&(e.video.autoplay=f.autoPlay);void 0!==f.loop&&(e.video.loop=f.loop);void 0!==f.muted&&(e.video.muted=f.muted);e.video.setAttribute("playsinline","");e.video.addEventListener("paused",e._updateInternalTexture);e.video.addEventListener("seeked",e._updateInternalTexture);e.video.addEventListener("emptied",e.reset);e._createInternalTextureOnEvent=f.poster&&!f.autoPlay?"play":"canplay";e.video.addEventListener(e._createInternalTextureOnEvent,e._createInternalTexture);f.autoPlay&&
e.video.play();b=e.video.readyState>=e.video.HAVE_CURRENT_DATA;!f.poster||f.autoPlay&&b?b&&e._createInternalTexture():(e._texture=e._getEngine().createTexture(f.poster,!1,!e.invertY,g),e._displayingPosterTexture=!0);return e}Object(l.d)(b,a);Object.defineProperty(b.prototype,"onUserActionRequestedObservable",{get:function(){this._onUserActionRequestedObservable||(this._onUserActionRequestedObservable=new h.a);return this._onUserActionRequestedObservable},enumerable:!1,configurable:!0});b.prototype._getName=
function(a){return a instanceof HTMLVideoElement?a.currentSrc:"object"===typeof a?a.toString():a};b.prototype._getVideo=function(a){if(a instanceof HTMLVideoElement)return v.b.SetCorsBehavior(a.currentSrc,a),a;var b=document.createElement("video");"string"===typeof a?(v.b.SetCorsBehavior(a,b),b.src=a):(v.b.SetCorsBehavior(a[0],b),a.forEach(function(a){var c=document.createElement("source");c.src=a;b.appendChild(c)}));return b};b.prototype._rebuild=function(){this.update()};b.prototype.update=function(){this.autoUpdateTexture&&
this.updateTexture(!0)};b.prototype.updateTexture=function(a){!a||this.video.paused&&this._stillImageCaptured||(this._stillImageCaptured=!0,this._updateInternalTexture())};b.prototype.updateURL=function(a){this._currentSrc=this.video.src=a};b.prototype.clone=function(){return new b(this.name,this._currentSrc,this.getScene(),this._generateMipMaps,this.invertY,this.samplingMode,this._settings)};b.prototype.dispose=function(){a.prototype.dispose.call(this);this._currentSrc=null;this._onUserActionRequestedObservable&&
(this._onUserActionRequestedObservable.clear(),this._onUserActionRequestedObservable=null);this.video.removeEventListener(this._createInternalTextureOnEvent,this._createInternalTexture);this.video.removeEventListener("paused",this._updateInternalTexture);this.video.removeEventListener("seeked",this._updateInternalTexture);this.video.removeEventListener("emptied",this.reset);this.video.pause()};b.CreateFromStreamAsync=function(a,d){var e=document.createElement("video");a.getEngine()._badOS&&(document.body.appendChild(e),
e.style.transform="scale(0.0001, 0.0001)",e.style.opacity="0",e.style.position="fixed",e.style.bottom="0px",e.style.right="0px");e.setAttribute("autoplay","");e.setAttribute("muted","true");e.setAttribute("playsinline","");e.muted=!0;void 0!==e.mozSrcObject?e.mozSrcObject=d:"object"==typeof e.srcObject?e.srcObject=d:(window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,e.src=window.URL&&window.URL.createObjectURL(d));return new Promise(function(c){var d=function(){c(new b("video",
e,a,!0,!0));e.removeEventListener("playing",d)};e.addEventListener("playing",d);e.play()})};b.CreateFromWebCamAsync=function(a,b,g){var c=this;void 0===g&&(g=!1);var d;b&&b.deviceId&&(d={exact:b.deviceId});if(navigator.mediaDevices)return navigator.mediaDevices.getUserMedia({video:b,audio:g}).then(function(b){return c.CreateFromStreamAsync(a,b)});navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;navigator.getUserMedia&&
navigator.getUserMedia({video:{deviceId:d,width:{min:b&&b.minWidth||256,max:b&&b.maxWidth||640},height:{min:b&&b.minHeight||256,max:b&&b.maxHeight||480}},audio:g},function(b){return c.CreateFromStreamAsync(a,b)},function(a){t.a.Error(a.name)});return Promise.reject("No support for userMedia on this device")};b.CreateFromWebCam=function(a,b,g,c){void 0===c&&(c=!1);this.CreateFromWebCamAsync(a,g,c).then(function(a){b&&b(a)}).catch(function(a){t.a.Error(a.name)})};return b}(m.a)},h5cR:function(n,r,b){b.d(r,
"a",function(){return m});var l=b("GR64"),h=b("sH6m"),v=b("Vc1k");b("c/gR");b("+TQ+");var t=b("uyO6"),m=function(){function a(a,b){void 0===b&&(b={});this._lodGenerationOffset=0;this._lodGenerationScale=.8;this.quality=4096;this.hdrScale=1;this._engine=a;this.hdrScale=b.hdrScale||this.hdrScale;this.quality=b.hdrScale||this.quality}a.prototype._createRenderTarget=function(a){var b=0;this._engine.getCaps().textureHalfFloatRender?b=2:this._engine.getCaps().textureFloatRender&&(b=1);a=this._engine.createRenderTargetCubeTexture(a,
{format:5,type:b,generateMipMaps:!1,generateDepthBuffer:!1,generateStencilBuffer:!1,samplingMode:1});this._engine.updateTextureWrappingMode(a,0,0,0);this._engine.updateTextureSamplingMode(3,a,!0);return a};a.prototype._prefilterInternal=function(a){var b=a.getSize().width,e=Math.round(h.a.Log2(b))+1,d=this._effectWrapper.effect,p=this._createRenderTarget(b);this._effectRenderer.setViewport();var c=a.getInternalTexture();c&&this._engine.updateTextureSamplingMode(3,c,!0);this._effectRenderer.applyEffectWrapper(this._effectWrapper);
c=[[new l.j(0,0,-1),new l.j(0,-1,0),new l.j(1,0,0)],[new l.j(0,0,1),new l.j(0,-1,0),new l.j(-1,0,0)],[new l.j(1,0,0),new l.j(0,0,1),new l.j(0,1,0)],[new l.j(1,0,0),new l.j(0,0,-1),new l.j(0,-1,0)],[new l.j(1,0,0),new l.j(0,-1,0),new l.j(0,0,1)],[new l.j(-1,0,0),new l.j(0,-1,0),new l.j(0,0,-1)]];d.setFloat("hdrScale",this.hdrScale);d.setFloat2("vFilteringInfo",a.getSize().width,e);d.setTexture("inputTexture",a);for(var k=0;6>k;k++){d.setVector3("up",c[k][0]);d.setVector3("right",c[k][1]);d.setVector3("front",
c[k][2]);for(var u=0;u<e;u++){this._engine.bindFramebuffer(p,k,void 0,void 0,!0,u);this._effectRenderer.applyEffectWrapper(this._effectWrapper);var f=Math.pow(2,(u-this._lodGenerationOffset)/this._lodGenerationScale)/b;0===u&&(f=0);d.setFloat("alphaG",f);this._effectRenderer.draw()}}this._effectRenderer.restoreStates();this._engine.restoreDefaultFramebuffer();this._engine._releaseFramebufferObjects(p);this._engine._releaseTexture(a._texture);p._swapAndDie(a._texture);a._prefiltered=!0;return a};a.prototype._createEffect=
function(a,b){var e=[];a.gammaSpace&&e.push("#define GAMMA_INPUT");e.push("#define NUM_SAMPLES "+this.quality+"u");return new v.b({engine:this._engine,name:"hdrFiltering",vertexShader:"hdrFiltering",fragmentShader:"hdrFiltering",samplerNames:["inputTexture"],uniformNames:"vSampleDirections vWeights up right front vFilteringInfo hdrScale alphaG".split(" "),useShaderStore:!0,defines:e,onCompiled:b})};a.prototype.isReady=function(a){return a.isReady()&&this._effectWrapper.effect.isReady()};a.prototype.prefilter=
function(a,b){var e=this;void 0===b&&(b=null);if(1===this._engine.webGLVersion)t.a.Warn("HDR prefiltering is not available in WebGL 1., you can use real time filtering instead.");else return new Promise(function(d){e._effectRenderer=new v.a(e._engine);e._effectWrapper=e._createEffect(a);e._effectWrapper.effect.executeWhenCompiled(function(){e._prefilterInternal(a);e._effectRenderer.dispose();e._effectWrapper.dispose();d();b&&b()})})};return a}()},jpcn:function(n,r,b){b.d(r,"a",function(){return d});
var l=b("oYeq"),h=b("ADVu"),v=b("ps+7"),t=b("y4Ty"),m=b("Yap0"),a=b("cdI9");n=b("aCSs");var q=b("srWW"),g=b("Irc+");b("DvRB");b("3XS9");b("bPxr");r=b("WHS4");var e=b("e2Mr"),d=function(b){function c(a,c,d,h,p,l,q,n){void 0===p&&(p=null);void 0===l&&(l=!0);void 0===q&&(q=!1);void 0===n&&(n=0);var f=b.call(this,null,h,!l)||this;f.isEnabled=!0;f.autoClear=!0;f.onGeneratedObservable=new v.a;f.onBeforeGenerationObservable=new v.a;f.nodeMaterialSource=null;f._textures={};f._currentRefreshId=-1;f._frameId=
-1;f._refreshRate=1;f._vertexBuffers={};f._uniforms=[];f._samplers=[];f._floats={};f._ints={};f._floatsArrays={};f._colors3={};f._colors4={};f._vectors2={};f._vectors3={};f._matrices={};f._fallbackTextureUsed=!1;f._cachedDefines="";f._contentUpdateId=-1;h=f.getScene()||e.a.LastCreatedScene;var k=h._getComponent(m.a.NAME_PROCEDURALTEXTURE);k||(k=new g.a(h),h._addComponent(k));h.proceduralTextures.push(f);f._fullEngine=h.getEngine();f.name=a;f.isRenderTarget=!0;f._size=c;f._generateMipMaps=l;f.setFragment(d);
f._fallbackTexture=p;q?(f._texture=f._fullEngine.createRenderTargetCubeTexture(c,{generateMipMaps:l,generateDepthBuffer:!1,generateStencilBuffer:!1,type:n}),f.setFloat("face",0)):f._texture=f._fullEngine.createRenderTargetTexture(c,{generateMipMaps:l,generateDepthBuffer:!1,generateStencilBuffer:!1,type:n});a=[];a.push(1,1);a.push(-1,1);a.push(-1,-1);a.push(1,-1);f._vertexBuffers[t.b.PositionKind]=new t.b(f._fullEngine,a,t.b.PositionKind,!1,!1,2);f._createIndexBuffer();return f}Object(l.d)(c,b);c.prototype.getEffect=
function(){return this._effect};c.prototype.getContent=function(){if(this._contentData&&this._frameId===this._contentUpdateId)return this._contentData;this._contentData=this.readPixels(0,0,this._contentData);this._contentUpdateId=this._frameId;return this._contentData};c.prototype._createIndexBuffer=function(){var a=this._fullEngine,b=[];b.push(0);b.push(1);b.push(2);b.push(0);b.push(2);b.push(3);this._indexBuffer=a.createIndexBuffer(b)};c.prototype._rebuild=function(){var a=this._vertexBuffers[t.b.PositionKind];
a&&a._rebuild();this._createIndexBuffer();this.refreshRate===q.a.REFRESHRATE_RENDER_ONCE&&(this.refreshRate=q.a.REFRESHRATE_RENDER_ONCE)};c.prototype.reset=function(){void 0!==this._effect&&this._effect.dispose()};c.prototype._getDefines=function(){return""};c.prototype.isReady=function(){var a=this,b=this._fullEngine;if(this.nodeMaterialSource)return this._effect.isReady();if(!this._fragment)return!1;if(this._fallbackTextureUsed)return!0;var c=this._getDefines();if(this._effect&&c===this._cachedDefines&&
this._effect.isReady())return!0;var d=void 0!==this._fragment.fragmentElement?{vertex:"procedural",fragmentElement:this._fragment.fragmentElement}:{vertex:"procedural",fragment:this._fragment};this._cachedDefines=c;this._effect=b.createEffect(d,[t.b.PositionKind],this._uniforms,this._samplers,c,void 0,void 0,function(){a.releaseInternalTexture();a._fallbackTexture&&(a._texture=a._fallbackTexture._texture,a._texture&&a._texture.incrementReferences());a._fallbackTextureUsed=!0});return this._effect.isReady()};
c.prototype.resetRefreshCounter=function(){this._currentRefreshId=-1};c.prototype.setFragment=function(a){this._fragment=a};Object.defineProperty(c.prototype,"refreshRate",{get:function(){return this._refreshRate},set:function(a){this._refreshRate=a;this.resetRefreshCounter()},enumerable:!1,configurable:!0});c.prototype._shouldRender=function(){if(!this.isEnabled||!this.isReady()||!this._texture)return this._texture&&(this._texture.isReady=!1),!1;if(this._fallbackTextureUsed)return!1;if(-1===this._currentRefreshId||
this.refreshRate===this._currentRefreshId)return this._currentRefreshId=1,this._frameId++,!0;this._currentRefreshId++;return!1};c.prototype.getRenderSize=function(){return this._size};c.prototype.resize=function(a,b){this._fallbackTextureUsed||(this.releaseInternalTexture(),this._texture=this._fullEngine.createRenderTargetTexture(a,b),this._size=a,this._generateMipMaps=b)};c.prototype._checkUniform=function(a){-1===this._uniforms.indexOf(a)&&this._uniforms.push(a)};c.prototype.setTexture=function(a,
b){-1===this._samplers.indexOf(a)&&this._samplers.push(a);this._textures[a]=b;return this};c.prototype.setFloat=function(a,b){this._checkUniform(a);this._floats[a]=b;return this};c.prototype.setInt=function(a,b){this._checkUniform(a);this._ints[a]=b;return this};c.prototype.setFloats=function(a,b){this._checkUniform(a);this._floatsArrays[a]=b;return this};c.prototype.setColor3=function(a,b){this._checkUniform(a);this._colors3[a]=b;return this};c.prototype.setColor4=function(a,b){this._checkUniform(a);
this._colors4[a]=b;return this};c.prototype.setVector2=function(a,b){this._checkUniform(a);this._vectors2[a]=b;return this};c.prototype.setVector3=function(a,b){this._checkUniform(a);this._vectors3[a]=b;return this};c.prototype.setMatrix=function(a,b){this._checkUniform(a);this._matrices[a]=b;return this};c.prototype.render=function(b){if(b=this.getScene()){var c=this._fullEngine;c.enableEffect(this._effect);this.onBeforeGenerationObservable.notifyObservers(this);c.setState(!1);if(!this.nodeMaterialSource){for(var d in this._textures)this._effect.setTexture(d,
this._textures[d]);for(d in this._ints)this._effect.setInt(d,this._ints[d]);for(d in this._floats)this._effect.setFloat(d,this._floats[d]);for(d in this._floatsArrays)this._effect.setArray(d,this._floatsArrays[d]);for(d in this._colors3)this._effect.setColor3(d,this._colors3[d]);for(d in this._colors4){var e=this._colors4[d];this._effect.setFloat4(d,e.r,e.g,e.b,e.a)}for(d in this._vectors2)this._effect.setVector2(d,this._vectors2[d]);for(d in this._vectors3)this._effect.setVector3(d,this._vectors3[d]);
for(d in this._matrices)this._effect.setMatrix(d,this._matrices[d])}if(this._texture){if(this.isCube)for(d=0;6>d;d++)c.bindFramebuffer(this._texture,d,void 0,void 0,!0),c.bindBuffers(this._vertexBuffers,this._indexBuffer,this._effect),this._effect.setFloat("face",d),this.autoClear&&c.clear(b.clearColor,!0,!1,!1),c.drawElementsType(a.a.TriangleFillMode,0,6),5===d&&c.generateMipMapsForCubemap(this._texture);else c.bindFramebuffer(this._texture,0,void 0,void 0,!0),c.bindBuffers(this._vertexBuffers,this._indexBuffer,
this._effect),this.autoClear&&c.clear(b.clearColor,!0,!1,!1),c.drawElementsType(a.a.TriangleFillMode,0,6);c.unBindFramebuffer(this._texture,this.isCube);if(this.onGenerated)this.onGenerated();this.onGeneratedObservable.notifyObservers(this)}}};c.prototype.clone=function(){var a=this.getSize();a=new c(this.name,a.width,this._fragment,this.getScene(),this._fallbackTexture,this._generateMipMaps);a.hasAlpha=this.hasAlpha;a.level=this.level;a.coordinatesMode=this.coordinatesMode;return a};c.prototype.dispose=
function(){var a=this.getScene();if(a){var c=a.proceduralTextures.indexOf(this);0<=c&&a.proceduralTextures.splice(c,1);if(a=this._vertexBuffers[t.b.PositionKind])a.dispose(),this._vertexBuffers[t.b.PositionKind]=null;this._indexBuffer&&this._fullEngine._releaseBuffer(this._indexBuffer)&&(this._indexBuffer=null);this.onGeneratedObservable.clear();this.onBeforeGenerationObservable.clear();b.prototype.dispose.call(this)}};Object(l.c)([Object(h.c)()],c.prototype,"isEnabled",void 0);Object(l.c)([Object(h.c)()],
c.prototype,"autoClear",void 0);Object(l.c)([Object(h.c)()],c.prototype,"_generateMipMaps",void 0);Object(l.c)([Object(h.c)()],c.prototype,"_size",void 0);Object(l.c)([Object(h.c)()],c.prototype,"refreshRate",null);return c}(n.a);r.a.RegisteredTypes["BABYLON.ProceduralTexture"]=d},k2R8:function(n,r,b){b.d(r,"b",function(){return t});b.d(r,"a",function(){return m});var l=b("ps+7"),h=b("9DX3"),v=b("n5HA"),t;(function(a){a[a.Unknown=0]="Unknown";a[a.Url=1]="Url";a[a.Temp=2]="Temp";a[a.Raw=3]="Raw";a[a.Dynamic=
4]="Dynamic";a[a.RenderTarget=5]="RenderTarget";a[a.MultiRenderTarget=6]="MultiRenderTarget";a[a.Cube=7]="Cube";a[a.CubeRaw=8]="CubeRaw";a[a.CubePrefiltered=9]="CubePrefiltered";a[a.Raw3D=10]="Raw3D";a[a.Raw2DArray=11]="Raw2DArray";a[a.Depth=12]="Depth";a[a.CubeRawRGBD=13]="CubeRawRGBD"})(t||(t={}));var m=function(){function a(a,b,e){void 0===e&&(e=!1);this.isMultiview=this.is2DArray=this.is3D=this.isCube=this.isReady=!1;this.url="";this.samplingMode=-1;this.generateMipMaps=!1;this.samples=0;this.format=
this.type=-1;this.onLoadedObservable=new l.a;this.baseDepth=this.baseHeight=this.baseWidth=this.depth=this.height=this.width=0;this._invertVScale=this.invertY=!1;this._associatedChannel=-1;this._source=t.Unknown;this._bufferViewArrayArray=this._bufferViewArray=this._bufferView=this._buffer=null;this._size=0;this._extension="";this._cachedAnisotropicFilteringLevel=this._cachedWrapR=this._cachedWrapV=this._cachedWrapU=this._cachedCoordinatesMode=this._textureArray=this._attachments=this._MSAARenderBuffer=
this._MSAAFramebuffer=this._depthStencilBuffer=this._framebuffer=this._workingContext=this._workingCanvas=this._files=null;this._isDisabled=!1;this._compression=null;this._generateDepthBuffer=this._generateStencilBuffer=!1;this._comparisonFunction=0;this._sphericalPolynomial=null;this._lodGenerationOffset=this._lodGenerationScale=0;this._lodTextureLow=this._lodTextureMid=this._lodTextureHigh=this._depthStencilTextureArray=this._colorTextureArray=null;this._linearSpecularLOD=this._isRGBD=!1;this._webGLTexture=
this._irradianceTexture=null;this._references=1;this._gammaSpace=null;this._engine=a;this._source=b;e||(this._webGLTexture=a._createTexture())}a.prototype.getEngine=function(){return this._engine};Object.defineProperty(a.prototype,"source",{get:function(){return this._source},enumerable:!1,configurable:!0});a.prototype.incrementReferences=function(){this._references++};a.prototype.updateSize=function(a,b,e){void 0===e&&(e=1);this.width=a;this.height=b;this.depth=e;this.baseWidth=a;this.baseHeight=
b;this.baseDepth=e;this._size=a*b*e};a.prototype._rebuild=function(){var b=this,g;this.isReady=!1;this._cachedAnisotropicFilteringLevel=this._cachedWrapV=this._cachedWrapU=this._cachedCoordinatesMode=null;switch(this.source){case t.Url:var e=this._engine.createTexture(null!==(g=this._originalUrl)&&void 0!==g?g:this.url,!this.generateMipMaps,this.invertY,null,this.samplingMode,function(){e._swapAndDie(b);b.isReady=!0},null,this._buffer,void 0,this.format);break;case t.Raw:e=this._engine.createRawTexture(this._bufferView,
this.baseWidth,this.baseHeight,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression);e._swapAndDie(this);this.isReady=!0;break;case t.Raw3D:e=this._engine.createRawTexture3D(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression);e._swapAndDie(this);this.isReady=!0;break;case t.Raw2DArray:e=this._engine.createRawTexture2DArray(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,
this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression);e._swapAndDie(this);this.isReady=!0;break;case t.Dynamic:e=this._engine.createDynamicTexture(this.baseWidth,this.baseHeight,this.generateMipMaps,this.samplingMode);e._swapAndDie(this);this._engine.updateDynamicTexture(this,this._engine.getRenderingCanvas(),this.invertY,void 0,void 0,!0);break;case t.RenderTarget:g=new h.a;g.generateDepthBuffer=this._generateDepthBuffer;g.generateMipMaps=this.generateMipMaps;g.generateStencilBuffer=
this._generateStencilBuffer;g.samplingMode=this.samplingMode;g.type=this.type;e=this.isCube?this._engine.createRenderTargetCubeTexture(this.width,g):this._engine.createRenderTargetTexture({width:this.width,height:this.height,layers:this.is2DArray?this.depth:void 0},g);e._swapAndDie(this);this.isReady=!0;break;case t.Depth:e=this._engine.createDepthStencilTexture({width:this.width,height:this.height,layers:this.is2DArray?this.depth:void 0},{bilinearFiltering:2!==this.samplingMode,comparisonFunction:this._comparisonFunction,
generateStencil:this._generateStencilBuffer,isCube:this.isCube});e._swapAndDie(this);this.isReady=!0;break;case t.Cube:e=this._engine.createCubeTexture(this.url,null,this._files,!this.generateMipMaps,function(){e._swapAndDie(b);b.isReady=!0},null,this.format,this._extension);break;case t.CubeRaw:e=this._engine.createRawCubeTexture(this._bufferViewArray,this.width,this.format,this.type,this.generateMipMaps,this.invertY,this.samplingMode,this._compression);e._swapAndDie(this);this.isReady=!0;break;
case t.CubeRawRGBD:e=this._engine.createRawCubeTexture(null,this.width,this.format,this.type,this.generateMipMaps,this.invertY,this.samplingMode,this._compression);a._UpdateRGBDAsync(e,this._bufferViewArrayArray,this._sphericalPolynomial,this._lodGenerationScale,this._lodGenerationOffset).then(function(){e._swapAndDie(b);b.isReady=!0});break;case t.CubePrefiltered:e=this._engine.createPrefilteredCubeTexture(this.url,null,this._lodGenerationScale,this._lodGenerationOffset,function(a){a&&a._swapAndDie(b);
b.isReady=!0},null,this.format,this._extension),e._sphericalPolynomial=this._sphericalPolynomial}};a.prototype._swapAndDie=function(a){a._webGLTexture=this._webGLTexture;a._isRGBD=this._isRGBD;this._framebuffer&&(a._framebuffer=this._framebuffer);this._depthStencilBuffer&&(a._depthStencilBuffer=this._depthStencilBuffer);a._depthStencilTexture=this._depthStencilTexture;this._lodTextureHigh&&(a._lodTextureHigh&&a._lodTextureHigh.dispose(),a._lodTextureHigh=this._lodTextureHigh);this._lodTextureMid&&
(a._lodTextureMid&&a._lodTextureMid.dispose(),a._lodTextureMid=this._lodTextureMid);this._lodTextureLow&&(a._lodTextureLow&&a._lodTextureLow.dispose(),a._lodTextureLow=this._lodTextureLow);this._irradianceTexture&&(a._irradianceTexture&&a._irradianceTexture.dispose(),a._irradianceTexture=this._irradianceTexture);var b=this._engine.getLoadedTexturesCache(),e=b.indexOf(this);-1!==e&&b.splice(e,1);e=b.indexOf(a);-1===e&&b.push(a)};a.prototype.dispose=function(){this._webGLTexture&&(this._references--,
0===this._references&&(this._engine._releaseTexture(this),this._webGLTexture=null))};a._UpdateRGBDAsync=function(a,b,e,d,h){throw v.a.WarnImport("environmentTextureTools");};return a}()},o7xM:function(n,r,b){b.d(r,"a",function(){return m});var l=b("oYeq"),h=b("ADVu"),v=b("nTJO"),t=b("k2R8");n=b("Z+J3");b("83xy");var m=function(a){function b(b,e,d,h,c,k,l,f,m){void 0===h&&(h=5);void 0===c&&(c=0);void 0===k&&(k=!1);void 0===l&&(l=!1);void 0===f&&(f=3);void 0===m&&(m=null);var g=a.call(this,"",b)||this;
g._texture=b.getEngine().createRawCubeTexture(e,d,h,c,k,l,f,m);return g}Object(l.d)(b,a);b.prototype.update=function(a,b,d,h,c){void 0===c&&(c=null);this._texture.getEngine().updateRawCubeTexture(this._texture,a,b,d,h,c)};b.prototype.updateRGBDAsync=function(a,e,d,h){void 0===e&&(e=null);void 0===d&&(d=.8);void 0===h&&(h=0);return b._UpdateRGBDAsync(this._texture,a,e,d,h)};b.prototype.clone=function(){var a=this;return h.a.Clone(function(){var e=a.getScene(),d=a._texture;e=new b(e,d._bufferViewArray,
d.width,d.format,d.type,d.generateMipMaps,d.invertY,d.samplingMode,d._compression);d.source===t.b.CubeRawRGBD&&e.updateRGBDAsync(d._bufferViewArrayArray,d._sphericalPolynomial,d._lodGenerationScale,d._lodGenerationOffset);return e},this)};b._UpdateRGBDAsync=function(a,b,d,h,c){a._source=t.b.CubeRawRGBD;a._bufferViewArrayArray=b;a._lodGenerationScale=h;a._lodGenerationOffset=c;a._sphericalPolynomial=d;return v.a.UploadLevelsAsync(a,b).then(function(){a.isReady=!0})};return b}(n.a)},obT0:function(n,
r,b){var l=b("nTJO");n=b("qUIE");var h=b("X2Ve");b=function(){function b(){this.supportCascades=!1}b.prototype.canLoad=function(b){return h.a.EndsWith(b,".env")};b.prototype.loadCubeData=function(b,h,a,n,g){Array.isArray(b)||((a=l.a.GetEnvInfo(b))?(h.width=a.width,h.height=a.width,l.a.UploadEnvSpherical(h,a),l.a.UploadEnvLevelsAsync(h,b,a).then(function(){h.isReady=!0;h.onLoadedObservable.notifyObservers(h);h.onLoadedObservable.clear();n&&n()})):g&&g("Can not parse the environment file",null))};b.prototype.loadData=
function(b,h,a){throw".env not supported in 2d.";};return b}();n.a._TextureLoaders.push(new b)},srWW:function(n,r,b){b.d(r,"a",function(){return e});var l=b("oYeq"),h=b("ps+7"),v=b("YKqZ"),t=b("/SR9"),m=b("aCSs"),a=b("WnUc"),q=b("F24J");b("DvRB");b("3XS9");var g=b("qUIE"),e=function(b){function d(a,d,e,f,g,l,n,p,r,v,B,D,E){void 0===g&&(g=!0);void 0===l&&(l=0);void 0===n&&(n=!1);void 0===p&&(p=m.a.TRILINEAR_SAMPLINGMODE);void 0===r&&(r=!0);void 0===v&&(v=!1);void 0===B&&(B=!1);void 0===D&&(D=5);void 0===
E&&(E=!1);var c=b.call(this,null,e,!f)||this;c.renderParticles=!0;c.renderSprites=!1;c.ignoreCameraViewport=!1;c.onBeforeBindObservable=new h.a;c.onAfterUnbindObservable=new h.a;c.onBeforeRenderObservable=new h.a;c.onAfterRenderObservable=new h.a;c.onClearObservable=new h.a;c.onResizeObservable=new h.a;c._currentRefreshId=-1;c._refreshRate=1;c._samples=1;c.boundingBoxPosition=t.e.Zero();e=c.getScene();if(!e)return c;c._coordinatesMode=m.a.PROJECTION_MODE;c.renderList=[];c.name=a;c.isRenderTarget=
!0;c._initialSizeParameter=d;c._processSizeParameter(d);c._resizeObserver=c.getScene().getEngine().onResizeObservable.add(function(){});c._generateMipMaps=f?!0:!1;c._doNotChangeAspectRatio=g;c._renderingManager=new q.a(e);c._renderingManager._useSceneAutoClearSetup=!0;if(B)return c;c._renderTargetOptions={generateMipMaps:f,type:l,format:D,samplingMode:p,generateDepthBuffer:r,generateStencilBuffer:v};p===m.a.NEAREST_SAMPLINGMODE&&(c.wrapU=m.a.CLAMP_ADDRESSMODE,c.wrapV=m.a.CLAMP_ADDRESSMODE);E||(n?
(c._texture=e.getEngine().createRenderTargetCubeTexture(c.getRenderSize(),c._renderTargetOptions),c.coordinatesMode=m.a.INVCUBIC_MODE,c._textureMatrix=t.a.Identity()):c._texture=e.getEngine().createRenderTargetTexture(c._size,c._renderTargetOptions));return c}Object(l.d)(d,b);Object.defineProperty(d.prototype,"renderList",{get:function(){return this._renderList},set:function(a){(this._renderList=a)&&this._hookArray(this._renderList)},enumerable:!1,configurable:!0});d.prototype._hookArray=function(a){var b=
this,c=a.push;a.push=function(){for(var d=[],e=0;e<arguments.length;e++)d[e]=arguments[e];e=0===a.length;d=c.apply(a,d);e&&b.getScene()&&b.getScene().meshes.forEach(function(a){a._markSubMeshesAsLightDirty()});return d};var d=a.splice;a.splice=function(c,e){c=d.apply(a,[c,e]);0===a.length&&b.getScene().meshes.forEach(function(a){a._markSubMeshesAsLightDirty()});return c}};Object.defineProperty(d.prototype,"onAfterUnbind",{set:function(a){this._onAfterUnbindObserver&&this.onAfterUnbindObservable.remove(this._onAfterUnbindObserver);
this._onAfterUnbindObserver=this.onAfterUnbindObservable.add(a)},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"onBeforeRender",{set:function(a){this._onBeforeRenderObserver&&this.onBeforeRenderObservable.remove(this._onBeforeRenderObserver);this._onBeforeRenderObserver=this.onBeforeRenderObservable.add(a)},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"onAfterRender",{set:function(a){this._onAfterRenderObserver&&this.onAfterRenderObservable.remove(this._onAfterRenderObserver);
this._onAfterRenderObserver=this.onAfterRenderObservable.add(a)},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"onClear",{set:function(a){this._onClearObserver&&this.onClearObservable.remove(this._onClearObserver);this._onClearObserver=this.onClearObservable.add(a)},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"renderTargetOptions",{get:function(){return this._renderTargetOptions},enumerable:!1,configurable:!0});d.prototype._onRatioRescale=function(){this._sizeRatio&&
this.resize(this._initialSizeParameter)};Object.defineProperty(d.prototype,"boundingBoxSize",{get:function(){return this._boundingBoxSize},set:function(a){this._boundingBoxSize&&this._boundingBoxSize.equals(a)||(this._boundingBoxSize=a,(a=this.getScene())&&a.markAllMaterialsAsDirty(1))},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"depthStencilTexture",{get:function(){var a;return(null===(a=this.getInternalTexture())||void 0===a?void 0:a._depthStencilTexture)||null},enumerable:!1,
configurable:!0});d.prototype.createDepthStencilTexture=function(a,b,d){void 0===a&&(a=0);void 0===b&&(b=!0);void 0===d&&(d=!1);var c=this.getInternalTexture();if(this.getScene()&&c){var e=this.getScene().getEngine();c._depthStencilTexture=e.createDepthStencilTexture(this._size,{bilinearFiltering:b,comparisonFunction:a,generateStencil:d,isCube:this.isCube})}};d.prototype._processSizeParameter=function(a){a.ratio?(this._sizeRatio=a.ratio,a=this._getEngine(),this._size={width:this._bestReflectionRenderTargetDimension(a.getRenderWidth(),
this._sizeRatio),height:this._bestReflectionRenderTargetDimension(a.getRenderHeight(),this._sizeRatio)}):this._size=a};Object.defineProperty(d.prototype,"samples",{get:function(){return this._samples},set:function(a){if(this._samples!==a){var b=this.getScene();b&&(this._samples=b.getEngine().updateRenderTargetTextureSampleCount(this._texture,a))}},enumerable:!1,configurable:!0});d.prototype.resetRefreshCounter=function(){this._currentRefreshId=-1};Object.defineProperty(d.prototype,"refreshRate",{get:function(){return this._refreshRate},
set:function(a){this._refreshRate=a;this.resetRefreshCounter()},enumerable:!1,configurable:!0});d.prototype.addPostProcess=function(b){if(!this._postProcessManager){var c=this.getScene();if(!c)return;this._postProcessManager=new a.a(c);this._postProcesses=[]}this._postProcesses.push(b);this._postProcesses[0].autoClear=!1};d.prototype.clearPostProcesses=function(a){void 0===a&&(a=!1);if(this._postProcesses){if(a){a=0;for(var b=this._postProcesses;a<b.length;a++)b[a].dispose()}this._postProcesses=[]}};
d.prototype.removePostProcess=function(a){this._postProcesses&&(a=this._postProcesses.indexOf(a),-1!==a&&(this._postProcesses.splice(a,1),0<this._postProcesses.length&&(this._postProcesses[0].autoClear=!1)))};d.prototype._shouldRender=function(){if(-1===this._currentRefreshId||this.refreshRate===this._currentRefreshId)return this._currentRefreshId=1,!0;this._currentRefreshId++;return!1};d.prototype.getRenderSize=function(){return this.getRenderWidth()};d.prototype.getRenderWidth=function(){return this._size.width?
this._size.width:this._size};d.prototype.getRenderHeight=function(){return this._size.width?this._size.height:this._size};d.prototype.getRenderLayers=function(){var a=this._size.layers;return a?a:0};Object.defineProperty(d.prototype,"canRescale",{get:function(){return!0},enumerable:!1,configurable:!0});d.prototype.scale=function(a){a=Math.max(1,this.getRenderSize()*a);this.resize(a)};d.prototype.getReflectionTextureMatrix=function(){return this.isCube?this._textureMatrix:b.prototype.getReflectionTextureMatrix.call(this)};
d.prototype.resize=function(a){var b=this.isCube;this.releaseInternalTexture();var c=this.getScene();c&&(this._processSizeParameter(a),this._texture=b?c.getEngine().createRenderTargetCubeTexture(this.getRenderSize(),this._renderTargetOptions):c.getEngine().createRenderTargetTexture(this._size,this._renderTargetOptions),this.onResizeObservable.hasObservers()&&this.onResizeObservable.notifyObservers(this))};d.prototype.render=function(a,b){void 0===a&&(a=!1);void 0===b&&(b=!1);var c=this.getScene();
if(c){var d=c.getEngine();void 0!==this.useCameraPostProcesses&&(a=this.useCameraPostProcesses);if(this._waitingRenderList){this.renderList=[];for(var e=0;e<this._waitingRenderList.length;e++){var k=c.getMeshByID(this._waitingRenderList[e]);k&&this.renderList.push(k)}this._waitingRenderList=void 0}if(this.renderListPredicate){this.renderList?this.renderList.length=0:this.renderList=[];c=this.getScene();if(!c)return;k=c.meshes;for(e=0;e<k.length;e++){var g=k[e];this.renderListPredicate(g)&&this.renderList.push(g)}}this.onBeforeBindObservable.notifyObservers(this);
this.activeCamera?(e=this.activeCamera,d.setViewport(this.activeCamera.viewport,this.getRenderWidth(),this.getRenderHeight()),this.activeCamera!==c.activeCamera&&c.setTransformMatrix(this.activeCamera.getViewMatrix(),this.activeCamera.getProjectionMatrix(!0))):(e=c.activeCamera)&&d.setViewport(e.viewport,this.getRenderWidth(),this.getRenderHeight());this._defaultRenderListPrepared=!1;if(this.is2DArray)for(k=0;k<this.getRenderLayers();k++)this.renderToTarget(0,a,b,k,e),c.incrementRenderId(),c.resetCachedMaterial();
else if(this.isCube)for(k=0;6>k;k++)this.renderToTarget(k,a,b,void 0,e),c.incrementRenderId(),c.resetCachedMaterial();else this.renderToTarget(0,a,b,void 0,e);this.onAfterUnbindObservable.notifyObservers(this);c.activeCamera&&((1<c.getEngine().scenes.length||this.activeCamera&&this.activeCamera!==c.activeCamera)&&c.setTransformMatrix(c.activeCamera.getViewMatrix(),c.activeCamera.getProjectionMatrix(!0)),d.setViewport(c.activeCamera.viewport));c.resetCachedMaterial()}};d.prototype._bestReflectionRenderTargetDimension=
function(a,b){b*=a;b=g.a.NearestPOT(b+16384/(128+b));return Math.min(g.a.FloorPOT(a),b)};d.prototype._prepareRenderingManager=function(a,b,d,e){var c=this.getScene();if(c){this._renderingManager.reset();for(var f=c.getRenderId(),k=0;k<b;k++){var g=a[k];if(g&&!g.isBlocked){if(this.customIsReadyFunction){if(!this.customIsReadyFunction(g,this.refreshRate)){this.resetRefreshCounter();continue}}else if(!g.isReady(0===this.refreshRate)){this.resetRefreshCounter();continue}!g._internalAbstractMeshDataInfo._currentLODIsUpToDate&&
c.activeCamera&&(g._internalAbstractMeshDataInfo._currentLOD=c.customLODSelector?c.customLODSelector(g,c.activeCamera):g.getLOD(c.activeCamera),g._internalAbstractMeshDataInfo._currentLODIsUpToDate=!0);if(g._internalAbstractMeshDataInfo._currentLOD){var h=g._internalAbstractMeshDataInfo._currentLOD;h._preActivateForIntermediateRendering(f);var l=e&&d?0===(g.layerMask&d.layerMask):!1;if(g.isEnabled()&&g.isVisible&&g.subMeshes&&!l&&(h!==g&&h._activate(f,!0),g._activate(f,!0)&&g.subMeshes.length))for(g.isAnInstance?
g._internalAbstractMeshDataInfo._actAsRegularMesh&&(h=g):h._internalAbstractMeshDataInfo._onlyForInstancesIntermediate=!1,h._internalAbstractMeshDataInfo._isActiveIntermediate=!0,g=0;g<h.subMeshes.length;g++)this._renderingManager.dispatch(h.subMeshes[g],h)}}}for(b=0;b<c.particleSystems.length;b++)d=c.particleSystems[b],e=d.emitter,d.isStarted()&&e&&e.position&&e.isEnabled()&&0<=a.indexOf(e)&&this._renderingManager.dispatchParticles(d)}};d.prototype._bindFrameBuffer=function(a,b){void 0===a&&(a=0);
void 0===b&&(b=0);var c=this.getScene();c&&(c=c.getEngine(),this._texture&&c.bindFramebuffer(this._texture,this.isCube?a:void 0,void 0,void 0,this.ignoreCameraViewport,0,b))};d.prototype.unbindFrameBuffer=function(a,b){var c=this;this._texture&&a.unBindFramebuffer(this._texture,this.isCube,function(){c.onAfterRenderObservable.notifyObservers(b)})};d.prototype.renderToTarget=function(a,b,d,e,g){void 0===e&&(e=0);void 0===g&&(g=null);var c=this.getScene();if(c){var f=c.getEngine();if(this._texture){this._postProcessManager?
this._postProcessManager._prepareFrame(this._texture,this._postProcesses):b&&c.postProcessManager._prepareFrame(this._texture)||this._bindFrameBuffer(a,e);this.is2DArray?this.onBeforeRenderObservable.notifyObservers(e):this.onBeforeRenderObservable.notifyObservers(a);var h=null,k=this.renderList?this.renderList:c.getActiveMeshes().data,l=this.renderList?this.renderList.length:c.getActiveMeshes().length;this.getCustomRenderList&&(h=this.getCustomRenderList(this.is2DArray?e:a,k,l));h?this._prepareRenderingManager(h,
h.length,g,!1):(this._defaultRenderListPrepared||(this._prepareRenderingManager(k,l,g,!this.renderList),this._defaultRenderListPrepared=!0),h=k);this.onClearObservable.hasObservers()?this.onClearObservable.notifyObservers(f):f.clear(this.clearColor||c.clearColor,!0,!0,!0);this._doNotChangeAspectRatio||c.updateTransformMatrix(!0);g=0;for(k=c._beforeRenderTargetDrawStage;g<k.length;g++)e=k[g],e.action(this);this._renderingManager.render(this.customRenderFunction,h,this.renderParticles,this.renderSprites);
h=0;for(g=c._afterRenderTargetDrawStage;h<g.length;h++)e=g[h],e.action(this);this._postProcessManager?this._postProcessManager._finalizeFrame(!1,this._texture,a,this._postProcesses,this.ignoreCameraViewport):b&&c.postProcessManager._finalizeFrame(!1,this._texture,a);this._doNotChangeAspectRatio||c.updateTransformMatrix(!0);d&&v.b.DumpFramebuffer(this.getRenderWidth(),this.getRenderHeight(),f);this.isCube&&5!==a?this.onAfterRenderObservable.notifyObservers(a):(this.isCube&&5===a&&f.generateMipMapsForCubemap(this._texture),
this.unbindFrameBuffer(f,a))}}};d.prototype.setRenderingOrder=function(a,b,d,e){void 0===b&&(b=null);void 0===d&&(d=null);void 0===e&&(e=null);this._renderingManager.setRenderingOrder(a,b,d,e)};d.prototype.setRenderingAutoClearDepthStencil=function(a,b){this._renderingManager.setRenderingAutoClearDepthStencil(a,b);this._renderingManager._useSceneAutoClearSetup=!1};d.prototype.clone=function(){var a=this.getSize();a=new d(this.name,a,this.getScene(),this._renderTargetOptions.generateMipMaps,this._doNotChangeAspectRatio,
this._renderTargetOptions.type,this.isCube,this._renderTargetOptions.samplingMode,this._renderTargetOptions.generateDepthBuffer,this._renderTargetOptions.generateStencilBuffer);a.hasAlpha=this.hasAlpha;a.level=this.level;a.coordinatesMode=this.coordinatesMode;this.renderList&&(a.renderList=this.renderList.slice(0));return a};d.prototype.serialize=function(){if(!this.name)return null;var a=b.prototype.serialize.call(this);a.renderTargetSize=this.getRenderSize();a.renderList=[];if(this.renderList)for(var d=
0;d<this.renderList.length;d++)a.renderList.push(this.renderList[d].id);return a};d.prototype.disposeFramebufferObjects=function(){var a=this.getInternalTexture(),b=this.getScene();a&&b&&b.getEngine()._releaseFramebufferObjects(a)};d.prototype.dispose=function(){this.onResizeObservable.clear();this.onClearObservable.clear();this.onAfterRenderObservable.clear();this.onAfterUnbindObservable.clear();this.onBeforeBindObservable.clear();this.onBeforeRenderObservable.clear();this._postProcessManager&&(this._postProcessManager.dispose(),
this._postProcessManager=null);this.clearPostProcesses(!0);this._resizeObserver&&(this.getScene().getEngine().onResizeObservable.remove(this._resizeObserver),this._resizeObserver=null);this.renderList=null;var a=this.getScene();if(a){var d=a.customRenderTargets.indexOf(this);0<=d&&a.customRenderTargets.splice(d,1);var e=0;for(a=a.cameras;e<a.length;e++){var f=a[e];d=f.customRenderTargets.indexOf(this);0<=d&&f.customRenderTargets.splice(d,1)}this.depthStencilTexture&&this.getScene().getEngine()._releaseTexture(this.depthStencilTexture);
b.prototype.dispose.call(this)}};d.prototype._rebuild=function(){this.refreshRate===d.REFRESHRATE_RENDER_ONCE&&(this.refreshRate=d.REFRESHRATE_RENDER_ONCE);this._postProcessManager&&this._postProcessManager._rebuild()};d.prototype.freeRenderingGroups=function(){this._renderingManager&&this._renderingManager.freeRenderingGroups()};d.prototype.getViewCount=function(){return 1};d.REFRESHRATE_RENDER_ONCE=0;d.REFRESHRATE_RENDER_ONEVERYFRAME=1;d.REFRESHRATE_RENDER_ONEVERYTWOFRAMES=2;return d}(m.a);m.a._CreateRenderTargetTexture=
function(a,b,c,g){return new e(a,b,c,g)}}}]);

var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(n){var r=0;return function(){return r<n.length?{done:!1,value:n[r++]}:{done:!0}}};$jscomp.arrayIterator=function(n){return{next:$jscomp.arrayIteratorImpl(n)}};$jscomp.makeIterator=function(n){var r="undefined"!=typeof Symbol&&Symbol.iterator&&n[Symbol.iterator];return r?r.call(n):$jscomp.arrayIterator(n)};
$jscomp.getGlobal=function(n){return"undefined"!=typeof window&&window===n?n:"undefined"!=typeof global&&null!=global?global:n};$jscomp.global=$jscomp.getGlobal(this);$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(n,r,h){n!=Array.prototype&&n!=Object.prototype&&(n[r]=h.value)};
$jscomp.polyfill=function(n,r,h,x){if(r){h=$jscomp.global;n=n.split(".");for(x=0;x<n.length-1;x++){var b=n[x];b in h||(h[b]={});h=h[b]}n=n[n.length-1];x=h[n];r=r(x);r!=x&&null!=r&&$jscomp.defineProperty(h,n,{configurable:!0,writable:!0,value:r})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(n){function r(){this.batch_=null}function h(h){return h instanceof b?h:new b(function(b,u){b(h)})}if(n&&!$jscomp.FORCE_POLYFILL_PROMISE)return n;r.prototype.asyncExecute=function(b){if(null==this.batch_){this.batch_=[];var h=this;this.asyncExecuteFunction(function(){h.executeBatch_()})}this.batch_.push(b)};var x=$jscomp.global.setTimeout;r.prototype.asyncExecuteFunction=function(b){x(b,0)};r.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var b=
this.batch_;this.batch_=[];for(var h=0;h<b.length;++h){var t=b[h];b[h]=null;try{t()}catch(v){this.asyncThrow_(v)}}}this.batch_=null};r.prototype.asyncThrow_=function(b){this.asyncExecuteFunction(function(){throw b;})};var b=function(b){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var h=this.createResolveAndReject_();try{b(h.resolve,h.reject)}catch(t){h.reject(t)}};b.prototype.createResolveAndReject_=function(){function b(b){return function(u){t||(t=!0,b.call(h,u))}}var h=this,t=!1;
return{resolve:b(this.resolveTo_),reject:b(this.reject_)}};b.prototype.resolveTo_=function(h){if(h===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(h instanceof b)this.settleSameAsPromise_(h);else{a:switch(typeof h){case "object":var u=null!=h;break a;case "function":u=!0;break a;default:u=!1}u?this.resolveToNonPromiseObj_(h):this.fulfill_(h)}};b.prototype.resolveToNonPromiseObj_=function(b){var h=void 0;try{h=b.then}catch(t){this.reject_(t);return}"function"==typeof h?
this.settleSameAsThenable_(h,b):this.fulfill_(b)};b.prototype.reject_=function(b){this.settle_(2,b)};b.prototype.fulfill_=function(b){this.settle_(1,b)};b.prototype.settle_=function(b,h){if(0!=this.state_)throw Error("Cannot settle("+b+", "+h+"): Promise already settled in state"+this.state_);this.state_=b;this.result_=h;this.executeOnSettledCallbacks_()};b.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var b=0;b<this.onSettledCallbacks_.length;++b)z.asyncExecute(this.onSettledCallbacks_[b]);
this.onSettledCallbacks_=null}};var z=new r;b.prototype.settleSameAsPromise_=function(b){var h=this.createResolveAndReject_();b.callWhenSettled_(h.resolve,h.reject)};b.prototype.settleSameAsThenable_=function(b,h){var t=this.createResolveAndReject_();try{b.call(h,t.resolve,t.reject)}catch(v){t.reject(v)}};b.prototype.then=function(h,n){function t(b,h){return"function"==typeof b?function(C){try{v(b(C))}catch(d){u(d)}}:h}var v,u,r=new b(function(b,h){v=b;u=h});this.callWhenSettled_(t(h,v),t(n,u));return r};
b.prototype.catch=function(b){return this.then(void 0,b)};b.prototype.callWhenSettled_=function(b,h){function t(){switch(n.state_){case 1:b(n.result_);break;case 2:h(n.result_);break;default:throw Error("Unexpected state: "+n.state_);}}var n=this;null==this.onSettledCallbacks_?z.asyncExecute(t):this.onSettledCallbacks_.push(t)};b.resolve=h;b.reject=function(h){return new b(function(b,n){n(h)})};b.race=function(n){return new b(function(b,t){for(var r=$jscomp.makeIterator(n),u=r.next();!u.done;u=r.next())h(u.value).callWhenSettled_(b,
t)})};b.all=function(n){var r=$jscomp.makeIterator(n),t=r.next();return t.done?h([]):new b(function(b,n){function u(C){return function(d){v[C]=d;k--;0==k&&b(v)}}var v=[],k=0;do v.push(void 0),k++,h(t.value).callWhenSettled_(u(v.length-1),n),t=r.next();while(!t.done)})};return b},"es6","es3");
(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{"7rXT":function(n,r,h){(function(n){var b=h("oYeq"),r=h("uyO6"),u=h("qUIE"),x=h("9DX3"),t=h("k2R8"),v=h("hSZw"),D=h("fn/E"),B=function(){return function(){this.renderWidth=512;this.renderHeight=256;this.textureSize=512;this.deterministicLockstep=!1;this.lockstepMaxSteps=4}}();(function(h){function k(b){void 0===b&&(b=new B);var d=h.call(this,null)||this;u.a.Instances.push(d);void 0===b.deterministicLockstep&&(b.deterministicLockstep=!1);void 0===
b.lockstepMaxSteps&&(b.lockstepMaxSteps=4);d._options=b;D.a.SetMatrixPrecision(!!b.useHighPrecisionMatrix);d._caps={maxTexturesImageUnits:16,maxVertexTextureImageUnits:16,maxCombinedTexturesImageUnits:32,maxTextureSize:512,maxCubemapTextureSize:512,maxRenderTextureSize:512,maxVertexAttribs:16,maxVaryingVectors:16,maxFragmentUniformVectors:16,maxVertexUniformVectors:16,standardDerivatives:!1,astc:null,pvrtc:null,etc1:null,etc2:null,bptc:null,maxAnisotropy:0,uintIndices:!1,fragmentDepthSupported:!1,
highPrecisionShaderSupported:!0,colorBufferFloat:!1,textureFloat:!1,textureFloatLinearFiltering:!1,textureFloatRender:!1,textureHalfFloat:!1,textureHalfFloatLinearFiltering:!1,textureHalfFloatRender:!1,textureLOD:!1,drawBuffersExtension:!1,depthTextureExtension:!1,vertexArrayObject:!1,instancedArrays:!1,canUseTimestampForTimerQuery:!1,maxMSAASamples:1,blendMinMax:!1};r.a.Log("Babylon.js v"+u.a.Version+" - Null engine");b="undefined"!==typeof self?self:"undefined"!==typeof n?n:window;"undefined"===
typeof URL&&(b.URL={createObjectURL:function(){},revokeObjectURL:function(){}});"undefined"===typeof Blob&&(b.Blob=function(){});return d}Object(b.d)(k,h);k.prototype.isDeterministicLockStep=function(){return this._options.deterministicLockstep};k.prototype.getLockstepMaxSteps=function(){return this._options.lockstepMaxSteps};k.prototype.getHardwareScalingLevel=function(){return 1};k.prototype.createVertexBuffer=function(b){b=new v.a;b.references=1;return b};k.prototype.createIndexBuffer=function(b){b=
new v.a;b.references=1;return b};k.prototype.clear=function(b,d,g,p){};k.prototype.getRenderWidth=function(b){void 0===b&&(b=!1);return!b&&this._currentRenderTarget?this._currentRenderTarget.width:this._options.renderWidth};k.prototype.getRenderHeight=function(b){void 0===b&&(b=!1);return!b&&this._currentRenderTarget?this._currentRenderTarget.height:this._options.renderHeight};k.prototype.setViewport=function(b,d,g){this._cachedViewport=b};k.prototype.createShaderProgram=function(b,d,g,p,h){return{__SPECTOR_rebuildProgram:null}};
k.prototype.getUniforms=function(b,d){return[]};k.prototype.getAttributes=function(b,d){return[]};k.prototype.bindSamplers=function(b){this._currentEffect=null};k.prototype.enableEffect=function(b){this._currentEffect=b;if(b.onBind)b.onBind(b);b._onBindObservable&&b._onBindObservable.notifyObservers(b)};k.prototype.setState=function(b,d,g,p){};k.prototype.setIntArray=function(b,d){return!0};k.prototype.setIntArray2=function(b,d){return!0};k.prototype.setIntArray3=function(b,d){return!0};k.prototype.setIntArray4=
function(b,d){return!0};k.prototype.setFloatArray=function(b,d){return!0};k.prototype.setFloatArray2=function(b,d){return!0};k.prototype.setFloatArray3=function(b,d){return!0};k.prototype.setFloatArray4=function(b,d){return!0};k.prototype.setArray=function(b,d){return!0};k.prototype.setArray2=function(b,d){return!0};k.prototype.setArray3=function(b,d){return!0};k.prototype.setArray4=function(b,d){return!0};k.prototype.setMatrices=function(b,d){return!0};k.prototype.setMatrix3x3=function(b,d){return!0};
k.prototype.setMatrix2x2=function(b,d){return!0};k.prototype.setFloat=function(b,d){return!0};k.prototype.setFloat2=function(b,d,g){return!0};k.prototype.setFloat3=function(b,d,g,p){return!0};k.prototype.setBool=function(b,d){return!0};k.prototype.setFloat4=function(b,d,g,p,h){return!0};k.prototype.setAlphaMode=function(b,d){void 0===d&&(d=!1);this._alphaMode!==b&&(this.alphaState.alphaBlend=0!==b,d||this.setDepthWrite(0===b),this._alphaMode=b)};k.prototype.bindBuffers=function(b,d,g){};k.prototype.wipeCaches=
function(b){this.preventCacheWipeBetweenFrames||(this.resetTextureCache(),this._currentEffect=null,b&&(this._currentProgram=null,this.stencilState.reset(),this.depthCullingState.reset(),this.alphaState.reset()),this._cachedEffectForVertexBuffers=this._cachedIndexBuffer=this._cachedVertexBuffers=null)};k.prototype.draw=function(b,d,g,p){};k.prototype.drawElementsType=function(b,d,g,p){};k.prototype.drawArraysType=function(b,d,g,p){};k.prototype._createTexture=function(){return{}};k.prototype._releaseTexture=
function(b){};k.prototype.createTexture=function(b,d,g,p,h,k,f,c,a,e,l,m){void 0===h&&(h=3);void 0===k&&(k=null);void 0===e&&(e=null);p=new t.a(this,t.b.Url);p.url=String(b);p.generateMipMaps=!d;p.samplingMode=h;p.invertY=g;p.baseWidth=this._options.textureSize;p.baseHeight=this._options.textureSize;p.width=this._options.textureSize;p.height=this._options.textureSize;e&&(p.format=e);p.isReady=!0;k&&k();this._internalTexturesCache.push(p);return p};k.prototype.createRenderTargetTexture=function(b,
d){var g=new x.a;void 0!==d&&"object"===typeof d?(g.generateMipMaps=d.generateMipMaps,g.generateDepthBuffer=void 0===d.generateDepthBuffer?!0:d.generateDepthBuffer,g.generateStencilBuffer=g.generateDepthBuffer&&d.generateStencilBuffer,g.type=void 0===d.type?0:d.type,g.samplingMode=void 0===d.samplingMode?3:d.samplingMode):(g.generateMipMaps=d,g.generateDepthBuffer=!0,g.generateStencilBuffer=!1,g.type=0,g.samplingMode=3);d=new t.a(this,t.b.RenderTarget);var h=b.width||b;b=b.height||b;d._depthStencilBuffer=
{};d._framebuffer={};d.baseWidth=h;d.baseHeight=b;d.width=h;d.height=b;d.isReady=!0;d.samples=1;d.generateMipMaps=g.generateMipMaps?!0:!1;d.samplingMode=g.samplingMode;d.type=g.type;d._generateDepthBuffer=g.generateDepthBuffer;d._generateStencilBuffer=g.generateStencilBuffer?!0:!1;this._internalTexturesCache.push(d);return d};k.prototype.updateTextureSamplingMode=function(b,d){d.samplingMode=b};k.prototype.bindFramebuffer=function(b,d,g,h,q){this._currentRenderTarget&&this.unBindFramebuffer(this._currentRenderTarget);
this._currentRenderTarget=b;this._currentFramebuffer=b._MSAAFramebuffer?b._MSAAFramebuffer:b._framebuffer;this._cachedViewport&&!q&&this.setViewport(this._cachedViewport,g,h)};k.prototype.unBindFramebuffer=function(b,d,g){this._currentRenderTarget=null;g&&(b._MSAAFramebuffer&&(this._currentFramebuffer=b._framebuffer),g());this._currentFramebuffer=null};k.prototype.createDynamicVertexBuffer=function(b){b=new v.a;b.references=1;b.capacity=1;return b};k.prototype.updateDynamicTexture=function(b,d,g,
h,q){};k.prototype.areAllEffectsReady=function(){return!0};k.prototype.getError=function(){return 0};k.prototype._getUnpackAlignement=function(){return 1};k.prototype._unpackFlipY=function(b){};k.prototype.updateDynamicIndexBuffer=function(b,d,g){};k.prototype.updateDynamicVertexBuffer=function(b,d,g,h){};k.prototype._bindTextureDirectly=function(b,d){return this._boundTexturesCache[this._activeChannel]!==d?(this._boundTexturesCache[this._activeChannel]=d,!0):!1};k.prototype._bindTexture=function(b,
d){0>b||this._bindTextureDirectly(0,d)};k.prototype._deleteBuffer=function(b){};k.prototype.releaseEffects=function(){};k.prototype.displayLoadingUI=function(){};k.prototype.hideLoadingUI=function(){};k.prototype._uploadCompressedDataToTextureDirectly=function(b,d,g,h,q,k,f){};k.prototype._uploadDataToTextureDirectly=function(b,d,g,h){};k.prototype._uploadArrayBufferViewToTexture=function(b,d,g,h){};k.prototype._uploadImageToTexture=function(b,d,g,h){};return k})(u.a)}).call(this,h("yLpj"))},BOQG:function(n,
r,h){h.d(r,"a",function(){return x});var x=function(){function b(){}b.ALPHA_DISABLE=0;b.ALPHA_ADD=1;b.ALPHA_COMBINE=2;b.ALPHA_SUBTRACT=3;b.ALPHA_MULTIPLY=4;b.ALPHA_MAXIMIZED=5;b.ALPHA_ONEONE=6;b.ALPHA_PREMULTIPLIED=7;b.ALPHA_PREMULTIPLIED_PORTERDUFF=8;b.ALPHA_INTERPOLATE=9;b.ALPHA_SCREENMODE=10;b.ALPHA_ONEONE_ONEONE=11;b.ALPHA_ALPHATOCOLOR=12;b.ALPHA_REVERSEONEMINUS=13;b.ALPHA_SRC_DSTONEMINUSSRCALPHA=14;b.ALPHA_ONEONE_ONEZERO=15;b.ALPHA_EXCLUSION=16;b.ALPHA_EQUATION_ADD=0;b.ALPHA_EQUATION_SUBSTRACT=
1;b.ALPHA_EQUATION_REVERSE_SUBTRACT=2;b.ALPHA_EQUATION_MAX=3;b.ALPHA_EQUATION_MIN=4;b.ALPHA_EQUATION_DARKEN=5;b.DELAYLOADSTATE_NONE=0;b.DELAYLOADSTATE_LOADED=1;b.DELAYLOADSTATE_LOADING=2;b.DELAYLOADSTATE_NOTLOADED=4;b.NEVER=512;b.ALWAYS=519;b.LESS=513;b.EQUAL=514;b.LEQUAL=515;b.GREATER=516;b.GEQUAL=518;b.NOTEQUAL=517;b.KEEP=7680;b.REPLACE=7681;b.INCR=7682;b.DECR=7683;b.INVERT=5386;b.INCR_WRAP=34055;b.DECR_WRAP=34056;b.TEXTURE_CLAMP_ADDRESSMODE=0;b.TEXTURE_WRAP_ADDRESSMODE=1;b.TEXTURE_MIRROR_ADDRESSMODE=
2;b.TEXTUREFORMAT_ALPHA=0;b.TEXTUREFORMAT_LUMINANCE=1;b.TEXTUREFORMAT_LUMINANCE_ALPHA=2;b.TEXTUREFORMAT_RGB=4;b.TEXTUREFORMAT_RGBA=5;b.TEXTUREFORMAT_RED=6;b.TEXTUREFORMAT_R=6;b.TEXTUREFORMAT_RG=7;b.TEXTUREFORMAT_RED_INTEGER=8;b.TEXTUREFORMAT_R_INTEGER=8;b.TEXTUREFORMAT_RG_INTEGER=9;b.TEXTUREFORMAT_RGB_INTEGER=10;b.TEXTUREFORMAT_RGBA_INTEGER=11;b.TEXTURETYPE_UNSIGNED_BYTE=0;b.TEXTURETYPE_UNSIGNED_INT=0;b.TEXTURETYPE_FLOAT=1;b.TEXTURETYPE_HALF_FLOAT=2;b.TEXTURETYPE_BYTE=3;b.TEXTURETYPE_SHORT=4;b.TEXTURETYPE_UNSIGNED_SHORT=
5;b.TEXTURETYPE_INT=6;b.TEXTURETYPE_UNSIGNED_INTEGER=7;b.TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4=8;b.TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1=9;b.TEXTURETYPE_UNSIGNED_SHORT_5_6_5=10;b.TEXTURETYPE_UNSIGNED_INT_2_10_10_10_REV=11;b.TEXTURETYPE_UNSIGNED_INT_24_8=12;b.TEXTURETYPE_UNSIGNED_INT_10F_11F_11F_REV=13;b.TEXTURETYPE_UNSIGNED_INT_5_9_9_9_REV=14;b.TEXTURETYPE_FLOAT_32_UNSIGNED_INT_24_8_REV=15;b.TEXTURE_NEAREST_SAMPLINGMODE=1;b.TEXTURE_NEAREST_NEAREST=1;b.TEXTURE_BILINEAR_SAMPLINGMODE=2;b.TEXTURE_LINEAR_LINEAR=
2;b.TEXTURE_TRILINEAR_SAMPLINGMODE=3;b.TEXTURE_LINEAR_LINEAR_MIPLINEAR=3;b.TEXTURE_NEAREST_NEAREST_MIPNEAREST=4;b.TEXTURE_NEAREST_LINEAR_MIPNEAREST=5;b.TEXTURE_NEAREST_LINEAR_MIPLINEAR=6;b.TEXTURE_NEAREST_LINEAR=7;b.TEXTURE_NEAREST_NEAREST_MIPLINEAR=8;b.TEXTURE_LINEAR_NEAREST_MIPNEAREST=9;b.TEXTURE_LINEAR_NEAREST_MIPLINEAR=10;b.TEXTURE_LINEAR_LINEAR_MIPNEAREST=11;b.TEXTURE_LINEAR_NEAREST=12;b.TEXTURE_EXPLICIT_MODE=0;b.TEXTURE_SPHERICAL_MODE=1;b.TEXTURE_PLANAR_MODE=2;b.TEXTURE_CUBIC_MODE=3;b.TEXTURE_PROJECTION_MODE=
4;b.TEXTURE_SKYBOX_MODE=5;b.TEXTURE_INVCUBIC_MODE=6;b.TEXTURE_EQUIRECTANGULAR_MODE=7;b.TEXTURE_FIXED_EQUIRECTANGULAR_MODE=8;b.TEXTURE_FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9;b.TEXTURE_FILTERING_QUALITY_OFFLINE=4096;b.TEXTURE_FILTERING_QUALITY_HIGH=64;b.TEXTURE_FILTERING_QUALITY_MEDIUM=16;b.TEXTURE_FILTERING_QUALITY_LOW=8;b.SCALEMODE_FLOOR=1;b.SCALEMODE_NEAREST=2;b.SCALEMODE_CEILING=3;b.MATERIAL_TextureDirtyFlag=1;b.MATERIAL_LightDirtyFlag=2;b.MATERIAL_FresnelDirtyFlag=4;b.MATERIAL_AttributesDirtyFlag=
8;b.MATERIAL_MiscDirtyFlag=16;b.MATERIAL_PrePassDirtyFlag=32;b.MATERIAL_AllDirtyFlag=63;b.MATERIAL_TriangleFillMode=0;b.MATERIAL_WireFrameFillMode=1;b.MATERIAL_PointFillMode=2;b.MATERIAL_PointListDrawMode=3;b.MATERIAL_LineListDrawMode=4;b.MATERIAL_LineLoopDrawMode=5;b.MATERIAL_LineStripDrawMode=6;b.MATERIAL_TriangleStripDrawMode=7;b.MATERIAL_TriangleFanDrawMode=8;b.MATERIAL_ClockWiseSideOrientation=0;b.MATERIAL_CounterClockWiseSideOrientation=1;b.ACTION_NothingTrigger=0;b.ACTION_OnPickTrigger=1;b.ACTION_OnLeftPickTrigger=
2;b.ACTION_OnRightPickTrigger=3;b.ACTION_OnCenterPickTrigger=4;b.ACTION_OnPickDownTrigger=5;b.ACTION_OnDoublePickTrigger=6;b.ACTION_OnPickUpTrigger=7;b.ACTION_OnPickOutTrigger=16;b.ACTION_OnLongPressTrigger=8;b.ACTION_OnPointerOverTrigger=9;b.ACTION_OnPointerOutTrigger=10;b.ACTION_OnEveryFrameTrigger=11;b.ACTION_OnIntersectionEnterTrigger=12;b.ACTION_OnIntersectionExitTrigger=13;b.ACTION_OnKeyDownTrigger=14;b.ACTION_OnKeyUpTrigger=15;b.PARTICLES_BILLBOARDMODE_Y=2;b.PARTICLES_BILLBOARDMODE_ALL=7;b.PARTICLES_BILLBOARDMODE_STRETCHED=
8;b.MESHES_CULLINGSTRATEGY_STANDARD=0;b.MESHES_CULLINGSTRATEGY_BOUNDINGSPHERE_ONLY=1;b.MESHES_CULLINGSTRATEGY_OPTIMISTIC_INCLUSION=2;b.MESHES_CULLINGSTRATEGY_OPTIMISTIC_INCLUSION_THEN_BSPHERE_ONLY=3;b.SCENELOADER_NO_LOGGING=0;b.SCENELOADER_MINIMAL_LOGGING=1;b.SCENELOADER_SUMMARY_LOGGING=2;b.SCENELOADER_DETAILED_LOGGING=3;b.PREPASS_IRRADIANCE_TEXTURE_TYPE=0;b.PREPASS_POSITION_TEXTURE_TYPE=1;b.PREPASS_VELOCITY_TEXTURE_TYPE=2;b.PREPASS_REFLECTIVITY_TEXTURE_TYPE=3;b.PREPASS_COLOR_TEXTURE_TYPE=4;b.PREPASS_DEPTHNORMAL_TEXTURE_TYPE=
5;b.PREPASS_ALBEDO_TEXTURE_TYPE=6;return b}()},JCKn:function(n,r,h){h.d(r,"a",function(){return b.a});h("BOQG");var x=h("h13i"),b=h("qUIE"),z=h("e2Mr");h("7rXT");h("firj");h("avWN");h("sBHe");var u=h("HwNq"),G=h("oYeq"),t=h("y4Ty"),v=h("k2R8"),D=h("aCSs");n=h("hSZw");var B=h("YKqZ"),A=h("nTJO"),k=h("9DX3"),C=h("uyO6"),d=h("C6Hv"),g=function(){function b(){this.isReady=this.isAsync=!1}b.prototype._getVertexShaderCode=function(){return null};b.prototype._getFragmentShaderCode=function(){return null};
b.prototype._handlesSpectorRebuildCallback=function(b){throw Error("Not implemented");};return b}(),p=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}Object(G.d)(d,b);return d}(n.a),q=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}Object(G.d)(d,b);d.prototype.getInternalTexture=function(){return this};d.prototype.getViewCount=function(){return 1};return d}(v.a);(function(h){function f(){var c=h.call(this,null)||this;c._native=new _native.Engine;c.INVALID_HANDLE=
65535;c._boundBuffersVertexArray=null;c._currentDepthTest=c._native.DEPTH_TEST_LEQUAL;c._webGLVersion=2;c.disableUniformBuffers=!0;c._caps={maxTexturesImageUnits:16,maxVertexTextureImageUnits:16,maxCombinedTexturesImageUnits:32,maxTextureSize:512,maxCubemapTextureSize:512,maxRenderTextureSize:512,maxVertexAttribs:16,maxVaryingVectors:16,maxFragmentUniformVectors:16,maxVertexUniformVectors:16,standardDerivatives:!0,astc:null,pvrtc:null,etc1:null,etc2:null,bptc:null,maxAnisotropy:16,uintIndices:!0,
fragmentDepthSupported:!1,highPrecisionShaderSupported:!0,colorBufferFloat:!1,textureFloat:!1,textureFloatLinearFiltering:!1,textureFloatRender:!1,textureHalfFloat:!1,textureHalfFloatLinearFiltering:!1,textureHalfFloatRender:!1,textureLOD:!0,drawBuffersExtension:!1,depthTextureExtension:!1,vertexArrayObject:!0,instancedArrays:!1,canUseTimestampForTimerQuery:!1,blendMinMax:!1,maxMSAASamples:1};B.b.Log("Babylon Native (v"+b.a.Version+") launched");B.b.LoadScript=function(a,e,c,b){B.b.LoadFile(a,function(a){Function(a).apply(null);
e&&e()},void 0,void 0,!1,function(a,e){c&&c("LoadScript Error",e)})};"undefined"===typeof URL&&(window.URL={createObjectURL:function(){},revokeObjectURL:function(){}});"undefined"===typeof Blob&&(window.Blob=function(){});c._shaderProcessor=new u.a;return c}Object(G.d)(f,h);f.prototype.getHardwareScalingLevel=function(){return 1};f.prototype.dispose=function(){h.prototype.dispose.call(this);this._boundBuffersVertexArray&&this._native.deleteVertexArray(this._boundBuffersVertexArray);this._native.dispose()};
f.prototype._queueNewFrame=function(c,a){a.requestAnimationFrame&&a!==window?a.requestAnimationFrame(c):this._native.requestAnimationFrame(c);return 0};f.prototype._bindUnboundFramebuffer=function(c){this._currentFramebuffer!==c&&(this._currentFramebuffer&&this._native.unbindFramebuffer(this._currentFramebuffer),c&&this._native.bindFramebuffer(c),this._currentFramebuffer=c)};f.prototype.getHostDocument=function(){return null};f.prototype.clear=function(c,a,e,b){void 0===b&&(b=!1);var l=0;a&&c&&(this._native.clearColor(c.r,
c.g,c.b,void 0!==c.a?c.a:1),l|=this._native.CLEAR_FLAG_COLOR);e&&(this._native.clearDepth(1),l|=this._native.CLEAR_FLAG_DEPTH);b&&(this._native.clearStencil(0),l|=this._native.CLEAR_FLAG_STENCIL);this._native.clear(l)};f.prototype.createIndexBuffer=function(c,a){c=this._normalizeIndexData(c);var e=new p;e.references=1;e.is32Bits=4===c.BYTES_PER_ELEMENT;if(c.length){if(e.nativeIndexBuffer=this._native.createIndexBuffer(c,null!==a&&void 0!==a?a:!1),e.nativeVertexBuffer===this.INVALID_HANDLE)throw Error("Could not create a native index buffer.");
}else e.nativeVertexBuffer=this.INVALID_HANDLE;return e};f.prototype.createVertexBuffer=function(c,a){var e=new p;e.references=1;e.nativeVertexBuffer=this._native.createVertexBuffer(ArrayBuffer.isView(c)?c:new Float32Array(c),null!==a&&void 0!==a?a:!1);if(e.nativeVertexBuffer===this.INVALID_HANDLE)throw Error("Could not create a native vertex buffer.");return e};f.prototype._recordVertexArrayObject=function(c,a,e,b){e&&this._native.recordIndexBuffer(c,e.nativeIndexBuffer);e=b.getAttributesNames();
for(var l=0;l<e.length;l++){var d=b.getAttributeLocation(l);if(0<=d){var g=a[e[l]];if(g){var f=g.getBuffer();f&&this._native.recordVertexBuffer(c,f.nativeVertexBuffer,d,g.byteOffset,g.byteStride,g.getSize(),this._getNativeAttribType(g.type),g.normalized)}}}};f.prototype.bindBuffers=function(c,a,e){this._boundBuffersVertexArray&&this._native.deleteVertexArray(this._boundBuffersVertexArray);this._boundBuffersVertexArray=this._native.createVertexArray();this._recordVertexArrayObject(this._boundBuffersVertexArray,
c,a,e);this._native.bindVertexArray(this._boundBuffersVertexArray)};f.prototype.recordVertexArrayObject=function(c,a,e){var b=this._native.createVertexArray();this._recordVertexArrayObject(b,c,a,e);return b};f.prototype.bindVertexArrayObject=function(c){this._native.bindVertexArray(c)};f.prototype.releaseVertexArrayObject=function(c){this._native.deleteVertexArray(c)};f.prototype.getAttributes=function(c,a){return this._native.getAttributes(c.nativeProgram,a)};f.prototype.drawElementsType=function(c,
a,e,b){this._drawCalls.addCount(1,!1);this._native.drawIndexed(c,a,e)};f.prototype.drawArraysType=function(c,a,e,b){this._drawCalls.addCount(1,!1);this._native.draw(c,a,e)};f.prototype.createPipelineContext=function(){return new g};f.prototype._preparePipelineContext=function(c,a,e,b,d,g,f){c.nativeProgram=b?this.createRawShaderProgram(c,a,e,void 0,f):this.createShaderProgram(c,a,e,g,void 0,f)};f.prototype._isRenderingStateCompiled=function(c){return!0};f.prototype._executeWhenRenderingStateIsCompiled=
function(c,a){a()};f.prototype.createRawShaderProgram=function(c,a,e,b,d){throw Error("Not Supported");};f.prototype.createShaderProgram=function(c,a,e,b,m,g){this.onBeforeShaderCompilationObservable.notifyObservers(this);a=new d.a(a);a.processCode();a=a.code;e=new d.a(e);e.processCode();e=e.code;a=x.a._ConcatenateShader(a,b);e=x.a._ConcatenateShader(e,b);b=this._native.createProgram(a,e);this.onAfterShaderCompilationObservable.notifyObservers(this);return b};f.prototype._setProgram=function(c){this._currentProgram!==
c&&(this._native.setProgram(c),this._currentProgram=c)};f.prototype._releaseEffect=function(c){};f.prototype._deletePipelineContext=function(c){};f.prototype.getUniforms=function(c,a){return this._native.getUniforms(c.nativeProgram,a)};f.prototype.bindUniformBlock=function(c,a,e){throw Error("Not Implemented");};f.prototype.bindSamplers=function(c){var a=c.getPipelineContext();this._setProgram(a.nativeProgram);a=c.getSamplers();for(var e=0;e<a.length;e++){var b=c.getUniform(a[e]);b&&(this._boundUniforms[e]=
b)}this._currentEffect=null};f.prototype.setMatrix=function(c,a){c&&this._native.setMatrix(c,a.toArray())};f.prototype.getRenderWidth=function(c){void 0===c&&(c=!1);return!c&&this._currentRenderTarget?this._currentRenderTarget.width:this._native.getRenderWidth()};f.prototype.getRenderHeight=function(c){void 0===c&&(c=!1);return!c&&this._currentRenderTarget?this._currentRenderTarget.height:this._native.getRenderHeight()};f.prototype.setViewport=function(c,a,e){this._cachedViewport=c;this._native.setViewPort(c.x,
c.y,c.width,c.height)};f.prototype.setState=function(c,a,e,b){void 0===a&&(a=0);void 0===b&&(b=!1);this._native.setState(c,a,b)};f.prototype.setZOffset=function(c){this._native.setZOffset(c)};f.prototype.getZOffset=function(){return this._native.getZOffset()};f.prototype.setDepthBuffer=function(c){this._native.setDepthTest(c?this._currentDepthTest:this._native.DEPTH_TEST_ALWAYS)};f.prototype.getDepthWrite=function(){return this._native.getDepthWrite()};f.prototype.setDepthFunctionToGreater=function(){this._currentDepthTest=
this._native.DEPTH_TEST_GREATER;this._native.setDepthTest(this._currentDepthTest)};f.prototype.setDepthFunctionToGreaterOrEqual=function(){this._currentDepthTest=this._native.DEPTH_TEST_GEQUAL;this._native.setDepthTest(this._currentDepthTest)};f.prototype.setDepthFunctionToLess=function(){this._currentDepthTest=this._native.DEPTH_TEST_LESS;this._native.setDepthTest(this._currentDepthTest)};f.prototype.setDepthFunctionToLessOrEqual=function(){this._currentDepthTest=this._native.DEPTH_TEST_LEQUAL;this._native.setDepthTest(this._currentDepthTest)};
f.prototype.setDepthWrite=function(c){this._native.setDepthWrite(c)};f.prototype.setColorWrite=function(c){this._native.setColorWrite(c);this._colorWrite=c};f.prototype.getColorWrite=function(){return this._colorWrite};f.prototype.setAlphaConstants=function(c,a,e,b){throw Error("Setting alpha blend constant color not yet implemented.");};f.prototype.setAlphaMode=function(c,a){void 0===a&&(a=!1);this._alphaMode!==c&&(c=this._getNativeAlphaMode(c),this._native.setBlendMode(c),a||this.setDepthWrite(0===
c),this._alphaMode=c)};f.prototype.getAlphaMode=function(){return this._alphaMode};f.prototype.setInt=function(c,a){if(!c)return!1;this._native.setInt(c,a);return!0};f.prototype.setIntArray=function(c,a){if(!c)return!1;this._native.setIntArray(c,a);return!0};f.prototype.setIntArray2=function(c,a){if(!c)return!1;this._native.setIntArray2(c,a);return!0};f.prototype.setIntArray3=function(c,a){if(!c)return!1;this._native.setIntArray3(c,a);return!0};f.prototype.setIntArray4=function(c,a){if(!c)return!1;
this._native.setIntArray4(c,a);return!0};f.prototype.setFloatArray=function(c,a){if(!c)return!1;this._native.setFloatArray(c,a);return!0};f.prototype.setFloatArray2=function(c,a){if(!c)return!1;this._native.setFloatArray2(c,a);return!0};f.prototype.setFloatArray3=function(c,a){if(!c)return!1;this._native.setFloatArray3(c,a);return!0};f.prototype.setFloatArray4=function(c,a){if(!c)return!1;this._native.setFloatArray4(c,a);return!0};f.prototype.setArray=function(c,a){if(!c)return!1;this._native.setFloatArray(c,
a);return!0};f.prototype.setArray2=function(c,a){if(!c)return!1;this._native.setFloatArray2(c,a);return!0};f.prototype.setArray3=function(c,a){if(!c)return!1;this._native.setFloatArray3(c,a);return!0};f.prototype.setArray4=function(c,a){if(!c)return!1;this._native.setFloatArray4(c,a);return!0};f.prototype.setMatrices=function(c,a){if(!c)return!1;this._native.setMatrices(c,a);return!0};f.prototype.setMatrix3x3=function(c,a){if(!c)return!1;this._native.setMatrix3x3(c,a);return!0};f.prototype.setMatrix2x2=
function(c,a){if(!c)return!1;this._native.setMatrix2x2(c,a);return!0};f.prototype.setFloat=function(c,a){if(!c)return!1;this._native.setFloat(c,a);return!0};f.prototype.setFloat2=function(c,a,e){if(!c)return!1;this._native.setFloat2(c,a,e);return!0};f.prototype.setFloat3=function(c,a,e,b){if(!c)return!1;this._native.setFloat3(c,a,e,b);return!0};f.prototype.setFloat4=function(c,a,e,b,d){if(!c)return!1;this._native.setFloat4(c,a,e,b,d);return!0};f.prototype.setColor3=function(c,a){if(!c)return!1;this._native.setFloat3(c,
a.r,a.g,a.b);return!0};f.prototype.setColor4=function(c,a,e){if(!c)return!1;this._native.setFloat4(c,a.r,a.g,a.b,e);return!0};f.prototype.wipeCaches=function(c){this.preventCacheWipeBetweenFrames||(this.resetTextureCache(),this._currentEffect=null,c&&(this._currentProgram=null,this._stencilState.reset(),this._depthCullingState.reset(),this._alphaState.reset()),this._cachedEffectForVertexBuffers=this._cachedIndexBuffer=this._cachedVertexBuffers=null)};f.prototype._createTexture=function(){return this._native.createTexture()};
f.prototype._deleteTexture=function(c){this._native.deleteTexture(c)};f.prototype.updateDynamicTexture=function(c,a,e,b,d){this.createTexture("data:my_image_name",!0,e,null,D.a.BILINEAR_SAMPLINGMODE,void 0,void 0,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYSURBVChTY/z//z8DPsAEpXGC4aCAgQEAGGMDDWwwgqsAAAAASUVORK5CYII=",c,f.TEXTUREFORMAT_RGBA,null,void 0)};f.prototype.createTexture=function(c,a,e,l,d,g,f,h,
p,q,k,n,F){var m=this;void 0===d&&(d=3);void 0===g&&(g=null);void 0===f&&(f=null);void 0===h&&(h=null);void 0===p&&(p=null);void 0===q&&(q=null);void 0===k&&(k=null);c=c||"";var H="data:"===c.substr(0,5),y=H&&-1!==c.indexOf(";base64,"),w=p?p:new v.a(this,v.b.Url),I=c;!this._transformTextureUrl||y||p||h||(c=this._transformTextureUrl(c));var J=c.lastIndexOf(".");J=k?k:-1<J?c.substring(J).toLowerCase():"";for(var r=null,t=0,K=b.a._TextureLoaders;t<K.length;t++){var u=K[t];if(u.canLoad(J)){r=u;break}}l&&
l._addPendingData(w);w.url=c;w.generateMipMaps=!a;w.samplingMode=d;w.invertY=e;this.doNotHandleContextLost||(w._buffer=h);var E=null;g&&!p&&(E=w.onLoadedObservable.add(g));p||this._internalTexturesCache.push(w);if(r)throw Error("Loading textures from IInternalTextureLoader not yet implemented.");var x=function(c){var b=w._webGLTexture;b?m._native.loadTexture(b,c,!a,e,function(){w.baseWidth=m._native.getTextureWidth(b);w.baseHeight=m._native.getTextureHeight(b);w.width=w.baseWidth;w.height=w.baseHeight;
w.isReady=!0;var a=m._getNativeSamplingMode(d);m._native.setTextureSampling(b,a);l&&l._removePendingData(w);w.onLoadedObservable.notifyObservers(w);w.onLoadedObservable.clear()},function(){throw Error("Could not load a native texture.");}):l&&l._removePendingData(w)};if(H)if(h instanceof ArrayBuffer)x(new Uint8Array(h));else if(ArrayBuffer.isView(h))x(h);else if("string"===typeof h)x(new Uint8Array(B.b.DecodeBase64(h)));else throw Error("Unsupported buffer type");else y?x(new Uint8Array(B.b.DecodeBase64(c))):
this._loadFile(c,function(a){return x(new Uint8Array(a))},void 0,void 0,!0,function(e,b){e="Unable to load "+(e?e.responseURL:c,b);l&&l._removePendingData(w);c===I?(E&&w.onLoadedObservable.remove(E),z.a.UseFallbackTexture&&m.createTexture(z.a.FallbackTexture,a,w.invertY,l,d,null,f,h,w),f&&f((e||"Unknown error")+(z.a.UseFallbackTexture?" - Fallback texture was used":""),void 0)):(C.a.Warn("Failed to load "+c+", falling back to "+I),m.createTexture(I,a,w.invertY,l,d,g,f,h,w,q,k,n,F))});return w};f.prototype._createDepthStencilTexture=
function(c,a){a=new q(this,v.b.Depth);c=this._native.createDepthTexture(a._webGLTexture,c.width||c,c.height||c);a._framebuffer=c;return a};f.prototype._releaseFramebufferObjects=function(c){};f.prototype.createCubeTexture=function(c,a,e,b,d,g,f,h,p,q,k,n){var l=this;void 0===d&&(d=null);void 0===g&&(g=null);void 0===h&&(h=null);void 0===p&&(p=!1);void 0===q&&(q=0);void 0===k&&(k=0);void 0===n&&(n=null);var m=n?n:new v.a(this,v.b.Cube);m.isCube=!0;m.url=c;m.generateMipMaps=!b;m._lodGenerationScale=
q;m._lodGenerationOffset=k;this._doNotHandleContextLost||(m._extension=h,m._files=e);a=c.lastIndexOf(".");if(".env"===(h?h:-1<a?c.substring(a).toLowerCase():"")){var H=function(a){var e=A.a.GetEnvInfo(a);m.width=e.width;m.height=e.width;A.a.UploadEnvSpherical(m,e);if(1!==e.version)throw Error('Unsupported babylon environment map version "'+e.version+'"');var c=e.specular;if(!c)throw Error("Nothing else parsed so far");m._lodGenerationScale=c.lodGenerationScale;a=A.a.CreateImageDataArrayBufferViews(a,
e);m.format=5;m.type=0;m.generateMipMaps=!0;m.getEngine().updateTextureSamplingMode(D.a.TRILINEAR_SAMPLINGMODE,m);m._isRGBD=!0;m.invertY=!0;l._native.loadCubeTextureWithMips(m._webGLTexture,a,function(){m.isReady=!0;d&&d()},function(){throw Error("Could not load a native cube texture.");})};if(e&&6===e.length)throw Error("Multi-file loading not allowed on env files.");this._loadFile(c,function(a){return H(new Uint8Array(a))},void 0,void 0,!0,function(a,e){g&&a&&g(a.status+" "+a.statusText,e)})}else{if(!e||
6!==e.length)throw Error("Cannot load cubemap because 6 files were not defined");Promise.all([e[0],e[3],e[1],e[4],e[2],e[5]].map(function(a){return B.b.LoadFileAsync(a).then(function(a){return new Uint8Array(a)})})).then(function(a){return new Promise(function(e,c){l._native.loadCubeTexture(m._webGLTexture,a,!b,e,c)})}).then(function(){m.isReady=!0;d&&d()},function(a){g&&g("Failed to load cubemap: "+a.message,a)})}this._internalTexturesCache.push(m);return m};f.prototype.createRenderTargetTexture=
function(c,a){var e=new k.a;void 0!==a&&"object"===typeof a?(e.generateMipMaps=a.generateMipMaps,e.generateDepthBuffer=void 0===a.generateDepthBuffer?!0:a.generateDepthBuffer,e.generateStencilBuffer=e.generateDepthBuffer&&a.generateStencilBuffer,e.type=void 0===a.type?0:a.type,e.samplingMode=void 0===a.samplingMode?3:a.samplingMode,e.format=void 0===a.format?5:a.format):(e.generateMipMaps=a,e.generateDepthBuffer=!0,e.generateStencilBuffer=!1,e.type=0,e.samplingMode=3,e.format=5);1!==e.type||this._caps.textureFloatLinearFiltering?
2!==e.type||this._caps.textureHalfFloatLinearFiltering||(e.samplingMode=1):e.samplingMode=1;a=new q(this,v.b.RenderTarget);var b=c.width||c;c=c.height||c;1!==e.type||this._caps.textureFloat||(e.type=0,C.a.Warn("Float textures are not supported. Render target forced to TEXTURETYPE_UNSIGNED_BYTE type"));var d=this._native.createFramebuffer(a._webGLTexture,b,c,this._getNativeTextureFormat(e.format,e.type),e.samplingMode,e.generateStencilBuffer?!0:!1,e.generateDepthBuffer,e.generateMipMaps?!0:!1);a._framebuffer=
d;a.baseWidth=b;a.baseHeight=c;a.width=b;a.height=c;a.isReady=!0;a.samples=1;a.generateMipMaps=e.generateMipMaps?!0:!1;a.samplingMode=e.samplingMode;a.type=e.type;a.format=e.format;a._generateDepthBuffer=e.generateDepthBuffer;a._generateStencilBuffer=e.generateStencilBuffer?!0:!1;this._internalTexturesCache.push(a);return a};f.prototype.updateTextureSamplingMode=function(c,a){if(a._webGLTexture){var e=this._getNativeSamplingMode(c);this._native.setTextureSampling(a._webGLTexture,e)}a.samplingMode=
c};f.prototype.bindFramebuffer=function(c,a,e,b,d){if(a)throw Error("Cuboid frame buffers are not yet supported in NativeEngine.");if(e||b)throw Error("Required width/height for frame buffers not yet supported in NativeEngine.");c._depthStencilTexture?this._bindUnboundFramebuffer(c._depthStencilTexture._framebuffer):this._bindUnboundFramebuffer(c._framebuffer)};f.prototype.unBindFramebuffer=function(c,a,e){void 0===a&&(a=!1);a&&C.a.Warn("Disabling mipmap generation not yet supported in NativeEngine. Ignoring.");
e&&e();this._bindUnboundFramebuffer(null)};f.prototype.createDynamicVertexBuffer=function(c){return this.createVertexBuffer(c,!0)};f.prototype.updateDynamicIndexBuffer=function(c,a,e){void 0===e&&(e=0);a=this._normalizeIndexData(a);c.is32Bits=4===a.BYTES_PER_ELEMENT;this._native.updateDynamicIndexBuffer(c.nativeIndexBuffer,a,e)};f.prototype.updateDynamicVertexBuffer=function(c,a,e,b){a=ArrayBuffer.isView(a)?a:new Float32Array(a);this._native.updateDynamicVertexBuffer(c.nativeVertexBuffer,a,null!==
e&&void 0!==e?e:0,null!==b&&void 0!==b?b:a.byteLength)};f.prototype._setTexture=function(c,a,e,b){void 0===b&&(b=!1);e=this._boundUniforms[c];if(!e)return!1;if(!a)return null!=this._boundTexturesCache[c]&&(this._activeChannel=c,this._native.setTexture(e,null)),!1;if(a.video)this._activeChannel=c,a.update();else if(4===a.delayLoadState)return a.delayLoad(),!1;b=b?a.depthStencilTexture:a.isReady()?a.getInternalTexture():a.isCube?this.emptyCubeTexture:a.is3D?this.emptyTexture3D:a.is2DArray?this.emptyTexture2DArray:
this.emptyTexture;this._activeChannel=c;if(!b||!b._webGLTexture)return!1;this._native.setTextureWrapMode(b._webGLTexture,this._getAddressMode(a.wrapU),this._getAddressMode(a.wrapV),this._getAddressMode(a.wrapR));this._updateAnisotropicLevel(a);this._native.setTexture(e,b._webGLTexture);return!0};f.prototype._updateAnisotropicLevel=function(c){var a=c.getInternalTexture();c=c.anisotropicFilteringLevel;a&&a._webGLTexture&&a._cachedAnisotropicFilteringLevel!==c&&(this._native.setTextureAnisotropicLevel(a._webGLTexture,
c),a._cachedAnisotropicFilteringLevel=c)};f.prototype._getAddressMode=function(c){switch(c){case 1:return this._native.ADDRESS_MODE_WRAP;case 0:return this._native.ADDRESS_MODE_CLAMP;case 2:return this._native.ADDRESS_MODE_MIRROR;default:throw Error("Unexpected wrap mode: "+c+".");}};f.prototype._bindTexture=function(c,a){(c=this._boundUniforms[c])&&this._native.setTexture(c,a._webGLTexture)};f.prototype._deleteBuffer=function(c){c.nativeIndexBuffer&&(this._native.deleteIndexBuffer(c.nativeIndexBuffer),
delete c.nativeIndexBuffer);c.nativeVertexBuffer&&(this._native.deleteVertexBuffer(c.nativeVertexBuffer),delete c.nativeVertexBuffer)};f.prototype.releaseEffects=function(){};f.prototype._uploadCompressedDataToTextureDirectly=function(c,a,e,b,d,g,f){throw Error("_uploadCompressedDataToTextureDirectly not implemented.");};f.prototype._uploadDataToTextureDirectly=function(c,a,e,b){throw Error("_uploadDataToTextureDirectly not implemented.");};f.prototype._uploadArrayBufferViewToTexture=function(c,a,
e,b){throw Error("_uploadArrayBufferViewToTexture not implemented.");};f.prototype._uploadImageToTexture=function(c,a,e,b){throw Error("_uploadArrayBufferViewToTexture not implemented.");};f.prototype._getNativeSamplingMode=function(c){switch(c){case 1:return this._native.TEXTURE_NEAREST_NEAREST;case 2:return this._native.TEXTURE_LINEAR_LINEAR;case 3:return this._native.TEXTURE_LINEAR_LINEAR_MIPLINEAR;case 4:return this._native.TEXTURE_NEAREST_NEAREST_MIPNEAREST;case 5:return this._native.TEXTURE_NEAREST_LINEAR_MIPNEAREST;
case 6:return this._native.TEXTURE_NEAREST_LINEAR_MIPLINEAR;case 7:return this._native.TEXTURE_NEAREST_LINEAR;case 8:return this._native.TEXTURE_NEAREST_NEAREST_MIPLINEAR;case 9:return this._native.TEXTURE_LINEAR_NEAREST_MIPNEAREST;case 10:return this._native.TEXTURE_LINEAR_NEAREST_MIPLINEAR;case 11:return this._native.TEXTURE_LINEAR_LINEAR_MIPNEAREST;case 12:return this._native.TEXTURE_LINEAR_NEAREST;default:throw Error("Unsupported sampling mode: "+c+".");}};f.prototype._getNativeTextureFormat=
function(c,a){if(5==c&&0==a)return this._native.TEXTURE_FORMAT_RGBA8;if(5==c&&1==a)return this._native.TEXTURE_FORMAT_RGBA32F;throw Error("Unsupported texture format or type: format "+c+", type "+a+".");};f.prototype._getNativeAlphaMode=function(c){switch(c){case 0:return this._native.ALPHA_DISABLE;case 1:return this._native.ALPHA_ADD;case 2:return this._native.ALPHA_COMBINE;case 3:return this._native.ALPHA_SUBTRACT;case 4:return this._native.ALPHA_MULTIPLY;case 5:return this._native.ALPHA_MAXIMIZED;
case 6:return this._native.ALPHA_ONEONE;case 7:return this._native.ALPHA_PREMULTIPLIED;case 8:return this._native.ALPHA_PREMULTIPLIED_PORTERDUFF;case 9:return this._native.ALPHA_INTERPOLATE;case 10:return this._native.ALPHA_SCREENMODE;default:throw Error("Unsupported alpha mode: "+c+".");}};f.prototype._getNativeAttribType=function(c){switch(c){case t.b.UNSIGNED_BYTE:return this._native.ATTRIB_TYPE_UINT8;case t.b.SHORT:return this._native.ATTRIB_TYPE_INT16;case t.b.FLOAT:return this._native.ATTRIB_TYPE_FLOAT;
default:throw Error("Unsupported attribute type: "+c+".");}};return f})(b.a);h("fn/E")},e2Mr:function(n,r,h){h.d(r,"a",function(){return x});var x=function(){function b(){}Object.defineProperty(b,"LastCreatedEngine",{get:function(){return 0===this.Instances.length?null:this.Instances[this.Instances.length-1]},enumerable:!1,configurable:!0});Object.defineProperty(b,"LastCreatedScene",{get:function(){return this._LastCreatedScene},enumerable:!1,configurable:!0});b.Instances=[];b._LastCreatedScene=null;
b.UseFallbackTexture=!0;b.FallbackTexture="";return b}()},"fn/E":function(n,r,h){h.d(r,"a",function(){return x});var x=function(){function b(){}b.SetMatrixPrecision=function(h){b.MatrixTrackPrecisionChange=!1;if(h&&!b.MatrixUse64Bits&&b.MatrixTrackedMatrices)for(var n=0;n<b.MatrixTrackedMatrices.length;++n){var r=b.MatrixTrackedMatrices[n],t=r._m;r._m=Array(16);for(var v=0;16>v;++v)r._m[v]=t[v]}b.MatrixUse64Bits=h;b.MatrixCurrentType=b.MatrixUse64Bits?Array:Float32Array;b.MatrixTrackedMatrices=null};
b.MatrixUse64Bits=!1;b.MatrixTrackPrecisionChange=!0;b.MatrixCurrentType=Float32Array;b.MatrixTrackedMatrices=[];return b}()},h13i:function(n,r,h){h.d(r,"a",function(){return f});var x=h("e2Mr"),b=h("Z6Y1"),z=h("n5HA"),u=h("ps+7"),G=h("nNNi"),t=h("hLnk"),v=h("J7JH"),D=h("k2R8"),B=h("uyO6"),A=h("h87I"),k=h("Yhyi"),C=h("HwNq"),d=h("25bV"),g=h("sBHe"),p=h("O3Sr"),q=h("fn/E"),F=function(){return function(){}}(),f=function(){function c(a,e,b,d){var l=this;void 0===d&&(d=!1);this.isFullscreen=this.forcePOTTextures=
!1;this.renderEvenInBackground=this.cullBackFaces=!0;this.disableUniformBuffers=this.useReverseDepthBuffer=this.validateShaderPrograms=this.preventCacheWipeBetweenFrames=!1;this._uniformBuffers=[];this._webGLVersion=1;this._windowIsBackground=!1;this._highPrecisionShadersAllowed=!0;this._renderingQueueLaunched=this._badDesktopOS=this._badOS=!1;this._activeRenderLoops=[];this.onContextLostObservable=new u.a;this.onContextRestoredObservable=new u.a;this.disableVertexArrayObjects=this._doNotHandleContextLost=
this._contextWasLost=!1;this._colorWriteChanged=this._colorWrite=!0;this._depthCullingState=new G.a;this._stencilState=new t.a;this._alphaState=new v.a;this._alphaMode=1;this._alphaEquation=0;this._internalTexturesCache=[];this._activeChannel=0;this._currentTextureChannel=-1;this._boundTexturesCache={};this._compiledEffects={};this._vertexAttribArraysEnabled=[];this._uintIndicesCurrentlySet=!1;this._currentBoundBuffer=[];this._dummyFramebuffer=this._currentFramebuffer=null;this._currentBufferPointers=
[];this._currentInstanceLocations=[];this._currentInstanceBuffers=[];this._mustWipeVertexAttributes=this._vaoRecordInProgress=!1;this._nextFreeTextureSlots=[];this._maxSimultaneousTextures=0;this._activeRequests=[];this._transformTextureUrl=null;this.hostInformation={isMobile:!1};this.premultipliedAlpha=!0;this.onBeforeTextureInitObservable=new u.a;this._viewportCached={x:0,y:0,z:0,w:0};this._unpackFlipYCached=null;this.enableUnpackFlipYCached=!0;this._getDepthStencilBuffer=function(a,e,c,b,d,m){var g=
l._gl,f=g.createRenderbuffer();g.bindRenderbuffer(g.RENDERBUFFER,f);1<c&&g.renderbufferStorageMultisample?g.renderbufferStorageMultisample(g.RENDERBUFFER,c,d,a,e):g.renderbufferStorage(g.RENDERBUFFER,b,a,e);g.framebufferRenderbuffer(g.FRAMEBUFFER,m,g.RENDERBUFFER,f);g.bindRenderbuffer(g.RENDERBUFFER,null);return f};this._boundUniforms={};var m=null;if(a){b=b||{};q.a.SetMatrixPrecision(!!b.useHighPrecisionMatrix);if(a.getContext){this._renderingCanvas=m=a;null!=e&&(b.antialias=e);void 0===b.deterministicLockstep&&
(b.deterministicLockstep=!1);void 0===b.lockstepMaxSteps&&(b.lockstepMaxSteps=4);void 0===b.timeStep&&(b.timeStep=1/60);void 0===b.preserveDrawingBuffer&&(b.preserveDrawingBuffer=!1);void 0===b.audioEngine&&(b.audioEngine=!0);void 0===b.stencil&&(b.stencil=!0);!1===b.premultipliedAlpha&&(this.premultipliedAlpha=!1);void 0===b.xrCompatible&&(b.xrCompatible=!0);this._doNotHandleContextLost=b.doNotHandleContextLost?!0:!1;if(navigator&&navigator.userAgent){a=navigator.userAgent;this.hostInformation.isMobile=
-1!==a.indexOf("Mobile");e=0;for(var g=c.ExceptionList;e<g.length;e++){var f=g[e],h=f.targets;if((new RegExp(f.key)).test(a)){if(f.capture&&f.captureConstraint){var p=f.captureConstraint;if((f=(new RegExp(f.capture)).exec(a))&&0<f.length&&parseInt(f[f.length-1])>=p)continue}for(p=0;p<h.length;p++)switch(h[p]){case "uniformBuffer":this.disableUniformBuffers=!0;break;case "vao":this.disableVertexArrayObjects=!0}}}}this._doNotHandleContextLost||(this._onContextLost=function(a){a.preventDefault();l._contextWasLost=
!0;B.a.Warn("WebGL context lost.");l.onContextLostObservable.notifyObservers(l)},this._onContextRestored=function(){setTimeout(function(){l._initGLContext();l._rebuildEffects();l._rebuildInternalTextures();l._rebuildBuffers();l.wipeCaches(!0);B.a.Warn("WebGL context successfully restored.");l.onContextRestoredObservable.notifyObservers(l);l._contextWasLost=!1},0)},m.addEventListener("webglcontextlost",this._onContextLost,!1),m.addEventListener("webglcontextrestored",this._onContextRestored,!1),b.powerPreference=
"high-performance");if(!b.disableWebGL2Support)try{if(this._gl=m.getContext("webgl2",b)||m.getContext("experimental-webgl2",b))this._webGLVersion=2,this._gl.deleteQuery||(this._webGLVersion=1)}catch(E){}if(!this._gl){if(!m)throw Error("The provided canvas is null or undefined.");try{this._gl=m.getContext("webgl",b)||m.getContext("experimental-webgl",b)}catch(E){throw Error("WebGL not supported");}}if(!this._gl)throw Error("WebGL not supported");}else if(this._gl=a,this._renderingCanvas=this._gl.canvas,
this._gl.renderbufferStorageMultisample&&(this._webGLVersion=2),m=this._gl.getContextAttributes())b.stencil=m.stencil;this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._gl.NONE);void 0!==b.useHighPrecisionFloats&&(this._highPrecisionShadersAllowed=b.useHighPrecisionFloats);m=A.a.IsWindowObjectExist()?window.devicePixelRatio||1:1;a=b.limitDeviceRatio||m;this._hardwareScalingLevel=d?1/Math.min(a,m):1;this.resize();this._isStencilEnable=b.stencil?!0:!1;this._initGLContext();for(d=
0;d<this._caps.maxVertexAttribs;d++)this._currentBufferPointers[d]=new F;this._shaderProcessor=1<this.webGLVersion?new C.a:new k.a;this._badOS=/iPad/i.test(navigator.userAgent)||/iPhone/i.test(navigator.userAgent);this._badDesktopOS=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);this._creationOptions=b;console.log("Babylon.js v"+c.Version+" - "+this.description)}}Object.defineProperty(c,"NpmPackage",{get:function(){return"babylonjs@4.2.0"},enumerable:!1,configurable:!0});Object.defineProperty(c,
"Version",{get:function(){return"4.2.0"},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"description",{get:function(){var a="WebGL"+this.webGLVersion;this._caps.parallelShaderCompile&&(a+=" - Parallel shader compilation");return a},enumerable:!1,configurable:!0});Object.defineProperty(c,"ShadersRepository",{get:function(){return b.a.ShadersRepository},set:function(a){b.a.ShadersRepository=a},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"supportsUniformBuffers",
{get:function(){return 1<this.webGLVersion&&!this.disableUniformBuffers},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"_shouldUseHighPrecisionShader",{get:function(){return!(!this._caps.highPrecisionShaderSupported||!this._highPrecisionShadersAllowed)},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"needPOTTextures",{get:function(){return 2>this._webGLVersion||this.forcePOTTextures},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"doNotHandleContextLost",
{get:function(){return this._doNotHandleContextLost},set:function(a){this._doNotHandleContextLost=a},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"_supportsHardwareTextureRescaling",{get:function(){return!1},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"framebufferDimensionsObject",{set:function(a){this._framebufferDimensionsObject=a},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"currentViewport",{get:function(){return this._cachedViewport},
enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"emptyTexture",{get:function(){this._emptyTexture||(this._emptyTexture=this.createRawTexture(new Uint8Array(4),1,1,5,!1,!1,1));return this._emptyTexture},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"emptyTexture3D",{get:function(){this._emptyTexture3D||(this._emptyTexture3D=this.createRawTexture3D(new Uint8Array(4),1,1,1,5,!1,!1,1));return this._emptyTexture3D},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,
"emptyTexture2DArray",{get:function(){this._emptyTexture2DArray||(this._emptyTexture2DArray=this.createRawTexture2DArray(new Uint8Array(4),1,1,1,5,!1,!1,1));return this._emptyTexture2DArray},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"emptyCubeTexture",{get:function(){if(!this._emptyCubeTexture){var a=new Uint8Array(4);this._emptyCubeTexture=this.createRawCubeTexture([a,a,a,a,a,a],1,5,0,!1,!1,1)}return this._emptyCubeTexture},enumerable:!1,configurable:!0});c.prototype._rebuildInternalTextures=
function(){for(var a=0,e=this._internalTexturesCache.slice();a<e.length;a++)e[a]._rebuild()};c.prototype._rebuildEffects=function(){for(var a in this._compiledEffects)this._compiledEffects[a]._prepareEffect();b.a.ResetCache()};c.prototype.areAllEffectsReady=function(){for(var a in this._compiledEffects)if(!this._compiledEffects[a].isReady())return!1;return!0};c.prototype._rebuildBuffers=function(){for(var a=0,e=this._uniformBuffers;a<e.length;a++)e[a]._rebuild()};c.prototype._initGLContext=function(){this._caps=
{maxTexturesImageUnits:this._gl.getParameter(this._gl.MAX_TEXTURE_IMAGE_UNITS),maxCombinedTexturesImageUnits:this._gl.getParameter(this._gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),maxVertexTextureImageUnits:this._gl.getParameter(this._gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxTextureSize:this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE),maxSamples:1<this._webGLVersion?this._gl.getParameter(this._gl.MAX_SAMPLES):1,maxCubemapTextureSize:this._gl.getParameter(this._gl.MAX_CUBE_MAP_TEXTURE_SIZE),maxRenderTextureSize:this._gl.getParameter(this._gl.MAX_RENDERBUFFER_SIZE),
maxVertexAttribs:this._gl.getParameter(this._gl.MAX_VERTEX_ATTRIBS),maxVaryingVectors:this._gl.getParameter(this._gl.MAX_VARYING_VECTORS),maxFragmentUniformVectors:this._gl.getParameter(this._gl.MAX_FRAGMENT_UNIFORM_VECTORS),maxVertexUniformVectors:this._gl.getParameter(this._gl.MAX_VERTEX_UNIFORM_VECTORS),parallelShaderCompile:this._gl.getExtension("KHR_parallel_shader_compile"),standardDerivatives:1<this._webGLVersion||null!==this._gl.getExtension("OES_standard_derivatives"),maxAnisotropy:1,astc:this._gl.getExtension("WEBGL_compressed_texture_astc")||
this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_astc"),bptc:this._gl.getExtension("EXT_texture_compression_bptc")||this._gl.getExtension("WEBKIT_EXT_texture_compression_bptc"),s3tc:this._gl.getExtension("WEBGL_compressed_texture_s3tc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),pvrtc:this._gl.getExtension("WEBGL_compressed_texture_pvrtc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:this._gl.getExtension("WEBGL_compressed_texture_etc1")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc1"),
etc2:this._gl.getExtension("WEBGL_compressed_texture_etc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc")||this._gl.getExtension("WEBGL_compressed_texture_es3_0"),textureAnisotropicFilterExtension:this._gl.getExtension("EXT_texture_filter_anisotropic")||this._gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||this._gl.getExtension("MOZ_EXT_texture_filter_anisotropic"),uintIndices:1<this._webGLVersion||null!==this._gl.getExtension("OES_element_index_uint"),fragmentDepthSupported:1<
this._webGLVersion||null!==this._gl.getExtension("EXT_frag_depth"),highPrecisionShaderSupported:!1,timerQuery:this._gl.getExtension("EXT_disjoint_timer_query_webgl2")||this._gl.getExtension("EXT_disjoint_timer_query"),canUseTimestampForTimerQuery:!1,drawBuffersExtension:!1,maxMSAASamples:1,colorBufferFloat:1<this._webGLVersion&&this._gl.getExtension("EXT_color_buffer_float"),textureFloat:1<this._webGLVersion||this._gl.getExtension("OES_texture_float")?!0:!1,textureHalfFloat:1<this._webGLVersion||
this._gl.getExtension("OES_texture_half_float")?!0:!1,textureHalfFloatRender:!1,textureFloatLinearFiltering:!1,textureFloatRender:!1,textureHalfFloatLinearFiltering:!1,vertexArrayObject:!1,instancedArrays:!1,textureLOD:1<this._webGLVersion||this._gl.getExtension("EXT_shader_texture_lod")?!0:!1,blendMinMax:!1,multiview:this._gl.getExtension("OVR_multiview2"),oculusMultiview:this._gl.getExtension("OCULUS_multiview"),depthTextureExtension:!1};this._glVersion=this._gl.getParameter(this._gl.VERSION);var a=
this._gl.getExtension("WEBGL_debug_renderer_info");null!=a&&(this._glRenderer=this._gl.getParameter(a.UNMASKED_RENDERER_WEBGL),this._glVendor=this._gl.getParameter(a.UNMASKED_VENDOR_WEBGL));this._glVendor||(this._glVendor="Unknown vendor");this._glRenderer||(this._glRenderer="Unknown renderer");36193!==this._gl.HALF_FLOAT_OES&&(this._gl.HALF_FLOAT_OES=36193);34842!==this._gl.RGBA16F&&(this._gl.RGBA16F=34842);34836!==this._gl.RGBA32F&&(this._gl.RGBA32F=34836);35056!==this._gl.DEPTH24_STENCIL8&&(this._gl.DEPTH24_STENCIL8=
35056);this._caps.timerQuery&&(1===this._webGLVersion&&(this._gl.getQuery=this._caps.timerQuery.getQueryEXT.bind(this._caps.timerQuery)),this._caps.canUseTimestampForTimerQuery=0<this._gl.getQuery(this._caps.timerQuery.TIMESTAMP_EXT,this._caps.timerQuery.QUERY_COUNTER_BITS_EXT));this._caps.maxAnisotropy=this._caps.textureAnisotropicFilterExtension?this._gl.getParameter(this._caps.textureAnisotropicFilterExtension.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0;this._caps.textureFloatLinearFiltering=this._caps.textureFloat&&
this._gl.getExtension("OES_texture_float_linear")?!0:!1;this._caps.textureFloatRender=this._caps.textureFloat&&this._canRenderToFloatFramebuffer()?!0:!1;this._caps.textureHalfFloatLinearFiltering=1<this._webGLVersion||this._caps.textureHalfFloat&&this._gl.getExtension("OES_texture_half_float_linear")?!0:!1;1<this._webGLVersion&&5131!==this._gl.HALF_FLOAT_OES&&(this._gl.HALF_FLOAT_OES=5131);this._caps.textureHalfFloatRender=this._caps.textureHalfFloat&&this._canRenderToHalfFloatFramebuffer();if(1<
this._webGLVersion)this._caps.drawBuffersExtension=!0,this._caps.maxMSAASamples=this._gl.getParameter(this._gl.MAX_SAMPLES);else if(a=this._gl.getExtension("WEBGL_draw_buffers"),null!==a){this._caps.drawBuffersExtension=!0;this._gl.drawBuffers=a.drawBuffersWEBGL.bind(a);this._gl.DRAW_FRAMEBUFFER=this._gl.FRAMEBUFFER;for(var e=0;16>e;e++)this._gl["COLOR_ATTACHMENT"+e+"_WEBGL"]=a["COLOR_ATTACHMENT"+e+"_WEBGL"]}1<this._webGLVersion?this._caps.depthTextureExtension=!0:(a=this._gl.getExtension("WEBGL_depth_texture"),
null!=a&&(this._caps.depthTextureExtension=!0,this._gl.UNSIGNED_INT_24_8=a.UNSIGNED_INT_24_8_WEBGL));this.disableVertexArrayObjects?this._caps.vertexArrayObject=!1:1<this._webGLVersion?this._caps.vertexArrayObject=!0:(a=this._gl.getExtension("OES_vertex_array_object"),null!=a&&(this._caps.vertexArrayObject=!0,this._gl.createVertexArray=a.createVertexArrayOES.bind(a),this._gl.bindVertexArray=a.bindVertexArrayOES.bind(a),this._gl.deleteVertexArray=a.deleteVertexArrayOES.bind(a)));1<this._webGLVersion?
this._caps.instancedArrays=!0:(a=this._gl.getExtension("ANGLE_instanced_arrays"),null!=a?(this._caps.instancedArrays=!0,this._gl.drawArraysInstanced=a.drawArraysInstancedANGLE.bind(a),this._gl.drawElementsInstanced=a.drawElementsInstancedANGLE.bind(a),this._gl.vertexAttribDivisor=a.vertexAttribDivisorANGLE.bind(a)):this._caps.instancedArrays=!1);this._gl.getShaderPrecisionFormat&&(a=this._gl.getShaderPrecisionFormat(this._gl.VERTEX_SHADER,this._gl.HIGH_FLOAT),e=this._gl.getShaderPrecisionFormat(this._gl.FRAGMENT_SHADER,
this._gl.HIGH_FLOAT),a&&e&&(this._caps.highPrecisionShaderSupported=0!==a.precision&&0!==e.precision));1<this._webGLVersion?this._caps.blendMinMax=!0:(a=this._gl.getExtension("EXT_blend_minmax"),null!=a&&(this._caps.blendMinMax=!0,this._gl.MAX=a.MAX_EXT,this._gl.MIN=a.MIN_EXT));this._depthCullingState.depthTest=!0;this._depthCullingState.depthFunc=this._gl.LEQUAL;this._depthCullingState.depthMask=!0;this._maxSimultaneousTextures=this._caps.maxCombinedTexturesImageUnits;for(a=0;a<this._maxSimultaneousTextures;a++)this._nextFreeTextureSlots.push(a)};
Object.defineProperty(c.prototype,"webGLVersion",{get:function(){return this._webGLVersion},enumerable:!1,configurable:!0});c.prototype.getClassName=function(){return"ThinEngine"};Object.defineProperty(c.prototype,"isStencilEnable",{get:function(){return this._isStencilEnable},enumerable:!1,configurable:!0});c.prototype._prepareWorkingCanvas=function(){if(!this._workingCanvas){this._workingCanvas=p.a.CreateCanvas(1,1);var a=this._workingCanvas.getContext("2d");a&&(this._workingContext=a)}};c.prototype.resetTextureCache=
function(){for(var a in this._boundTexturesCache)this._boundTexturesCache.hasOwnProperty(a)&&(this._boundTexturesCache[a]=null);this._currentTextureChannel=-1};c.prototype.getGlInfo=function(){return{vendor:this._glVendor,renderer:this._glRenderer,version:this._glVersion}};c.prototype.setHardwareScalingLevel=function(a){this._hardwareScalingLevel=a;this.resize()};c.prototype.getHardwareScalingLevel=function(){return this._hardwareScalingLevel};c.prototype.getLoadedTexturesCache=function(){return this._internalTexturesCache};
c.prototype.getCaps=function(){return this._caps};c.prototype.stopRenderLoop=function(a){a?(a=this._activeRenderLoops.indexOf(a),0<=a&&this._activeRenderLoops.splice(a,1)):this._activeRenderLoops=[]};c.prototype._renderLoop=function(){if(!this._contextWasLost){var a=!0;!this.renderEvenInBackground&&this._windowIsBackground&&(a=!1);if(a){this.beginFrame();for(a=0;a<this._activeRenderLoops.length;a++)(0,this._activeRenderLoops[a])();this.endFrame()}}0<this._activeRenderLoops.length?this._frameHandler=
this._queueNewFrame(this._boundRenderFunction,this.getHostWindow()):this._renderingQueueLaunched=!1};c.prototype.getRenderingCanvas=function(){return this._renderingCanvas};c.prototype.getHostWindow=function(){return A.a.IsWindowObjectExist()?this._renderingCanvas&&this._renderingCanvas.ownerDocument&&this._renderingCanvas.ownerDocument.defaultView?this._renderingCanvas.ownerDocument.defaultView:window:null};c.prototype.getRenderWidth=function(a){void 0===a&&(a=!1);return!a&&this._currentRenderTarget?
this._currentRenderTarget.width:this._framebufferDimensionsObject?this._framebufferDimensionsObject.framebufferWidth:this._gl.drawingBufferWidth};c.prototype.getRenderHeight=function(a){void 0===a&&(a=!1);return!a&&this._currentRenderTarget?this._currentRenderTarget.height:this._framebufferDimensionsObject?this._framebufferDimensionsObject.framebufferHeight:this._gl.drawingBufferHeight};c.prototype._queueNewFrame=function(a,e){return c.QueueNewFrame(a,e)};c.prototype.runRenderLoop=function(a){-1===
this._activeRenderLoops.indexOf(a)&&(this._activeRenderLoops.push(a),this._renderingQueueLaunched||(this._renderingQueueLaunched=!0,this._boundRenderFunction=this._renderLoop.bind(this),this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow())))};c.prototype.clear=function(a,e,c,b){void 0===b&&(b=!1);this.applyStates();var d=0;e&&a&&(this._gl.clearColor(a.r,a.g,a.b,void 0!==a.a?a.a:1),d|=this._gl.COLOR_BUFFER_BIT);c&&(this.useReverseDepthBuffer?(this._depthCullingState.depthFunc=
this._gl.GREATER,this._gl.clearDepth(0)):this._gl.clearDepth(1),d|=this._gl.DEPTH_BUFFER_BIT);b&&(this._gl.clearStencil(0),d|=this._gl.STENCIL_BUFFER_BIT);this._gl.clear(d)};c.prototype._viewport=function(a,e,c,b){if(a!==this._viewportCached.x||e!==this._viewportCached.y||c!==this._viewportCached.z||b!==this._viewportCached.w)this._viewportCached.x=a,this._viewportCached.y=e,this._viewportCached.z=c,this._viewportCached.w=b,this._gl.viewport(a,e,c,b)};c.prototype.setViewport=function(a,e,c){e=e||
this.getRenderWidth();c=c||this.getRenderHeight();var b=a.x||0,d=a.y||0;this._cachedViewport=a;this._viewport(b*e,d*c,e*a.width,c*a.height)};c.prototype.beginFrame=function(){};c.prototype.endFrame=function(){this._badOS&&this.flushFramebuffer()};c.prototype.resize=function(){if(A.a.IsWindowObjectExist()){var a=this._renderingCanvas?this._renderingCanvas.clientWidth||this._renderingCanvas.width:window.innerWidth;var e=this._renderingCanvas?this._renderingCanvas.clientHeight||this._renderingCanvas.height:
window.innerHeight}else a=this._renderingCanvas?this._renderingCanvas.width:100,e=this._renderingCanvas?this._renderingCanvas.height:100;this.setSize(a/this._hardwareScalingLevel,e/this._hardwareScalingLevel)};c.prototype.setSize=function(a,e){if(!this._renderingCanvas)return!1;a|=0;e|=0;if(this._renderingCanvas.width===a&&this._renderingCanvas.height===e)return!1;this._renderingCanvas.width=a;this._renderingCanvas.height=e;return!0};c.prototype.bindFramebuffer=function(a,e,c,b,d,g,f){void 0===e&&
(e=0);void 0===g&&(g=0);void 0===f&&(f=0);this._currentRenderTarget&&this.unBindFramebuffer(this._currentRenderTarget);this._currentRenderTarget=a;this._bindUnboundFramebuffer(a._MSAAFramebuffer?a._MSAAFramebuffer:a._framebuffer);var l=this._gl;a.is2DArray?l.framebufferTextureLayer(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,a._webGLTexture,g,f):a.isCube&&l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_CUBE_MAP_POSITIVE_X+e,a._webGLTexture,g);var m=a._depthStencilTexture;if(m){var h=m._generateStencilBuffer?
l.DEPTH_STENCIL_ATTACHMENT:l.DEPTH_ATTACHMENT;a.is2DArray?l.framebufferTextureLayer(l.FRAMEBUFFER,h,m._webGLTexture,g,f):a.isCube?l.framebufferTexture2D(l.FRAMEBUFFER,h,l.TEXTURE_CUBE_MAP_POSITIVE_X+e,m._webGLTexture,g):l.framebufferTexture2D(l.FRAMEBUFFER,h,l.TEXTURE_2D,m._webGLTexture,g)}this._cachedViewport&&!d?this.setViewport(this._cachedViewport,c,b):(c||(c=a.width,g&&(c/=Math.pow(2,g))),b||(b=a.height,g&&(b/=Math.pow(2,g))),this._viewport(0,0,c,b));this.wipeCaches()};c.prototype._bindUnboundFramebuffer=
function(a){this._currentFramebuffer!==a&&(this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,a),this._currentFramebuffer=a)};c.prototype.unBindFramebuffer=function(a,e,c){void 0===e&&(e=!1);this._currentRenderTarget=null;var b=this._gl;if(a._MSAAFramebuffer){if(a._textureArray){this.unBindMultiColorAttachmentFramebuffer(a._textureArray,e,c);return}b.bindFramebuffer(b.READ_FRAMEBUFFER,a._MSAAFramebuffer);b.bindFramebuffer(b.DRAW_FRAMEBUFFER,a._framebuffer);b.blitFramebuffer(0,0,a.width,a.height,0,0,a.width,
a.height,b.COLOR_BUFFER_BIT,b.NEAREST)}!a.generateMipMaps||e||a.isCube||(this._bindTextureDirectly(b.TEXTURE_2D,a,!0),b.generateMipmap(b.TEXTURE_2D),this._bindTextureDirectly(b.TEXTURE_2D,null));c&&(a._MSAAFramebuffer&&this._bindUnboundFramebuffer(a._framebuffer),c());this._bindUnboundFramebuffer(null)};c.prototype.flushFramebuffer=function(){this._gl.flush()};c.prototype.restoreDefaultFramebuffer=function(){this._currentRenderTarget?this.unBindFramebuffer(this._currentRenderTarget):this._bindUnboundFramebuffer(null);
this._cachedViewport&&this.setViewport(this._cachedViewport);this.wipeCaches()};c.prototype._resetVertexBufferBinding=function(){this.bindArrayBuffer(null);this._cachedVertexBuffers=null};c.prototype.createVertexBuffer=function(a){return this._createVertexBuffer(a,this._gl.STATIC_DRAW)};c.prototype._createVertexBuffer=function(a,e){e=this._gl.createBuffer();if(!e)throw Error("Unable to create vertex buffer");e=new d.a(e);this.bindArrayBuffer(e);a instanceof Array?this._gl.bufferData(this._gl.ARRAY_BUFFER,
new Float32Array(a),this._gl.STATIC_DRAW):this._gl.bufferData(this._gl.ARRAY_BUFFER,a,this._gl.STATIC_DRAW);this._resetVertexBufferBinding();e.references=1;return e};c.prototype.createDynamicVertexBuffer=function(a){return this._createVertexBuffer(a,this._gl.DYNAMIC_DRAW)};c.prototype._resetIndexBufferBinding=function(){this.bindIndexBuffer(null);this._cachedIndexBuffer=null};c.prototype.createIndexBuffer=function(a,e){var c=this._gl.createBuffer(),b=new d.a(c);if(!c)throw Error("Unable to create index buffer");
this.bindIndexBuffer(b);a=this._normalizeIndexData(a);this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,a,e?this._gl.DYNAMIC_DRAW:this._gl.STATIC_DRAW);this._resetIndexBufferBinding();b.references=1;b.is32Bits=4===a.BYTES_PER_ELEMENT;return b};c.prototype._normalizeIndexData=function(a){if(a instanceof Uint16Array)return a;if(this._caps.uintIndices){if(a instanceof Uint32Array)return a;for(var e=0;e<a.length;e++)if(65535<=a[e])return new Uint32Array(a)}return new Uint16Array(a)};c.prototype.bindArrayBuffer=
function(a){this._vaoRecordInProgress||this._unbindVertexArrayObject();this.bindBuffer(a,this._gl.ARRAY_BUFFER)};c.prototype.bindUniformBlock=function(a,e,c){a=a.program;e=this._gl.getUniformBlockIndex(a,e);this._gl.uniformBlockBinding(a,e,c)};c.prototype.bindIndexBuffer=function(a){this._vaoRecordInProgress||this._unbindVertexArrayObject();this.bindBuffer(a,this._gl.ELEMENT_ARRAY_BUFFER)};c.prototype.bindBuffer=function(a,e){if(this._vaoRecordInProgress||this._currentBoundBuffer[e]!==a)this._gl.bindBuffer(e,
a?a.underlyingResource:null),this._currentBoundBuffer[e]=a};c.prototype.updateArrayBuffer=function(a){this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,a)};c.prototype._vertexAttribPointer=function(a,e,c,b,d,g,f){var l=this._currentBufferPointers[e];if(l){var m=!1;l.active?(l.buffer!==a&&(l.buffer=a,m=!0),l.size!==c&&(l.size=c,m=!0),l.type!==b&&(l.type=b,m=!0),l.normalized!==d&&(l.normalized=d,m=!0),l.stride!==g&&(l.stride=g,m=!0),l.offset!==f&&(l.offset=f,m=!0)):(m=!0,l.active=!0,l.index=e,l.size=c,
l.type=b,l.normalized=d,l.stride=g,l.offset=f,l.buffer=a);if(m||this._vaoRecordInProgress)this.bindArrayBuffer(a),this._gl.vertexAttribPointer(e,c,b,d,g,f)}};c.prototype._bindIndexBufferWithCache=function(a){null!=a&&this._cachedIndexBuffer!==a&&(this._cachedIndexBuffer=a,this.bindIndexBuffer(a),this._uintIndicesCurrentlySet=a.is32Bits)};c.prototype._bindVertexBuffersAttributes=function(a,e){var c=e.getAttributesNames();this._vaoRecordInProgress||this._unbindVertexArrayObject();this.unbindAllAttributes();
for(var b=0;b<c.length;b++){var d=e.getAttributeLocation(b);if(0<=d){var g=a[c[b]];if(g){this._gl.enableVertexAttribArray(d);this._vaoRecordInProgress||(this._vertexAttribArraysEnabled[d]=!0);var f=g.getBuffer();f&&(this._vertexAttribPointer(f,d,g.getSize(),g.type,g.normalized,g.byteStride,g.byteOffset),g.getIsInstanced()&&(this._gl.vertexAttribDivisor(d,g.getInstanceDivisor()),this._vaoRecordInProgress||(this._currentInstanceLocations.push(d),this._currentInstanceBuffers.push(f))))}}}};c.prototype.recordVertexArrayObject=
function(a,e,c){var b=this._gl.createVertexArray();this._vaoRecordInProgress=!0;this._gl.bindVertexArray(b);this._mustWipeVertexAttributes=!0;this._bindVertexBuffersAttributes(a,c);this.bindIndexBuffer(e);this._vaoRecordInProgress=!1;this._gl.bindVertexArray(null);return b};c.prototype.bindVertexArrayObject=function(a,e){this._cachedVertexArrayObject!==a&&(this._cachedVertexArrayObject=a,this._gl.bindVertexArray(a),this._cachedIndexBuffer=this._cachedVertexBuffers=null,this._uintIndicesCurrentlySet=
null!=e&&e.is32Bits,this._mustWipeVertexAttributes=!0)};c.prototype.bindBuffersDirectly=function(a,e,c,b,d){if(this._cachedVertexBuffers!==a||this._cachedEffectForVertexBuffers!==d){this._cachedVertexBuffers=a;this._cachedEffectForVertexBuffers=d;var l=d.getAttributesCount();this._unbindVertexArrayObject();this.unbindAllAttributes();for(var g=0,m=0;m<l;m++)if(m<c.length){var f=d.getAttributeLocation(m);0<=f&&(this._gl.enableVertexAttribArray(f),this._vertexAttribArraysEnabled[f]=!0,this._vertexAttribPointer(a,
f,c[m],this._gl.FLOAT,!1,b,g));g+=4*c[m]}}this._bindIndexBufferWithCache(e)};c.prototype._unbindVertexArrayObject=function(){this._cachedVertexArrayObject&&(this._cachedVertexArrayObject=null,this._gl.bindVertexArray(null))};c.prototype.bindBuffers=function(a,e,c){if(this._cachedVertexBuffers!==a||this._cachedEffectForVertexBuffers!==c)this._cachedVertexBuffers=a,this._cachedEffectForVertexBuffers=c,this._bindVertexBuffersAttributes(a,c);this._bindIndexBufferWithCache(e)};c.prototype.unbindInstanceAttributes=
function(){for(var a,e=0,c=this._currentInstanceLocations.length;e<c;e++){var b=this._currentInstanceBuffers[e];a!=b&&b.references&&(a=b,this.bindArrayBuffer(b));this._gl.vertexAttribDivisor(this._currentInstanceLocations[e],0)}this._currentInstanceBuffers.length=0;this._currentInstanceLocations.length=0};c.prototype.releaseVertexArrayObject=function(a){this._gl.deleteVertexArray(a)};c.prototype._releaseBuffer=function(a){a.references--;return 0===a.references?(this._deleteBuffer(a),!0):!1};c.prototype._deleteBuffer=
function(a){this._gl.deleteBuffer(a.underlyingResource)};c.prototype.updateAndBindInstancesBuffer=function(a,e,c){this.bindArrayBuffer(a);e&&this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,e);if(void 0!==c[0].index)this.bindInstancesBuffer(a,c,!0);else for(e=0;4>e;e++){var b=c[e];this._vertexAttribArraysEnabled[b]||(this._gl.enableVertexAttribArray(b),this._vertexAttribArraysEnabled[b]=!0);this._vertexAttribPointer(a,b,4,this._gl.FLOAT,!1,64,16*e);this._gl.vertexAttribDivisor(b,1);this._currentInstanceLocations.push(b);
this._currentInstanceBuffers.push(a)}};c.prototype.bindInstancesBuffer=function(a,e,c){void 0===c&&(c=!0);this.bindArrayBuffer(a);var b=0;if(c)for(c=0;c<e.length;c++){var d=e[c];b+=4*d.attributeSize}for(c=0;c<e.length;c++)d=e[c],void 0===d.index&&(d.index=this._currentEffect.getAttributeLocationByName(d.attributeName)),0>d.index||(this._vertexAttribArraysEnabled[d.index]||(this._gl.enableVertexAttribArray(d.index),this._vertexAttribArraysEnabled[d.index]=!0),this._vertexAttribPointer(a,d.index,d.attributeSize,
d.attributeType||this._gl.FLOAT,d.normalized||!1,b,d.offset),this._gl.vertexAttribDivisor(d.index,void 0===d.divisor?1:d.divisor),this._currentInstanceLocations.push(d.index),this._currentInstanceBuffers.push(a))};c.prototype.disableInstanceAttributeByName=function(a){this._currentEffect&&(a=this._currentEffect.getAttributeLocationByName(a),this.disableInstanceAttribute(a))};c.prototype.disableInstanceAttribute=function(a){for(var e=!1,c;-1!==(c=this._currentInstanceLocations.indexOf(a));)this._currentInstanceLocations.splice(c,
1),this._currentInstanceBuffers.splice(c,1),e=!0,this._currentInstanceLocations.indexOf(a);e&&(this._gl.vertexAttribDivisor(a,0),this.disableAttributeByIndex(a))};c.prototype.disableAttributeByIndex=function(a){this._gl.disableVertexAttribArray(a);this._vertexAttribArraysEnabled[a]=!1;this._currentBufferPointers[a].active=!1};c.prototype.draw=function(a,e,c,b){this.drawElementsType(a?0:1,e,c,b)};c.prototype.drawPointClouds=function(a,e,c){this.drawArraysType(2,a,e,c)};c.prototype.drawUnIndexed=function(a,
e,c,b){this.drawArraysType(a?0:1,e,c,b)};c.prototype.drawElementsType=function(a,e,c,b){this.applyStates();this._reportDrawCall();a=this._drawMode(a);var d=this._uintIndicesCurrentlySet?this._gl.UNSIGNED_INT:this._gl.UNSIGNED_SHORT,g=this._uintIndicesCurrentlySet?4:2;b?this._gl.drawElementsInstanced(a,c,d,e*g,b):this._gl.drawElements(a,c,d,e*g)};c.prototype.drawArraysType=function(a,e,c,b){this.applyStates();this._reportDrawCall();a=this._drawMode(a);b?this._gl.drawArraysInstanced(a,e,c,b):this._gl.drawArrays(a,
e,c)};c.prototype._drawMode=function(a){switch(a){case 0:return this._gl.TRIANGLES;case 2:return this._gl.POINTS;case 1:return this._gl.LINES;case 3:return this._gl.POINTS;case 4:return this._gl.LINES;case 5:return this._gl.LINE_LOOP;case 6:return this._gl.LINE_STRIP;case 7:return this._gl.TRIANGLE_STRIP;case 8:return this._gl.TRIANGLE_FAN;default:return this._gl.TRIANGLES}};c.prototype._reportDrawCall=function(){};c.prototype._releaseEffect=function(a){this._compiledEffects[a._key]&&(delete this._compiledEffects[a._key],
this._deletePipelineContext(a.getPipelineContext()))};c.prototype._deletePipelineContext=function(a){a&&a.program&&(a.program.__SPECTOR_rebuildProgram=null,this._gl.deleteProgram(a.program))};c.prototype.createEffect=function(a,e,c,d,g,f,h,p,q){var l=(a.vertexElement||a.vertex||a.vertexToken||a.vertexSource||a)+"+"+(a.fragmentElement||a.fragment||a.fragmentToken||a.fragmentSource||a)+"@"+(g?g:e.defines);if(this._compiledEffects[l])return l=this._compiledEffects[l],h&&l.isReady()&&h(l),l;h=new b.a(a,
e,c,d,this,g,f,h,p,q);h._key=l;return this._compiledEffects[l]=h};c._ConcatenateShader=function(a,e,c){void 0===c&&(c="");return c+(e?e+"\n":"")+a};c.prototype._compileShader=function(a,e,b,d){return this._compileRawShader(c._ConcatenateShader(a,b,d),e)};c.prototype._compileRawShader=function(a,e){var c=this._gl;e=c.createShader("vertex"===e?c.VERTEX_SHADER:c.FRAGMENT_SHADER);if(!e)throw Error("Something went wrong while compile the shader.");c.shaderSource(e,a);c.compileShader(e);return e};c.prototype._getShaderSource=
function(a){return this._gl.getShaderSource(a)};c.prototype.createRawShaderProgram=function(a,e,c,b,d){void 0===d&&(d=null);b=b||this._gl;e=this._compileRawShader(e,"vertex");c=this._compileRawShader(c,"fragment");return this._createShaderProgram(a,e,c,b,d)};c.prototype.createShaderProgram=function(a,e,c,b,d,g){void 0===g&&(g=null);d=d||this._gl;var l=1<this._webGLVersion?"#version 300 es\n#define WEBGL2 \n":"";e=this._compileShader(e,"vertex",b,l);c=this._compileShader(c,"fragment",b,l);return this._createShaderProgram(a,
e,c,d,g)};c.prototype.createPipelineContext=function(){var a=new g.a;a.engine=this;this._caps.parallelShaderCompile&&(a.isParallelCompiled=!0);return a};c.prototype._createShaderProgram=function(a,c,b,d,g){g=d.createProgram();a.program=g;if(!g)throw Error("Unable to create program");d.attachShader(g,c);d.attachShader(g,b);d.linkProgram(g);a.context=d;a.vertexShader=c;a.fragmentShader=b;a.isParallelCompiled||this._finalizePipelineContext(a);return g};c.prototype._finalizePipelineContext=function(a){var c=
a.context,b=a.vertexShader,d=a.fragmentShader,g=a.program;if(!c.getProgramParameter(g,c.LINK_STATUS)){if(!this._gl.getShaderParameter(b,this._gl.COMPILE_STATUS)){var f=this._gl.getShaderInfoLog(b);if(f)throw a.vertexCompilationError=f,Error("VERTEX SHADER "+f);}if(!this._gl.getShaderParameter(d,this._gl.COMPILE_STATUS)&&(f=this._gl.getShaderInfoLog(d)))throw a.fragmentCompilationError=f,Error("FRAGMENT SHADER "+f);if(f=c.getProgramInfoLog(g))throw a.programLinkError=f,Error(f);}if(this.validateShaderPrograms&&
(c.validateProgram(g),!c.getProgramParameter(g,c.VALIDATE_STATUS)&&(f=c.getProgramInfoLog(g))))throw a.programValidationError=f,Error(f);c.deleteShader(b);c.deleteShader(d);a.vertexShader=void 0;a.fragmentShader=void 0;a.onCompiled&&(a.onCompiled(),a.onCompiled=void 0)};c.prototype._preparePipelineContext=function(a,c,b,d,g,f,h){a.program=d?this.createRawShaderProgram(a,c,b,void 0,h):this.createShaderProgram(a,c,b,f,void 0,h);a.program.__SPECTOR_rebuildProgram=g};c.prototype._isRenderingStateCompiled=
function(a){return this._gl.getProgramParameter(a.program,this._caps.parallelShaderCompile.COMPLETION_STATUS_KHR)?(this._finalizePipelineContext(a),!0):!1};c.prototype._executeWhenRenderingStateIsCompiled=function(a,c){if(a.isParallelCompiled){var e=a.onCompiled;a.onCompiled=e?function(){e();c()}:c}else c()};c.prototype.getUniforms=function(a,c){for(var e=[],b=0;b<c.length;b++)e.push(this._gl.getUniformLocation(a.program,c[b]));return e};c.prototype.getAttributes=function(a,c){for(var e=[],b=0;b<
c.length;b++)try{e.push(this._gl.getAttribLocation(a.program,c[b]))}catch(H){e.push(-1)}return e};c.prototype.enableEffect=function(a){if(a&&a!==this._currentEffect){this.bindSamplers(a);this._currentEffect=a;if(a.onBind)a.onBind(a);a._onBindObservable&&a._onBindObservable.notifyObservers(a)}};c.prototype.setInt=function(a,c){if(!a)return!1;this._gl.uniform1i(a,c);return!0};c.prototype.setIntArray=function(a,c){if(!a)return!1;this._gl.uniform1iv(a,c);return!0};c.prototype.setIntArray2=function(a,
c){if(!a||0!==c.length%2)return!1;this._gl.uniform2iv(a,c);return!0};c.prototype.setIntArray3=function(a,c){if(!a||0!==c.length%3)return!1;this._gl.uniform3iv(a,c);return!0};c.prototype.setIntArray4=function(a,c){if(!a||0!==c.length%4)return!1;this._gl.uniform4iv(a,c);return!0};c.prototype.setArray=function(a,c){if(!a)return!1;this._gl.uniform1fv(a,c);return!0};c.prototype.setArray2=function(a,c){if(!a||0!==c.length%2)return!1;this._gl.uniform2fv(a,c);return!0};c.prototype.setArray3=function(a,c){if(!a||
0!==c.length%3)return!1;this._gl.uniform3fv(a,c);return!0};c.prototype.setArray4=function(a,c){if(!a||0!==c.length%4)return!1;this._gl.uniform4fv(a,c);return!0};c.prototype.setMatrices=function(a,c){if(!a)return!1;this._gl.uniformMatrix4fv(a,!1,c);return!0};c.prototype.setMatrix3x3=function(a,c){if(!a)return!1;this._gl.uniformMatrix3fv(a,!1,c);return!0};c.prototype.setMatrix2x2=function(a,c){if(!a)return!1;this._gl.uniformMatrix2fv(a,!1,c);return!0};c.prototype.setFloat=function(a,c){if(!a)return!1;
this._gl.uniform1f(a,c);return!0};c.prototype.setFloat2=function(a,c,b){if(!a)return!1;this._gl.uniform2f(a,c,b);return!0};c.prototype.setFloat3=function(a,c,b,d){if(!a)return!1;this._gl.uniform3f(a,c,b,d);return!0};c.prototype.setFloat4=function(a,c,b,d,g){if(!a)return!1;this._gl.uniform4f(a,c,b,d,g);return!0};c.prototype.applyStates=function(){this._depthCullingState.apply(this._gl);this._stencilState.apply(this._gl);this._alphaState.apply(this._gl);if(this._colorWriteChanged){this._colorWriteChanged=
!1;var a=this._colorWrite;this._gl.colorMask(a,a,a,a)}};c.prototype.setColorWrite=function(a){a!==this._colorWrite&&(this._colorWriteChanged=!0,this._colorWrite=a)};c.prototype.getColorWrite=function(){return this._colorWrite};Object.defineProperty(c.prototype,"depthCullingState",{get:function(){return this._depthCullingState},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"alphaState",{get:function(){return this._alphaState},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,
"stencilState",{get:function(){return this._stencilState},enumerable:!1,configurable:!0});c.prototype.clearInternalTexturesCache=function(){this._internalTexturesCache=[]};c.prototype.wipeCaches=function(a){if(!this.preventCacheWipeBetweenFrames||a)this._currentEffect=null,this._viewportCached.x=0,this._viewportCached.y=0,this._viewportCached.z=0,this._viewportCached.w=0,this._unbindVertexArrayObject(),a&&(this._currentProgram=null,this.resetTextureCache(),this._stencilState.reset(),this._depthCullingState.reset(),
this._depthCullingState.depthFunc=this._gl.LEQUAL,this._alphaState.reset(),this._alphaMode=1,this._alphaEquation=0,this._colorWriteChanged=this._colorWrite=!0,this._unpackFlipYCached=null,this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._gl.NONE),this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),this._mustWipeVertexAttributes=!0,this.unbindAllAttributes()),this._resetVertexBufferBinding(),this._cachedEffectForVertexBuffers=this._cachedIndexBuffer=null,this.bindIndexBuffer(null)};
c.prototype._getSamplingParameters=function(a,c){var b=this._gl,e=b.NEAREST,d=b.NEAREST;switch(a){case 11:e=b.LINEAR;d=c?b.LINEAR_MIPMAP_NEAREST:b.LINEAR;break;case 3:e=b.LINEAR;d=c?b.LINEAR_MIPMAP_LINEAR:b.LINEAR;break;case 8:e=b.NEAREST;d=c?b.NEAREST_MIPMAP_LINEAR:b.NEAREST;break;case 4:e=b.NEAREST;d=c?b.NEAREST_MIPMAP_NEAREST:b.NEAREST;break;case 5:e=b.NEAREST;d=c?b.LINEAR_MIPMAP_NEAREST:b.LINEAR;break;case 6:e=b.NEAREST;d=c?b.LINEAR_MIPMAP_LINEAR:b.LINEAR;break;case 7:e=b.NEAREST;d=b.LINEAR;break;
case 1:d=e=b.NEAREST;break;case 9:e=b.LINEAR;d=c?b.NEAREST_MIPMAP_NEAREST:b.NEAREST;break;case 10:e=b.LINEAR;d=c?b.NEAREST_MIPMAP_LINEAR:b.NEAREST;break;case 2:d=e=b.LINEAR;break;case 12:e=b.LINEAR,d=b.NEAREST}return{min:d,mag:e}};c.prototype._createTexture=function(){var a=this._gl.createTexture();if(!a)throw Error("Unable to create texture");return a};c.prototype.createTexture=function(a,b,d,g,f,h,p,q,k,n,F,r,t){var e=this;void 0===f&&(f=3);void 0===h&&(h=null);void 0===p&&(p=null);void 0===q&&
(q=null);void 0===k&&(k=null);void 0===n&&(n=null);void 0===F&&(F=null);a=a||"";var l="data:"===a.substr(0,5),m="blob:"===a.substr(0,5),H=l&&-1!==a.indexOf(";base64,"),y=k?k:new D.a(this,D.b.Url),w=a;!this._transformTextureUrl||H||k||q||(a=this._transformTextureUrl(a));w!==a&&(y._originalUrl=w);var u=a.lastIndexOf("."),v=F?F:-1<u?a.substring(u).toLowerCase():"",I=null;-1<v.indexOf("?")&&(v=v.split("?")[0]);u=0;for(var C=c._TextureLoaders;u<C.length;u++){var J=C[u];if(J.canLoad(v,r)){I=J;break}}g&&
g._addPendingData(y);y.url=a;y.generateMipMaps=!b;y.samplingMode=f;y.invertY=d;this._doNotHandleContextLost||(y._buffer=q);var z=null;h&&!k&&(z=y.onLoadedObservable.add(h));k||this._internalTexturesCache.push(y);var E=function(c,d){g&&g._removePendingData(y);a===w?(z&&y.onLoadedObservable.remove(z),x.a.UseFallbackTexture&&e.createTexture(x.a.FallbackTexture,b,y.invertY,g,f,null,p,q,y),p&&p((c||"Unknown error")+(x.a.UseFallbackTexture?" - Fallback texture was used":""),d)):(B.a.Warn("Failed to load "+
a+", falling back to "+w),e.createTexture(w,b,y.invertY,g,f,h,p,q,y,n,F,r,t))};if(I){var A=function(a){I.loadData(a,y,function(a,c,b,d,l,h){h?E("TextureLoader failed to load data"):e._prepareWebGLTexture(y,g,a,c,y.invertY,!b,d,function(){l();return!1},f)},t)};q?q instanceof ArrayBuffer?A(new Uint8Array(q)):ArrayBuffer.isView(q)?A(q):p&&p("Unable to load: only ArrayBuffer or ArrayBufferView is supported",null):this._loadFile(a,function(a){return A(new Uint8Array(a))},void 0,g?g.offlineProvider:void 0,
!0,function(c,b){E("Unable to load "+(c?c.responseURL:a,b))})}else d=function(a){m&&!e._doNotHandleContextLost&&(y._buffer=a);e._prepareWebGLTexture(y,g,a.width,a.height,y.invertY,b,!1,function(c,b,d){var f=e._gl,l=a.width===c&&a.height===b,h=n?e._getInternalFormat(n):".jpg"===v?f.RGB:f.RGBA;if(l)return f.texImage2D(f.TEXTURE_2D,0,h,h,f.UNSIGNED_BYTE,a),!1;l=e._caps.maxTextureSize;if(a.width>l||a.height>l||!e._supportsHardwareTextureRescaling){e._prepareWorkingCanvas();if(!e._workingCanvas||!e._workingContext)return!1;
e._workingCanvas.width=c;e._workingCanvas.height=b;e._workingContext.drawImage(a,0,0,a.width,a.height,0,0,c,b);f.texImage2D(f.TEXTURE_2D,0,h,h,f.UNSIGNED_BYTE,e._workingCanvas);y.width=c;y.height=b;return!1}var m=new D.a(e,D.b.Temp);e._bindTextureDirectly(f.TEXTURE_2D,m,!0);f.texImage2D(f.TEXTURE_2D,0,h,h,f.UNSIGNED_BYTE,a);e._rescaleTexture(m,y,g,h,function(){e._releaseTexture(m);e._bindTextureDirectly(f.TEXTURE_2D,y,!0);d()});return!0},f)},!l||H?q&&(q.decoding||q.close)?d(q):c._FileToolsLoadImage(a,
d,E,g?g.offlineProvider:null,r):"string"===typeof q||q instanceof ArrayBuffer||ArrayBuffer.isView(q)||q instanceof Blob?c._FileToolsLoadImage(q,d,E,g?g.offlineProvider:null,r):q&&d(q);return y};c._FileToolsLoadImage=function(a,c,b,d,g){throw z.a.WarnImport("FileTools");};c.prototype._rescaleTexture=function(a,c,b,d,g){};c.prototype.createRawTexture=function(a,c,b,d,g,f,h,p,q){throw z.a.WarnImport("Engine.RawTexture");};c.prototype.createRawCubeTexture=function(a,c,b,d,g,f,h,p){throw z.a.WarnImport("Engine.RawTexture");
};c.prototype.createRawTexture3D=function(a,c,b,d,g,f,h,p,q,k){throw z.a.WarnImport("Engine.RawTexture");};c.prototype.createRawTexture2DArray=function(a,c,b,d,g,f,h,p,q,k){throw z.a.WarnImport("Engine.RawTexture");};c.prototype._unpackFlipY=function(a){this._unpackFlipYCached!==a&&(this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,a?1:0),this.enableUnpackFlipYCached&&(this._unpackFlipYCached=a))};c.prototype._getUnpackAlignement=function(){return this._gl.getParameter(this._gl.UNPACK_ALIGNMENT)};
c.prototype._getTextureTarget=function(a){return a.isCube?this._gl.TEXTURE_CUBE_MAP:a.is3D?this._gl.TEXTURE_3D:a.is2DArray||a.isMultiview?this._gl.TEXTURE_2D_ARRAY:this._gl.TEXTURE_2D};c.prototype.updateTextureSamplingMode=function(a,c,b){void 0===b&&(b=!1);var e=this._getTextureTarget(c),d=this._getSamplingParameters(a,c.generateMipMaps||b);this._setTextureParameterInteger(e,this._gl.TEXTURE_MAG_FILTER,d.mag,c);this._setTextureParameterInteger(e,this._gl.TEXTURE_MIN_FILTER,d.min);b&&(c.generateMipMaps=
!0,this._gl.generateMipmap(e));this._bindTextureDirectly(e,null);c.samplingMode=a};c.prototype.updateTextureWrappingMode=function(a,c,b,d){void 0===b&&(b=null);void 0===d&&(d=null);var e=this._getTextureTarget(a);null!==c&&(this._setTextureParameterInteger(e,this._gl.TEXTURE_WRAP_S,this._getTextureWrapMode(c),a),a._cachedWrapU=c);null!==b&&(this._setTextureParameterInteger(e,this._gl.TEXTURE_WRAP_T,this._getTextureWrapMode(b),a),a._cachedWrapV=b);(a.is2DArray||a.is3D)&&null!==d&&(this._setTextureParameterInteger(e,
this._gl.TEXTURE_WRAP_R,this._getTextureWrapMode(d),a),a._cachedWrapR=d);this._bindTextureDirectly(e,null)};c.prototype._setupDepthStencilTexture=function(a,c,b,d,g){var e=c.width||c,f=c.height||c;c=c.layers||0;a.baseWidth=e;a.baseHeight=f;a.width=e;a.height=f;a.is2DArray=0<c;a.depth=c;a.isReady=!0;a.samples=1;a.generateMipMaps=!1;a._generateDepthBuffer=!0;a._generateStencilBuffer=b;a.samplingMode=d?2:1;a.type=0;a._comparisonFunction=g;b=this._gl;d=this._getTextureTarget(a);a=this._getSamplingParameters(a.samplingMode,
!1);b.texParameteri(d,b.TEXTURE_MAG_FILTER,a.mag);b.texParameteri(d,b.TEXTURE_MIN_FILTER,a.min);b.texParameteri(d,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(d,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);0===g?(b.texParameteri(d,b.TEXTURE_COMPARE_FUNC,515),b.texParameteri(d,b.TEXTURE_COMPARE_MODE,b.NONE)):(b.texParameteri(d,b.TEXTURE_COMPARE_FUNC,g),b.texParameteri(d,b.TEXTURE_COMPARE_MODE,b.COMPARE_REF_TO_TEXTURE))};c.prototype._uploadCompressedDataToTextureDirectly=function(a,c,b,d,g,f,h){void 0===
f&&(f=0);void 0===h&&(h=0);var e=this._gl,l=e.TEXTURE_2D;a.isCube&&(l=e.TEXTURE_CUBE_MAP_POSITIVE_X+f);this._gl.compressedTexImage2D(l,h,c,b,d,0,g)};c.prototype._uploadDataToTextureDirectly=function(a,c,b,d,g,f){void 0===b&&(b=0);void 0===d&&(d=0);void 0===f&&(f=!1);var e=this._gl,h=this._getWebGLTextureType(a.type),l=this._getInternalFormat(a.format);g=void 0===g?this._getRGBABufferInternalSizedFormat(a.type,a.format):this._getInternalFormat(g);this._unpackFlipY(a.invertY);var m=e.TEXTURE_2D;a.isCube&&
(m=e.TEXTURE_CUBE_MAP_POSITIVE_X+b);b=Math.round(Math.log(a.width)*Math.LOG2E);var p=Math.round(Math.log(a.height)*Math.LOG2E);e.texImage2D(m,d,g,f?a.width:Math.pow(2,Math.max(b-d,0)),f?a.height:Math.pow(2,Math.max(p-d,0)),0,l,h,c)};c.prototype.updateTextureData=function(a,c,b,d,g,f,h,p){void 0===h&&(h=0);void 0===p&&(p=0);var e=this._gl,l=this._getWebGLTextureType(a.type),m=this._getInternalFormat(a.format);this._unpackFlipY(a.invertY);var q=e.TEXTURE_2D;a.isCube&&(q=e.TEXTURE_CUBE_MAP_POSITIVE_X+
h);e.texSubImage2D(q,p,b,d,g,f,m,l,c)};c.prototype._uploadArrayBufferViewToTexture=function(a,c,b,d){void 0===b&&(b=0);void 0===d&&(d=0);var e=this._gl;e=a.isCube?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D;this._bindTextureDirectly(e,a,!0);this._uploadDataToTextureDirectly(a,c,b,d);this._bindTextureDirectly(e,null,!0)};c.prototype._prepareWebGLTextureContinuation=function(a,c,b,d,g){var e=this._gl;e&&(g=this._getSamplingParameters(g,!b),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,g.mag),e.texParameteri(e.TEXTURE_2D,
e.TEXTURE_MIN_FILTER,g.min),b||d||e.generateMipmap(e.TEXTURE_2D),this._bindTextureDirectly(e.TEXTURE_2D,null),c&&c._removePendingData(a),a.onLoadedObservable.notifyObservers(a),a.onLoadedObservable.clear())};c.prototype._prepareWebGLTexture=function(a,b,d,g,f,h,p,q,k){var e=this;void 0===k&&(k=3);var l=this.getCaps().maxTextureSize,m=Math.min(l,this.needPOTTextures?c.GetExponentOfTwo(d,l):d);l=Math.min(l,this.needPOTTextures?c.GetExponentOfTwo(g,l):g);var n=this._gl;n&&(a._webGLTexture?(this._bindTextureDirectly(n.TEXTURE_2D,
a,!0),this._unpackFlipY(void 0===f?!0:f?!0:!1),a.baseWidth=d,a.baseHeight=g,a.width=m,a.height=l,a.isReady=!0,q(m,l,function(){e._prepareWebGLTextureContinuation(a,b,h,p,k)})||this._prepareWebGLTextureContinuation(a,b,h,p,k)):b&&b._removePendingData(a))};c.prototype._setupFramebufferDepthAttachments=function(a,c,b,d,g){void 0===g&&(g=1);var e=this._gl;return a&&c?this._getDepthStencilBuffer(b,d,g,e.DEPTH_STENCIL,e.DEPTH24_STENCIL8,e.DEPTH_STENCIL_ATTACHMENT):c?(a=e.DEPTH_COMPONENT16,1<this._webGLVersion&&
(a=e.DEPTH_COMPONENT32F),this._getDepthStencilBuffer(b,d,g,a,a,e.DEPTH_ATTACHMENT)):a?this._getDepthStencilBuffer(b,d,g,e.STENCIL_INDEX8,e.STENCIL_INDEX8,e.STENCIL_ATTACHMENT):null};c.prototype._releaseFramebufferObjects=function(a){var c=this._gl;a._framebuffer&&(c.deleteFramebuffer(a._framebuffer),a._framebuffer=null);a._depthStencilBuffer&&(c.deleteRenderbuffer(a._depthStencilBuffer),a._depthStencilBuffer=null);a._MSAAFramebuffer&&(c.deleteFramebuffer(a._MSAAFramebuffer),a._MSAAFramebuffer=null);
a._MSAARenderBuffer&&(c.deleteRenderbuffer(a._MSAARenderBuffer),a._MSAARenderBuffer=null)};c.prototype._releaseTexture=function(a){this._releaseFramebufferObjects(a);this._deleteTexture(a._webGLTexture);this.unbindAllTextures();var c=this._internalTexturesCache.indexOf(a);-1!==c&&this._internalTexturesCache.splice(c,1);a._lodTextureHigh&&a._lodTextureHigh.dispose();a._lodTextureMid&&a._lodTextureMid.dispose();a._lodTextureLow&&a._lodTextureLow.dispose();a._irradianceTexture&&a._irradianceTexture.dispose()};
c.prototype._deleteTexture=function(a){this._gl.deleteTexture(a)};c.prototype._setProgram=function(a){this._currentProgram!==a&&(this._gl.useProgram(a),this._currentProgram=a)};c.prototype.bindSamplers=function(a){var c=a.getPipelineContext();this._setProgram(c.program);c=a.getSamplers();for(var b=0;b<c.length;b++){var d=a.getUniform(c[b]);d&&(this._boundUniforms[b]=d)}this._currentEffect=null};c.prototype._activateCurrentTexture=function(){this._currentTextureChannel!==this._activeChannel&&(this._gl.activeTexture(this._gl.TEXTURE0+
this._activeChannel),this._currentTextureChannel=this._activeChannel)};c.prototype._bindTextureDirectly=function(a,c,b,d){void 0===b&&(b=!1);void 0===d&&(d=!1);var e=!1,g=c&&-1<c._associatedChannel;b&&g&&(this._activeChannel=c._associatedChannel);if(this._boundTexturesCache[this._activeChannel]!==c||d){if(this._activateCurrentTexture(),c&&c.isMultiview?this._gl.bindTexture(a,c?c._colorTextureArray:null):this._gl.bindTexture(a,c?c._webGLTexture:null),this._boundTexturesCache[this._activeChannel]=c)c._associatedChannel=
this._activeChannel}else b&&(e=!0,this._activateCurrentTexture());g&&!b&&this._bindSamplerUniformToChannel(c._associatedChannel,this._activeChannel);return e};c.prototype._bindTexture=function(a,c){void 0!==a&&(c&&(c._associatedChannel=a),this._activeChannel=a,a=c?this._getTextureTarget(c):this._gl.TEXTURE_2D,this._bindTextureDirectly(a,c))};c.prototype.unbindAllTextures=function(){for(var a=0;a<this._maxSimultaneousTextures;a++)this._activeChannel=a,this._bindTextureDirectly(this._gl.TEXTURE_2D,
null),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),1<this.webGLVersion&&(this._bindTextureDirectly(this._gl.TEXTURE_3D,null),this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY,null))};c.prototype.setTexture=function(a,c,b){void 0!==a&&(c&&(this._boundUniforms[a]=c),this._setTexture(a,b))};c.prototype._bindSamplerUniformToChannel=function(a,c){(a=this._boundUniforms[a])&&a._currentState!==c&&(this._gl.uniform1i(a,c),a._currentState=c)};c.prototype._getTextureWrapMode=function(a){switch(a){case 0:return this._gl.CLAMP_TO_EDGE;
case 2:return this._gl.MIRRORED_REPEAT}return this._gl.REPEAT};c.prototype._setTexture=function(a,c,b,d){void 0===b&&(b=!1);void 0===d&&(d=!1);if(!c)return null!=this._boundTexturesCache[a]&&(this._activeChannel=a,this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),1<this.webGLVersion&&(this._bindTextureDirectly(this._gl.TEXTURE_3D,null),this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY,null))),!1;if(c.video)this._activeChannel=a,c.update();
else if(4===c.delayLoadState)return c.delayLoad(),!1;d=d?c.depthStencilTexture:c.isReady()?c.getInternalTexture():c.isCube?this.emptyCubeTexture:c.is3D?this.emptyTexture3D:c.is2DArray?this.emptyTexture2DArray:this.emptyTexture;!b&&d&&(d._associatedChannel=a);var e=!0;this._boundTexturesCache[a]===d&&(b||this._bindSamplerUniformToChannel(d._associatedChannel,a),e=!1);this._activeChannel=a;a=this._getTextureTarget(d);e&&this._bindTextureDirectly(a,d,b);d&&!d.isMultiview&&(d.isCube&&d._cachedCoordinatesMode!==
c.coordinatesMode&&(d._cachedCoordinatesMode=c.coordinatesMode,b=3!==c.coordinatesMode&&5!==c.coordinatesMode?1:0,c.wrapU=b,c.wrapV=b),d._cachedWrapU!==c.wrapU&&(d._cachedWrapU=c.wrapU,this._setTextureParameterInteger(a,this._gl.TEXTURE_WRAP_S,this._getTextureWrapMode(c.wrapU),d)),d._cachedWrapV!==c.wrapV&&(d._cachedWrapV=c.wrapV,this._setTextureParameterInteger(a,this._gl.TEXTURE_WRAP_T,this._getTextureWrapMode(c.wrapV),d)),d.is3D&&d._cachedWrapR!==c.wrapR&&(d._cachedWrapR=c.wrapR,this._setTextureParameterInteger(a,
this._gl.TEXTURE_WRAP_R,this._getTextureWrapMode(c.wrapR),d)),this._setAnisotropicLevel(a,d,c.anisotropicFilteringLevel));return!0};c.prototype.setTextureArray=function(a,c,b){if(void 0!==a&&c){this._textureUnits&&this._textureUnits.length===b.length||(this._textureUnits=new Int32Array(b.length));for(var e=0;e<b.length;e++){var d=b[e].getInternalTexture();d?(this._textureUnits[e]=a+e,d._associatedChannel=a+e):this._textureUnits[e]=-1}this._gl.uniform1iv(c,this._textureUnits);for(a=0;a<b.length;a++)this._setTexture(this._textureUnits[a],
b[a],!0)}};c.prototype._setAnisotropicLevel=function(a,c,b){var e=this._caps.textureAnisotropicFilterExtension;11!==c.samplingMode&&3!==c.samplingMode&&2!==c.samplingMode&&(b=1);e&&c._cachedAnisotropicFilteringLevel!==b&&(this._setTextureParameterFloat(a,e.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(b,this._caps.maxAnisotropy),c),c._cachedAnisotropicFilteringLevel=b)};c.prototype._setTextureParameterFloat=function(a,c,b,d){this._bindTextureDirectly(a,d,!0,!0);this._gl.texParameterf(a,c,b)};c.prototype._setTextureParameterInteger=
function(a,c,b,d){d&&this._bindTextureDirectly(a,d,!0,!0);this._gl.texParameteri(a,c,b)};c.prototype.unbindAllAttributes=function(){if(this._mustWipeVertexAttributes){this._mustWipeVertexAttributes=!1;for(var a=0;a<this._caps.maxVertexAttribs;a++)this.disableAttributeByIndex(a)}else{a=0;for(var c=this._vertexAttribArraysEnabled.length;a<c;a++)a>=this._caps.maxVertexAttribs||!this._vertexAttribArraysEnabled[a]||this.disableAttributeByIndex(a)}};c.prototype.releaseEffects=function(){for(var a in this._compiledEffects){var c=
this._compiledEffects[a].getPipelineContext();this._deletePipelineContext(c)}this._compiledEffects={}};c.prototype.dispose=function(){this.stopRenderLoop();this.onBeforeTextureInitObservable&&this.onBeforeTextureInitObservable.clear();this._emptyTexture&&(this._releaseTexture(this._emptyTexture),this._emptyTexture=null);this._emptyCubeTexture&&(this._releaseTexture(this._emptyCubeTexture),this._emptyCubeTexture=null);this._dummyFramebuffer&&this._gl.deleteFramebuffer(this._dummyFramebuffer);this.releaseEffects();
this.unbindAllAttributes();this._boundUniforms=[];A.a.IsWindowObjectExist()&&this._renderingCanvas&&!this._doNotHandleContextLost&&(this._renderingCanvas.removeEventListener("webglcontextlost",this._onContextLost),this._renderingCanvas.removeEventListener("webglcontextrestored",this._onContextRestored));this._workingContext=this._workingCanvas=null;this._currentBufferPointers=[];this._boundRenderFunction=this._currentProgram=this._renderingCanvas=null;b.a.ResetCache();for(var a=0,c=this._activeRequests;a<
c.length;a++)c[a].abort()};c.prototype.attachContextLostEvent=function(a){this._renderingCanvas&&this._renderingCanvas.addEventListener("webglcontextlost",a,!1)};c.prototype.attachContextRestoredEvent=function(a){this._renderingCanvas&&this._renderingCanvas.addEventListener("webglcontextrestored",a,!1)};c.prototype.getError=function(){return this._gl.getError()};c.prototype._canRenderToFloatFramebuffer=function(){return 1<this._webGLVersion?this._caps.colorBufferFloat:this._canRenderToFramebuffer(1)};
c.prototype._canRenderToHalfFloatFramebuffer=function(){return 1<this._webGLVersion?this._caps.colorBufferFloat:this._canRenderToFramebuffer(2)};c.prototype._canRenderToFramebuffer=function(a){for(var c=this._gl;c.getError()!==c.NO_ERROR;);var b=!0,d=c.createTexture();c.bindTexture(c.TEXTURE_2D,d);c.texImage2D(c.TEXTURE_2D,0,this._getRGBABufferInternalSizedFormat(a),1,1,0,c.RGBA,this._getWebGLTextureType(a),null);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST);c.texParameteri(c.TEXTURE_2D,
c.TEXTURE_MAG_FILTER,c.NEAREST);a=c.createFramebuffer();c.bindFramebuffer(c.FRAMEBUFFER,a);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,d,0);var g=c.checkFramebufferStatus(c.FRAMEBUFFER);if(b=(b=b&&g===c.FRAMEBUFFER_COMPLETE)&&c.getError()===c.NO_ERROR)c.clear(c.COLOR_BUFFER_BIT),b=b&&c.getError()===c.NO_ERROR;if(b){c.bindFramebuffer(c.FRAMEBUFFER,null);g=c.RGBA;var f=c.UNSIGNED_BYTE,h=new Uint8Array(4);c.readPixels(0,0,1,1,g,f,h);b=b&&c.getError()===c.NO_ERROR}c.deleteTexture(d);
c.deleteFramebuffer(a);for(c.bindFramebuffer(c.FRAMEBUFFER,null);!b&&c.getError()!==c.NO_ERROR;);return b};c.prototype._getWebGLTextureType=function(a){if(1===this._webGLVersion){switch(a){case 1:return this._gl.FLOAT;case 2:return this._gl.HALF_FLOAT_OES;case 8:return this._gl.UNSIGNED_SHORT_4_4_4_4;case 9:return this._gl.UNSIGNED_SHORT_5_5_5_1;case 10:return this._gl.UNSIGNED_SHORT_5_6_5}return this._gl.UNSIGNED_BYTE}switch(a){case 3:return this._gl.BYTE;case 4:return this._gl.SHORT;case 5:return this._gl.UNSIGNED_SHORT;
case 6:return this._gl.INT;case 7:return this._gl.UNSIGNED_INT;case 1:return this._gl.FLOAT;case 2:return this._gl.HALF_FLOAT;case 8:return this._gl.UNSIGNED_SHORT_4_4_4_4;case 9:return this._gl.UNSIGNED_SHORT_5_5_5_1;case 10:return this._gl.UNSIGNED_SHORT_5_6_5;case 11:return this._gl.UNSIGNED_INT_2_10_10_10_REV;case 12:return this._gl.UNSIGNED_INT_24_8;case 13:return this._gl.UNSIGNED_INT_10F_11F_11F_REV;case 14:return this._gl.UNSIGNED_INT_5_9_9_9_REV;case 15:return this._gl.FLOAT_32_UNSIGNED_INT_24_8_REV}return this._gl.UNSIGNED_BYTE};
c.prototype._getInternalFormat=function(a){var c=this._gl.RGBA;switch(a){case 0:c=this._gl.ALPHA;break;case 1:c=this._gl.LUMINANCE;break;case 2:c=this._gl.LUMINANCE_ALPHA;break;case 6:c=this._gl.RED;break;case 7:c=this._gl.RG;break;case 4:c=this._gl.RGB;break;case 5:c=this._gl.RGBA}if(1<this._webGLVersion)switch(a){case 8:c=this._gl.RED_INTEGER;break;case 9:c=this._gl.RG_INTEGER;break;case 10:c=this._gl.RGB_INTEGER;break;case 11:c=this._gl.RGBA_INTEGER}return c};c.prototype._getRGBABufferInternalSizedFormat=
function(a,c){if(1===this._webGLVersion){if(void 0!==c)switch(c){case 0:return this._gl.ALPHA;case 1:return this._gl.LUMINANCE;case 2:return this._gl.LUMINANCE_ALPHA;case 4:return this._gl.RGB}return this._gl.RGBA}switch(a){case 3:switch(c){case 6:return this._gl.R8_SNORM;case 7:return this._gl.RG8_SNORM;case 4:return this._gl.RGB8_SNORM;case 8:return this._gl.R8I;case 9:return this._gl.RG8I;case 10:return this._gl.RGB8I;case 11:return this._gl.RGBA8I;default:return this._gl.RGBA8_SNORM}case 0:switch(c){case 6:return this._gl.R8;
case 7:return this._gl.RG8;case 4:return this._gl.RGB8;case 5:return this._gl.RGBA8;case 8:return this._gl.R8UI;case 9:return this._gl.RG8UI;case 10:return this._gl.RGB8UI;case 11:return this._gl.RGBA8UI;case 0:return this._gl.ALPHA;case 1:return this._gl.LUMINANCE;case 2:return this._gl.LUMINANCE_ALPHA;default:return this._gl.RGBA8}case 4:switch(c){case 8:return this._gl.R16I;case 9:return this._gl.RG16I;case 10:return this._gl.RGB16I;case 11:return this._gl.RGBA16I;default:return this._gl.RGBA16I}case 5:switch(c){case 8:return this._gl.R16UI;
case 9:return this._gl.RG16UI;case 10:return this._gl.RGB16UI;case 11:return this._gl.RGBA16UI;default:return this._gl.RGBA16UI}case 6:switch(c){case 8:return this._gl.R32I;case 9:return this._gl.RG32I;case 10:return this._gl.RGB32I;case 11:return this._gl.RGBA32I;default:return this._gl.RGBA32I}case 7:switch(c){case 8:return this._gl.R32UI;case 9:return this._gl.RG32UI;case 10:return this._gl.RGB32UI;case 11:return this._gl.RGBA32UI;default:return this._gl.RGBA32UI}case 1:switch(c){case 6:return this._gl.R32F;
case 7:return this._gl.RG32F;case 4:return this._gl.RGB32F;case 5:return this._gl.RGBA32F;default:return this._gl.RGBA32F}case 2:switch(c){case 6:return this._gl.R16F;case 7:return this._gl.RG16F;case 4:return this._gl.RGB16F;case 5:return this._gl.RGBA16F;default:return this._gl.RGBA16F}case 10:return this._gl.RGB565;case 13:return this._gl.R11F_G11F_B10F;case 14:return this._gl.RGB9_E5;case 8:return this._gl.RGBA4;case 9:return this._gl.RGB5_A1;case 11:switch(c){case 5:return this._gl.RGB10_A2;
case 11:return this._gl.RGB10_A2UI;default:return this._gl.RGB10_A2}}return this._gl.RGBA8};c.prototype._getRGBAMultiSampleBufferFormat=function(a){return 1===a?this._gl.RGBA32F:2===a?this._gl.RGBA16F:this._gl.RGBA8};c.prototype._loadFile=function(a,b,d,g,f,h){var e=this;a=c._FileToolsLoadFile(a,b,d,g,f,h);this._activeRequests.push(a);a.onCompleteObservable.add(function(a){e._activeRequests.splice(e._activeRequests.indexOf(a),1)});return a};c._FileToolsLoadFile=function(a,c,b,d,g,f){throw z.a.WarnImport("FileTools");
};c.prototype.readPixels=function(a,c,b,d,g){void 0===g&&(g=!0);var e=g?this._gl.RGBA:this._gl.RGB;g=new Uint8Array(d*b*(g?4:3));this._gl.readPixels(a,c,b,d,e,this._gl.UNSIGNED_BYTE,g);return g};Object.defineProperty(c,"IsSupported",{get:function(){return this.isSupported()},enumerable:!1,configurable:!0});c.isSupported=function(){if(null!==this._HasMajorPerformanceCaveat)return!this._HasMajorPerformanceCaveat;if(null===this._IsSupported)try{var a=p.a.CreateCanvas(1,1);this._IsSupported=null!=(a.getContext("webgl")||
a.getContext("experimental-webgl"))&&!!window.WebGLRenderingContext}catch(e){this._IsSupported=!1}return this._IsSupported};Object.defineProperty(c,"HasMajorPerformanceCaveat",{get:function(){if(null===this._HasMajorPerformanceCaveat)try{var a=p.a.CreateCanvas(1,1);this._HasMajorPerformanceCaveat=!(a.getContext("webgl",{failIfMajorPerformanceCaveat:!0})||a.getContext("experimental-webgl",{failIfMajorPerformanceCaveat:!0}))}catch(e){this._HasMajorPerformanceCaveat=!1}return this._HasMajorPerformanceCaveat},
enumerable:!1,configurable:!0});c.CeilingPOT=function(a){a--;a|=a>>1;a|=a>>2;a|=a>>4;a|=a>>8;a|=a>>16;a++;return a};c.FloorPOT=function(a){a|=a>>1;a|=a>>2;a|=a>>4;a|=a>>8;a|=a>>16;return a-(a>>1)};c.NearestPOT=function(a){var b=c.CeilingPOT(a),d=c.FloorPOT(a);return b-a>a-d?d:b};c.GetExponentOfTwo=function(a,b,d){void 0===d&&(d=2);switch(d){case 1:a=c.FloorPOT(a);break;case 2:a=c.NearestPOT(a);break;default:a=c.CeilingPOT(a)}return Math.min(a,b)};c.QueueNewFrame=function(a,c){if(!A.a.IsWindowObjectExist())return"undefined"!==
typeof requestAnimationFrame?requestAnimationFrame(a):setTimeout(a,16);c||(c=window);return c.requestPostAnimationFrame?c.requestPostAnimationFrame(a):c.requestAnimationFrame?c.requestAnimationFrame(a):c.msRequestAnimationFrame?c.msRequestAnimationFrame(a):c.webkitRequestAnimationFrame?c.webkitRequestAnimationFrame(a):c.mozRequestAnimationFrame?c.mozRequestAnimationFrame(a):c.oRequestAnimationFrame?c.oRequestAnimationFrame(a):window.setTimeout(a,16)};c.prototype.getHostDocument=function(){return this._renderingCanvas&&
this._renderingCanvas.ownerDocument?this._renderingCanvas.ownerDocument:document};c.ExceptionList=[{key:"Chrome/63.0",capture:"63\\.0\\.3239\\.(\\d+)",captureConstraint:108,targets:["uniformBuffer"]},{key:"Firefox/58",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Firefox/59",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Chrome/72.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Chrome/73.+?Mobile",capture:null,captureConstraint:null,
targets:["vao"]},{key:"Chrome/74.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome/71",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome/72",capture:null,captureConstraint:null,targets:["vao"]}];c._TextureLoaders=[];c.CollisionsEpsilon=.001;c._IsSupported=null;c._HasMajorPerformanceCaveat=null;return c}()},qUIE:function(n,r,h){h.d(r,"a",function(){return k});var x=h("oYeq"),b=h("ps+7"),z=h("h87I"),u=h("e2Mr"),G=h("n5HA"),t=h("h13i"),v=h("W+I9"),
D=h("waC4"),B=h("25bV"),A=h("uyO6");h("+zdb");h("s+Kb");h("/4XI");var k=function(h){function d(g,p,q,k){void 0===k&&(k=!1);var f=h.call(this,g,p,q,k)||this;f.enableOfflineSupport=!1;f.disableManifestCheck=!1;f.scenes=[];f.onNewSceneAddedObservable=new b.a;f.postProcesses=[];f.isPointerLock=!1;f.onResizeObservable=new b.a;f.onCanvasBlurObservable=new b.a;f.onCanvasFocusObservable=new b.a;f.onCanvasPointerOutObservable=new b.a;f.onBeginFrameObservable=new b.a;f.customAnimationFrameRequester=null;f.onEndFrameObservable=
new b.a;f.onBeforeShaderCompilationObservable=new b.a;f.onAfterShaderCompilationObservable=new b.a;f._deterministicLockstep=!1;f._lockstepMaxSteps=4;f._timeStep=1/60;f._fps=60;f._deltaTime=0;f._drawCalls=new D.a;f.canvasTabIndex=1;f.disablePerformanceMonitorInBackground=!1;f._performanceMonitor=new v.a;d.Instances.push(f);if(!g)return f;q=f._creationOptions;if(g.getContext){f._onCanvasFocus=function(){f.onCanvasFocusObservable.notifyObservers(f)};f._onCanvasBlur=function(){f.onCanvasBlurObservable.notifyObservers(f)};
g.addEventListener("focus",f._onCanvasFocus);g.addEventListener("blur",f._onCanvasBlur);f._onBlur=function(){f.disablePerformanceMonitorInBackground&&f._performanceMonitor.disable();f._windowIsBackground=!0};f._onFocus=function(){f.disablePerformanceMonitorInBackground&&f._performanceMonitor.enable();f._windowIsBackground=!1};f._onCanvasPointerOut=function(a){f.onCanvasPointerOutObservable.notifyObservers(a)};g.addEventListener("pointerout",f._onCanvasPointerOut);if(z.a.IsWindowObjectExist()){p=f.getHostWindow();
p.addEventListener("blur",f._onBlur);p.addEventListener("focus",f._onFocus);var c=document;f._onFullscreenChange=function(){void 0!==c.fullscreen?f.isFullscreen=c.fullscreen:void 0!==c.mozFullScreen?f.isFullscreen=c.mozFullScreen:void 0!==c.webkitIsFullScreen?f.isFullscreen=c.webkitIsFullScreen:void 0!==c.msIsFullScreen&&(f.isFullscreen=c.msIsFullScreen);f.isFullscreen&&f._pointerLockRequested&&g&&d._RequestPointerlock(g)};document.addEventListener("fullscreenchange",f._onFullscreenChange,!1);document.addEventListener("mozfullscreenchange",
f._onFullscreenChange,!1);document.addEventListener("webkitfullscreenchange",f._onFullscreenChange,!1);document.addEventListener("msfullscreenchange",f._onFullscreenChange,!1);f._onPointerLockChange=function(){f.isPointerLock=c.mozPointerLockElement===g||c.webkitPointerLockElement===g||c.msPointerLockElement===g||c.pointerLockElement===g};document.addEventListener("pointerlockchange",f._onPointerLockChange,!1);document.addEventListener("mspointerlockchange",f._onPointerLockChange,!1);document.addEventListener("mozpointerlockchange",
f._onPointerLockChange,!1);document.addEventListener("webkitpointerlockchange",f._onPointerLockChange,!1);!d.audioEngine&&q.audioEngine&&d.AudioEngineFactory&&(d.audioEngine=d.AudioEngineFactory(f.getRenderingCanvas()))}f._connectVREvents();f.enableOfflineSupport=void 0!==d.OfflineProviderFactory;q.doNotHandleTouchAction||f._disableTouchAction();f._deterministicLockstep=!!q.deterministicLockstep;f._lockstepMaxSteps=q.lockstepMaxSteps||0;f._timeStep=q.timeStep||1/60}f._prepareVRComponent();q.autoEnableWebVR&&
f.initWebVR();return f}Object(x.d)(d,h);Object.defineProperty(d,"NpmPackage",{get:function(){return t.a.NpmPackage},enumerable:!1,configurable:!0});Object.defineProperty(d,"Version",{get:function(){return t.a.Version},enumerable:!1,configurable:!0});Object.defineProperty(d,"Instances",{get:function(){return u.a.Instances},enumerable:!1,configurable:!0});Object.defineProperty(d,"LastCreatedEngine",{get:function(){return u.a.LastCreatedEngine},enumerable:!1,configurable:!0});Object.defineProperty(d,
"LastCreatedScene",{get:function(){return u.a.LastCreatedScene},enumerable:!1,configurable:!0});d.MarkAllMaterialsAsDirty=function(b,h){for(var g=0;g<d.Instances.length;g++)for(var p=d.Instances[g],f=0;f<p.scenes.length;f++)p.scenes[f].markAllMaterialsAsDirty(b,h)};d.DefaultLoadingScreenFactory=function(b){throw G.a.WarnImport("LoadingScreen");};Object.defineProperty(d.prototype,"_supportsHardwareTextureRescaling",{get:function(){return!!d._RescalePostProcessFactory},enumerable:!1,configurable:!0});
Object.defineProperty(d.prototype,"performanceMonitor",{get:function(){return this._performanceMonitor},enumerable:!1,configurable:!0});d.prototype.getInputElement=function(){return this._renderingCanvas};d.prototype.getAspectRatio=function(b,d){void 0===d&&(d=!1);b=b.viewport;return this.getRenderWidth(d)*b.width/(this.getRenderHeight(d)*b.height)};d.prototype.getScreenAspectRatio=function(){return this.getRenderWidth(!0)/this.getRenderHeight(!0)};d.prototype.getRenderingCanvasClientRect=function(){return this._renderingCanvas?
this._renderingCanvas.getBoundingClientRect():null};d.prototype.getInputElementClientRect=function(){return this._renderingCanvas?this.getInputElement().getBoundingClientRect():null};d.prototype.isDeterministicLockStep=function(){return this._deterministicLockstep};d.prototype.getLockstepMaxSteps=function(){return this._lockstepMaxSteps};d.prototype.getTimeStep=function(){return 1E3*this._timeStep};d.prototype.generateMipMapsForCubemap=function(b,d){void 0===d&&(d=!0);if(b.generateMipMaps){var g=
this._gl;this._bindTextureDirectly(g.TEXTURE_CUBE_MAP,b,!0);g.generateMipmap(g.TEXTURE_CUBE_MAP);d&&this._bindTextureDirectly(g.TEXTURE_CUBE_MAP,null)}};d.prototype.setState=function(b,d,h,k){void 0===d&&(d=0);void 0===k&&(k=!1);if(this._depthCullingState.cull!==b||h)this._depthCullingState.cull=b;b=this.cullBackFaces?this._gl.BACK:this._gl.FRONT;if(this._depthCullingState.cullFace!==b||h)this._depthCullingState.cullFace=b;this.setZOffset(d);d=k?this._gl.CW:this._gl.CCW;if(this._depthCullingState.frontFace!==
d||h)this._depthCullingState.frontFace=d};d.prototype.setZOffset=function(b){this._depthCullingState.zOffset=b};d.prototype.getZOffset=function(){return this._depthCullingState.zOffset};d.prototype.setDepthBuffer=function(b){this._depthCullingState.depthTest=b};d.prototype.getDepthWrite=function(){return this._depthCullingState.depthMask};d.prototype.setDepthWrite=function(b){this._depthCullingState.depthMask=b};d.prototype.getStencilBuffer=function(){return this._stencilState.stencilTest};d.prototype.setStencilBuffer=
function(b){this._stencilState.stencilTest=b};d.prototype.getStencilMask=function(){return this._stencilState.stencilMask};d.prototype.setStencilMask=function(b){this._stencilState.stencilMask=b};d.prototype.getStencilFunction=function(){return this._stencilState.stencilFunc};d.prototype.getStencilFunctionReference=function(){return this._stencilState.stencilFuncRef};d.prototype.getStencilFunctionMask=function(){return this._stencilState.stencilFuncMask};d.prototype.setStencilFunction=function(b){this._stencilState.stencilFunc=
b};d.prototype.setStencilFunctionReference=function(b){this._stencilState.stencilFuncRef=b};d.prototype.setStencilFunctionMask=function(b){this._stencilState.stencilFuncMask=b};d.prototype.getStencilOperationFail=function(){return this._stencilState.stencilOpStencilFail};d.prototype.getStencilOperationDepthFail=function(){return this._stencilState.stencilOpDepthFail};d.prototype.getStencilOperationPass=function(){return this._stencilState.stencilOpStencilDepthPass};d.prototype.setStencilOperationFail=
function(b){this._stencilState.stencilOpStencilFail=b};d.prototype.setStencilOperationDepthFail=function(b){this._stencilState.stencilOpDepthFail=b};d.prototype.setStencilOperationPass=function(b){this._stencilState.stencilOpStencilDepthPass=b};d.prototype.setDitheringState=function(b){b?this._gl.enable(this._gl.DITHER):this._gl.disable(this._gl.DITHER)};d.prototype.setRasterizerState=function(b){b?this._gl.disable(this._gl.RASTERIZER_DISCARD):this._gl.enable(this._gl.RASTERIZER_DISCARD)};d.prototype.getDepthFunction=
function(){return this._depthCullingState.depthFunc};d.prototype.setDepthFunction=function(b){this._depthCullingState.depthFunc=b};d.prototype.setDepthFunctionToGreater=function(){this._depthCullingState.depthFunc=this._gl.GREATER};d.prototype.setDepthFunctionToGreaterOrEqual=function(){this._depthCullingState.depthFunc=this._gl.GEQUAL};d.prototype.setDepthFunctionToLess=function(){this._depthCullingState.depthFunc=this._gl.LESS};d.prototype.setDepthFunctionToLessOrEqual=function(){this._depthCullingState.depthFunc=
this._gl.LEQUAL};d.prototype.cacheStencilState=function(){this._cachedStencilBuffer=this.getStencilBuffer();this._cachedStencilFunction=this.getStencilFunction();this._cachedStencilMask=this.getStencilMask();this._cachedStencilOperationPass=this.getStencilOperationPass();this._cachedStencilOperationFail=this.getStencilOperationFail();this._cachedStencilOperationDepthFail=this.getStencilOperationDepthFail();this._cachedStencilReference=this.getStencilFunctionReference()};d.prototype.restoreStencilState=
function(){this.setStencilFunction(this._cachedStencilFunction);this.setStencilMask(this._cachedStencilMask);this.setStencilBuffer(this._cachedStencilBuffer);this.setStencilOperationPass(this._cachedStencilOperationPass);this.setStencilOperationFail(this._cachedStencilOperationFail);this.setStencilOperationDepthFail(this._cachedStencilOperationDepthFail);this.setStencilFunctionReference(this._cachedStencilReference)};d.prototype.setDirectViewport=function(b,d,h,k){var g=this._cachedViewport;this._cachedViewport=
null;this._viewport(b,d,h,k);return g};d.prototype.scissorClear=function(b,d,h,k,f){this.enableScissor(b,d,h,k);this.clear(f,!0,!0,!0);this.disableScissor()};d.prototype.enableScissor=function(b,d,h,k){var g=this._gl;g.enable(g.SCISSOR_TEST);g.scissor(b,d,h,k)};d.prototype.disableScissor=function(){var b=this._gl;b.disable(b.SCISSOR_TEST)};d.prototype._reportDrawCall=function(){this._drawCalls.addCount(1,!1)};d.prototype.initWebVR=function(){throw G.a.WarnImport("WebVRCamera");};d.prototype._prepareVRComponent=
function(){};d.prototype._connectVREvents=function(b,d){};d.prototype._submitVRFrame=function(){};d.prototype.disableVR=function(){};d.prototype.isVRPresenting=function(){return!1};d.prototype._requestVRFrame=function(){};d.prototype._loadFileAsync=function(b,d,h){var g=this;return new Promise(function(f,c){g._loadFile(b,function(a){f(a)},void 0,d,h,function(a,b){c(b)})})};d.prototype.getVertexShaderSource=function(b){return(b=this._gl.getAttachedShaders(b))?this._gl.getShaderSource(b[0]):null};d.prototype.getFragmentShaderSource=
function(b){return(b=this._gl.getAttachedShaders(b))?this._gl.getShaderSource(b[1]):null};d.prototype.setDepthStencilTexture=function(b,d,h){void 0!==b&&(d&&(this._boundUniforms[b]=d),h&&h.depthStencilTexture?this._setTexture(b,h,!1,!0):this._setTexture(b,null))};d.prototype.setTextureFromPostProcess=function(b,d){this._bindTexture(b,d?d._textures.data[d._currentRenderTextureInd]:null)};d.prototype.setTextureFromPostProcessOutput=function(b,d){this._bindTexture(b,d?d._outputTexture:null)};d.prototype._rebuildBuffers=
function(){for(var b=0,d=this.scenes;b<d.length;b++){var q=d[b];q.resetCachedMaterial();q._rebuildGeometries();q._rebuildTextures()}h.prototype._rebuildBuffers.call(this)};d.prototype._renderFrame=function(){for(var b=0;b<this._activeRenderLoops.length;b++)(0,this._activeRenderLoops[b])()};d.prototype._renderLoop=function(){if(!this._contextWasLost){var b=!0;!this.renderEvenInBackground&&this._windowIsBackground&&(b=!1);b&&(this.beginFrame(),this._renderViews()||this._renderFrame(),this.endFrame())}0<
this._activeRenderLoops.length?this.customAnimationFrameRequester?(this.customAnimationFrameRequester.requestID=this._queueNewFrame(this.customAnimationFrameRequester.renderFunction||this._boundRenderFunction,this.customAnimationFrameRequester),this._frameHandler=this.customAnimationFrameRequester.requestID):this.isVRPresenting()?this._requestVRFrame():this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow()):this._renderingQueueLaunched=!1};d.prototype._renderViews=function(){return!1};
d.prototype.switchFullscreen=function(b){this.isFullscreen?this.exitFullscreen():this.enterFullscreen(b)};d.prototype.enterFullscreen=function(b){this.isFullscreen||(this._pointerLockRequested=b,this._renderingCanvas&&d._RequestFullscreen(this._renderingCanvas))};d.prototype.exitFullscreen=function(){this.isFullscreen&&d._ExitFullscreen()};d.prototype.enterPointerlock=function(){this._renderingCanvas&&d._RequestPointerlock(this._renderingCanvas)};d.prototype.exitPointerlock=function(){d._ExitPointerlock()};
d.prototype.beginFrame=function(){this._measureFps();this.onBeginFrameObservable.notifyObservers(this);h.prototype.beginFrame.call(this)};d.prototype.endFrame=function(){h.prototype.endFrame.call(this);this._submitVRFrame();this.onEndFrameObservable.notifyObservers(this)};d.prototype.resize=function(){this.isVRPresenting()||h.prototype.resize.call(this)};d.prototype.setSize=function(b,d){if(!this._renderingCanvas||!h.prototype.setSize.call(this,b,d))return!1;if(this.scenes){for(b=0;b<this.scenes.length;b++){d=
this.scenes[b];for(var g=0;g<d.cameras.length;g++)d.cameras[g]._currentRenderId=0}this.onResizeObservable.hasObservers()&&this.onResizeObservable.notifyObservers(this)}return!0};d.prototype._deletePipelineContext=function(b){b&&b.program&&b.transformFeedback&&(this.deleteTransformFeedback(b.transformFeedback),b.transformFeedback=null);h.prototype._deletePipelineContext.call(this,b)};d.prototype.createShaderProgram=function(b,d,q,k,f,c){void 0===c&&(c=null);f=f||this._gl;this.onBeforeShaderCompilationObservable.notifyObservers(this);
b=h.prototype.createShaderProgram.call(this,b,d,q,k,f,c);this.onAfterShaderCompilationObservable.notifyObservers(this);return b};d.prototype._createShaderProgram=function(b,d,h,k,f){void 0===f&&(f=null);var c=k.createProgram();b.program=c;if(!c)throw Error("Unable to create program");k.attachShader(c,d);k.attachShader(c,h);if(1<this.webGLVersion&&f){var a=this.createTransformFeedback();this.bindTransformFeedback(a);this.setTranformFeedbackVaryings(c,f);b.transformFeedback=a}k.linkProgram(c);1<this.webGLVersion&&
f&&this.bindTransformFeedback(null);b.context=k;b.vertexShader=d;b.fragmentShader=h;b.isParallelCompiled||this._finalizePipelineContext(b);return c};d.prototype._releaseTexture=function(b){h.prototype._releaseTexture.call(this,b);this.scenes.forEach(function(d){d.postProcesses.forEach(function(d){d._outputTexture==b&&(d._outputTexture=null)});d.cameras.forEach(function(d){d._postProcesses.forEach(function(d){d&&d._outputTexture==b&&(d._outputTexture=null)})})})};d.prototype._rescaleTexture=function(b,
h,k,n,f){var c=this;this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR);this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR);this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE);this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE);var a=this.createRenderTargetTexture({width:h.width,height:h.height},{generateMipMaps:!1,type:0,samplingMode:2,generateDepthBuffer:!1,
generateStencilBuffer:!1});!this._rescalePostProcess&&d._RescalePostProcessFactory&&(this._rescalePostProcess=d._RescalePostProcessFactory(this));this._rescalePostProcess.getEffect().executeWhenCompiled(function(){c._rescalePostProcess.onApply=function(a){a._bindTexture("textureSampler",b)};var d=k;d||(d=c.scenes[c.scenes.length-1]);d.postProcessManager.directRender([c._rescalePostProcess],a,!0);c._bindTextureDirectly(c._gl.TEXTURE_2D,h,!0);c._gl.copyTexImage2D(c._gl.TEXTURE_2D,0,n,0,0,h.width,h.height,
0);c.unBindFramebuffer(a);c._releaseTexture(a);f&&f()})};d.prototype.getFps=function(){return this._fps};d.prototype.getDeltaTime=function(){return this._deltaTime};d.prototype._measureFps=function(){this._performanceMonitor.sampleFrame();this._fps=this._performanceMonitor.averageFPS;this._deltaTime=this._performanceMonitor.instantaneousFrameTime||0};d.prototype._uploadImageToTexture=function(b,d,h,k){void 0===h&&(h=0);void 0===k&&(k=0);var g=this._gl,c=this._getWebGLTextureType(b.type),a=this._getInternalFormat(b.format),
e=this._getRGBABufferInternalSizedFormat(b.type,a),l=b.isCube?g.TEXTURE_CUBE_MAP:g.TEXTURE_2D;this._bindTextureDirectly(l,b,!0);this._unpackFlipY(b.invertY);var q=g.TEXTURE_2D;b.isCube&&(q=g.TEXTURE_CUBE_MAP_POSITIVE_X+h);g.texImage2D(q,k,e,a,c,d);this._bindTextureDirectly(l,null,!0)};d.prototype.updateRenderTargetTextureSampleCount=function(b,d){if(2>this.webGLVersion||!b)return 1;if(b.samples===d)return d;var g=this._gl;d=Math.min(d,this.getCaps().maxMSAASamples);b._depthStencilBuffer&&(g.deleteRenderbuffer(b._depthStencilBuffer),
b._depthStencilBuffer=null);b._MSAAFramebuffer&&(g.deleteFramebuffer(b._MSAAFramebuffer),b._MSAAFramebuffer=null);b._MSAARenderBuffer&&(g.deleteRenderbuffer(b._MSAARenderBuffer),b._MSAARenderBuffer=null);if(1<d&&g.renderbufferStorageMultisample){var h=g.createFramebuffer();if(!h)throw Error("Unable to create multi sampled framebuffer");b._MSAAFramebuffer=h;this._bindUnboundFramebuffer(b._MSAAFramebuffer);h=g.createRenderbuffer();if(!h)throw Error("Unable to create multi sampled framebuffer");g.bindRenderbuffer(g.RENDERBUFFER,
h);g.renderbufferStorageMultisample(g.RENDERBUFFER,d,this._getRGBAMultiSampleBufferFormat(b.type),b.width,b.height);g.framebufferRenderbuffer(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.RENDERBUFFER,h);b._MSAARenderBuffer=h}else this._bindUnboundFramebuffer(b._framebuffer);b.samples=d;b._depthStencilBuffer=this._setupFramebufferDepthAttachments(b._generateStencilBuffer,b._generateDepthBuffer,b.width,b.height,d);this._bindUnboundFramebuffer(null);return d};d.prototype.updateTextureComparisonFunction=function(b,
d){if(1===this.webGLVersion)A.a.Error("WebGL 1 does not support texture comparison.");else{var g=this._gl;b.isCube?(this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,b,!0),0===d?(g.texParameteri(g.TEXTURE_CUBE_MAP,g.TEXTURE_COMPARE_FUNC,515),g.texParameteri(g.TEXTURE_CUBE_MAP,g.TEXTURE_COMPARE_MODE,g.NONE)):(g.texParameteri(g.TEXTURE_CUBE_MAP,g.TEXTURE_COMPARE_FUNC,d),g.texParameteri(g.TEXTURE_CUBE_MAP,g.TEXTURE_COMPARE_MODE,g.COMPARE_REF_TO_TEXTURE)),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,
null)):(this._bindTextureDirectly(this._gl.TEXTURE_2D,b,!0),0===d?(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_COMPARE_FUNC,515),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_COMPARE_MODE,g.NONE)):(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_COMPARE_FUNC,d),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_COMPARE_MODE,g.COMPARE_REF_TO_TEXTURE)),this._bindTextureDirectly(this._gl.TEXTURE_2D,null));b._comparisonFunction=d}};d.prototype.createInstancesBuffer=function(b){var d=this._gl.createBuffer();if(!d)throw Error("Unable to create instance buffer");
d=new B.a(d);d.capacity=b;this.bindArrayBuffer(d);this._gl.bufferData(this._gl.ARRAY_BUFFER,b,this._gl.DYNAMIC_DRAW);return d};d.prototype.deleteInstancesBuffer=function(b){this._gl.deleteBuffer(b)};d.prototype._clientWaitAsync=function(b,d,h){void 0===d&&(d=0);void 0===h&&(h=10);var g=this._gl;return new Promise(function(f,c){var a=function(){var e=g.clientWaitSync(b,d,0);e==g.WAIT_FAILED?c():e==g.TIMEOUT_EXPIRED?setTimeout(a,h):f()};a()})};d.prototype._readPixelsAsync=function(b,d,h,k,f,c,a){if(2>
this._webGLVersion)throw Error("_readPixelsAsync only work on WebGL2+");var e=this._gl,g=e.createBuffer();e.bindBuffer(e.PIXEL_PACK_BUFFER,g);e.bufferData(e.PIXEL_PACK_BUFFER,a.byteLength,e.STREAM_READ);e.readPixels(b,d,h,k,f,c,0);e.bindBuffer(e.PIXEL_PACK_BUFFER,null);var m=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);if(!m)return null;e.flush();return this._clientWaitAsync(m,0,10).then(function(){e.deleteSync(m);e.bindBuffer(e.PIXEL_PACK_BUFFER,g);e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,a);e.bindBuffer(e.PIXEL_PACK_BUFFER,
null);e.deleteBuffer(g);return a})};d.prototype.dispose=function(){this.hideLoadingUI();for(this.onNewSceneAddedObservable.clear();this.postProcesses.length;)this.postProcesses[0].dispose();for(this._rescalePostProcess&&this._rescalePostProcess.dispose();this.scenes.length;)this.scenes[0].dispose();1===d.Instances.length&&d.audioEngine&&d.audioEngine.dispose();this.disableVR();z.a.IsWindowObjectExist()&&(window.removeEventListener("blur",this._onBlur),window.removeEventListener("focus",this._onFocus),
this._renderingCanvas&&(this._renderingCanvas.removeEventListener("focus",this._onCanvasFocus),this._renderingCanvas.removeEventListener("blur",this._onCanvasBlur),this._renderingCanvas.removeEventListener("pointerout",this._onCanvasPointerOut)),z.a.IsDocumentAvailable()&&(document.removeEventListener("fullscreenchange",this._onFullscreenChange),document.removeEventListener("mozfullscreenchange",this._onFullscreenChange),document.removeEventListener("webkitfullscreenchange",this._onFullscreenChange),
document.removeEventListener("msfullscreenchange",this._onFullscreenChange),document.removeEventListener("pointerlockchange",this._onPointerLockChange),document.removeEventListener("mspointerlockchange",this._onPointerLockChange),document.removeEventListener("mozpointerlockchange",this._onPointerLockChange),document.removeEventListener("webkitpointerlockchange",this._onPointerLockChange)));h.prototype.dispose.call(this);var b=d.Instances.indexOf(this);0<=b&&d.Instances.splice(b,1);this.onResizeObservable.clear();
this.onCanvasBlurObservable.clear();this.onCanvasFocusObservable.clear();this.onCanvasPointerOutObservable.clear();this.onBeginFrameObservable.clear();this.onEndFrameObservable.clear()};d.prototype._disableTouchAction=function(){this._renderingCanvas&&this._renderingCanvas.setAttribute&&(this._renderingCanvas.setAttribute("touch-action","none"),this._renderingCanvas.style.touchAction="none",this._renderingCanvas.style.msTouchAction="none")};d.prototype.displayLoadingUI=function(){if(z.a.IsWindowObjectExist()){var b=
this.loadingScreen;b&&b.displayLoadingUI()}};d.prototype.hideLoadingUI=function(){if(z.a.IsWindowObjectExist()){var b=this._loadingScreen;b&&b.hideLoadingUI()}};Object.defineProperty(d.prototype,"loadingScreen",{get:function(){!this._loadingScreen&&this._renderingCanvas&&(this._loadingScreen=d.DefaultLoadingScreenFactory(this._renderingCanvas));return this._loadingScreen},set:function(b){this._loadingScreen=b},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"loadingUIText",{set:function(b){this.loadingScreen.loadingUIText=
b},enumerable:!1,configurable:!0});Object.defineProperty(d.prototype,"loadingUIBackgroundColor",{set:function(b){this.loadingScreen.loadingUIBackgroundColor=b},enumerable:!1,configurable:!0});d._RequestPointerlock=function(b){b.requestPointerLock=b.requestPointerLock||b.msRequestPointerLock||b.mozRequestPointerLock||b.webkitRequestPointerLock;b.requestPointerLock&&b.requestPointerLock()};d._ExitPointerlock=function(){var b=document;document.exitPointerLock=document.exitPointerLock||b.msExitPointerLock||
b.mozExitPointerLock||b.webkitExitPointerLock;document.exitPointerLock&&document.exitPointerLock()};d._RequestFullscreen=function(b){var d=b.requestFullscreen||b.msRequestFullscreen||b.webkitRequestFullscreen||b.mozRequestFullScreen;d&&d.call(b)};d._ExitFullscreen=function(){var b=document;document.exitFullscreen?document.exitFullscreen():b.mozCancelFullScreen?b.mozCancelFullScreen():b.webkitCancelFullScreen?b.webkitCancelFullScreen():b.msCancelFullScreen&&b.msCancelFullScreen()};d.ALPHA_DISABLE=
0;d.ALPHA_ADD=1;d.ALPHA_COMBINE=2;d.ALPHA_SUBTRACT=3;d.ALPHA_MULTIPLY=4;d.ALPHA_MAXIMIZED=5;d.ALPHA_ONEONE=6;d.ALPHA_PREMULTIPLIED=7;d.ALPHA_PREMULTIPLIED_PORTERDUFF=8;d.ALPHA_INTERPOLATE=9;d.ALPHA_SCREENMODE=10;d.DELAYLOADSTATE_NONE=0;d.DELAYLOADSTATE_LOADED=1;d.DELAYLOADSTATE_LOADING=2;d.DELAYLOADSTATE_NOTLOADED=4;d.NEVER=512;d.ALWAYS=519;d.LESS=513;d.EQUAL=514;d.LEQUAL=515;d.GREATER=516;d.GEQUAL=518;d.NOTEQUAL=517;d.KEEP=7680;d.REPLACE=7681;d.INCR=7682;d.DECR=7683;d.INVERT=5386;d.INCR_WRAP=34055;
d.DECR_WRAP=34056;d.TEXTURE_CLAMP_ADDRESSMODE=0;d.TEXTURE_WRAP_ADDRESSMODE=1;d.TEXTURE_MIRROR_ADDRESSMODE=2;d.TEXTUREFORMAT_ALPHA=0;d.TEXTUREFORMAT_LUMINANCE=1;d.TEXTUREFORMAT_LUMINANCE_ALPHA=2;d.TEXTUREFORMAT_RGB=4;d.TEXTUREFORMAT_RGBA=5;d.TEXTUREFORMAT_RED=6;d.TEXTUREFORMAT_R=6;d.TEXTUREFORMAT_RG=7;d.TEXTUREFORMAT_RED_INTEGER=8;d.TEXTUREFORMAT_R_INTEGER=8;d.TEXTUREFORMAT_RG_INTEGER=9;d.TEXTUREFORMAT_RGB_INTEGER=10;d.TEXTUREFORMAT_RGBA_INTEGER=11;d.TEXTURETYPE_UNSIGNED_BYTE=0;d.TEXTURETYPE_UNSIGNED_INT=
0;d.TEXTURETYPE_FLOAT=1;d.TEXTURETYPE_HALF_FLOAT=2;d.TEXTURETYPE_BYTE=3;d.TEXTURETYPE_SHORT=4;d.TEXTURETYPE_UNSIGNED_SHORT=5;d.TEXTURETYPE_INT=6;d.TEXTURETYPE_UNSIGNED_INTEGER=7;d.TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4=8;d.TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1=9;d.TEXTURETYPE_UNSIGNED_SHORT_5_6_5=10;d.TEXTURETYPE_UNSIGNED_INT_2_10_10_10_REV=11;d.TEXTURETYPE_UNSIGNED_INT_24_8=12;d.TEXTURETYPE_UNSIGNED_INT_10F_11F_11F_REV=13;d.TEXTURETYPE_UNSIGNED_INT_5_9_9_9_REV=14;d.TEXTURETYPE_FLOAT_32_UNSIGNED_INT_24_8_REV=
15;d.TEXTURE_NEAREST_SAMPLINGMODE=1;d.TEXTURE_BILINEAR_SAMPLINGMODE=2;d.TEXTURE_TRILINEAR_SAMPLINGMODE=3;d.TEXTURE_NEAREST_NEAREST_MIPLINEAR=8;d.TEXTURE_LINEAR_LINEAR_MIPNEAREST=11;d.TEXTURE_LINEAR_LINEAR_MIPLINEAR=3;d.TEXTURE_NEAREST_NEAREST_MIPNEAREST=4;d.TEXTURE_NEAREST_LINEAR_MIPNEAREST=5;d.TEXTURE_NEAREST_LINEAR_MIPLINEAR=6;d.TEXTURE_NEAREST_LINEAR=7;d.TEXTURE_NEAREST_NEAREST=1;d.TEXTURE_LINEAR_NEAREST_MIPNEAREST=9;d.TEXTURE_LINEAR_NEAREST_MIPLINEAR=10;d.TEXTURE_LINEAR_LINEAR=2;d.TEXTURE_LINEAR_NEAREST=
12;d.TEXTURE_EXPLICIT_MODE=0;d.TEXTURE_SPHERICAL_MODE=1;d.TEXTURE_PLANAR_MODE=2;d.TEXTURE_CUBIC_MODE=3;d.TEXTURE_PROJECTION_MODE=4;d.TEXTURE_SKYBOX_MODE=5;d.TEXTURE_INVCUBIC_MODE=6;d.TEXTURE_EQUIRECTANGULAR_MODE=7;d.TEXTURE_FIXED_EQUIRECTANGULAR_MODE=8;d.TEXTURE_FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9;d.SCALEMODE_FLOOR=1;d.SCALEMODE_NEAREST=2;d.SCALEMODE_CEILING=3;d._RescalePostProcessFactory=null;return d}(t.a)}}]);

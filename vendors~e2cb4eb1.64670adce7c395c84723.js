var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(b){var h=0;return function(){return h<b.length?{done:!1,value:b[h++]}:{done:!0}}};$jscomp.arrayIterator=function(b){return{next:$jscomp.arrayIteratorImpl(b)}};$jscomp.makeIterator=function(b){var h="undefined"!=typeof Symbol&&Symbol.iterator&&b[Symbol.iterator];return h?h.call(b):$jscomp.arrayIterator(b)};
$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,h,d){b!=Array.prototype&&b!=Object.prototype&&(b[h]=d.value)};
$jscomp.polyfill=function(b,h,d,a){if(h){d=$jscomp.global;b=b.split(".");for(a=0;a<b.length-1;a++){var e=b[a];e in d||(d[e]={});d=d[e]}b=b[b.length-1];a=d[b];h=h(a);h!=a&&null!=h&&$jscomp.defineProperty(d,b,{configurable:!0,writable:!0,value:h})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(b){function h(){this.batch_=null}function d(a){return a instanceof e?a:new e(function(k,m){k(a)})}if(b&&!$jscomp.FORCE_POLYFILL_PROMISE)return b;h.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var k=this;this.asyncExecuteFunction(function(){k.executeBatch_()})}this.batch_.push(a)};var a=$jscomp.global.setTimeout;h.prototype.asyncExecuteFunction=function(k){a(k,0)};h.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var m=a[b];a[b]=null;try{m()}catch(p){this.asyncThrow_(p)}}}this.batch_=null};h.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(m){b.reject(m)}};e.prototype.createResolveAndReject_=function(){function a(a){return function(k){m||(m=!0,a.call(b,k))}}var b=this,m=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var b=void 0;try{b=a.then}catch(m){this.reject_(m);return}"function"==typeof b?
this.settleSameAsThenable_(b,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)n.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var n=new h;e.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};e.prototype.settleSameAsThenable_=function(a,b){var m=this.createResolveAndReject_();try{a.call(b,m.resolve,m.reject)}catch(p){m.reject(p)}};e.prototype.then=function(a,b){function m(c,a){return"function"==typeof c?function(a){try{p(c(a))}catch(u){d(u)}}:a}var p,d,c=new e(function(c,a){p=c;d=a});this.callWhenSettled_(m(a,p),m(b,d));return c};
e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,b){function m(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?n.asyncExecute(m):this.onSettledCallbacks_.push(m)};e.resolve=d;e.reject=function(a){return new e(function(b,m){m(a)})};e.race=function(a){return new e(function(b,m){for(var p=$jscomp.makeIterator(a),e=p.next();!e.done;e=p.next())d(e.value).callWhenSettled_(b,
m)})};e.all=function(a){var b=$jscomp.makeIterator(a),m=b.next();return m.done?d([]):new e(function(a,e){function c(c){return function(b){f[c]=b;g--;0==g&&a(f)}}var f=[],g=0;do f.push(void 0),g++,d(m.value).callWhenSettled_(c(f.length-1),e),m=b.next();while(!m.done)})};return e},"es6","es3");$jscomp.checkEs6ConformanceViaProxy=function(){try{var b={},h=Object.create(new $jscomp.global.Proxy(b,{get:function(d,a,e){return d==b&&"q"==a&&e==h}}));return!0===h.q}catch(d){return!1}};
$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(b,h){this.$jscomp$symbol$id_=b;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:h})};
$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function b(d){if(this instanceof b)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(d||"")+"_"+h++,d)}var h=0;return b}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.asyncIterator;b||(b=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};$jscomp.owns=function(b,h){return Object.prototype.hasOwnProperty.call(b,h)};
$jscomp.polyfill("WeakMap",function(b){function h(){if(!b||!Object.seal)return!1;try{var a=Object.seal({}),d=Object.seal({}),e=new b([[a,2],[d,3]]);if(2!=e.get(a)||3!=e.get(d))return!1;e.delete(a);e.set(d,4);return!e.has(a)&&4==e.get(d)}catch(c){return!1}}function d(){}function a(a){if(!$jscomp.owns(a,n)){var b=new d;$jscomp.defineProperty(a,n,{value:b})}}function e(b){var m=Object[b];m&&(Object[b]=function(b){if(b instanceof d)return b;a(b);return m(b)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&
$jscomp.ES6_CONFORMANCE)return b}else if(h())return b;var n="$jscomp_hidden_"+Math.random();e("freeze");e("preventExtensions");e("seal");var k=0,r=function(a){this.id_=(k+=Math.random()+1).toString();if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};r.prototype.set=function(b,d){a(b);if(!$jscomp.owns(b,n))throw Error("WeakMap key fail: "+b);b[n][this.id_]=d;return this};r.prototype.get=function(a){return $jscomp.owns(a,n)?a[n][this.id_]:void 0};r.prototype.has=
function(a){return $jscomp.owns(a,n)&&$jscomp.owns(a[n],this.id_)};r.prototype.delete=function(a){return $jscomp.owns(a,n)&&$jscomp.owns(a[n],this.id_)?delete a[n][this.id_]:!1};return r},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(b){function h(){if($jscomp.ASSUME_NO_NATIVE_MAP||!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),d=new b($jscomp.makeIterator([[a,"s"]]));if("s"!=d.get(a)||1!=d.size||d.get({x:4})||d.set({x:4},"t")!=d||2!=d.size)return!1;var e=d.entries(),c=e.next();if(c.done||c.value[0]!=a||"s"!=c.value[1])return!1;c=e.next();return c.done||4!=c.value[0].x||"t"!=c.value[1]||!e.next().done?!1:!0}catch(f){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE)return b}else if(h())return b;$jscomp.initSymbolIterator();var d=new WeakMap,a=function(a){this.data_={};this.head_=k();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};a.prototype.set=function(a,b){a=0===a?0:a;var d=e(this,a);d.list||(d.list=this.data_[d.id]=[]);d.entry?d.entry.value=b:(d.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,
value:b},d.list.push(d.entry),this.head_.previous.next=d.entry,this.head_.previous=d.entry,this.size++);return this};a.prototype.delete=function(a){a=e(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};a.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=k();this.size=0};a.prototype.has=function(a){return!!e(this,a).entry};
a.prototype.get=function(a){return(a=e(this,a).entry)&&a.value};a.prototype.entries=function(){return n(this,function(a){return[a.key,a.value]})};a.prototype.keys=function(){return n(this,function(a){return a.key})};a.prototype.values=function(){return n(this,function(a){return a.value})};a.prototype.forEach=function(a,b){for(var d=this.entries(),c;!(c=d.next()).done;)c=c.value,a.call(b,c[1],c[0],this)};a.prototype[Symbol.iterator]=a.prototype.entries;var e=function(a,b){var e=b&&typeof b;"object"==
e||"function"==e?d.has(b)?e=d.get(b):(e=""+ ++r,d.set(b,e)):e="p_"+b;var c=a.data_[e];if(c&&$jscomp.owns(a.data_,e))for(a=0;a<c.length;a++){var f=c[a];if(b!==b&&f.key!==f.key||b===f.key)return{id:e,list:c,index:a,entry:f}}return{id:e,list:c,index:-1,entry:void 0}},n=function(a,b){var d=a.head_;return $jscomp.iteratorPrototype(function(){if(d){for(;d.head!=a.head_;)d=d.previous;for(;d.next!=d.head;)return d=d.next,{done:!1,value:b(d)};d=null}return{done:!0,value:void 0}})},k=function(){var a={};return a.previous=
a.next=a.head=a},r=0;return a},"es6","es3");
$jscomp.polyfill("Set",function(b){function h(){if($jscomp.ASSUME_NO_NATIVE_SET||!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),d=new b($jscomp.makeIterator([a]));if(!d.has(a)||1!=d.size||d.add(a)!=d||1!=d.size||d.add({x:4})!=d||2!=d.size)return!1;var h=d.entries(),k=h.next();if(k.done||k.value[0]!=a||k.value[1]!=a)return!1;k=h.next();return k.done||k.value[0]==a||4!=k.value[0].x||k.value[1]!=k.value[0]?!1:h.next().done}catch(r){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE)return b}else if(h())return b;$jscomp.initSymbolIterator();var d=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)this.add(b.value)}this.size=this.map_.size};d.prototype.add=function(a){a=0===a?0:a;this.map_.set(a,a);this.size=this.map_.size;return this};d.prototype.delete=function(a){a=this.map_.delete(a);this.size=this.map_.size;return a};d.prototype.clear=function(){this.map_.clear();
this.size=0};d.prototype.has=function(a){return this.map_.has(a)};d.prototype.entries=function(){return this.map_.entries()};d.prototype.values=function(){return this.map_.values()};d.prototype.keys=d.prototype.values;d.prototype[Symbol.iterator]=d.prototype.values;d.prototype.forEach=function(a,b){var d=this;this.map_.forEach(function(e){return a.call(b,e,e,d)})};return d},"es6","es3");
$jscomp.iteratorFromArray=function(b,h){$jscomp.initSymbolIterator();b instanceof String&&(b+="");var d=0,a={next:function(){if(d<b.length){var e=d++;return{value:h(e,b[e]),done:!1}}a.next=function(){return{done:!0,value:void 0}};return a.next()}};a[Symbol.iterator]=function(){return a};return a};$jscomp.polyfill("Array.prototype.keys",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(b){return b})}},"es6","es3");
(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{"8y7U":function(b,h,d){var a=d("/SR9"),e=d("kdvT"),n=d("K5KS"),k=d("Xeau");b=function(){function c(l,b,f,d,g,v){void 0===b&&(b=1);void 0===f&&(f=2);this._scaleLinesFactor=4;this._instanced=!1;this.scene=null;this.scaleLines=1;this.scaleLines=b;d||(d=new e.a("",l),d.disableLighting=!0,d.emissiveColor=k.a.Red().scale(.5),d=n.a._CreateArrow(l,d));g||(g=new e.a("",l),g.disableLighting=!0,g.emissiveColor=k.a.Green().scale(.5),g=n.a._CreateArrow(l,
g));v||(v=new e.a("",l),v.disableLighting=!0,v.emissiveColor=k.a.Blue().scale(.5),v=n.a._CreateArrow(l,v));this._xAxis=d;this._xAxis.scaling.setAll(this.scaleLines*this._scaleLinesFactor);this._yAxis=g;this._yAxis.scaling.setAll(this.scaleLines*this._scaleLinesFactor);this._zAxis=v;this._zAxis.scaling.setAll(this.scaleLines*this._scaleLinesFactor);null!=f&&(c._SetRenderingGroupId(this._xAxis,f),c._SetRenderingGroupId(this._yAxis,f),c._SetRenderingGroupId(this._zAxis,f));this.scene=l;this.update(new a.e,
a.e.Right(),a.e.Up(),a.e.Forward())}Object.defineProperty(c.prototype,"xAxis",{get:function(){return this._xAxis},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"yAxis",{get:function(){return this._yAxis},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"zAxis",{get:function(){return this._zAxis},enumerable:!1,configurable:!0});c.prototype.update=function(a,c,b,f){this._xAxis.position.copyFrom(a);this._xAxis.setDirection(c);this._xAxis.scaling.setAll(this.scaleLines*
this._scaleLinesFactor);this._yAxis.position.copyFrom(a);this._yAxis.setDirection(b);this._yAxis.scaling.setAll(this.scaleLines*this._scaleLinesFactor);this._zAxis.position.copyFrom(a);this._zAxis.setDirection(f);this._zAxis.scaling.setAll(this.scaleLines*this._scaleLinesFactor)};c.prototype.createInstance=function(){var a=n.a._CreateArrowInstance(this.scene,this._xAxis),b=n.a._CreateArrowInstance(this.scene,this._yAxis),f=n.a._CreateArrowInstance(this.scene,this._zAxis);a=new c(this.scene,this.scaleLines,
null,a,b,f);a._instanced=!0;return a};c.prototype.dispose=function(){this._xAxis&&this._xAxis.dispose(!1,!this._instanced);this._yAxis&&this._yAxis.dispose(!1,!this._instanced);this._zAxis&&this._zAxis.dispose(!1,!this._instanced);this.scene=null};c._SetRenderingGroupId=function(a,c){a.getChildMeshes().forEach(function(a){a.renderingGroupId=c})};return c}();var r=d("oYeq"),m=d("SYzJ");(function(c){function b(b,l,f,d){void 0===d&&(d=1);b=c.call(this,b,d)||this;b.pos=a.e.Zero();b.xaxis=a.e.Zero();b.yaxis=
a.e.Zero();b.zaxis=a.e.Zero();b.mesh=f;b.bone=l;return b}Object(r.d)(b,c);b.prototype.update=function(){if(this.mesh&&this.bone){var a=this.bone;a._markAsDirtyAndCompose();a.getAbsolutePositionToRef(this.mesh,this.pos);a.getDirectionToRef(m.a.X,this.mesh,this.xaxis);a.getDirectionToRef(m.a.Y,this.mesh,this.yaxis);a.getDirectionToRef(m.a.Z,this.mesh,this.zaxis);c.prototype.update.call(this,this.pos,this.xaxis,this.yaxis,this.zaxis)}};b.prototype.dispose=function(){this.mesh&&(this.bone=this.mesh=null,
c.prototype.dispose.call(this))};return b})(b);var p=d("YKqZ"),B=d("ps+7");b=d("tVVT");var c=d("qUIE");Object.defineProperty(b.a.prototype,"debugLayer",{get:function(){this._debugLayer||(this._debugLayer=new g(this));return this._debugLayer},enumerable:!0,configurable:!0});var f;(function(a){a[a.Properties=0]="Properties";a[a.Debug=1]="Debug";a[a.Statistics=2]="Statistics";a[a.Tools=3]="Tools";a[a.Settings=4]="Settings"})(f||(f={}));var g=function(){function a(a){var c=this;this.BJSINSPECTOR=this._getGlobalInspector();
this._scene=a;this._scene.onDisposeObservable.add(function(){c._scene._debugLayer&&c._scene._debugLayer.hide()})}Object.defineProperty(a.prototype,"onPropertyChangedObservable",{get:function(){if(this.BJSINSPECTOR&&this.BJSINSPECTOR.Inspector)return this.BJSINSPECTOR.Inspector.OnPropertyChangedObservable;this._onPropertyChangedObservable||(this._onPropertyChangedObservable=new B.a);return this._onPropertyChangedObservable},enumerable:!1,configurable:!0});a.prototype._createInspector=function(a){if(!this.isVisible()){if(this._onPropertyChangedObservable){for(var c=
0,b=this._onPropertyChangedObservable.observers;c<b.length;c++)this.BJSINSPECTOR.Inspector.OnPropertyChangedObservable.add(b[c]);this._onPropertyChangedObservable.clear();this._onPropertyChangedObservable=void 0}a=Object(r.a)({overlay:!1,showExplorer:!0,showInspector:!0,embedMode:!1,handleResize:!0,enablePopup:!0},a);this.BJSINSPECTOR=this.BJSINSPECTOR||this._getGlobalInspector();this.BJSINSPECTOR.Inspector.Show(this._scene,a)}};a.prototype.select=function(a,c){this.BJSINSPECTOR&&(c&&("[object String]"==
Object.prototype.toString.call(c)?this.BJSINSPECTOR.Inspector.MarkLineContainerTitleForHighlighting(c):this.BJSINSPECTOR.Inspector.MarkMultipleLineContainerTitlesForHighlighting(c)),this.BJSINSPECTOR.Inspector.OnSelectionChangeObservable.notifyObservers(a))};a.prototype._getGlobalInspector=function(){if("undefined"!==typeof INSPECTOR)return INSPECTOR;if("undefined"!==typeof BABYLON&&"undefined"!==typeof BABYLON.Inspector)return BABYLON};a.prototype.isVisible=function(){return this.BJSINSPECTOR&&this.BJSINSPECTOR.Inspector.IsVisible};
a.prototype.hide=function(){this.BJSINSPECTOR&&this.BJSINSPECTOR.Inspector.Hide()};a.prototype.setAsActiveScene=function(){this.BJSINSPECTOR&&this.BJSINSPECTOR.Inspector._SetNewScene(this._scene)};a.prototype.show=function(c){var b=this;return new Promise(function(l,f){"undefined"==typeof b.BJSINSPECTOR?p.b.LoadScript(c&&c.inspectorURL?c.inspectorURL:a.InspectorURL,function(){b._createInspector(c);l(b)}):(b._createInspector(c),l(b))})};a.InspectorURL="https://unpkg.com/babylonjs-inspector@"+c.a.Version+
"/babylon.inspector.bundle.js";return a}(),q=d("wAMR"),u=d("HZbn"),w=d("H22S"),F=d("e2Mr"),t=d("LVN+"),y=d("zRBM"),A=d("5xLc");(function(){function c(a){this._impostors=[];this._meshes=[];this._numMeshes=0;this._debugMeshMeshes=[];this._scene=a||F.a.LastCreatedScene;if(a=this._scene.getPhysicsEngine())this._physicsEnginePlugin=a.getPhysicsPlugin();this._utilityLayer=new y.a(this._scene,!1);this._utilityLayer.pickUtilitySceneFirst=!1;this._utilityLayer.utilityLayerScene.autoClearDepthAndStencil=!0}
c.prototype._updateDebugMeshes=function(){for(var a=this._physicsEnginePlugin,c=0;c<this._numMeshes;c++){var b=this._impostors[c];if(b)if(b.isDisposed)this.hideImpostor(this._impostors[c--]);else if(b.type!==t.a.MeshImpostor){var f=this._meshes[c];f&&a&&a.syncMeshWithImpostor(f,b)}}};c.prototype.showImpostor=function(a,c){if(!this._scene)return null;for(var b=0;b<this._numMeshes;b++)if(this._impostors[b]==a)return null;if(c=this._getDebugMesh(a,c))this._impostors[this._numMeshes]=a,this._meshes[this._numMeshes]=
c,0===this._numMeshes&&(this._renderFunction=this._updateDebugMeshes.bind(this),this._scene.registerBeforeRender(this._renderFunction)),this._numMeshes++;return c};c.prototype.hideImpostor=function(a){if(a&&this._scene&&this._utilityLayer){for(var c=!1,b=this._utilityLayer.utilityLayerScene,f=0;f<this._numMeshes;f++)if(this._impostors[f]==a){var l=this._meshes[f];if(l){b.removeMesh(l);l.dispose();a=this._debugMeshMeshes.indexOf(l);-1<a&&this._debugMeshMeshes.splice(a,1);this._numMeshes--;0<this._numMeshes?
(this._meshes[f]=this._meshes[this._numMeshes],this._impostors[f]=this._impostors[this._numMeshes],this._meshes[this._numMeshes]=null,this._impostors[this._numMeshes]=null):(this._meshes[0]=null,this._impostors[0]=null);c=!0;break}}c&&0===this._numMeshes&&this._scene.unregisterBeforeRender(this._renderFunction)}};c.prototype._getDebugMaterial=function(a){this._debugMaterial||(this._debugMaterial=new e.a("",a),this._debugMaterial.wireframe=!0,this._debugMaterial.emissiveColor=k.a.White(),this._debugMaterial.disableLighting=
!0);return this._debugMaterial};c.prototype._getDebugBoxMesh=function(c){this._debugBoxMesh||(this._debugBoxMesh=u.a.CreateBox("physicsBodyBoxViewMesh",{size:1},c),this._debugBoxMesh.rotationQuaternion=a.b.Identity(),this._debugBoxMesh.material=this._getDebugMaterial(c),this._debugBoxMesh.setEnabled(!1));return this._debugBoxMesh.createInstance("physicsBodyBoxViewInstance")};c.prototype._getDebugSphereMesh=function(c){this._debugSphereMesh||(this._debugSphereMesh=w.a.CreateSphere("physicsBodySphereViewMesh",
{diameter:1},c),this._debugSphereMesh.rotationQuaternion=a.b.Identity(),this._debugSphereMesh.material=this._getDebugMaterial(c),this._debugSphereMesh.setEnabled(!1));return this._debugSphereMesh.createInstance("physicsBodyBoxViewInstance")};c.prototype._getDebugCylinderMesh=function(c){this._debugCylinderMesh||(this._debugCylinderMesh=A.a.CreateCylinder("physicsBodyCylinderViewMesh",{diameterTop:1,diameterBottom:1,height:1},c),this._debugCylinderMesh.rotationQuaternion=a.b.Identity(),this._debugCylinderMesh.material=
this._getDebugMaterial(c),this._debugCylinderMesh.setEnabled(!1));return this._debugCylinderMesh.createInstance("physicsBodyBoxViewInstance")};c.prototype._getDebugMeshMesh=function(c,b){var f=new q.a(c.name,b,null,c);f.position=a.e.Zero();f.setParent(c);f.material=this._getDebugMaterial(b);this._debugMeshMeshes.push(f);return f};c.prototype._getDebugMesh=function(a,c){var b=this;if(!this._utilityLayer||c&&c.parent&&c.parent.physicsImpostor)return null;var f=null,d=this._utilityLayer.utilityLayerScene;
switch(a.type){case t.a.BoxImpostor:f=this._getDebugBoxMesh(d);a.getBoxSizeToRef(f.scaling);break;case t.a.SphereImpostor:f=this._getDebugSphereMesh(d);a=a.getRadius();f.scaling.x=2*a;f.scaling.y=2*a;f.scaling.z=2*a;break;case t.a.MeshImpostor:c&&(f=this._getDebugMeshMesh(c,d));break;case t.a.NoImpostor:c&&c.getChildMeshes().filter(function(a){return a.physicsImpostor?1:0}).forEach(function(a){b._getDebugBoxMesh(d).parent=a});break;case t.a.CylinderImpostor:f=this._getDebugCylinderMesh(d),a=a.object.getBoundingInfo(),
f.scaling.x=a.boundingBox.maximum.x-a.boundingBox.minimum.x,f.scaling.y=a.boundingBox.maximum.y-a.boundingBox.minimum.y,f.scaling.z=a.boundingBox.maximum.z-a.boundingBox.minimum.z}return f};c.prototype.dispose=function(){for(var a=this._numMeshes,c=0;c<a;c++)this.hideImpostor(this._impostors[0]);this._debugBoxMesh&&this._debugBoxMesh.dispose();this._debugSphereMesh&&this._debugSphereMesh.dispose();this._debugCylinderMesh&&this._debugCylinderMesh.dispose();this._debugMaterial&&this._debugMaterial.dispose();
this._impostors.length=0;this._physicsEnginePlugin=this._scene=null;this._utilityLayer&&(this._utilityLayer.dispose(),this._utilityLayer=null)};return c})();var G=d("IIC5");(function(){function c(a){this.ray=a}c.CreateAndShow=function(a,b,f){a=new c(a);a.show(b,f);return a};c.prototype.show=function(a,c){if(!this._renderFunction&&this.ray){var b=this.ray;this._renderFunction=this._render.bind(this);this._scene=a;this._renderPoints=[b.origin,b.origin.add(b.direction.scale(b.length))];this._renderLine=
q.a.CreateLines("ray",this._renderPoints,a,!0);this._renderLine.isPickable=!1;this._renderFunction&&this._scene.registerBeforeRender(this._renderFunction)}c&&this._renderLine&&this._renderLine.color.copyFrom(c)};c.prototype.hide=function(){this._renderFunction&&this._scene&&(this._scene.unregisterBeforeRender(this._renderFunction),this._renderFunction=this._scene=null,this._renderLine&&(this._renderLine.dispose(),this._renderLine=null),this._renderPoints=[])};c.prototype._render=function(){var a=
this.ray;if(a){var c=this._renderPoints[1],b=Math.min(a.length,1E6);c.copyFrom(a.direction);c.scaleInPlace(b);c.addInPlace(a.origin);this._renderPoints[0].copyFrom(a.origin);q.a.CreateLines("ray",this._renderPoints,this._scene,!0,this._renderLine)}};c.prototype.attachToMesh=function(c,b,f,d){var g=this;this._attachedToMesh=c;var l=this.ray;l&&(l.direction||(l.direction=a.e.Zero()),l.origin||(l.origin=a.e.Zero()),d&&(l.length=d),f||(f=a.e.Zero()),b||(b=new a.e(0,0,-1)),this._scene||(this._scene=c.getScene()),
this._meshSpaceDirection?(this._meshSpaceDirection.copyFrom(b),this._meshSpaceOrigin.copyFrom(f)):(this._meshSpaceDirection=b.clone(),this._meshSpaceOrigin=f.clone()),this._onAfterRenderObserver||(this._onAfterRenderObserver=this._scene.onBeforeRenderObservable.add(function(){return g._updateToMesh()}),this._onAfterStepObserver=this._scene.onAfterStepObservable.add(function(){return g._updateToMesh()})),this._attachedToMesh.computeWorldMatrix(!0),this._updateToMesh())};c.prototype.detachFromMesh=
function(){this._attachedToMesh&&this._scene&&(this._onAfterRenderObserver&&(this._scene.onBeforeRenderObservable.remove(this._onAfterRenderObserver),this._scene.onAfterStepObservable.remove(this._onAfterStepObserver)),this._scene=this._onAfterStepObserver=this._onAfterRenderObserver=this._attachedToMesh=null)};c.prototype._updateToMesh=function(){var c=this.ray;this._attachedToMesh&&c&&(this._attachedToMesh._isDisposed?this.detachFromMesh():(this._attachedToMesh.getDirectionToRef(this._meshSpaceDirection,
c.direction),a.e.TransformCoordinatesToRef(this._meshSpaceOrigin,this._attachedToMesh.getWorldMatrix(),c.origin)))};c.prototype.dispose=function(){this.hide();this.detachFromMesh();this.ray=null};return c})();var H=d("cdI9"),I=d("NDL1"),L=d("WrCc"),z=d("y4Ty"),J=d("Z6Y1"),M=d("SgR9");(function(){function c(a,b,f,d,g,e){void 0===d&&(d=!0);void 0===g&&(g=3);void 0===e&&(e={});var l,q,x,u,h,m,v,w,D,C,n,E,p,r;this.skeleton=a;this.mesh=b;this.autoUpdateBonesMatrices=d;this.renderingGroupId=g;this.options=
e;this.color=k.a.White();this._debugLines=[];this._localAxes=null;this._isEnabled=!1;this._obs=null;this._scene=f;this._ready=!1;e.pauseAnimations=null!==(l=e.pauseAnimations)&&void 0!==l?l:!0;e.returnToRest=null!==(q=e.returnToRest)&&void 0!==q?q:!1;e.displayMode=null!==(x=e.displayMode)&&void 0!==x?x:c.DISPLAY_LINES;e.displayOptions=null!==(u=e.displayOptions)&&void 0!==u?u:{};e.displayOptions.midStep=null!==(h=e.displayOptions.midStep)&&void 0!==h?h:.235;e.displayOptions.midStepFactor=null!==(m=
e.displayOptions.midStepFactor)&&void 0!==m?m:.155;e.displayOptions.sphereBaseSize=null!==(v=e.displayOptions.sphereBaseSize)&&void 0!==v?v:.15;e.displayOptions.sphereScaleUnit=null!==(w=e.displayOptions.sphereScaleUnit)&&void 0!==w?w:2;e.displayOptions.sphereFactor=null!==(D=e.displayOptions.sphereFactor)&&void 0!==D?D:.865;e.displayOptions.spurFollowsChild=null!==(C=e.displayOptions.spurFollowsChild)&&void 0!==C?C:!1;e.displayOptions.showLocalAxes=null!==(n=e.displayOptions.showLocalAxes)&&void 0!==
n?n:!1;e.displayOptions.localAxesSize=null!==(E=e.displayOptions.localAxesSize)&&void 0!==E?E:.075;e.computeBonesUsingShaders=null!==(p=e.computeBonesUsingShaders)&&void 0!==p?p:!0;e.useAllBones=null!==(r=e.useAllBones)&&void 0!==r?r:!0;a=b.getVerticesData(z.b.MatricesIndicesKind);b=b.getVerticesData(z.b.MatricesWeightsKind);this._boneIndices=new Set;if(!e.useAllBones&&a&&b)for(e=0;e<a.length;++e)f=a[e],0!==b[e]&&this._boneIndices.add(f);this._utilityLayer=new y.a(this._scene,!1);this._utilityLayer.pickUtilitySceneFirst=
!1;this._utilityLayer.utilityLayerScene.autoClearDepthAndStencil=!0;e=this.options.displayMode||0;e>c.DISPLAY_SPHERE_AND_SPURS&&(e=c.DISPLAY_LINES);this.displayMode=e;this.update();this._bindObs()}c.CreateBoneWeightShader=function(a,c){var b,f,d,g,e,l,q=a.skeleton,x=null!==(b=a.colorBase)&&void 0!==b?b:k.a.Black();b=null!==(f=a.colorZero)&&void 0!==f?f:k.a.Blue();f=null!==(d=a.colorQuarter)&&void 0!==d?d:k.a.Green();d=null!==(g=a.colorHalf)&&void 0!==g?g:k.a.Yellow();g=null!==(e=a.colorFull)&&void 0!==
e?e:k.a.Red();a=null!==(l=a.targetBoneIndex)&&void 0!==l?l:0;J.a.ShadersStore["boneWeights:"+q.name+"VertexShader"]="precision highp float;\n\n        attribute vec3 position;\n        attribute vec2 uv;\n\n        uniform mat4 view;\n        uniform mat4 projection;\n        uniform mat4 worldViewProjection;\n\n        #include<bonesDeclaration>\n        #if NUM_BONE_INFLUENCERS == 0\n            attribute vec4 matricesIndices;\n            attribute vec4 matricesWeights;\n        #endif\n\n        #include<instancesDeclaration>\n\n        varying vec3 vColor;\n\n        uniform vec3 colorBase;\n        uniform vec3 colorZero;\n        uniform vec3 colorQuarter;\n        uniform vec3 colorHalf;\n        uniform vec3 colorFull;\n\n        uniform float targetBoneIndex;\n\n        void main() {\n            vec3 positionUpdated = position;\n\n            #include<instancesVertex>\n            #include<bonesVertex>\n\n            vec4 worldPos = finalWorld * vec4(positionUpdated, 1.0);\n\n            vec3 color = colorBase;\n            float totalWeight = 0.;\n            if(matricesIndices[0] == targetBoneIndex && matricesWeights[0] > 0.){\n                totalWeight += matricesWeights[0];\n            }\n            if(matricesIndices[1] == targetBoneIndex && matricesWeights[1] > 0.){\n                totalWeight += matricesWeights[1];\n            }\n            if(matricesIndices[2] == targetBoneIndex && matricesWeights[2] > 0.){\n                totalWeight += matricesWeights[2];\n            }\n            if(matricesIndices[3] == targetBoneIndex && matricesWeights[3] > 0.){\n                totalWeight += matricesWeights[3];\n            }\n\n            color = mix(color, colorZero, smoothstep(0., 0.25, totalWeight));\n            color = mix(color, colorQuarter, smoothstep(0.25, 0.5, totalWeight));\n            color = mix(color, colorHalf, smoothstep(0.5, 0.75, totalWeight));\n            color = mix(color, colorFull, smoothstep(0.75, 1.0, totalWeight));\n            vColor = color;\n\n        gl_Position = projection * view * worldPos;\n        }";
J.a.ShadersStore["boneWeights:"+q.name+"FragmentShader"]="\n            precision highp float;\n            varying vec3 vPosition;\n\n            varying vec3 vColor;\n\n            void main() {\n                vec4 color = vec4(vColor, 1.0);\n                gl_FragColor = color;\n            }\n        ";c=new I.a("boneWeight:"+q.name,c,{vertex:"boneWeights:"+q.name,fragment:"boneWeights:"+q.name},{attributes:["position","normal","matricesIndices","matricesWeights"],uniforms:"world worldView worldViewProjection view projection viewProjection colorBase colorZero colorQuarter colorHalf colorFull targetBoneIndex".split(" ")});
c.setColor3("colorBase",x);c.setColor3("colorZero",b);c.setColor3("colorQuarter",f);c.setColor3("colorHalf",d);c.setColor3("colorFull",g);c.setFloat("targetBoneIndex",a);c.getClassName=function(){return"BoneWeightShader"};c.transparencyMode=H.a.MATERIAL_OPAQUE;return c};c.CreateSkeletonMapShader=function(a,b){var f,d=a.skeleton;a=null!==(f=a.colorMap)&&void 0!==f?f:[{color:new k.a(1,.38,.18),location:0},{color:new k.a(.59,.18,1),location:.2},{color:new k.a(.59,1,.18),location:.4},{color:new k.a(1,
.87,.17),location:.6},{color:new k.a(1,.17,.42),location:.8},{color:new k.a(.17,.68,1),location:1}];f=c._CreateBoneMapColorBuffer(d.bones.length+1,a,b);b=new I.a("boneWeights:"+d.name,b,{vertexSource:"precision highp float;\n\n            attribute vec3 position;\n            attribute vec2 uv;\n\n            uniform mat4 view;\n            uniform mat4 projection;\n            uniform mat4 worldViewProjection;\n            uniform float colorMap["+4*d.bones.length+"];\n\n            #include<bonesDeclaration>\n            #if NUM_BONE_INFLUENCERS == 0\n                attribute vec4 matricesIndices;\n                attribute vec4 matricesWeights;\n            #endif\n            #include<instancesDeclaration>\n\n            varying vec3 vColor;\n\n            void main() {\n                vec3 positionUpdated = position;\n\n                #include<instancesVertex>\n                #include<bonesVertex>\n\n                vec3 color = vec3(0.);\n                bool first = true;\n\n                for (int i = 0; i < 4; i++) {\n                    int boneIdx = int(matricesIndices[i]);\n                    float boneWgt = matricesWeights[i];\n\n                    vec3 c = vec3(colorMap[boneIdx * 4 + 0], colorMap[boneIdx * 4 + 1], colorMap[boneIdx * 4 + 2]);\n\n                    if (boneWgt > 0.) {\n                        if (first) {\n                            first = false;\n                            color = c;\n                        } else {\n                            color = mix(color, c, boneWgt);\n                        }\n                    }\n                }\n\n                vColor = color;\n\n                vec4 worldPos = finalWorld * vec4(positionUpdated, 1.0);\n\n                gl_Position = projection * view * worldPos;\n            }",
fragmentSource:"\n            precision highp float;\n            varying vec3 vColor;\n\n            void main() {\n                vec4 color = vec4( vColor, 1.0 );\n                gl_FragColor = color;\n            }\n            "},{attributes:["position","normal","matricesIndices","matricesWeights"],uniforms:"world worldView worldViewProjection view projection viewProjection colorMap".split(" ")});b.setFloats("colorMap",f);b.getClassName=function(){return"SkeletonMapShader"};b.transparencyMode=
H.a.MATERIAL_OPAQUE;return b};c._CreateBoneMapColorBuffer=function(a,c,b){b=new L.a("temp",{width:a,height:1},b,!1);var f=b.getContext(),d=f.createLinearGradient(0,0,a,0);c.forEach(function(a){d.addColorStop(a.location,a.color.toHexString())});f.fillStyle=d;f.fillRect(0,0,a,1);b.update();c=[];a=f.getImageData(0,0,a,1).data;f=1/255;for(var g=0;g<a.length;g++)c.push(a[g]*f);b.dispose();return c};Object.defineProperty(c.prototype,"scene",{get:function(){return this._scene},enumerable:!1,configurable:!0});
Object.defineProperty(c.prototype,"utilityLayer",{get:function(){return this._utilityLayer},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"isReady",{get:function(){return this._ready},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"ready",{set:function(a){this._ready=a},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,"debugMesh",{get:function(){return this._debugMesh},set:function(a){this._debugMesh=a},enumerable:!1,configurable:!0});Object.defineProperty(c.prototype,
"displayMode",{get:function(){return this.options.displayMode||c.DISPLAY_LINES},set:function(a){a>c.DISPLAY_SPHERE_AND_SPURS&&(a=c.DISPLAY_LINES);this.options.displayMode=a},enumerable:!1,configurable:!0});c.prototype._bindObs=function(){var a=this;switch(this.displayMode){case c.DISPLAY_LINES:this._obs=this.scene.onBeforeRenderObservable.add(function(){a._displayLinesUpdate()})}};c.prototype.update=function(){switch(this.displayMode){case c.DISPLAY_LINES:this._displayLinesUpdate();break;case c.DISPLAY_SPHERES:this._buildSpheresAndSpurs(!0);
break;case c.DISPLAY_SPHERE_AND_SPURS:this._buildSpheresAndSpurs(!1)}this._buildLocalAxes()};Object.defineProperty(c.prototype,"isEnabled",{get:function(){return this._isEnabled},set:function(a){this.isEnabled!==a&&(this._isEnabled=a,this.debugMesh&&this.debugMesh.setEnabled(a),a&&!this._obs?this._bindObs():!a&&this._obs&&(this.scene.onBeforeRenderObservable.remove(this._obs),this._obs=null))},enumerable:!1,configurable:!0});c.prototype._getBonePosition=function(c,b,f,d,g,e){void 0===d&&(d=0);void 0===
g&&(g=0);void 0===e&&(e=0);var q=a.c.Matrix[0],l=b.getParent();q.copyFrom(b.getLocalMatrix());if(0!==d||0!==g||0!==e)b=a.c.Matrix[1],a.a.IdentityToRef(b),b.setTranslationFromFloats(d,g,e),b.multiplyToRef(q,q);l&&q.multiplyToRef(l.getAbsoluteTransform(),q);q.multiplyToRef(f,q);c.x=q.m[12];c.y=q.m[13];c.z=q.m[14]};c.prototype._getLinesForBonesWithLength=function(c,b){for(var f=c.length,d=this.mesh._effectiveMesh.position,g=0,e=0;e<f;e++){var q=c[e],l=this._debugLines[g];-1!==q._index&&(this._boneIndices.has(q.getIndex())||
this.options.useAllBones)&&(l||(l=[a.e.Zero(),a.e.Zero()],this._debugLines[g]=l),this._getBonePosition(l[0],q,b),this._getBonePosition(l[1],q,b,0,q.length,0),l[0].subtractInPlace(d),l[1].subtractInPlace(d),g++)}};c.prototype._getLinesForBonesNoLength=function(c){for(var b=0,f=this.mesh._effectiveMesh,d=f.position,g=c.length-1;0<=g;g--){var e=c[g],q=e.getParent();if(q&&(this._boneIndices.has(e.getIndex())||this.options.useAllBones)){var l=this._debugLines[b];l||(l=[a.e.Zero(),a.e.Zero()],this._debugLines[b]=
l);e.getAbsolutePositionToRef(f,l[0]);q.getAbsolutePositionToRef(f,l[1]);l[0].subtractInPlace(d);l[1].subtractInPlace(d);b++}}};c.prototype._revert=function(a){this.options.pauseAnimations&&(this.scene.animationsEnabled=a,this.utilityLayer.utilityLayerScene.animationsEnabled=a)};c.prototype._getAbsoluteBindPoseToRef=function(c,b){null===c||-1===c._index?b.copyFrom(a.a.Identity()):(this._getAbsoluteBindPoseToRef(c.getParent(),b),c.getBindPose().multiplyToRef(b,b))};c.prototype._buildSpheresAndSpurs=
function(c){var b,f;void 0===c&&(c=!0);this._debugMesh&&(this._debugMesh.dispose(),this._debugMesh=null,this.ready=!1);this._ready=!1;var d=null===(b=this.utilityLayer)||void 0===b?void 0:b.utilityLayerScene,g=this.skeleton.bones,e=[],l=[];b=this.scene.animationsEnabled;try{this.options.pauseAnimations&&(this.scene.animationsEnabled=!1,d.animationsEnabled=!1);this.options.returnToRest&&this.skeleton.returnToRest();this.autoUpdateBonesMatrices&&this.skeleton.computeAbsoluteTransforms();for(var u=Number.NEGATIVE_INFINITY,
h=this.options.displayOptions||{},k=function(b){var f=g[b];if(-1===f._index||!m._boneIndices.has(f.getIndex())&&!m.options.useAllBones)return"continue";var k=new a.a;m._getAbsoluteBindPoseToRef(f,k);var n=new a.e;k.decompose(void 0,void 0,n);f.children.forEach(function(b,g){var e=new a.a;b.getBindPose().multiplyToRef(k,e);g=new a.e;e.decompose(void 0,void 0,g);e=a.e.Distance(n,g);e>u&&(u=e);if(!c){g=g.clone().subtract(n.clone());var m=g.length();g=g.normalize().scale(m);var w=h.midStepFactor||.215;
e=g.scale(h.midStep||.165);g=M.a.ExtrudeShapeCustom("skeletonViewer",{shape:[new a.e(1,-1,0),new a.e(1,1,0),new a.e(-1,1,0),new a.e(-1,-1,0),new a.e(1,-1,0)],path:[a.e.Zero(),e,g],scaleFunction:function(a){switch(a){case 1:return m*w}return 0},sideOrientation:q.a.DEFAULTSIDE,updatable:!1},d);e=g.getTotalVertices();for(var p=[],r=[],x=0;x<e;x++)p.push(1,0,0,0),h.spurFollowsChild&&9<x?r.push(b.getIndex(),0,0,0):r.push(f.getIndex(),0,0,0);g.position=n.clone();g.setVerticesData(z.b.MatricesWeightsKind,
p,!1);g.setVerticesData(z.b.MatricesIndicesKind,r,!1);g.convertToFlatShadedMesh();l.push(g)}});b=w.a.CreateSphere("skeletonViewer",{segments:6,diameter:h.sphereBaseSize||.2,updatable:!0},d);for(var p=b.getTotalVertices(),r=[],x=[],v=0;v<p;v++)r.push(1,0,0,0),x.push(f.getIndex(),0,0,0);b.setVerticesData(z.b.MatricesWeightsKind,r,!1);b.setVerticesData(z.b.MatricesIndicesKind,x,!1);b.position=n.clone();e.push([b,f])},m=this,n=0;n<g.length;n++)k(n);var p=h.sphereScaleUnit||2,r=h.sphereFactor||.85;k=[];
for(n=0;n<e.length;n++){for(var K=e[n],t=K[0],F=1/(p/u),A=0,y=K[1];y.getParent()&&-1!==y.getParent().getIndex();)A++,y=y.getParent();t.scaling.scaleInPlace(F*Math.pow(r,A));k.push(t)}if(this.debugMesh=q.a.MergeMeshes(k.concat(l),!0,!0))this.debugMesh.renderingGroupId=this.renderingGroupId,this.debugMesh.skeleton=this.skeleton,this.debugMesh.parent=this.mesh,this.debugMesh.computeBonesUsingShaders=null!==(f=this.options.computeBonesUsingShaders)&&void 0!==f?f:!0,this.debugMesh.alwaysSelectAsActiveMesh=
!0;this.utilityLayer._getSharedGizmoLight().intensity=.7;this._revert(b);this.ready=!0}catch(N){console.error(N),this._revert(b),this.dispose()}};c.prototype._buildLocalAxes=function(){var c;this._localAxes&&this._localAxes.dispose();this._localAxes=null;var b=this.options.displayOptions||{};if(b.showLocalAxes){var f=this._utilityLayer.utilityLayerScene;b=b.localAxesSize||.075;var d=[],g=[],e=new k.b(1,0,0,1),q=new k.b(0,1,0,1),h=new k.b(0,0,1,1),u=[],m=[],n;for(n in this.skeleton.bones){var w=this.skeleton.bones[n];
if(-1!==w._index&&(this._boneIndices.has(w.getIndex())||this.options.useAllBones)){var r=new a.a,p=new a.e;this._getAbsoluteBindPoseToRef(w,r);r.decompose(void 0,void 0,p);var t=w.getBindPose().getRotationMatrix();r=a.e.TransformCoordinates(new a.e(0+b,0,0),t);var y=a.e.TransformCoordinates(new a.e(0,0+b,0),t);t=a.e.TransformCoordinates(new a.e(0,0,0+b),t);r=[p,p.add(r)];y=[p,p.add(y)];p=[p,p.add(t)];t=[[e,e],[q,q],[h,h]];d.push.apply(d,[r,y,p]);g.push.apply(g,t);for(p=0;6>p;p++)u.push(1,0,0,0),m.push(w.getIndex(),
0,0,0)}}this._localAxes=G.a.CreateLineSystem("localAxes",{lines:d,colors:g,updatable:!0},f);this._localAxes.setVerticesData(z.b.MatricesWeightsKind,u,!1);this._localAxes.setVerticesData(z.b.MatricesIndicesKind,m,!1);this._localAxes.skeleton=this.skeleton;this._localAxes.renderingGroupId=this.renderingGroupId;this._localAxes.parent=this.mesh;this._localAxes.computeBonesUsingShaders=null!==(c=this.options.computeBonesUsingShaders)&&void 0!==c?c:!0}};c.prototype._displayLinesUpdate=function(){if(this._utilityLayer){this.autoUpdateBonesMatrices&&
this.skeleton.computeAbsoluteTransforms();var a=this.mesh._effectiveMesh;void 0===this.skeleton.bones[0].length?this._getLinesForBonesNoLength(this.skeleton.bones):this._getLinesForBonesWithLength(this.skeleton.bones,a.getWorldMatrix());if(a=this._utilityLayer.utilityLayerScene)this._debugMesh?G.a.CreateLineSystem("",{lines:this._debugLines,updatable:!0,instance:this._debugMesh},a):(this._debugMesh=G.a.CreateLineSystem("",{lines:this._debugLines,updatable:!0,instance:null},a),this._debugMesh.renderingGroupId=
this.renderingGroupId),this._debugMesh.position.copyFrom(this.mesh.position),this._debugMesh.color=this.color}};c.prototype.changeDisplayMode=function(a){var c=this.isEnabled?!0:!1;this.displayMode!==a&&(this.isEnabled=!1,this._debugMesh&&(this._debugMesh.dispose(),this._debugMesh=null,this.ready=!1),this.displayMode=a,this.update(),this._bindObs(),this.isEnabled=c)};c.prototype.changeDisplayOptions=function(a,c){var b=this.isEnabled?!0:!1;this.options.displayOptions[a]=c;this.isEnabled=!1;this._debugMesh&&
(this._debugMesh.dispose(),this._debugMesh=null,this.ready=!1);this.update();this._bindObs();this.isEnabled=b};c.prototype.dispose=function(){this.isEnabled=!1;this._debugMesh&&(this._debugMesh.dispose(),this._debugMesh=null);this._utilityLayer&&(this._utilityLayer.dispose(),this._utilityLayer=null);this.ready=!1};c.DISPLAY_LINES=0;c.DISPLAY_SPHERES=1;c.DISPLAY_SPHERE_AND_SPURS=2;return c})()},VThl:function(b,h,d){var a;(function(a){a[a.Generic=0]="Generic";a[a.Keyboard=1]="Keyboard";a[a.Mouse=2]=
"Mouse";a[a.Touch=3]="Touch";a[a.DualShock=4]="DualShock";a[a.Xbox=5]="Xbox";a[a.Switch=6]="Switch"})(a||(a={}));var e;(function(a){a[a.Horizontal=0]="Horizontal";a[a.Vertical=1]="Vertical";a[a.LeftClick=2]="LeftClick";a[a.MiddleClick=3]="MiddleClick";a[a.RightClick=4]="RightClick";a[a.BrowserBack=5]="BrowserBack";a[a.BrowserForward=6]="BrowserForward"})(e||(e={}));var n;(function(a){a[a.Cross=0]="Cross";a[a.Circle=1]="Circle";a[a.Square=2]="Square";a[a.Triangle=3]="Triangle";a[a.L1=4]="L1";a[a.R1=
5]="R1";a[a.L2=6]="L2";a[a.R2=7]="R2";a[a.Share=8]="Share";a[a.Options=9]="Options";a[a.L3=10]="L3";a[a.R3=11]="R3";a[a.DPadUp=12]="DPadUp";a[a.DPadDown=13]="DPadDown";a[a.DPadLeft=14]="DPadLeft";a[a.DPadRight=15]="DPadRight";a[a.Home=16]="Home";a[a.TouchPad=17]="TouchPad";a[a.LStickXAxis=18]="LStickXAxis";a[a.LStickYAxis=19]="LStickYAxis";a[a.RStickXAxis=20]="RStickXAxis";a[a.RStickYAxis=21]="RStickYAxis"})(n||(n={}));var k;(function(a){a[a.A=0]="A";a[a.B=1]="B";a[a.X=2]="X";a[a.Y=3]="Y";a[a.LB=
4]="LB";a[a.RB=5]="RB";a[a.LT=6]="LT";a[a.RT=7]="RT";a[a.Back=8]="Back";a[a.Start=9]="Start";a[a.LS=10]="LS";a[a.RS=11]="RS";a[a.DPadUp=12]="DPadUp";a[a.DPadDown=13]="DPadDown";a[a.DPadLeft=14]="DPadLeft";a[a.DPadRight=15]="DPadRight";a[a.Home=16]="Home";a[a.LStickXAxis=17]="LStickXAxis";a[a.LStickYAxis=18]="LStickYAxis";a[a.RStickXAxis=19]="RStickXAxis";a[a.RStickYAxis=20]="RStickYAxis"})(k||(k={}));var r;(function(a){a[a.B=0]="B";a[a.A=1]="A";a[a.Y=2]="Y";a[a.X=3]="X";a[a.L=4]="L";a[a.R=5]="R";
a[a.ZL=6]="ZL";a[a.ZR=7]="ZR";a[a.Minus=8]="Minus";a[a.Plus=9]="Plus";a[a.LS=10]="LS";a[a.RS=11]="RS";a[a.DPadUp=12]="DPadUp";a[a.DPadDown=13]="DPadDown";a[a.DPadLeft=14]="DPadLeft";a[a.DPadRight=15]="DPadRight";a[a.Home=16]="Home";a[a.Capture=17]="Capture";a[a.LStickXAxis=18]="LStickXAxis";a[a.LStickYAxis=19]="LStickYAxis";a[a.RStickXAxis=20]="RStickXAxis";a[a.RStickYAxis=21]="RStickYAxis"})(r||(r={}));var m=function(){function b(a){this.onDeviceDisconnected=function(){};this._inputs=[];this._pointerActive=
this._keyboardActive=!1;this._keyboardDownEvent=function(a){};this._keyboardUpEvent=function(a){};this._pointerMoveEvent=function(a){};this._pointerDownEvent=function(a){};this._pointerUpEvent=function(a){};this._gamepadConnectedEvent=function(a){};this._gamepadDisconnectedEvent=function(a){};this._onDeviceConnected=function(){};if(a=a.getInputElement())this._elementToAttachTo=a,this._handleKeyActions(),this._handlePointerActions(),this._handleGamepadActions(),this._checkForConnectedDevices()}Object.defineProperty(b.prototype,
"onDeviceConnected",{get:function(){return this._onDeviceConnected},set:function(a){this._onDeviceConnected=a;for(a=0;a<this._inputs.length;a++)if(this._inputs[a])for(var b=0;b<this._inputs[a].length;b++)this._inputs[a][b]&&this._onDeviceConnected(a,b)},enumerable:!1,configurable:!0});b.Create=function(a){return"undefined"!==typeof _native&&_native.DeviceInputSystem?new _native.DeviceInputSystem(a):new b(a)};b.prototype.pollInput=function(b,c,d){var f=this._inputs[b][c];if(!f)throw"Unable to find device "+
a[b];this._updateDevice(b,c,d);if(void 0===f[d])throw"Unable to find input "+d+" for device "+a[b]+" in slot "+c;return f[d]};b.prototype.dispose=function(){this._keyboardActive&&(window.removeEventListener("keydown",this._keyboardDownEvent),window.removeEventListener("keyup",this._keyboardUpEvent));this._pointerActive&&(this._elementToAttachTo.removeEventListener("pointermove",this._pointerMoveEvent),this._elementToAttachTo.removeEventListener("pointerdown",this._pointerDownEvent),this._elementToAttachTo.removeEventListener("pointerup",
this._pointerUpEvent));window.removeEventListener("gamepadconnected",this._gamepadConnectedEvent);window.removeEventListener("gamepaddisconnected",this._gamepadDisconnectedEvent)};b.prototype._checkForConnectedDevices=function(){for(var b=0,c=navigator.getGamepads();b<c.length;b++){var d=c[b];d&&this._addGamePad(d)}matchMedia("(pointer:fine)").matches&&this._addPointerDevice(a.Mouse,0,0,0)};b.prototype._addGamePad=function(a){var b=this._getGamepadDeviceType(a.id),c=a.index;this._registerDevice(b,
c,a.buttons.length+a.axes.length);this._gamepads=this._gamepads||Array(a.index+1);this._gamepads[c]=b};b.prototype._addPointerDevice=function(a,c,d,e){this._pointerActive=!0;this._registerDevice(a,c,b._MAX_POINTER_INPUTS);a=this._inputs[a][c];a[0]=d;a[1]=e};b.prototype._registerDevice=function(a,b,c){this._inputs[a]||(this._inputs[a]=[]);if(!this._inputs[a][b]){for(var d=Array(c),f=0;f<c;f++)d[f]=0;this._inputs[a][b]=d;this.onDeviceConnected(a,b)}};b.prototype._unregisterDevice=function(a,b){this._inputs[a][b]&&
(delete this._inputs[a][b],this.onDeviceDisconnected(a,b))};b.prototype._handleKeyActions=function(){var c=this;this._keyboardDownEvent=function(d){c._keyboardActive||(c._keyboardActive=!0,c._registerDevice(a.Keyboard,0,b._MAX_KEYCODES));var f=c._inputs[a.Keyboard][0];if(f){if(c.onInputChanged)c.onInputChanged(a.Keyboard,0,d.keyCode,f[d.keyCode],1);f[d.keyCode]=1}};this._keyboardUpEvent=function(b){var d=c._inputs[a.Keyboard][0];if(d){if(c.onInputChanged)c.onInputChanged(a.Keyboard,0,b.keyCode,d[b.keyCode],
0);d[b.keyCode]=0}};window.addEventListener("keydown",this._keyboardDownEvent);window.addEventListener("keyup",this._keyboardUpEvent)};b.prototype._handlePointerActions=function(){var b=this;this._pointerMoveEvent=function(c){var d="mouse"==c.pointerType?a.Mouse:a.Touch,f="mouse"==c.pointerType?0:c.pointerId;b._inputs[d]||(b._inputs[d]=[]);b._inputs[d][f]||b._addPointerDevice(d,f,c.clientX,c.clientY);var e=b._inputs[d][f];e&&(b.onInputChanged&&(b.onInputChanged(d,f,0,e[0],c.clientX),b.onInputChanged(d,
f,1,e[1],c.clientY)),e[0]=c.clientX,e[1]=c.clientY)};this._pointerDownEvent=function(c){var d="mouse"==c.pointerType?a.Mouse:a.Touch,f="mouse"==c.pointerType?0:c.pointerId;b._inputs[d]||(b._inputs[d]=[]);b._inputs[d][f]||b._addPointerDevice(d,f,c.clientX,c.clientY);var e=b._inputs[d][f];e&&(b.onInputChanged&&(b.onInputChanged(d,f,0,e[0],c.clientX),b.onInputChanged(d,f,1,e[1],c.clientY),b.onInputChanged(d,f,c.button+2,e[c.button+2],1)),e[0]=c.clientX,e[1]=c.clientY,e[c.button+2]=1)};this._pointerUpEvent=
function(c){var d="mouse"==c.pointerType?a.Mouse:a.Touch,f="mouse"==c.pointerType?0:c.pointerId,e=b._inputs[d][f];if(e){if(b.onInputChanged)b.onInputChanged(d,f,c.button+2,e[c.button+2],0);e[0]=c.clientX;e[1]=c.clientY;e[c.button+2]=0}"mouse"!=c.pointerType&&b._unregisterDevice(d,f)};this._elementToAttachTo.addEventListener("pointermove",this._pointerMoveEvent);this._elementToAttachTo.addEventListener("pointerdown",this._pointerDownEvent);this._elementToAttachTo.addEventListener("pointerup",this._pointerUpEvent)};
b.prototype._handleGamepadActions=function(){var a=this;this._gamepadConnectedEvent=function(b){a._addGamePad(b.gamepad)};this._gamepadDisconnectedEvent=function(b){if(a._gamepads){var c=a._getGamepadDeviceType(b.gamepad.id);b=b.gamepad.index;a._unregisterDevice(c,b);delete a._gamepads[b]}};window.addEventListener("gamepadconnected",this._gamepadConnectedEvent);window.addEventListener("gamepaddisconnected",this._gamepadDisconnectedEvent)};b.prototype._updateDevice=function(a,b,c){var d=navigator.getGamepads()[b];
d&&a==this._gamepads[b]&&(this._inputs[a][b][c]=c>=d.buttons.length?d.axes[c-d.buttons.length].valueOf():d.buttons[c].value)};b.prototype._getGamepadDeviceType=function(b){return-1!==b.indexOf("054c")?a.DualShock:-1!==b.indexOf("Xbox One")||-1!==b.search("Xbox 360")||-1!==b.search("xinput")?a.Xbox:-1!==b.indexOf("057e")?a.Switch:a.Generic};b._MAX_KEYCODES=255;b._MAX_POINTER_INPUTS=7;return b}(),p=d("ps+7"),B=function(){function a(a,b,c){void 0===c&&(c=0);this.deviceType=b;this.deviceSlot=c;this.onInputChangedObservable=
new p.a;this._deviceInputSystem=a}a.prototype.getInput=function(a){return this._deviceInputSystem.pollInput(this.deviceType,this.deviceSlot,a)};return a}();(function(){function b(b){var c=this;this.onDeviceConnectedObservable=new p.a(function(a){c.getDevices().forEach(function(b){c.onDeviceConnectedObservable.notifyObserver(a,b)})});this.onDeviceDisconnectedObservable=new p.a;var d=Object.keys(a).length/2;this._devices=Array(d);this._firstDevice=Array(d);this._deviceInputSystem=m.Create(b);this._deviceInputSystem.onDeviceConnected=
function(a,b){c._addDevice(a,b);c.onDeviceConnectedObservable.notifyObservers(c.getDeviceSource(a,b))};this._deviceInputSystem.onDeviceDisconnected=function(a,b){var d=c.getDeviceSource(a,b);c._removeDevice(a,b);c.onDeviceDisconnectedObservable.notifyObservers(d)};this._deviceInputSystem.onInputChanged||(this._deviceInputSystem.onInputChanged=function(a,b,d,e,f){var g;null===(g=c.getDeviceSource(a,b))||void 0===g?void 0:g.onInputChangedObservable.notifyObservers({inputIndex:d,previousState:e,currentState:f})})}
b.prototype.getDeviceSource=function(a,b){if(void 0===b){if(void 0===this._firstDevice[a])return null;b=this._firstDevice[a]}return this._devices[a]&&void 0!==this._devices[a][b]?this._devices[a][b]:null};b.prototype.getDeviceSources=function(a){return this._devices[a].filter(function(a){return!!a})};b.prototype.getDevices=function(){var a=[];this._devices.forEach(function(b){a.push.apply(a,b)});return a};b.prototype.dispose=function(){this.onDeviceConnectedObservable.clear();this.onDeviceDisconnectedObservable.clear();
this._deviceInputSystem.dispose()};b.prototype._addDevice=function(a,b){this._devices[a]||(this._devices[a]=[]);this._devices[a][b]||(this._devices[a][b]=new B(this._deviceInputSystem,a,b),this._updateFirstDevices(a))};b.prototype._removeDevice=function(a,b){delete this._devices[a][b];this._updateFirstDevices(a)};b.prototype._updateFirstDevices=function(b){switch(b){case a.Keyboard:case a.Mouse:this._firstDevice[b]=0;break;case a.Touch:case a.DualShock:case a.Xbox:case a.Switch:case a.Generic:var c=
this._devices[b];delete this._firstDevice[b];for(var d=0;d<c.length;d++)if(c[d]){this._firstDevice[b]=d;break}}};return b})()}}]);
